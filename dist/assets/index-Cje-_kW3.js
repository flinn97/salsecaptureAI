var K9=Object.defineProperty;var DR=i=>{throw TypeError(i)};var J9=(i,e,t)=>e in i?K9(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var re=(i,e,t)=>J9(i,typeof e!="symbol"?e+"":e,t),hE=(i,e,t)=>e.has(i)||DR("Cannot "+t);var f=(i,e,t)=>(hE(i,e,"read from private field"),t?t.call(i):e.get(i)),z=(i,e,t)=>e.has(i)?DR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),U=(i,e,t,n)=>(hE(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),W=(i,e,t)=>(hE(i,e,"access private method"),t);var ir=(i,e,t,n)=>({set _(r){U(i,e,r,t)},get _(){return f(i,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var cp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function M0(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var dE={exports:{}},Gg={},fE={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kR;function Y9(){if(kR)return It;kR=1;var i=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),m=Symbol.iterator;function p(q){return q===null||typeof q!="object"?null:(q=m&&q[m]||q["@@iterator"],typeof q=="function"?q:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function A(q,H,G){this.props=q,this.context=H,this.refs=b,this.updater=G||g}A.prototype.isReactComponent={},A.prototype.setState=function(q,H){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,H,"setState")},A.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function _(){}_.prototype=A.prototype;function C(q,H,G){this.props=q,this.context=H,this.refs=b,this.updater=G||g}var I=C.prototype=new _;I.constructor=C,w(I,A.prototype),I.isPureReactComponent=!0;var S=Array.isArray,R=Object.prototype.hasOwnProperty,L={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function T(q,H,G){var le,se={},X=null,ne=null;if(H!=null)for(le in H.ref!==void 0&&(ne=H.ref),H.key!==void 0&&(X=""+H.key),H)R.call(H,le)&&!k.hasOwnProperty(le)&&(se[le]=H[le]);var te=arguments.length-2;if(te===1)se.children=G;else if(1<te){for(var ae=Array(te),de=0;de<te;de++)ae[de]=arguments[de+2];se.children=ae}if(q&&q.defaultProps)for(le in te=q.defaultProps,te)se[le]===void 0&&(se[le]=te[le]);return{$$typeof:i,type:q,key:X,ref:ne,props:se,_owner:L.current}}function D(q,H){return{$$typeof:i,type:q.type,key:H,ref:q.ref,props:q.props,_owner:q._owner}}function P(q){return typeof q=="object"&&q!==null&&q.$$typeof===i}function N(q){var H={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(G){return H[G]})}var F=/\/+/g;function M(q,H){return typeof q=="object"&&q!==null&&q.key!=null?N(""+q.key):H.toString(36)}function $(q,H,G,le,se){var X=typeof q;(X==="undefined"||X==="boolean")&&(q=null);var ne=!1;if(q===null)ne=!0;else switch(X){case"string":case"number":ne=!0;break;case"object":switch(q.$$typeof){case i:case e:ne=!0}}if(ne)return ne=q,se=se(ne),q=le===""?"."+M(ne,0):le,S(se)?(G="",q!=null&&(G=q.replace(F,"$&/")+"/"),$(se,H,G,"",function(de){return de})):se!=null&&(P(se)&&(se=D(se,G+(!se.key||ne&&ne.key===se.key?"":(""+se.key).replace(F,"$&/")+"/")+q)),H.push(se)),1;if(ne=0,le=le===""?".":le+":",S(q))for(var te=0;te<q.length;te++){X=q[te];var ae=le+M(X,te);ne+=$(X,H,G,ae,se)}else if(ae=p(q),typeof ae=="function")for(q=ae.call(q),te=0;!(X=q.next()).done;)X=X.value,ae=le+M(X,te++),ne+=$(X,H,G,ae,se);else if(X==="object")throw H=String(q),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return ne}function Q(q,H,G){if(q==null)return q;var le=[],se=0;return $(q,le,"","",function(X){return H.call(G,X,se++)}),le}function ie(q){if(q._status===-1){var H=q._result;H=H(),H.then(function(G){(q._status===0||q._status===-1)&&(q._status=1,q._result=G)},function(G){(q._status===0||q._status===-1)&&(q._status=2,q._result=G)}),q._status===-1&&(q._status=0,q._result=H)}if(q._status===1)return q._result.default;throw q._result}var ee={current:null},ue={transition:null},Y={ReactCurrentDispatcher:ee,ReactCurrentBatchConfig:ue,ReactCurrentOwner:L};function J(){throw Error("act(...) is not supported in production builds of React.")}return It.Children={map:Q,forEach:function(q,H,G){Q(q,function(){H.apply(this,arguments)},G)},count:function(q){var H=0;return Q(q,function(){H++}),H},toArray:function(q){return Q(q,function(H){return H})||[]},only:function(q){if(!P(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},It.Component=A,It.Fragment=t,It.Profiler=r,It.PureComponent=C,It.StrictMode=n,It.Suspense=u,It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,It.act=J,It.cloneElement=function(q,H,G){if(q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+q+".");var le=w({},q.props),se=q.key,X=q.ref,ne=q._owner;if(H!=null){if(H.ref!==void 0&&(X=H.ref,ne=L.current),H.key!==void 0&&(se=""+H.key),q.type&&q.type.defaultProps)var te=q.type.defaultProps;for(ae in H)R.call(H,ae)&&!k.hasOwnProperty(ae)&&(le[ae]=H[ae]===void 0&&te!==void 0?te[ae]:H[ae])}var ae=arguments.length-2;if(ae===1)le.children=G;else if(1<ae){te=Array(ae);for(var de=0;de<ae;de++)te[de]=arguments[de+2];le.children=te}return{$$typeof:i,type:q.type,key:se,ref:X,props:le,_owner:ne}},It.createContext=function(q){return q={$$typeof:o,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},q.Provider={$$typeof:s,_context:q},q.Consumer=q},It.createElement=T,It.createFactory=function(q){var H=T.bind(null,q);return H.type=q,H},It.createRef=function(){return{current:null}},It.forwardRef=function(q){return{$$typeof:a,render:q}},It.isValidElement=P,It.lazy=function(q){return{$$typeof:d,_payload:{_status:-1,_result:q},_init:ie}},It.memo=function(q,H){return{$$typeof:c,type:q,compare:H===void 0?null:H}},It.startTransition=function(q){var H=ue.transition;ue.transition={};try{q()}finally{ue.transition=H}},It.unstable_act=J,It.useCallback=function(q,H){return ee.current.useCallback(q,H)},It.useContext=function(q){return ee.current.useContext(q)},It.useDebugValue=function(){},It.useDeferredValue=function(q){return ee.current.useDeferredValue(q)},It.useEffect=function(q,H){return ee.current.useEffect(q,H)},It.useId=function(){return ee.current.useId()},It.useImperativeHandle=function(q,H,G){return ee.current.useImperativeHandle(q,H,G)},It.useInsertionEffect=function(q,H){return ee.current.useInsertionEffect(q,H)},It.useLayoutEffect=function(q,H){return ee.current.useLayoutEffect(q,H)},It.useMemo=function(q,H){return ee.current.useMemo(q,H)},It.useReducer=function(q,H,G){return ee.current.useReducer(q,H,G)},It.useRef=function(q){return ee.current.useRef(q)},It.useState=function(q){return ee.current.useState(q)},It.useSyncExternalStore=function(q,H,G){return ee.current.useSyncExternalStore(q,H,G)},It.useTransition=function(){return ee.current.useTransition()},It.version="18.3.1",It}var RR;function q1(){return RR||(RR=1,fE.exports=Y9()),fE.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PR;function X9(){if(PR)return Gg;PR=1;var i=q1(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,u,c){var d,m={},p=null,g=null;c!==void 0&&(p=""+c),u.key!==void 0&&(p=""+u.key),u.ref!==void 0&&(g=u.ref);for(d in u)n.call(u,d)&&!s.hasOwnProperty(d)&&(m[d]=u[d]);if(a&&a.defaultProps)for(d in u=a.defaultProps,u)m[d]===void 0&&(m[d]=u[d]);return{$$typeof:e,type:a,key:p,ref:g,props:m,_owner:r.current}}return Gg.Fragment=t,Gg.jsx=o,Gg.jsxs=o,Gg}var NR;function Q9(){return NR||(NR=1,dE.exports=X9()),dE.exports}var v=Q9(),Ae=q1();const ze=M0(Ae);var Aw={},pE={exports:{}},Ni={},mE={exports:{}},gE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OR;function Z9(){return OR||(OR=1,function(i){function e(ue,Y){var J=ue.length;ue.push(Y);e:for(;0<J;){var q=J-1>>>1,H=ue[q];if(0<r(H,Y))ue[q]=Y,ue[J]=H,J=q;else break e}}function t(ue){return ue.length===0?null:ue[0]}function n(ue){if(ue.length===0)return null;var Y=ue[0],J=ue.pop();if(J!==Y){ue[0]=J;e:for(var q=0,H=ue.length,G=H>>>1;q<G;){var le=2*(q+1)-1,se=ue[le],X=le+1,ne=ue[X];if(0>r(se,J))X<H&&0>r(ne,se)?(ue[q]=ne,ue[X]=J,q=X):(ue[q]=se,ue[le]=J,q=le);else if(X<H&&0>r(ne,J))ue[q]=ne,ue[X]=J,q=X;else break e}}return Y}function r(ue,Y){var J=ue.sortIndex-Y.sortIndex;return J!==0?J:ue.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();i.unstable_now=function(){return o.now()-a}}var u=[],c=[],d=1,m=null,p=3,g=!1,w=!1,b=!1,A=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(ue){for(var Y=t(c);Y!==null;){if(Y.callback===null)n(c);else if(Y.startTime<=ue)n(c),Y.sortIndex=Y.expirationTime,e(u,Y);else break;Y=t(c)}}function S(ue){if(b=!1,I(ue),!w)if(t(u)!==null)w=!0,ie(R);else{var Y=t(c);Y!==null&&ee(S,Y.startTime-ue)}}function R(ue,Y){w=!1,b&&(b=!1,_(T),T=-1),g=!0;var J=p;try{for(I(Y),m=t(u);m!==null&&(!(m.expirationTime>Y)||ue&&!N());){var q=m.callback;if(typeof q=="function"){m.callback=null,p=m.priorityLevel;var H=q(m.expirationTime<=Y);Y=i.unstable_now(),typeof H=="function"?m.callback=H:m===t(u)&&n(u),I(Y)}else n(u);m=t(u)}if(m!==null)var G=!0;else{var le=t(c);le!==null&&ee(S,le.startTime-Y),G=!1}return G}finally{m=null,p=J,g=!1}}var L=!1,k=null,T=-1,D=5,P=-1;function N(){return!(i.unstable_now()-P<D)}function F(){if(k!==null){var ue=i.unstable_now();P=ue;var Y=!0;try{Y=k(!0,ue)}finally{Y?M():(L=!1,k=null)}}else L=!1}var M;if(typeof C=="function")M=function(){C(F)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,Q=$.port2;$.port1.onmessage=F,M=function(){Q.postMessage(null)}}else M=function(){A(F,0)};function ie(ue){k=ue,L||(L=!0,M())}function ee(ue,Y){T=A(function(){ue(i.unstable_now())},Y)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(ue){ue.callback=null},i.unstable_continueExecution=function(){w||g||(w=!0,ie(R))},i.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<ue?Math.floor(1e3/ue):5},i.unstable_getCurrentPriorityLevel=function(){return p},i.unstable_getFirstCallbackNode=function(){return t(u)},i.unstable_next=function(ue){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var J=p;p=Y;try{return ue()}finally{p=J}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(ue,Y){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var J=p;p=ue;try{return Y()}finally{p=J}},i.unstable_scheduleCallback=function(ue,Y,J){var q=i.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?q+J:q):J=q,ue){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=J+H,ue={id:d++,callback:Y,priorityLevel:ue,startTime:J,expirationTime:H,sortIndex:-1},J>q?(ue.sortIndex=J,e(c,ue),t(u)===null&&ue===t(c)&&(b?(_(T),T=-1):b=!0,ee(S,J-q))):(ue.sortIndex=H,e(u,ue),w||g||(w=!0,ie(R))),ue},i.unstable_shouldYield=N,i.unstable_wrapCallback=function(ue){var Y=p;return function(){var J=p;p=Y;try{return ue.apply(this,arguments)}finally{p=J}}}}(gE)),gE}var LR;function e6(){return LR||(LR=1,mE.exports=Z9()),mE.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FR;function t6(){if(FR)return Ni;FR=1;var i=q1(),e=e6();function t(l){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+l,y=1;y<arguments.length;y++)h+="&args[]="+encodeURIComponent(arguments[y]);return"Minified React error #"+l+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,r={};function s(l,h){o(l,h),o(l+"Capture",h)}function o(l,h){for(r[l]=h,l=0;l<h.length;l++)n.add(h[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},m={};function p(l){return u.call(m,l)?!0:u.call(d,l)?!1:c.test(l)?m[l]=!0:(d[l]=!0,!1)}function g(l,h,y,x){if(y!==null&&y.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return x?!1:y!==null?!y.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function w(l,h,y,x){if(h===null||typeof h>"u"||g(l,h,y,x))return!0;if(x)return!1;if(y!==null)switch(y.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function b(l,h,y,x,O,j,K){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=x,this.attributeNamespace=O,this.mustUseProperty=y,this.propertyName=l,this.type=h,this.sanitizeURL=j,this.removeEmptyString=K}var A={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){A[l]=new b(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var h=l[0];A[h]=new b(h,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){A[l]=new b(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){A[l]=new b(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){A[l]=new b(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){A[l]=new b(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){A[l]=new b(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){A[l]=new b(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){A[l]=new b(l,5,!1,l.toLowerCase(),null,!1,!1)});var _=/[\-:]([a-z])/g;function C(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var h=l.replace(_,C);A[h]=new b(h,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var h=l.replace(_,C);A[h]=new b(h,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var h=l.replace(_,C);A[h]=new b(h,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){A[l]=new b(l,1,!1,l.toLowerCase(),null,!1,!1)}),A.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){A[l]=new b(l,1,!1,l.toLowerCase(),null,!0,!0)});function I(l,h,y,x){var O=A.hasOwnProperty(h)?A[h]:null;(O!==null?O.type!==0:x||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(w(h,y,O,x)&&(y=null),x||O===null?p(h)&&(y===null?l.removeAttribute(h):l.setAttribute(h,""+y)):O.mustUseProperty?l[O.propertyName]=y===null?O.type===3?!1:"":y:(h=O.attributeName,x=O.attributeNamespace,y===null?l.removeAttribute(h):(O=O.type,y=O===3||O===4&&y===!0?"":""+y,x?l.setAttributeNS(x,h,y):l.setAttribute(h,y))))}var S=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),L=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),N=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),Q=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),ee=Symbol.for("react.offscreen"),ue=Symbol.iterator;function Y(l){return l===null||typeof l!="object"?null:(l=ue&&l[ue]||l["@@iterator"],typeof l=="function"?l:null)}var J=Object.assign,q;function H(l){if(q===void 0)try{throw Error()}catch(y){var h=y.stack.trim().match(/\n( *(at )?)/);q=h&&h[1]||""}return`
`+q+l}var G=!1;function le(l,h){if(!l||G)return"";G=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(we){var x=we}Reflect.construct(l,[],h)}else{try{h.call()}catch(we){x=we}l.call(h.prototype)}else{try{throw Error()}catch(we){x=we}l()}}catch(we){if(we&&x&&typeof we.stack=="string"){for(var O=we.stack.split(`
`),j=x.stack.split(`
`),K=O.length-1,oe=j.length-1;1<=K&&0<=oe&&O[K]!==j[oe];)oe--;for(;1<=K&&0<=oe;K--,oe--)if(O[K]!==j[oe]){if(K!==1||oe!==1)do if(K--,oe--,0>oe||O[K]!==j[oe]){var ce=`
`+O[K].replace(" at new "," at ");return l.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",l.displayName)),ce}while(1<=K&&0<=oe);break}}}finally{G=!1,Error.prepareStackTrace=y}return(l=l?l.displayName||l.name:"")?H(l):""}function se(l){switch(l.tag){case 5:return H(l.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return l=le(l.type,!1),l;case 11:return l=le(l.type.render,!1),l;case 1:return l=le(l.type,!0),l;default:return""}}function X(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case k:return"Fragment";case L:return"Portal";case D:return"Profiler";case T:return"StrictMode";case M:return"Suspense";case $:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case N:return(l.displayName||"Context")+".Consumer";case P:return(l._context.displayName||"Context")+".Provider";case F:var h=l.render;return l=l.displayName,l||(l=h.displayName||h.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case Q:return h=l.displayName||null,h!==null?h:X(l.type)||"Memo";case ie:h=l._payload,l=l._init;try{return X(l(h))}catch{}}return null}function ne(l){var h=l.type;switch(l.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=h.render,l=l.displayName||l.name||"",h.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X(h);case 8:return h===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function te(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function ae(l){var h=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function de(l){var h=ae(l)?"checked":"value",y=Object.getOwnPropertyDescriptor(l.constructor.prototype,h),x=""+l[h];if(!l.hasOwnProperty(h)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var O=y.get,j=y.set;return Object.defineProperty(l,h,{configurable:!0,get:function(){return O.call(this)},set:function(K){x=""+K,j.call(this,K)}}),Object.defineProperty(l,h,{enumerable:y.enumerable}),{getValue:function(){return x},setValue:function(K){x=""+K},stopTracking:function(){l._valueTracker=null,delete l[h]}}}}function ye(l){l._valueTracker||(l._valueTracker=de(l))}function xe(l){if(!l)return!1;var h=l._valueTracker;if(!h)return!0;var y=h.getValue(),x="";return l&&(x=ae(l)?l.checked?"true":"false":l.value),l=x,l!==y?(h.setValue(l),!0):!1}function Oe(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function Fe(l,h){var y=h.checked;return J({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:y??l._wrapperState.initialChecked})}function Be(l,h){var y=h.defaultValue==null?"":h.defaultValue,x=h.checked!=null?h.checked:h.defaultChecked;y=te(h.value!=null?h.value:y),l._wrapperState={initialChecked:x,initialValue:y,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function We(l,h){h=h.checked,h!=null&&I(l,"checked",h,!1)}function mt(l,h){We(l,h);var y=te(h.value),x=h.type;if(y!=null)x==="number"?(y===0&&l.value===""||l.value!=y)&&(l.value=""+y):l.value!==""+y&&(l.value=""+y);else if(x==="submit"||x==="reset"){l.removeAttribute("value");return}h.hasOwnProperty("value")?ve(l,h.type,y):h.hasOwnProperty("defaultValue")&&ve(l,h.type,te(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(l.defaultChecked=!!h.defaultChecked)}function fe(l,h,y){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var x=h.type;if(!(x!=="submit"&&x!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+l._wrapperState.initialValue,y||h===l.value||(l.value=h),l.defaultValue=h}y=l.name,y!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,y!==""&&(l.name=y)}function ve(l,h,y){(h!=="number"||Oe(l.ownerDocument)!==l)&&(y==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+y&&(l.defaultValue=""+y))}var Ie=Array.isArray;function Re(l,h,y,x){if(l=l.options,h){h={};for(var O=0;O<y.length;O++)h["$"+y[O]]=!0;for(y=0;y<l.length;y++)O=h.hasOwnProperty("$"+l[y].value),l[y].selected!==O&&(l[y].selected=O),O&&x&&(l[y].defaultSelected=!0)}else{for(y=""+te(y),h=null,O=0;O<l.length;O++){if(l[O].value===y){l[O].selected=!0,x&&(l[O].defaultSelected=!0);return}h!==null||l[O].disabled||(h=l[O])}h!==null&&(h.selected=!0)}}function be(l,h){if(h.dangerouslySetInnerHTML!=null)throw Error(t(91));return J({},h,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function rt(l,h){var y=h.value;if(y==null){if(y=h.children,h=h.defaultValue,y!=null){if(h!=null)throw Error(t(92));if(Ie(y)){if(1<y.length)throw Error(t(93));y=y[0]}h=y}h==null&&(h=""),y=h}l._wrapperState={initialValue:te(y)}}function qe(l,h){var y=te(h.value),x=te(h.defaultValue);y!=null&&(y=""+y,y!==l.value&&(l.value=y),h.defaultValue==null&&l.defaultValue!==y&&(l.defaultValue=y)),x!=null&&(l.defaultValue=""+x)}function Ze(l){var h=l.textContent;h===l._wrapperState.initialValue&&h!==""&&h!==null&&(l.value=h)}function st(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ft(l,h){return l==null||l==="http://www.w3.org/1999/xhtml"?st(h):l==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var gt,xi=function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,y,x,O){MSApp.execUnsafeLocalFunction(function(){return l(h,y,x,O)})}:l}(function(l,h){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=h;else{for(gt=gt||document.createElement("div"),gt.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=gt.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;h.firstChild;)l.appendChild(h.firstChild)}});function Mt(l,h){if(h){var y=l.firstChild;if(y&&y===l.lastChild&&y.nodeType===3){y.nodeValue=h;return}}l.textContent=h}var an={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Hn=["Webkit","ms","Moz","O"];Object.keys(an).forEach(function(l){Hn.forEach(function(h){h=h+l.charAt(0).toUpperCase()+l.substring(1),an[h]=an[l]})});function Qs(l,h,y){return h==null||typeof h=="boolean"||h===""?"":y||typeof h!="number"||h===0||an.hasOwnProperty(l)&&an[l]?(""+h).trim():h+"px"}function iu(l,h){l=l.style;for(var y in h)if(h.hasOwnProperty(y)){var x=y.indexOf("--")===0,O=Qs(y,h[y],x);y==="float"&&(y="cssFloat"),x?l.setProperty(y,O):l[y]=O}}var og=J({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ag(l,h){if(h){if(og[l]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(t(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(t(61))}if(h.style!=null&&typeof h.style!="object")throw Error(t(62))}}function lg(l,h){if(l.indexOf("-")===-1)return typeof h.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ih=null;function hf(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var df=null,Cs=null,Lo=null;function ff(l){if(l=Pg(l)){if(typeof df!="function")throw Error(t(280));var h=l.stateNode;h&&(h=M2(h),df(l.stateNode,l.type,h))}}function Fo(l){Cs?Lo?Lo.push(l):Lo=[l]:Cs=l}function ug(){if(Cs){var l=Cs,h=Lo;if(Lo=Cs=null,ff(l),h)for(l=0;l<h.length;l++)ff(h[l])}}function sh(l,h){return l(h)}function cg(){}var La=!1;function hg(l,h,y){if(La)return l(h,y);La=!0;try{return sh(l,h,y)}finally{La=!1,(Cs!==null||Lo!==null)&&(cg(),ug())}}function Mn(l,h){var y=l.stateNode;if(y===null)return null;var x=M2(y);if(x===null)return null;y=x[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(l=l.type,x=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!x;break e;default:l=!1}if(l)return null;if(y&&typeof y!="function")throw Error(t(231,h,typeof y));return y}var pf=!1;if(a)try{var Zs={};Object.defineProperty(Zs,"passive",{get:function(){pf=!0}}),window.addEventListener("test",Zs,Zs),window.removeEventListener("test",Zs,Zs)}catch{pf=!1}function oh(l,h,y,x,O,j,K,oe,ce){var we=Array.prototype.slice.call(arguments,3);try{h.apply(y,we)}catch(Te){this.onError(Te)}}var ah=!1,mf=null,eo=!1,dg=null,jb={onError:function(l){ah=!0,mf=l}};function gf(l,h,y,x,O,j,K,oe,ce){ah=!1,mf=null,oh.apply(jb,arguments)}function l2(l,h,y,x,O,j,K,oe,ce){if(gf.apply(this,arguments),ah){if(ah){var we=mf;ah=!1,mf=null}else throw Error(t(198));eo||(eo=!0,dg=we)}}function to(l){var h=l,y=l;if(l.alternate)for(;h.return;)h=h.return;else{l=h;do h=l,(h.flags&4098)!==0&&(y=h.return),l=h.return;while(l)}return h.tag===3?y:null}function lh(l){if(l.tag===13){var h=l.memoizedState;if(h===null&&(l=l.alternate,l!==null&&(h=l.memoizedState)),h!==null)return h.dehydrated}return null}function no(l){if(to(l)!==l)throw Error(t(188))}function u2(l){var h=l.alternate;if(!h){if(h=to(l),h===null)throw Error(t(188));return h!==l?null:l}for(var y=l,x=h;;){var O=y.return;if(O===null)break;var j=O.alternate;if(j===null){if(x=O.return,x!==null){y=x;continue}break}if(O.child===j.child){for(j=O.child;j;){if(j===y)return no(O),l;if(j===x)return no(O),h;j=j.sibling}throw Error(t(188))}if(y.return!==x.return)y=O,x=j;else{for(var K=!1,oe=O.child;oe;){if(oe===y){K=!0,y=O,x=j;break}if(oe===x){K=!0,x=O,y=j;break}oe=oe.sibling}if(!K){for(oe=j.child;oe;){if(oe===y){K=!0,y=j,x=O;break}if(oe===x){K=!0,x=j,y=O;break}oe=oe.sibling}if(!K)throw Error(t(189))}}if(y.alternate!==x)throw Error(t(190))}if(y.tag!==3)throw Error(t(188));return y.stateNode.current===y?l:h}function fg(l){return l=u2(l),l!==null?yf(l):null}function yf(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var h=yf(l);if(h!==null)return h;l=l.sibling}return null}var vf=e.unstable_scheduleCallback,pg=e.unstable_cancelCallback,c2=e.unstable_shouldYield,qb=e.unstable_requestPaint,ln=e.unstable_now,h2=e.unstable_getCurrentPriorityLevel,uh=e.unstable_ImmediatePriority,su=e.unstable_UserBlockingPriority,xs=e.unstable_NormalPriority,mg=e.unstable_LowPriority,d2=e.unstable_IdlePriority,ch=null,Hi=null;function f2(l){if(Hi&&typeof Hi.onCommitFiberRoot=="function")try{Hi.onCommitFiberRoot(ch,l,void 0,(l.current.flags&128)===128)}catch{}}var oi=Math.clz32?Math.clz32:m2,gg=Math.log,p2=Math.LN2;function m2(l){return l>>>=0,l===0?32:31-(gg(l)/p2|0)|0}var wf=64,_f=4194304;function ou(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function hh(l,h){var y=l.pendingLanes;if(y===0)return 0;var x=0,O=l.suspendedLanes,j=l.pingedLanes,K=y&268435455;if(K!==0){var oe=K&~O;oe!==0?x=ou(oe):(j&=K,j!==0&&(x=ou(j)))}else K=y&~O,K!==0?x=ou(K):j!==0&&(x=ou(j));if(x===0)return 0;if(h!==0&&h!==x&&(h&O)===0&&(O=x&-x,j=h&-h,O>=j||O===16&&(j&4194240)!==0))return h;if((x&4)!==0&&(x|=y&16),h=l.entangledLanes,h!==0)for(l=l.entanglements,h&=x;0<h;)y=31-oi(h),O=1<<y,x|=l[y],h&=~O;return x}function Ub(l,h){switch(l){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fa(l,h){for(var y=l.suspendedLanes,x=l.pingedLanes,O=l.expirationTimes,j=l.pendingLanes;0<j;){var K=31-oi(j),oe=1<<K,ce=O[K];ce===-1?((oe&y)===0||(oe&x)!==0)&&(O[K]=Ub(oe,h)):ce<=h&&(l.expiredLanes|=oe),j&=~oe}}function zi(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function dh(){var l=wf;return wf<<=1,(wf&4194240)===0&&(wf=64),l}function au(l){for(var h=[],y=0;31>y;y++)h.push(l);return h}function lu(l,h,y){l.pendingLanes|=h,h!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,h=31-oi(h),l[h]=y}function sn(l,h){var y=l.pendingLanes&~h;l.pendingLanes=h,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=h,l.mutableReadLanes&=h,l.entangledLanes&=h,h=l.entanglements;var x=l.eventTimes;for(l=l.expirationTimes;0<y;){var O=31-oi(y),j=1<<O;h[O]=0,x[O]=-1,l[O]=-1,y&=~j}}function uu(l,h){var y=l.entangledLanes|=h;for(l=l.entanglements;y;){var x=31-oi(y),O=1<<x;O&h|l[x]&h&&(l[x]|=h),y&=~O}}var Lt=0;function cu(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var g2,bf,y2,v2,w2,yg=!1,Mo=[],Ir=null,ro=null,io=null,hu=new Map,Ss=new Map,Bo=[],Vb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _2(l,h){switch(l){case"focusin":case"focusout":Ir=null;break;case"dragenter":case"dragleave":ro=null;break;case"mouseover":case"mouseout":io=null;break;case"pointerover":case"pointerout":hu.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ss.delete(h.pointerId)}}function Si(l,h,y,x,O,j){return l===null||l.nativeEvent!==j?(l={blockedOn:h,domEventName:y,eventSystemFlags:x,nativeEvent:j,targetContainers:[O]},h!==null&&(h=Pg(h),h!==null&&bf(h)),l):(l.eventSystemFlags|=x,h=l.targetContainers,O!==null&&h.indexOf(O)===-1&&h.push(O),l)}function Hb(l,h,y,x,O){switch(h){case"focusin":return Ir=Si(Ir,l,h,y,x,O),!0;case"dragenter":return ro=Si(ro,l,h,y,x,O),!0;case"mouseover":return io=Si(io,l,h,y,x,O),!0;case"pointerover":var j=O.pointerId;return hu.set(j,Si(hu.get(j)||null,l,h,y,x,O)),!0;case"gotpointercapture":return j=O.pointerId,Ss.set(j,Si(Ss.get(j)||null,l,h,y,x,O)),!0}return!1}function b2(l){var h=yh(l.target);if(h!==null){var y=to(h);if(y!==null){if(h=y.tag,h===13){if(h=lh(y),h!==null){l.blockedOn=h,w2(l.priority,function(){y2(y)});return}}else if(h===3&&y.stateNode.current.memoizedState.isDehydrated){l.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Ma(l){if(l.blockedOn!==null)return!1;for(var h=l.targetContainers;0<h.length;){var y=Af(l.domEventName,l.eventSystemFlags,h[0],l.nativeEvent);if(y===null){y=l.nativeEvent;var x=new y.constructor(y.type,y);ih=x,y.target.dispatchEvent(x),ih=null}else return h=Pg(y),h!==null&&bf(h),l.blockedOn=y,!1;h.shift()}return!0}function fh(l,h,y){Ma(l)&&y.delete(h)}function A2(){yg=!1,Ir!==null&&Ma(Ir)&&(Ir=null),ro!==null&&Ma(ro)&&(ro=null),io!==null&&Ma(io)&&(io=null),hu.forEach(fh),Ss.forEach(fh)}function so(l,h){l.blockedOn===h&&(l.blockedOn=null,yg||(yg=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,A2)))}function oo(l){function h(O){return so(O,l)}if(0<Mo.length){so(Mo[0],l);for(var y=1;y<Mo.length;y++){var x=Mo[y];x.blockedOn===l&&(x.blockedOn=null)}}for(Ir!==null&&so(Ir,l),ro!==null&&so(ro,l),io!==null&&so(io,l),hu.forEach(h),Ss.forEach(h),y=0;y<Bo.length;y++)x=Bo[y],x.blockedOn===l&&(x.blockedOn=null);for(;0<Bo.length&&(y=Bo[0],y.blockedOn===null);)b2(y),y.blockedOn===null&&Bo.shift()}var Ba=S.ReactCurrentBatchConfig,du=!0;function wn(l,h,y,x){var O=Lt,j=Ba.transition;Ba.transition=null;try{Lt=1,vg(l,h,y,x)}finally{Lt=O,Ba.transition=j}}function zb(l,h,y,x){var O=Lt,j=Ba.transition;Ba.transition=null;try{Lt=4,vg(l,h,y,x)}finally{Lt=O,Ba.transition=j}}function vg(l,h,y,x){if(du){var O=Af(l,h,y,x);if(O===null)tA(l,h,x,ph,y),_2(l,x);else if(Hb(O,l,h,y,x))x.stopPropagation();else if(_2(l,x),h&4&&-1<Vb.indexOf(l)){for(;O!==null;){var j=Pg(O);if(j!==null&&g2(j),j=Af(l,h,y,x),j===null&&tA(l,h,x,ph,y),j===O)break;O=j}O!==null&&x.stopPropagation()}else tA(l,h,x,null,y)}}var ph=null;function Af(l,h,y,x){if(ph=null,l=hf(x),l=yh(l),l!==null)if(h=to(l),h===null)l=null;else if(y=h.tag,y===13){if(l=lh(h),l!==null)return l;l=null}else if(y===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;l=null}else h!==l&&(l=null);return ph=l,null}function wg(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(h2()){case uh:return 1;case su:return 4;case xs:case mg:return 16;case d2:return 536870912;default:return 16}default:return 16}}var $i=null,Ef=null,Ti=null;function _g(){if(Ti)return Ti;var l,h=Ef,y=h.length,x,O="value"in $i?$i.value:$i.textContent,j=O.length;for(l=0;l<y&&h[l]===O[l];l++);var K=y-l;for(x=1;x<=K&&h[y-x]===O[j-x];x++);return Ti=O.slice(l,1<x?1-x:void 0)}function Cf(l){var h=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&h===13&&(l=13)):l=h,l===10&&(l=13),32<=l||l===13?l:0}function jo(){return!0}function bg(){return!1}function Dr(l){function h(y,x,O,j,K){this._reactName=y,this._targetInst=O,this.type=x,this.nativeEvent=j,this.target=K,this.currentTarget=null;for(var oe in l)l.hasOwnProperty(oe)&&(y=l[oe],this[oe]=y?y(j):j[oe]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?jo:bg,this.isPropagationStopped=bg,this}return J(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!="unknown"&&(y.returnValue=!1),this.isDefaultPrevented=jo)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!="unknown"&&(y.cancelBubble=!0),this.isPropagationStopped=jo)},persist:function(){},isPersistent:jo}),h}var ao={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xf=Dr(ao),qo=J({},ao,{view:0,detail:0}),$b=Dr(qo),Sf,ja,fu,mh=J({},qo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uo,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==fu&&(fu&&l.type==="mousemove"?(Sf=l.screenX-fu.screenX,ja=l.screenY-fu.screenY):ja=Sf=0,fu=l),Sf)},movementY:function(l){return"movementY"in l?l.movementY:ja}}),Tf=Dr(mh),Ag=J({},mh,{dataTransfer:0}),E2=Dr(Ag),If=J({},qo,{relatedTarget:0}),Df=Dr(If),C2=J({},ao,{animationName:0,elapsedTime:0,pseudoElement:0}),qa=Dr(C2),x2=J({},ao,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),S2=Dr(x2),T2=J({},ao,{data:0}),Eg=Dr(T2),kf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ai={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},I2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function D2(l){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(l):(l=I2[l])?!!h[l]:!1}function Uo(){return D2}var E=J({},qo,{key:function(l){if(l.key){var h=kf[l.key]||l.key;if(h!=="Unidentified")return h}return l.type==="keypress"?(l=Cf(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?ai[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uo,charCode:function(l){return l.type==="keypress"?Cf(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Cf(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),B=Dr(E),V=J({},mh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Z=Dr(V),pe=J({},qo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uo}),_e=Dr(pe),Le=J({},ao,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yt=Dr(Le),tr=J({},mh,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Bt=Dr(tr),mr=[9,13,27,32],zn=a&&"CompositionEvent"in window,Ts=null;a&&"documentMode"in document&&(Ts=document.documentMode);var Wi=a&&"TextEvent"in window&&!Ts,gh=a&&(!zn||Ts&&8<Ts&&11>=Ts),Rf=" ",ED=!1;function CD(l,h){switch(l){case"keyup":return mr.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xD(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Pf=!1;function $4(l,h){switch(l){case"compositionend":return xD(h);case"keypress":return h.which!==32?null:(ED=!0,Rf);case"textInput":return l=h.data,l===Rf&&ED?null:l;default:return null}}function W4(l,h){if(Pf)return l==="compositionend"||!zn&&CD(l,h)?(l=_g(),Ti=Ef=$i=null,Pf=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return gh&&h.locale!=="ko"?null:h.data;default:return null}}var G4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function SD(l){var h=l&&l.nodeName&&l.nodeName.toLowerCase();return h==="input"?!!G4[l.type]:h==="textarea"}function TD(l,h,y,x){Fo(x),h=O2(h,"onChange"),0<h.length&&(y=new xf("onChange","change",null,y,x),l.push({event:y,listeners:h}))}var Cg=null,xg=null;function K4(l){$D(l,0)}function k2(l){var h=Mf(l);if(xe(h))return l}function J4(l,h){if(l==="change")return h}var ID=!1;if(a){var Wb;if(a){var Gb="oninput"in document;if(!Gb){var DD=document.createElement("div");DD.setAttribute("oninput","return;"),Gb=typeof DD.oninput=="function"}Wb=Gb}else Wb=!1;ID=Wb&&(!document.documentMode||9<document.documentMode)}function kD(){Cg&&(Cg.detachEvent("onpropertychange",RD),xg=Cg=null)}function RD(l){if(l.propertyName==="value"&&k2(xg)){var h=[];TD(h,xg,l,hf(l)),hg(K4,h)}}function Y4(l,h,y){l==="focusin"?(kD(),Cg=h,xg=y,Cg.attachEvent("onpropertychange",RD)):l==="focusout"&&kD()}function X4(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return k2(xg)}function Q4(l,h){if(l==="click")return k2(h)}function Z4(l,h){if(l==="input"||l==="change")return k2(h)}function e9(l,h){return l===h&&(l!==0||1/l===1/h)||l!==l&&h!==h}var lo=typeof Object.is=="function"?Object.is:e9;function Sg(l,h){if(lo(l,h))return!0;if(typeof l!="object"||l===null||typeof h!="object"||h===null)return!1;var y=Object.keys(l),x=Object.keys(h);if(y.length!==x.length)return!1;for(x=0;x<y.length;x++){var O=y[x];if(!u.call(h,O)||!lo(l[O],h[O]))return!1}return!0}function PD(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function ND(l,h){var y=PD(l);l=0;for(var x;y;){if(y.nodeType===3){if(x=l+y.textContent.length,l<=h&&x>=h)return{node:y,offset:h-l};l=x}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=PD(y)}}function OD(l,h){return l&&h?l===h?!0:l&&l.nodeType===3?!1:h&&h.nodeType===3?OD(l,h.parentNode):"contains"in l?l.contains(h):l.compareDocumentPosition?!!(l.compareDocumentPosition(h)&16):!1:!1}function LD(){for(var l=window,h=Oe();h instanceof l.HTMLIFrameElement;){try{var y=typeof h.contentWindow.location.href=="string"}catch{y=!1}if(y)l=h.contentWindow;else break;h=Oe(l.document)}return h}function Kb(l){var h=l&&l.nodeName&&l.nodeName.toLowerCase();return h&&(h==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||h==="textarea"||l.contentEditable==="true")}function t9(l){var h=LD(),y=l.focusedElem,x=l.selectionRange;if(h!==y&&y&&y.ownerDocument&&OD(y.ownerDocument.documentElement,y)){if(x!==null&&Kb(y)){if(h=x.start,l=x.end,l===void 0&&(l=h),"selectionStart"in y)y.selectionStart=h,y.selectionEnd=Math.min(l,y.value.length);else if(l=(h=y.ownerDocument||document)&&h.defaultView||window,l.getSelection){l=l.getSelection();var O=y.textContent.length,j=Math.min(x.start,O);x=x.end===void 0?j:Math.min(x.end,O),!l.extend&&j>x&&(O=x,x=j,j=O),O=ND(y,j);var K=ND(y,x);O&&K&&(l.rangeCount!==1||l.anchorNode!==O.node||l.anchorOffset!==O.offset||l.focusNode!==K.node||l.focusOffset!==K.offset)&&(h=h.createRange(),h.setStart(O.node,O.offset),l.removeAllRanges(),j>x?(l.addRange(h),l.extend(K.node,K.offset)):(h.setEnd(K.node,K.offset),l.addRange(h)))}}for(h=[],l=y;l=l.parentNode;)l.nodeType===1&&h.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof y.focus=="function"&&y.focus(),y=0;y<h.length;y++)l=h[y],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var n9=a&&"documentMode"in document&&11>=document.documentMode,Nf=null,Jb=null,Tg=null,Yb=!1;function FD(l,h,y){var x=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;Yb||Nf==null||Nf!==Oe(x)||(x=Nf,"selectionStart"in x&&Kb(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Tg&&Sg(Tg,x)||(Tg=x,x=O2(Jb,"onSelect"),0<x.length&&(h=new xf("onSelect","select",null,h,y),l.push({event:h,listeners:x}),h.target=Nf)))}function R2(l,h){var y={};return y[l.toLowerCase()]=h.toLowerCase(),y["Webkit"+l]="webkit"+h,y["Moz"+l]="moz"+h,y}var Of={animationend:R2("Animation","AnimationEnd"),animationiteration:R2("Animation","AnimationIteration"),animationstart:R2("Animation","AnimationStart"),transitionend:R2("Transition","TransitionEnd")},Xb={},MD={};a&&(MD=document.createElement("div").style,"AnimationEvent"in window||(delete Of.animationend.animation,delete Of.animationiteration.animation,delete Of.animationstart.animation),"TransitionEvent"in window||delete Of.transitionend.transition);function P2(l){if(Xb[l])return Xb[l];if(!Of[l])return l;var h=Of[l],y;for(y in h)if(h.hasOwnProperty(y)&&y in MD)return Xb[l]=h[y];return l}var BD=P2("animationend"),jD=P2("animationiteration"),qD=P2("animationstart"),UD=P2("transitionend"),VD=new Map,HD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pu(l,h){VD.set(l,h),s(h,[l])}for(var Qb=0;Qb<HD.length;Qb++){var Zb=HD[Qb],r9=Zb.toLowerCase(),i9=Zb[0].toUpperCase()+Zb.slice(1);pu(r9,"on"+i9)}pu(BD,"onAnimationEnd"),pu(jD,"onAnimationIteration"),pu(qD,"onAnimationStart"),pu("dblclick","onDoubleClick"),pu("focusin","onFocus"),pu("focusout","onBlur"),pu(UD,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ig="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),s9=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ig));function zD(l,h,y){var x=l.type||"unknown-event";l.currentTarget=y,l2(x,h,void 0,l),l.currentTarget=null}function $D(l,h){h=(h&4)!==0;for(var y=0;y<l.length;y++){var x=l[y],O=x.event;x=x.listeners;e:{var j=void 0;if(h)for(var K=x.length-1;0<=K;K--){var oe=x[K],ce=oe.instance,we=oe.currentTarget;if(oe=oe.listener,ce!==j&&O.isPropagationStopped())break e;zD(O,oe,we),j=ce}else for(K=0;K<x.length;K++){if(oe=x[K],ce=oe.instance,we=oe.currentTarget,oe=oe.listener,ce!==j&&O.isPropagationStopped())break e;zD(O,oe,we),j=ce}}}if(eo)throw l=dg,eo=!1,dg=null,l}function dn(l,h){var y=h[aA];y===void 0&&(y=h[aA]=new Set);var x=l+"__bubble";y.has(x)||(WD(h,l,2,!1),y.add(x))}function eA(l,h,y){var x=0;h&&(x|=4),WD(y,l,x,h)}var N2="_reactListening"+Math.random().toString(36).slice(2);function Dg(l){if(!l[N2]){l[N2]=!0,n.forEach(function(y){y!=="selectionchange"&&(s9.has(y)||eA(y,!1,l),eA(y,!0,l))});var h=l.nodeType===9?l:l.ownerDocument;h===null||h[N2]||(h[N2]=!0,eA("selectionchange",!1,h))}}function WD(l,h,y,x){switch(wg(h)){case 1:var O=wn;break;case 4:O=zb;break;default:O=vg}y=O.bind(null,h,y,l),O=void 0,!pf||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(O=!0),x?O!==void 0?l.addEventListener(h,y,{capture:!0,passive:O}):l.addEventListener(h,y,!0):O!==void 0?l.addEventListener(h,y,{passive:O}):l.addEventListener(h,y,!1)}function tA(l,h,y,x,O){var j=x;if((h&1)===0&&(h&2)===0&&x!==null)e:for(;;){if(x===null)return;var K=x.tag;if(K===3||K===4){var oe=x.stateNode.containerInfo;if(oe===O||oe.nodeType===8&&oe.parentNode===O)break;if(K===4)for(K=x.return;K!==null;){var ce=K.tag;if((ce===3||ce===4)&&(ce=K.stateNode.containerInfo,ce===O||ce.nodeType===8&&ce.parentNode===O))return;K=K.return}for(;oe!==null;){if(K=yh(oe),K===null)return;if(ce=K.tag,ce===5||ce===6){x=j=K;continue e}oe=oe.parentNode}}x=x.return}hg(function(){var we=j,Te=hf(y),De=[];e:{var Se=VD.get(l);if(Se!==void 0){var je=xf,Xe=l;switch(l){case"keypress":if(Cf(y)===0)break e;case"keydown":case"keyup":je=B;break;case"focusin":Xe="focus",je=Df;break;case"focusout":Xe="blur",je=Df;break;case"beforeblur":case"afterblur":je=Df;break;case"click":if(y.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":je=Tf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":je=E2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":je=_e;break;case BD:case jD:case qD:je=qa;break;case UD:je=Yt;break;case"scroll":je=$b;break;case"wheel":je=Bt;break;case"copy":case"cut":case"paste":je=S2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":je=Z}var et=(h&4)!==0,Bn=!et&&l==="scroll",me=et?Se!==null?Se+"Capture":null:Se;et=[];for(var he=we,ge;he!==null;){ge=he;var Pe=ge.stateNode;if(ge.tag===5&&Pe!==null&&(ge=Pe,me!==null&&(Pe=Mn(he,me),Pe!=null&&et.push(kg(he,Pe,ge)))),Bn)break;he=he.return}0<et.length&&(Se=new je(Se,Xe,null,y,Te),De.push({event:Se,listeners:et}))}}if((h&7)===0){e:{if(Se=l==="mouseover"||l==="pointerover",je=l==="mouseout"||l==="pointerout",Se&&y!==ih&&(Xe=y.relatedTarget||y.fromElement)&&(yh(Xe)||Xe[Ua]))break e;if((je||Se)&&(Se=Te.window===Te?Te:(Se=Te.ownerDocument)?Se.defaultView||Se.parentWindow:window,je?(Xe=y.relatedTarget||y.toElement,je=we,Xe=Xe?yh(Xe):null,Xe!==null&&(Bn=to(Xe),Xe!==Bn||Xe.tag!==5&&Xe.tag!==6)&&(Xe=null)):(je=null,Xe=we),je!==Xe)){if(et=Tf,Pe="onMouseLeave",me="onMouseEnter",he="mouse",(l==="pointerout"||l==="pointerover")&&(et=Z,Pe="onPointerLeave",me="onPointerEnter",he="pointer"),Bn=je==null?Se:Mf(je),ge=Xe==null?Se:Mf(Xe),Se=new et(Pe,he+"leave",je,y,Te),Se.target=Bn,Se.relatedTarget=ge,Pe=null,yh(Te)===we&&(et=new et(me,he+"enter",Xe,y,Te),et.target=ge,et.relatedTarget=Bn,Pe=et),Bn=Pe,je&&Xe)t:{for(et=je,me=Xe,he=0,ge=et;ge;ge=Lf(ge))he++;for(ge=0,Pe=me;Pe;Pe=Lf(Pe))ge++;for(;0<he-ge;)et=Lf(et),he--;for(;0<ge-he;)me=Lf(me),ge--;for(;he--;){if(et===me||me!==null&&et===me.alternate)break t;et=Lf(et),me=Lf(me)}et=null}else et=null;je!==null&&GD(De,Se,je,et,!1),Xe!==null&&Bn!==null&&GD(De,Bn,Xe,et,!0)}}e:{if(Se=we?Mf(we):window,je=Se.nodeName&&Se.nodeName.toLowerCase(),je==="select"||je==="input"&&Se.type==="file")var tt=J4;else if(SD(Se))if(ID)tt=Z4;else{tt=X4;var at=Y4}else(je=Se.nodeName)&&je.toLowerCase()==="input"&&(Se.type==="checkbox"||Se.type==="radio")&&(tt=Q4);if(tt&&(tt=tt(l,we))){TD(De,tt,y,Te);break e}at&&at(l,Se,we),l==="focusout"&&(at=Se._wrapperState)&&at.controlled&&Se.type==="number"&&ve(Se,"number",Se.value)}switch(at=we?Mf(we):window,l){case"focusin":(SD(at)||at.contentEditable==="true")&&(Nf=at,Jb=we,Tg=null);break;case"focusout":Tg=Jb=Nf=null;break;case"mousedown":Yb=!0;break;case"contextmenu":case"mouseup":case"dragend":Yb=!1,FD(De,y,Te);break;case"selectionchange":if(n9)break;case"keydown":case"keyup":FD(De,y,Te)}var lt;if(zn)e:{switch(l){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else Pf?CD(l,y)&&(pt="onCompositionEnd"):l==="keydown"&&y.keyCode===229&&(pt="onCompositionStart");pt&&(gh&&y.locale!=="ko"&&(Pf||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&Pf&&(lt=_g()):($i=Te,Ef="value"in $i?$i.value:$i.textContent,Pf=!0)),at=O2(we,pt),0<at.length&&(pt=new Eg(pt,l,null,y,Te),De.push({event:pt,listeners:at}),lt?pt.data=lt:(lt=xD(y),lt!==null&&(pt.data=lt)))),(lt=Wi?$4(l,y):W4(l,y))&&(we=O2(we,"onBeforeInput"),0<we.length&&(Te=new Eg("onBeforeInput","beforeinput",null,y,Te),De.push({event:Te,listeners:we}),Te.data=lt))}$D(De,h)})}function kg(l,h,y){return{instance:l,listener:h,currentTarget:y}}function O2(l,h){for(var y=h+"Capture",x=[];l!==null;){var O=l,j=O.stateNode;O.tag===5&&j!==null&&(O=j,j=Mn(l,y),j!=null&&x.unshift(kg(l,j,O)),j=Mn(l,h),j!=null&&x.push(kg(l,j,O))),l=l.return}return x}function Lf(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function GD(l,h,y,x,O){for(var j=h._reactName,K=[];y!==null&&y!==x;){var oe=y,ce=oe.alternate,we=oe.stateNode;if(ce!==null&&ce===x)break;oe.tag===5&&we!==null&&(oe=we,O?(ce=Mn(y,j),ce!=null&&K.unshift(kg(y,ce,oe))):O||(ce=Mn(y,j),ce!=null&&K.push(kg(y,ce,oe)))),y=y.return}K.length!==0&&l.push({event:h,listeners:K})}var o9=/\r\n?/g,a9=/\u0000|\uFFFD/g;function KD(l){return(typeof l=="string"?l:""+l).replace(o9,`
`).replace(a9,"")}function L2(l,h,y){if(h=KD(h),KD(l)!==h&&y)throw Error(t(425))}function F2(){}var nA=null,rA=null;function iA(l,h){return l==="textarea"||l==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var sA=typeof setTimeout=="function"?setTimeout:void 0,l9=typeof clearTimeout=="function"?clearTimeout:void 0,JD=typeof Promise=="function"?Promise:void 0,u9=typeof queueMicrotask=="function"?queueMicrotask:typeof JD<"u"?function(l){return JD.resolve(null).then(l).catch(c9)}:sA;function c9(l){setTimeout(function(){throw l})}function oA(l,h){var y=h,x=0;do{var O=y.nextSibling;if(l.removeChild(y),O&&O.nodeType===8)if(y=O.data,y==="/$"){if(x===0){l.removeChild(O),oo(h);return}x--}else y!=="$"&&y!=="$?"&&y!=="$!"||x++;y=O}while(y);oo(h)}function mu(l){for(;l!=null;l=l.nextSibling){var h=l.nodeType;if(h===1||h===3)break;if(h===8){if(h=l.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return l}function YD(l){l=l.previousSibling;for(var h=0;l;){if(l.nodeType===8){var y=l.data;if(y==="$"||y==="$!"||y==="$?"){if(h===0)return l;h--}else y==="/$"&&h++}l=l.previousSibling}return null}var Ff=Math.random().toString(36).slice(2),Vo="__reactFiber$"+Ff,Rg="__reactProps$"+Ff,Ua="__reactContainer$"+Ff,aA="__reactEvents$"+Ff,h9="__reactListeners$"+Ff,d9="__reactHandles$"+Ff;function yh(l){var h=l[Vo];if(h)return h;for(var y=l.parentNode;y;){if(h=y[Ua]||y[Vo]){if(y=h.alternate,h.child!==null||y!==null&&y.child!==null)for(l=YD(l);l!==null;){if(y=l[Vo])return y;l=YD(l)}return h}l=y,y=l.parentNode}return null}function Pg(l){return l=l[Vo]||l[Ua],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Mf(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function M2(l){return l[Rg]||null}var lA=[],Bf=-1;function gu(l){return{current:l}}function fn(l){0>Bf||(l.current=lA[Bf],lA[Bf]=null,Bf--)}function un(l,h){Bf++,lA[Bf]=l.current,l.current=h}var yu={},Gr=gu(yu),Ii=gu(!1),vh=yu;function jf(l,h){var y=l.type.contextTypes;if(!y)return yu;var x=l.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===h)return x.__reactInternalMemoizedMaskedChildContext;var O={},j;for(j in y)O[j]=h[j];return x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=h,l.__reactInternalMemoizedMaskedChildContext=O),O}function Di(l){return l=l.childContextTypes,l!=null}function B2(){fn(Ii),fn(Gr)}function XD(l,h,y){if(Gr.current!==yu)throw Error(t(168));un(Gr,h),un(Ii,y)}function QD(l,h,y){var x=l.stateNode;if(h=h.childContextTypes,typeof x.getChildContext!="function")return y;x=x.getChildContext();for(var O in x)if(!(O in h))throw Error(t(108,ne(l)||"Unknown",O));return J({},y,x)}function j2(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||yu,vh=Gr.current,un(Gr,l),un(Ii,Ii.current),!0}function ZD(l,h,y){var x=l.stateNode;if(!x)throw Error(t(169));y?(l=QD(l,h,vh),x.__reactInternalMemoizedMergedChildContext=l,fn(Ii),fn(Gr),un(Gr,l)):fn(Ii),un(Ii,y)}var Va=null,q2=!1,uA=!1;function ek(l){Va===null?Va=[l]:Va.push(l)}function f9(l){q2=!0,ek(l)}function vu(){if(!uA&&Va!==null){uA=!0;var l=0,h=Lt;try{var y=Va;for(Lt=1;l<y.length;l++){var x=y[l];do x=x(!0);while(x!==null)}Va=null,q2=!1}catch(O){throw Va!==null&&(Va=Va.slice(l+1)),vf(uh,vu),O}finally{Lt=h,uA=!1}}return null}var qf=[],Uf=0,U2=null,V2=0,Is=[],Ds=0,wh=null,Ha=1,za="";function _h(l,h){qf[Uf++]=V2,qf[Uf++]=U2,U2=l,V2=h}function tk(l,h,y){Is[Ds++]=Ha,Is[Ds++]=za,Is[Ds++]=wh,wh=l;var x=Ha;l=za;var O=32-oi(x)-1;x&=~(1<<O),y+=1;var j=32-oi(h)+O;if(30<j){var K=O-O%5;j=(x&(1<<K)-1).toString(32),x>>=K,O-=K,Ha=1<<32-oi(h)+O|y<<O|x,za=j+l}else Ha=1<<j|y<<O|x,za=l}function cA(l){l.return!==null&&(_h(l,1),tk(l,1,0))}function hA(l){for(;l===U2;)U2=qf[--Uf],qf[Uf]=null,V2=qf[--Uf],qf[Uf]=null;for(;l===wh;)wh=Is[--Ds],Is[Ds]=null,za=Is[--Ds],Is[Ds]=null,Ha=Is[--Ds],Is[Ds]=null}var Gi=null,Ki=null,_n=!1,uo=null;function nk(l,h){var y=Ns(5,null,null,0);y.elementType="DELETED",y.stateNode=h,y.return=l,h=l.deletions,h===null?(l.deletions=[y],l.flags|=16):h.push(y)}function rk(l,h){switch(l.tag){case 5:var y=l.type;return h=h.nodeType!==1||y.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(l.stateNode=h,Gi=l,Ki=mu(h.firstChild),!0):!1;case 6:return h=l.pendingProps===""||h.nodeType!==3?null:h,h!==null?(l.stateNode=h,Gi=l,Ki=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(y=wh!==null?{id:Ha,overflow:za}:null,l.memoizedState={dehydrated:h,treeContext:y,retryLane:1073741824},y=Ns(18,null,null,0),y.stateNode=h,y.return=l,l.child=y,Gi=l,Ki=null,!0):!1;default:return!1}}function dA(l){return(l.mode&1)!==0&&(l.flags&128)===0}function fA(l){if(_n){var h=Ki;if(h){var y=h;if(!rk(l,h)){if(dA(l))throw Error(t(418));h=mu(y.nextSibling);var x=Gi;h&&rk(l,h)?nk(x,y):(l.flags=l.flags&-4097|2,_n=!1,Gi=l)}}else{if(dA(l))throw Error(t(418));l.flags=l.flags&-4097|2,_n=!1,Gi=l}}}function ik(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Gi=l}function H2(l){if(l!==Gi)return!1;if(!_n)return ik(l),_n=!0,!1;var h;if((h=l.tag!==3)&&!(h=l.tag!==5)&&(h=l.type,h=h!=="head"&&h!=="body"&&!iA(l.type,l.memoizedProps)),h&&(h=Ki)){if(dA(l))throw sk(),Error(t(418));for(;h;)nk(l,h),h=mu(h.nextSibling)}if(ik(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,h=0;l;){if(l.nodeType===8){var y=l.data;if(y==="/$"){if(h===0){Ki=mu(l.nextSibling);break e}h--}else y!=="$"&&y!=="$!"&&y!=="$?"||h++}l=l.nextSibling}Ki=null}}else Ki=Gi?mu(l.stateNode.nextSibling):null;return!0}function sk(){for(var l=Ki;l;)l=mu(l.nextSibling)}function Vf(){Ki=Gi=null,_n=!1}function pA(l){uo===null?uo=[l]:uo.push(l)}var p9=S.ReactCurrentBatchConfig;function Ng(l,h,y){if(l=y.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(y._owner){if(y=y._owner,y){if(y.tag!==1)throw Error(t(309));var x=y.stateNode}if(!x)throw Error(t(147,l));var O=x,j=""+l;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===j?h.ref:(h=function(K){var oe=O.refs;K===null?delete oe[j]:oe[j]=K},h._stringRef=j,h)}if(typeof l!="string")throw Error(t(284));if(!y._owner)throw Error(t(290,l))}return l}function z2(l,h){throw l=Object.prototype.toString.call(h),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":l))}function ok(l){var h=l._init;return h(l._payload)}function ak(l){function h(me,he){if(l){var ge=me.deletions;ge===null?(me.deletions=[he],me.flags|=16):ge.push(he)}}function y(me,he){if(!l)return null;for(;he!==null;)h(me,he),he=he.sibling;return null}function x(me,he){for(me=new Map;he!==null;)he.key!==null?me.set(he.key,he):me.set(he.index,he),he=he.sibling;return me}function O(me,he){return me=Su(me,he),me.index=0,me.sibling=null,me}function j(me,he,ge){return me.index=ge,l?(ge=me.alternate,ge!==null?(ge=ge.index,ge<he?(me.flags|=2,he):ge):(me.flags|=2,he)):(me.flags|=1048576,he)}function K(me){return l&&me.alternate===null&&(me.flags|=2),me}function oe(me,he,ge,Pe){return he===null||he.tag!==6?(he=sE(ge,me.mode,Pe),he.return=me,he):(he=O(he,ge),he.return=me,he)}function ce(me,he,ge,Pe){var tt=ge.type;return tt===k?Te(me,he,ge.props.children,Pe,ge.key):he!==null&&(he.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===ie&&ok(tt)===he.type)?(Pe=O(he,ge.props),Pe.ref=Ng(me,he,ge),Pe.return=me,Pe):(Pe=pw(ge.type,ge.key,ge.props,null,me.mode,Pe),Pe.ref=Ng(me,he,ge),Pe.return=me,Pe)}function we(me,he,ge,Pe){return he===null||he.tag!==4||he.stateNode.containerInfo!==ge.containerInfo||he.stateNode.implementation!==ge.implementation?(he=oE(ge,me.mode,Pe),he.return=me,he):(he=O(he,ge.children||[]),he.return=me,he)}function Te(me,he,ge,Pe,tt){return he===null||he.tag!==7?(he=Ih(ge,me.mode,Pe,tt),he.return=me,he):(he=O(he,ge),he.return=me,he)}function De(me,he,ge){if(typeof he=="string"&&he!==""||typeof he=="number")return he=sE(""+he,me.mode,ge),he.return=me,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case R:return ge=pw(he.type,he.key,he.props,null,me.mode,ge),ge.ref=Ng(me,null,he),ge.return=me,ge;case L:return he=oE(he,me.mode,ge),he.return=me,he;case ie:var Pe=he._init;return De(me,Pe(he._payload),ge)}if(Ie(he)||Y(he))return he=Ih(he,me.mode,ge,null),he.return=me,he;z2(me,he)}return null}function Se(me,he,ge,Pe){var tt=he!==null?he.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return tt!==null?null:oe(me,he,""+ge,Pe);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case R:return ge.key===tt?ce(me,he,ge,Pe):null;case L:return ge.key===tt?we(me,he,ge,Pe):null;case ie:return tt=ge._init,Se(me,he,tt(ge._payload),Pe)}if(Ie(ge)||Y(ge))return tt!==null?null:Te(me,he,ge,Pe,null);z2(me,ge)}return null}function je(me,he,ge,Pe,tt){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return me=me.get(ge)||null,oe(he,me,""+Pe,tt);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case R:return me=me.get(Pe.key===null?ge:Pe.key)||null,ce(he,me,Pe,tt);case L:return me=me.get(Pe.key===null?ge:Pe.key)||null,we(he,me,Pe,tt);case ie:var at=Pe._init;return je(me,he,ge,at(Pe._payload),tt)}if(Ie(Pe)||Y(Pe))return me=me.get(ge)||null,Te(he,me,Pe,tt,null);z2(he,Pe)}return null}function Xe(me,he,ge,Pe){for(var tt=null,at=null,lt=he,pt=he=0,vr=null;lt!==null&&pt<ge.length;pt++){lt.index>pt?(vr=lt,lt=null):vr=lt.sibling;var zt=Se(me,lt,ge[pt],Pe);if(zt===null){lt===null&&(lt=vr);break}l&&lt&&zt.alternate===null&&h(me,lt),he=j(zt,he,pt),at===null?tt=zt:at.sibling=zt,at=zt,lt=vr}if(pt===ge.length)return y(me,lt),_n&&_h(me,pt),tt;if(lt===null){for(;pt<ge.length;pt++)lt=De(me,ge[pt],Pe),lt!==null&&(he=j(lt,he,pt),at===null?tt=lt:at.sibling=lt,at=lt);return _n&&_h(me,pt),tt}for(lt=x(me,lt);pt<ge.length;pt++)vr=je(lt,me,pt,ge[pt],Pe),vr!==null&&(l&&vr.alternate!==null&&lt.delete(vr.key===null?pt:vr.key),he=j(vr,he,pt),at===null?tt=vr:at.sibling=vr,at=vr);return l&&lt.forEach(function(Tu){return h(me,Tu)}),_n&&_h(me,pt),tt}function et(me,he,ge,Pe){var tt=Y(ge);if(typeof tt!="function")throw Error(t(150));if(ge=tt.call(ge),ge==null)throw Error(t(151));for(var at=tt=null,lt=he,pt=he=0,vr=null,zt=ge.next();lt!==null&&!zt.done;pt++,zt=ge.next()){lt.index>pt?(vr=lt,lt=null):vr=lt.sibling;var Tu=Se(me,lt,zt.value,Pe);if(Tu===null){lt===null&&(lt=vr);break}l&&lt&&Tu.alternate===null&&h(me,lt),he=j(Tu,he,pt),at===null?tt=Tu:at.sibling=Tu,at=Tu,lt=vr}if(zt.done)return y(me,lt),_n&&_h(me,pt),tt;if(lt===null){for(;!zt.done;pt++,zt=ge.next())zt=De(me,zt.value,Pe),zt!==null&&(he=j(zt,he,pt),at===null?tt=zt:at.sibling=zt,at=zt);return _n&&_h(me,pt),tt}for(lt=x(me,lt);!zt.done;pt++,zt=ge.next())zt=je(lt,me,pt,zt.value,Pe),zt!==null&&(l&&zt.alternate!==null&&lt.delete(zt.key===null?pt:zt.key),he=j(zt,he,pt),at===null?tt=zt:at.sibling=zt,at=zt);return l&&lt.forEach(function(G9){return h(me,G9)}),_n&&_h(me,pt),tt}function Bn(me,he,ge,Pe){if(typeof ge=="object"&&ge!==null&&ge.type===k&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case R:e:{for(var tt=ge.key,at=he;at!==null;){if(at.key===tt){if(tt=ge.type,tt===k){if(at.tag===7){y(me,at.sibling),he=O(at,ge.props.children),he.return=me,me=he;break e}}else if(at.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===ie&&ok(tt)===at.type){y(me,at.sibling),he=O(at,ge.props),he.ref=Ng(me,at,ge),he.return=me,me=he;break e}y(me,at);break}else h(me,at);at=at.sibling}ge.type===k?(he=Ih(ge.props.children,me.mode,Pe,ge.key),he.return=me,me=he):(Pe=pw(ge.type,ge.key,ge.props,null,me.mode,Pe),Pe.ref=Ng(me,he,ge),Pe.return=me,me=Pe)}return K(me);case L:e:{for(at=ge.key;he!==null;){if(he.key===at)if(he.tag===4&&he.stateNode.containerInfo===ge.containerInfo&&he.stateNode.implementation===ge.implementation){y(me,he.sibling),he=O(he,ge.children||[]),he.return=me,me=he;break e}else{y(me,he);break}else h(me,he);he=he.sibling}he=oE(ge,me.mode,Pe),he.return=me,me=he}return K(me);case ie:return at=ge._init,Bn(me,he,at(ge._payload),Pe)}if(Ie(ge))return Xe(me,he,ge,Pe);if(Y(ge))return et(me,he,ge,Pe);z2(me,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,he!==null&&he.tag===6?(y(me,he.sibling),he=O(he,ge),he.return=me,me=he):(y(me,he),he=sE(ge,me.mode,Pe),he.return=me,me=he),K(me)):y(me,he)}return Bn}var Hf=ak(!0),lk=ak(!1),$2=gu(null),W2=null,zf=null,mA=null;function gA(){mA=zf=W2=null}function yA(l){var h=$2.current;fn($2),l._currentValue=h}function vA(l,h,y){for(;l!==null;){var x=l.alternate;if((l.childLanes&h)!==h?(l.childLanes|=h,x!==null&&(x.childLanes|=h)):x!==null&&(x.childLanes&h)!==h&&(x.childLanes|=h),l===y)break;l=l.return}}function $f(l,h){W2=l,mA=zf=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&h)!==0&&(ki=!0),l.firstContext=null)}function ks(l){var h=l._currentValue;if(mA!==l)if(l={context:l,memoizedValue:h,next:null},zf===null){if(W2===null)throw Error(t(308));zf=l,W2.dependencies={lanes:0,firstContext:l}}else zf=zf.next=l;return h}var bh=null;function wA(l){bh===null?bh=[l]:bh.push(l)}function uk(l,h,y,x){var O=h.interleaved;return O===null?(y.next=y,wA(h)):(y.next=O.next,O.next=y),h.interleaved=y,$a(l,x)}function $a(l,h){l.lanes|=h;var y=l.alternate;for(y!==null&&(y.lanes|=h),y=l,l=l.return;l!==null;)l.childLanes|=h,y=l.alternate,y!==null&&(y.childLanes|=h),y=l,l=l.return;return y.tag===3?y.stateNode:null}var wu=!1;function _A(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ck(l,h){l=l.updateQueue,h.updateQueue===l&&(h.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Wa(l,h){return{eventTime:l,lane:h,tag:0,payload:null,callback:null,next:null}}function _u(l,h,y){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,(Ut&2)!==0){var O=x.pending;return O===null?h.next=h:(h.next=O.next,O.next=h),x.pending=h,$a(l,y)}return O=x.interleaved,O===null?(h.next=h,wA(x)):(h.next=O.next,O.next=h),x.interleaved=h,$a(l,y)}function G2(l,h,y){if(h=h.updateQueue,h!==null&&(h=h.shared,(y&4194240)!==0)){var x=h.lanes;x&=l.pendingLanes,y|=x,h.lanes=y,uu(l,y)}}function hk(l,h){var y=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,y===x)){var O=null,j=null;if(y=y.firstBaseUpdate,y!==null){do{var K={eventTime:y.eventTime,lane:y.lane,tag:y.tag,payload:y.payload,callback:y.callback,next:null};j===null?O=j=K:j=j.next=K,y=y.next}while(y!==null);j===null?O=j=h:j=j.next=h}else O=j=h;y={baseState:x.baseState,firstBaseUpdate:O,lastBaseUpdate:j,shared:x.shared,effects:x.effects},l.updateQueue=y;return}l=y.lastBaseUpdate,l===null?y.firstBaseUpdate=h:l.next=h,y.lastBaseUpdate=h}function K2(l,h,y,x){var O=l.updateQueue;wu=!1;var j=O.firstBaseUpdate,K=O.lastBaseUpdate,oe=O.shared.pending;if(oe!==null){O.shared.pending=null;var ce=oe,we=ce.next;ce.next=null,K===null?j=we:K.next=we,K=ce;var Te=l.alternate;Te!==null&&(Te=Te.updateQueue,oe=Te.lastBaseUpdate,oe!==K&&(oe===null?Te.firstBaseUpdate=we:oe.next=we,Te.lastBaseUpdate=ce))}if(j!==null){var De=O.baseState;K=0,Te=we=ce=null,oe=j;do{var Se=oe.lane,je=oe.eventTime;if((x&Se)===Se){Te!==null&&(Te=Te.next={eventTime:je,lane:0,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null});e:{var Xe=l,et=oe;switch(Se=h,je=y,et.tag){case 1:if(Xe=et.payload,typeof Xe=="function"){De=Xe.call(je,De,Se);break e}De=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=et.payload,Se=typeof Xe=="function"?Xe.call(je,De,Se):Xe,Se==null)break e;De=J({},De,Se);break e;case 2:wu=!0}}oe.callback!==null&&oe.lane!==0&&(l.flags|=64,Se=O.effects,Se===null?O.effects=[oe]:Se.push(oe))}else je={eventTime:je,lane:Se,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null},Te===null?(we=Te=je,ce=De):Te=Te.next=je,K|=Se;if(oe=oe.next,oe===null){if(oe=O.shared.pending,oe===null)break;Se=oe,oe=Se.next,Se.next=null,O.lastBaseUpdate=Se,O.shared.pending=null}}while(!0);if(Te===null&&(ce=De),O.baseState=ce,O.firstBaseUpdate=we,O.lastBaseUpdate=Te,h=O.shared.interleaved,h!==null){O=h;do K|=O.lane,O=O.next;while(O!==h)}else j===null&&(O.shared.lanes=0);Ch|=K,l.lanes=K,l.memoizedState=De}}function dk(l,h,y){if(l=h.effects,h.effects=null,l!==null)for(h=0;h<l.length;h++){var x=l[h],O=x.callback;if(O!==null){if(x.callback=null,x=y,typeof O!="function")throw Error(t(191,O));O.call(x)}}}var Og={},Ho=gu(Og),Lg=gu(Og),Fg=gu(Og);function Ah(l){if(l===Og)throw Error(t(174));return l}function bA(l,h){switch(un(Fg,h),un(Lg,l),un(Ho,Og),l=h.nodeType,l){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:ft(null,"");break;default:l=l===8?h.parentNode:h,h=l.namespaceURI||null,l=l.tagName,h=ft(h,l)}fn(Ho),un(Ho,h)}function Wf(){fn(Ho),fn(Lg),fn(Fg)}function fk(l){Ah(Fg.current);var h=Ah(Ho.current),y=ft(h,l.type);h!==y&&(un(Lg,l),un(Ho,y))}function AA(l){Lg.current===l&&(fn(Ho),fn(Lg))}var Sn=gu(0);function J2(l){for(var h=l;h!==null;){if(h.tag===13){var y=h.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||y.data==="$?"||y.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var EA=[];function CA(){for(var l=0;l<EA.length;l++)EA[l]._workInProgressVersionPrimary=null;EA.length=0}var Y2=S.ReactCurrentDispatcher,xA=S.ReactCurrentBatchConfig,Eh=0,Tn=null,nr=null,gr=null,X2=!1,Mg=!1,Bg=0,m9=0;function Kr(){throw Error(t(321))}function SA(l,h){if(h===null)return!1;for(var y=0;y<h.length&&y<l.length;y++)if(!lo(l[y],h[y]))return!1;return!0}function TA(l,h,y,x,O,j){if(Eh=j,Tn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Y2.current=l===null||l.memoizedState===null?w9:_9,l=y(x,O),Mg){j=0;do{if(Mg=!1,Bg=0,25<=j)throw Error(t(301));j+=1,gr=nr=null,h.updateQueue=null,Y2.current=b9,l=y(x,O)}while(Mg)}if(Y2.current=ew,h=nr!==null&&nr.next!==null,Eh=0,gr=nr=Tn=null,X2=!1,h)throw Error(t(300));return l}function IA(){var l=Bg!==0;return Bg=0,l}function zo(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gr===null?Tn.memoizedState=gr=l:gr=gr.next=l,gr}function Rs(){if(nr===null){var l=Tn.alternate;l=l!==null?l.memoizedState:null}else l=nr.next;var h=gr===null?Tn.memoizedState:gr.next;if(h!==null)gr=h,nr=l;else{if(l===null)throw Error(t(310));nr=l,l={memoizedState:nr.memoizedState,baseState:nr.baseState,baseQueue:nr.baseQueue,queue:nr.queue,next:null},gr===null?Tn.memoizedState=gr=l:gr=gr.next=l}return gr}function jg(l,h){return typeof h=="function"?h(l):h}function DA(l){var h=Rs(),y=h.queue;if(y===null)throw Error(t(311));y.lastRenderedReducer=l;var x=nr,O=x.baseQueue,j=y.pending;if(j!==null){if(O!==null){var K=O.next;O.next=j.next,j.next=K}x.baseQueue=O=j,y.pending=null}if(O!==null){j=O.next,x=x.baseState;var oe=K=null,ce=null,we=j;do{var Te=we.lane;if((Eh&Te)===Te)ce!==null&&(ce=ce.next={lane:0,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),x=we.hasEagerState?we.eagerState:l(x,we.action);else{var De={lane:Te,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null};ce===null?(oe=ce=De,K=x):ce=ce.next=De,Tn.lanes|=Te,Ch|=Te}we=we.next}while(we!==null&&we!==j);ce===null?K=x:ce.next=oe,lo(x,h.memoizedState)||(ki=!0),h.memoizedState=x,h.baseState=K,h.baseQueue=ce,y.lastRenderedState=x}if(l=y.interleaved,l!==null){O=l;do j=O.lane,Tn.lanes|=j,Ch|=j,O=O.next;while(O!==l)}else O===null&&(y.lanes=0);return[h.memoizedState,y.dispatch]}function kA(l){var h=Rs(),y=h.queue;if(y===null)throw Error(t(311));y.lastRenderedReducer=l;var x=y.dispatch,O=y.pending,j=h.memoizedState;if(O!==null){y.pending=null;var K=O=O.next;do j=l(j,K.action),K=K.next;while(K!==O);lo(j,h.memoizedState)||(ki=!0),h.memoizedState=j,h.baseQueue===null&&(h.baseState=j),y.lastRenderedState=j}return[j,x]}function pk(){}function mk(l,h){var y=Tn,x=Rs(),O=h(),j=!lo(x.memoizedState,O);if(j&&(x.memoizedState=O,ki=!0),x=x.queue,RA(vk.bind(null,y,x,l),[l]),x.getSnapshot!==h||j||gr!==null&&gr.memoizedState.tag&1){if(y.flags|=2048,qg(9,yk.bind(null,y,x,O,h),void 0,null),yr===null)throw Error(t(349));(Eh&30)!==0||gk(y,h,O)}return O}function gk(l,h,y){l.flags|=16384,l={getSnapshot:h,value:y},h=Tn.updateQueue,h===null?(h={lastEffect:null,stores:null},Tn.updateQueue=h,h.stores=[l]):(y=h.stores,y===null?h.stores=[l]:y.push(l))}function yk(l,h,y,x){h.value=y,h.getSnapshot=x,wk(h)&&_k(l)}function vk(l,h,y){return y(function(){wk(h)&&_k(l)})}function wk(l){var h=l.getSnapshot;l=l.value;try{var y=h();return!lo(l,y)}catch{return!0}}function _k(l){var h=$a(l,1);h!==null&&po(h,l,1,-1)}function bk(l){var h=zo();return typeof l=="function"&&(l=l()),h.memoizedState=h.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jg,lastRenderedState:l},h.queue=l,l=l.dispatch=v9.bind(null,Tn,l),[h.memoizedState,l]}function qg(l,h,y,x){return l={tag:l,create:h,destroy:y,deps:x,next:null},h=Tn.updateQueue,h===null?(h={lastEffect:null,stores:null},Tn.updateQueue=h,h.lastEffect=l.next=l):(y=h.lastEffect,y===null?h.lastEffect=l.next=l:(x=y.next,y.next=l,l.next=x,h.lastEffect=l)),l}function Ak(){return Rs().memoizedState}function Q2(l,h,y,x){var O=zo();Tn.flags|=l,O.memoizedState=qg(1|h,y,void 0,x===void 0?null:x)}function Z2(l,h,y,x){var O=Rs();x=x===void 0?null:x;var j=void 0;if(nr!==null){var K=nr.memoizedState;if(j=K.destroy,x!==null&&SA(x,K.deps)){O.memoizedState=qg(h,y,j,x);return}}Tn.flags|=l,O.memoizedState=qg(1|h,y,j,x)}function Ek(l,h){return Q2(8390656,8,l,h)}function RA(l,h){return Z2(2048,8,l,h)}function Ck(l,h){return Z2(4,2,l,h)}function xk(l,h){return Z2(4,4,l,h)}function Sk(l,h){if(typeof h=="function")return l=l(),h(l),function(){h(null)};if(h!=null)return l=l(),h.current=l,function(){h.current=null}}function Tk(l,h,y){return y=y!=null?y.concat([l]):null,Z2(4,4,Sk.bind(null,h,l),y)}function PA(){}function Ik(l,h){var y=Rs();h=h===void 0?null:h;var x=y.memoizedState;return x!==null&&h!==null&&SA(h,x[1])?x[0]:(y.memoizedState=[l,h],l)}function Dk(l,h){var y=Rs();h=h===void 0?null:h;var x=y.memoizedState;return x!==null&&h!==null&&SA(h,x[1])?x[0]:(l=l(),y.memoizedState=[l,h],l)}function kk(l,h,y){return(Eh&21)===0?(l.baseState&&(l.baseState=!1,ki=!0),l.memoizedState=y):(lo(y,h)||(y=dh(),Tn.lanes|=y,Ch|=y,l.baseState=!0),h)}function g9(l,h){var y=Lt;Lt=y!==0&&4>y?y:4,l(!0);var x=xA.transition;xA.transition={};try{l(!1),h()}finally{Lt=y,xA.transition=x}}function Rk(){return Rs().memoizedState}function y9(l,h,y){var x=Cu(l);if(y={lane:x,action:y,hasEagerState:!1,eagerState:null,next:null},Pk(l))Nk(h,y);else if(y=uk(l,h,y,x),y!==null){var O=ui();po(y,l,x,O),Ok(y,h,x)}}function v9(l,h,y){var x=Cu(l),O={lane:x,action:y,hasEagerState:!1,eagerState:null,next:null};if(Pk(l))Nk(h,O);else{var j=l.alternate;if(l.lanes===0&&(j===null||j.lanes===0)&&(j=h.lastRenderedReducer,j!==null))try{var K=h.lastRenderedState,oe=j(K,y);if(O.hasEagerState=!0,O.eagerState=oe,lo(oe,K)){var ce=h.interleaved;ce===null?(O.next=O,wA(h)):(O.next=ce.next,ce.next=O),h.interleaved=O;return}}catch{}finally{}y=uk(l,h,O,x),y!==null&&(O=ui(),po(y,l,x,O),Ok(y,h,x))}}function Pk(l){var h=l.alternate;return l===Tn||h!==null&&h===Tn}function Nk(l,h){Mg=X2=!0;var y=l.pending;y===null?h.next=h:(h.next=y.next,y.next=h),l.pending=h}function Ok(l,h,y){if((y&4194240)!==0){var x=h.lanes;x&=l.pendingLanes,y|=x,h.lanes=y,uu(l,y)}}var ew={readContext:ks,useCallback:Kr,useContext:Kr,useEffect:Kr,useImperativeHandle:Kr,useInsertionEffect:Kr,useLayoutEffect:Kr,useMemo:Kr,useReducer:Kr,useRef:Kr,useState:Kr,useDebugValue:Kr,useDeferredValue:Kr,useTransition:Kr,useMutableSource:Kr,useSyncExternalStore:Kr,useId:Kr,unstable_isNewReconciler:!1},w9={readContext:ks,useCallback:function(l,h){return zo().memoizedState=[l,h===void 0?null:h],l},useContext:ks,useEffect:Ek,useImperativeHandle:function(l,h,y){return y=y!=null?y.concat([l]):null,Q2(4194308,4,Sk.bind(null,h,l),y)},useLayoutEffect:function(l,h){return Q2(4194308,4,l,h)},useInsertionEffect:function(l,h){return Q2(4,2,l,h)},useMemo:function(l,h){var y=zo();return h=h===void 0?null:h,l=l(),y.memoizedState=[l,h],l},useReducer:function(l,h,y){var x=zo();return h=y!==void 0?y(h):h,x.memoizedState=x.baseState=h,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:h},x.queue=l,l=l.dispatch=y9.bind(null,Tn,l),[x.memoizedState,l]},useRef:function(l){var h=zo();return l={current:l},h.memoizedState=l},useState:bk,useDebugValue:PA,useDeferredValue:function(l){return zo().memoizedState=l},useTransition:function(){var l=bk(!1),h=l[0];return l=g9.bind(null,l[1]),zo().memoizedState=l,[h,l]},useMutableSource:function(){},useSyncExternalStore:function(l,h,y){var x=Tn,O=zo();if(_n){if(y===void 0)throw Error(t(407));y=y()}else{if(y=h(),yr===null)throw Error(t(349));(Eh&30)!==0||gk(x,h,y)}O.memoizedState=y;var j={value:y,getSnapshot:h};return O.queue=j,Ek(vk.bind(null,x,j,l),[l]),x.flags|=2048,qg(9,yk.bind(null,x,j,y,h),void 0,null),y},useId:function(){var l=zo(),h=yr.identifierPrefix;if(_n){var y=za,x=Ha;y=(x&~(1<<32-oi(x)-1)).toString(32)+y,h=":"+h+"R"+y,y=Bg++,0<y&&(h+="H"+y.toString(32)),h+=":"}else y=m9++,h=":"+h+"r"+y.toString(32)+":";return l.memoizedState=h},unstable_isNewReconciler:!1},_9={readContext:ks,useCallback:Ik,useContext:ks,useEffect:RA,useImperativeHandle:Tk,useInsertionEffect:Ck,useLayoutEffect:xk,useMemo:Dk,useReducer:DA,useRef:Ak,useState:function(){return DA(jg)},useDebugValue:PA,useDeferredValue:function(l){var h=Rs();return kk(h,nr.memoizedState,l)},useTransition:function(){var l=DA(jg)[0],h=Rs().memoizedState;return[l,h]},useMutableSource:pk,useSyncExternalStore:mk,useId:Rk,unstable_isNewReconciler:!1},b9={readContext:ks,useCallback:Ik,useContext:ks,useEffect:RA,useImperativeHandle:Tk,useInsertionEffect:Ck,useLayoutEffect:xk,useMemo:Dk,useReducer:kA,useRef:Ak,useState:function(){return kA(jg)},useDebugValue:PA,useDeferredValue:function(l){var h=Rs();return nr===null?h.memoizedState=l:kk(h,nr.memoizedState,l)},useTransition:function(){var l=kA(jg)[0],h=Rs().memoizedState;return[l,h]},useMutableSource:pk,useSyncExternalStore:mk,useId:Rk,unstable_isNewReconciler:!1};function co(l,h){if(l&&l.defaultProps){h=J({},h),l=l.defaultProps;for(var y in l)h[y]===void 0&&(h[y]=l[y]);return h}return h}function NA(l,h,y,x){h=l.memoizedState,y=y(x,h),y=y==null?h:J({},h,y),l.memoizedState=y,l.lanes===0&&(l.updateQueue.baseState=y)}var tw={isMounted:function(l){return(l=l._reactInternals)?to(l)===l:!1},enqueueSetState:function(l,h,y){l=l._reactInternals;var x=ui(),O=Cu(l),j=Wa(x,O);j.payload=h,y!=null&&(j.callback=y),h=_u(l,j,O),h!==null&&(po(h,l,O,x),G2(h,l,O))},enqueueReplaceState:function(l,h,y){l=l._reactInternals;var x=ui(),O=Cu(l),j=Wa(x,O);j.tag=1,j.payload=h,y!=null&&(j.callback=y),h=_u(l,j,O),h!==null&&(po(h,l,O,x),G2(h,l,O))},enqueueForceUpdate:function(l,h){l=l._reactInternals;var y=ui(),x=Cu(l),O=Wa(y,x);O.tag=2,h!=null&&(O.callback=h),h=_u(l,O,x),h!==null&&(po(h,l,x,y),G2(h,l,x))}};function Lk(l,h,y,x,O,j,K){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,j,K):h.prototype&&h.prototype.isPureReactComponent?!Sg(y,x)||!Sg(O,j):!0}function Fk(l,h,y){var x=!1,O=yu,j=h.contextType;return typeof j=="object"&&j!==null?j=ks(j):(O=Di(h)?vh:Gr.current,x=h.contextTypes,j=(x=x!=null)?jf(l,O):yu),h=new h(y,j),l.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=tw,l.stateNode=h,h._reactInternals=l,x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=O,l.__reactInternalMemoizedMaskedChildContext=j),h}function Mk(l,h,y,x){l=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(y,x),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(y,x),h.state!==l&&tw.enqueueReplaceState(h,h.state,null)}function OA(l,h,y,x){var O=l.stateNode;O.props=y,O.state=l.memoizedState,O.refs={},_A(l);var j=h.contextType;typeof j=="object"&&j!==null?O.context=ks(j):(j=Di(h)?vh:Gr.current,O.context=jf(l,j)),O.state=l.memoizedState,j=h.getDerivedStateFromProps,typeof j=="function"&&(NA(l,h,j,y),O.state=l.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof O.getSnapshotBeforeUpdate=="function"||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(h=O.state,typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount(),h!==O.state&&tw.enqueueReplaceState(O,O.state,null),K2(l,y,O,x),O.state=l.memoizedState),typeof O.componentDidMount=="function"&&(l.flags|=4194308)}function Gf(l,h){try{var y="",x=h;do y+=se(x),x=x.return;while(x);var O=y}catch(j){O=`
Error generating stack: `+j.message+`
`+j.stack}return{value:l,source:h,stack:O,digest:null}}function LA(l,h,y){return{value:l,source:null,stack:y??null,digest:h??null}}function FA(l,h){try{console.error(h.value)}catch(y){setTimeout(function(){throw y})}}var A9=typeof WeakMap=="function"?WeakMap:Map;function Bk(l,h,y){y=Wa(-1,y),y.tag=3,y.payload={element:null};var x=h.value;return y.callback=function(){lw||(lw=!0,XA=x),FA(l,h)},y}function jk(l,h,y){y=Wa(-1,y),y.tag=3;var x=l.type.getDerivedStateFromError;if(typeof x=="function"){var O=h.value;y.payload=function(){return x(O)},y.callback=function(){FA(l,h)}}var j=l.stateNode;return j!==null&&typeof j.componentDidCatch=="function"&&(y.callback=function(){FA(l,h),typeof x!="function"&&(Au===null?Au=new Set([this]):Au.add(this));var K=h.stack;this.componentDidCatch(h.value,{componentStack:K!==null?K:""})}),y}function qk(l,h,y){var x=l.pingCache;if(x===null){x=l.pingCache=new A9;var O=new Set;x.set(h,O)}else O=x.get(h),O===void 0&&(O=new Set,x.set(h,O));O.has(y)||(O.add(y),l=F9.bind(null,l,h,y),h.then(l,l))}function Uk(l){do{var h;if((h=l.tag===13)&&(h=l.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return l;l=l.return}while(l!==null);return null}function Vk(l,h,y,x,O){return(l.mode&1)===0?(l===h?l.flags|=65536:(l.flags|=128,y.flags|=131072,y.flags&=-52805,y.tag===1&&(y.alternate===null?y.tag=17:(h=Wa(-1,1),h.tag=2,_u(y,h,1))),y.lanes|=1),l):(l.flags|=65536,l.lanes=O,l)}var E9=S.ReactCurrentOwner,ki=!1;function li(l,h,y,x){h.child=l===null?lk(h,null,y,x):Hf(h,l.child,y,x)}function Hk(l,h,y,x,O){y=y.render;var j=h.ref;return $f(h,O),x=TA(l,h,y,x,j,O),y=IA(),l!==null&&!ki?(h.updateQueue=l.updateQueue,h.flags&=-2053,l.lanes&=~O,Ga(l,h,O)):(_n&&y&&cA(h),h.flags|=1,li(l,h,x,O),h.child)}function zk(l,h,y,x,O){if(l===null){var j=y.type;return typeof j=="function"&&!iE(j)&&j.defaultProps===void 0&&y.compare===null&&y.defaultProps===void 0?(h.tag=15,h.type=j,$k(l,h,j,x,O)):(l=pw(y.type,null,x,h,h.mode,O),l.ref=h.ref,l.return=h,h.child=l)}if(j=l.child,(l.lanes&O)===0){var K=j.memoizedProps;if(y=y.compare,y=y!==null?y:Sg,y(K,x)&&l.ref===h.ref)return Ga(l,h,O)}return h.flags|=1,l=Su(j,x),l.ref=h.ref,l.return=h,h.child=l}function $k(l,h,y,x,O){if(l!==null){var j=l.memoizedProps;if(Sg(j,x)&&l.ref===h.ref)if(ki=!1,h.pendingProps=x=j,(l.lanes&O)!==0)(l.flags&131072)!==0&&(ki=!0);else return h.lanes=l.lanes,Ga(l,h,O)}return MA(l,h,y,x,O)}function Wk(l,h,y){var x=h.pendingProps,O=x.children,j=l!==null?l.memoizedState:null;if(x.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},un(Jf,Ji),Ji|=y;else{if((y&1073741824)===0)return l=j!==null?j.baseLanes|y:y,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:l,cachePool:null,transitions:null},h.updateQueue=null,un(Jf,Ji),Ji|=l,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=j!==null?j.baseLanes:y,un(Jf,Ji),Ji|=x}else j!==null?(x=j.baseLanes|y,h.memoizedState=null):x=y,un(Jf,Ji),Ji|=x;return li(l,h,O,y),h.child}function Gk(l,h){var y=h.ref;(l===null&&y!==null||l!==null&&l.ref!==y)&&(h.flags|=512,h.flags|=2097152)}function MA(l,h,y,x,O){var j=Di(y)?vh:Gr.current;return j=jf(h,j),$f(h,O),y=TA(l,h,y,x,j,O),x=IA(),l!==null&&!ki?(h.updateQueue=l.updateQueue,h.flags&=-2053,l.lanes&=~O,Ga(l,h,O)):(_n&&x&&cA(h),h.flags|=1,li(l,h,y,O),h.child)}function Kk(l,h,y,x,O){if(Di(y)){var j=!0;j2(h)}else j=!1;if($f(h,O),h.stateNode===null)rw(l,h),Fk(h,y,x),OA(h,y,x,O),x=!0;else if(l===null){var K=h.stateNode,oe=h.memoizedProps;K.props=oe;var ce=K.context,we=y.contextType;typeof we=="object"&&we!==null?we=ks(we):(we=Di(y)?vh:Gr.current,we=jf(h,we));var Te=y.getDerivedStateFromProps,De=typeof Te=="function"||typeof K.getSnapshotBeforeUpdate=="function";De||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(oe!==x||ce!==we)&&Mk(h,K,x,we),wu=!1;var Se=h.memoizedState;K.state=Se,K2(h,x,K,O),ce=h.memoizedState,oe!==x||Se!==ce||Ii.current||wu?(typeof Te=="function"&&(NA(h,y,Te,x),ce=h.memoizedState),(oe=wu||Lk(h,y,oe,x,Se,ce,we))?(De||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount()),typeof K.componentDidMount=="function"&&(h.flags|=4194308)):(typeof K.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=x,h.memoizedState=ce),K.props=x,K.state=ce,K.context=we,x=oe):(typeof K.componentDidMount=="function"&&(h.flags|=4194308),x=!1)}else{K=h.stateNode,ck(l,h),oe=h.memoizedProps,we=h.type===h.elementType?oe:co(h.type,oe),K.props=we,De=h.pendingProps,Se=K.context,ce=y.contextType,typeof ce=="object"&&ce!==null?ce=ks(ce):(ce=Di(y)?vh:Gr.current,ce=jf(h,ce));var je=y.getDerivedStateFromProps;(Te=typeof je=="function"||typeof K.getSnapshotBeforeUpdate=="function")||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(oe!==De||Se!==ce)&&Mk(h,K,x,ce),wu=!1,Se=h.memoizedState,K.state=Se,K2(h,x,K,O);var Xe=h.memoizedState;oe!==De||Se!==Xe||Ii.current||wu?(typeof je=="function"&&(NA(h,y,je,x),Xe=h.memoizedState),(we=wu||Lk(h,y,we,x,Se,Xe,ce)||!1)?(Te||typeof K.UNSAFE_componentWillUpdate!="function"&&typeof K.componentWillUpdate!="function"||(typeof K.componentWillUpdate=="function"&&K.componentWillUpdate(x,Xe,ce),typeof K.UNSAFE_componentWillUpdate=="function"&&K.UNSAFE_componentWillUpdate(x,Xe,ce)),typeof K.componentDidUpdate=="function"&&(h.flags|=4),typeof K.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof K.componentDidUpdate!="function"||oe===l.memoizedProps&&Se===l.memoizedState||(h.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||oe===l.memoizedProps&&Se===l.memoizedState||(h.flags|=1024),h.memoizedProps=x,h.memoizedState=Xe),K.props=x,K.state=Xe,K.context=ce,x=we):(typeof K.componentDidUpdate!="function"||oe===l.memoizedProps&&Se===l.memoizedState||(h.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||oe===l.memoizedProps&&Se===l.memoizedState||(h.flags|=1024),x=!1)}return BA(l,h,y,x,j,O)}function BA(l,h,y,x,O,j){Gk(l,h);var K=(h.flags&128)!==0;if(!x&&!K)return O&&ZD(h,y,!1),Ga(l,h,j);x=h.stateNode,E9.current=h;var oe=K&&typeof y.getDerivedStateFromError!="function"?null:x.render();return h.flags|=1,l!==null&&K?(h.child=Hf(h,l.child,null,j),h.child=Hf(h,null,oe,j)):li(l,h,oe,j),h.memoizedState=x.state,O&&ZD(h,y,!0),h.child}function Jk(l){var h=l.stateNode;h.pendingContext?XD(l,h.pendingContext,h.pendingContext!==h.context):h.context&&XD(l,h.context,!1),bA(l,h.containerInfo)}function Yk(l,h,y,x,O){return Vf(),pA(O),h.flags|=256,li(l,h,y,x),h.child}var jA={dehydrated:null,treeContext:null,retryLane:0};function qA(l){return{baseLanes:l,cachePool:null,transitions:null}}function Xk(l,h,y){var x=h.pendingProps,O=Sn.current,j=!1,K=(h.flags&128)!==0,oe;if((oe=K)||(oe=l!==null&&l.memoizedState===null?!1:(O&2)!==0),oe?(j=!0,h.flags&=-129):(l===null||l.memoizedState!==null)&&(O|=1),un(Sn,O&1),l===null)return fA(h),l=h.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((h.mode&1)===0?h.lanes=1:l.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(K=x.children,l=x.fallback,j?(x=h.mode,j=h.child,K={mode:"hidden",children:K},(x&1)===0&&j!==null?(j.childLanes=0,j.pendingProps=K):j=mw(K,x,0,null),l=Ih(l,x,y,null),j.return=h,l.return=h,j.sibling=l,h.child=j,h.child.memoizedState=qA(y),h.memoizedState=jA,l):UA(h,K));if(O=l.memoizedState,O!==null&&(oe=O.dehydrated,oe!==null))return C9(l,h,K,x,oe,O,y);if(j){j=x.fallback,K=h.mode,O=l.child,oe=O.sibling;var ce={mode:"hidden",children:x.children};return(K&1)===0&&h.child!==O?(x=h.child,x.childLanes=0,x.pendingProps=ce,h.deletions=null):(x=Su(O,ce),x.subtreeFlags=O.subtreeFlags&14680064),oe!==null?j=Su(oe,j):(j=Ih(j,K,y,null),j.flags|=2),j.return=h,x.return=h,x.sibling=j,h.child=x,x=j,j=h.child,K=l.child.memoizedState,K=K===null?qA(y):{baseLanes:K.baseLanes|y,cachePool:null,transitions:K.transitions},j.memoizedState=K,j.childLanes=l.childLanes&~y,h.memoizedState=jA,x}return j=l.child,l=j.sibling,x=Su(j,{mode:"visible",children:x.children}),(h.mode&1)===0&&(x.lanes=y),x.return=h,x.sibling=null,l!==null&&(y=h.deletions,y===null?(h.deletions=[l],h.flags|=16):y.push(l)),h.child=x,h.memoizedState=null,x}function UA(l,h){return h=mw({mode:"visible",children:h},l.mode,0,null),h.return=l,l.child=h}function nw(l,h,y,x){return x!==null&&pA(x),Hf(h,l.child,null,y),l=UA(h,h.pendingProps.children),l.flags|=2,h.memoizedState=null,l}function C9(l,h,y,x,O,j,K){if(y)return h.flags&256?(h.flags&=-257,x=LA(Error(t(422))),nw(l,h,K,x)):h.memoizedState!==null?(h.child=l.child,h.flags|=128,null):(j=x.fallback,O=h.mode,x=mw({mode:"visible",children:x.children},O,0,null),j=Ih(j,O,K,null),j.flags|=2,x.return=h,j.return=h,x.sibling=j,h.child=x,(h.mode&1)!==0&&Hf(h,l.child,null,K),h.child.memoizedState=qA(K),h.memoizedState=jA,j);if((h.mode&1)===0)return nw(l,h,K,null);if(O.data==="$!"){if(x=O.nextSibling&&O.nextSibling.dataset,x)var oe=x.dgst;return x=oe,j=Error(t(419)),x=LA(j,x,void 0),nw(l,h,K,x)}if(oe=(K&l.childLanes)!==0,ki||oe){if(x=yr,x!==null){switch(K&-K){case 4:O=2;break;case 16:O=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:O=32;break;case 536870912:O=268435456;break;default:O=0}O=(O&(x.suspendedLanes|K))!==0?0:O,O!==0&&O!==j.retryLane&&(j.retryLane=O,$a(l,O),po(x,l,O,-1))}return rE(),x=LA(Error(t(421))),nw(l,h,K,x)}return O.data==="$?"?(h.flags|=128,h.child=l.child,h=M9.bind(null,l),O._reactRetry=h,null):(l=j.treeContext,Ki=mu(O.nextSibling),Gi=h,_n=!0,uo=null,l!==null&&(Is[Ds++]=Ha,Is[Ds++]=za,Is[Ds++]=wh,Ha=l.id,za=l.overflow,wh=h),h=UA(h,x.children),h.flags|=4096,h)}function Qk(l,h,y){l.lanes|=h;var x=l.alternate;x!==null&&(x.lanes|=h),vA(l.return,h,y)}function VA(l,h,y,x,O){var j=l.memoizedState;j===null?l.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:x,tail:y,tailMode:O}:(j.isBackwards=h,j.rendering=null,j.renderingStartTime=0,j.last=x,j.tail=y,j.tailMode=O)}function Zk(l,h,y){var x=h.pendingProps,O=x.revealOrder,j=x.tail;if(li(l,h,x.children,y),x=Sn.current,(x&2)!==0)x=x&1|2,h.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=h.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Qk(l,y,h);else if(l.tag===19)Qk(l,y,h);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===h)break e;for(;l.sibling===null;){if(l.return===null||l.return===h)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}x&=1}if(un(Sn,x),(h.mode&1)===0)h.memoizedState=null;else switch(O){case"forwards":for(y=h.child,O=null;y!==null;)l=y.alternate,l!==null&&J2(l)===null&&(O=y),y=y.sibling;y=O,y===null?(O=h.child,h.child=null):(O=y.sibling,y.sibling=null),VA(h,!1,O,y,j);break;case"backwards":for(y=null,O=h.child,h.child=null;O!==null;){if(l=O.alternate,l!==null&&J2(l)===null){h.child=O;break}l=O.sibling,O.sibling=y,y=O,O=l}VA(h,!0,y,null,j);break;case"together":VA(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function rw(l,h){(h.mode&1)===0&&l!==null&&(l.alternate=null,h.alternate=null,h.flags|=2)}function Ga(l,h,y){if(l!==null&&(h.dependencies=l.dependencies),Ch|=h.lanes,(y&h.childLanes)===0)return null;if(l!==null&&h.child!==l.child)throw Error(t(153));if(h.child!==null){for(l=h.child,y=Su(l,l.pendingProps),h.child=y,y.return=h;l.sibling!==null;)l=l.sibling,y=y.sibling=Su(l,l.pendingProps),y.return=h;y.sibling=null}return h.child}function x9(l,h,y){switch(h.tag){case 3:Jk(h),Vf();break;case 5:fk(h);break;case 1:Di(h.type)&&j2(h);break;case 4:bA(h,h.stateNode.containerInfo);break;case 10:var x=h.type._context,O=h.memoizedProps.value;un($2,x._currentValue),x._currentValue=O;break;case 13:if(x=h.memoizedState,x!==null)return x.dehydrated!==null?(un(Sn,Sn.current&1),h.flags|=128,null):(y&h.child.childLanes)!==0?Xk(l,h,y):(un(Sn,Sn.current&1),l=Ga(l,h,y),l!==null?l.sibling:null);un(Sn,Sn.current&1);break;case 19:if(x=(y&h.childLanes)!==0,(l.flags&128)!==0){if(x)return Zk(l,h,y);h.flags|=128}if(O=h.memoizedState,O!==null&&(O.rendering=null,O.tail=null,O.lastEffect=null),un(Sn,Sn.current),x)break;return null;case 22:case 23:return h.lanes=0,Wk(l,h,y)}return Ga(l,h,y)}var eR,HA,tR,nR;eR=function(l,h){for(var y=h.child;y!==null;){if(y.tag===5||y.tag===6)l.appendChild(y.stateNode);else if(y.tag!==4&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===h)break;for(;y.sibling===null;){if(y.return===null||y.return===h)return;y=y.return}y.sibling.return=y.return,y=y.sibling}},HA=function(){},tR=function(l,h,y,x){var O=l.memoizedProps;if(O!==x){l=h.stateNode,Ah(Ho.current);var j=null;switch(y){case"input":O=Fe(l,O),x=Fe(l,x),j=[];break;case"select":O=J({},O,{value:void 0}),x=J({},x,{value:void 0}),j=[];break;case"textarea":O=be(l,O),x=be(l,x),j=[];break;default:typeof O.onClick!="function"&&typeof x.onClick=="function"&&(l.onclick=F2)}ag(y,x);var K;y=null;for(we in O)if(!x.hasOwnProperty(we)&&O.hasOwnProperty(we)&&O[we]!=null)if(we==="style"){var oe=O[we];for(K in oe)oe.hasOwnProperty(K)&&(y||(y={}),y[K]="")}else we!=="dangerouslySetInnerHTML"&&we!=="children"&&we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&we!=="autoFocus"&&(r.hasOwnProperty(we)?j||(j=[]):(j=j||[]).push(we,null));for(we in x){var ce=x[we];if(oe=O!=null?O[we]:void 0,x.hasOwnProperty(we)&&ce!==oe&&(ce!=null||oe!=null))if(we==="style")if(oe){for(K in oe)!oe.hasOwnProperty(K)||ce&&ce.hasOwnProperty(K)||(y||(y={}),y[K]="");for(K in ce)ce.hasOwnProperty(K)&&oe[K]!==ce[K]&&(y||(y={}),y[K]=ce[K])}else y||(j||(j=[]),j.push(we,y)),y=ce;else we==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,oe=oe?oe.__html:void 0,ce!=null&&oe!==ce&&(j=j||[]).push(we,ce)):we==="children"?typeof ce!="string"&&typeof ce!="number"||(j=j||[]).push(we,""+ce):we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&(r.hasOwnProperty(we)?(ce!=null&&we==="onScroll"&&dn("scroll",l),j||oe===ce||(j=[])):(j=j||[]).push(we,ce))}y&&(j=j||[]).push("style",y);var we=j;(h.updateQueue=we)&&(h.flags|=4)}},nR=function(l,h,y,x){y!==x&&(h.flags|=4)};function Ug(l,h){if(!_n)switch(l.tailMode){case"hidden":h=l.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?l.tail=null:y.sibling=null;break;case"collapsed":y=l.tail;for(var x=null;y!==null;)y.alternate!==null&&(x=y),y=y.sibling;x===null?h||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function Jr(l){var h=l.alternate!==null&&l.alternate.child===l.child,y=0,x=0;if(h)for(var O=l.child;O!==null;)y|=O.lanes|O.childLanes,x|=O.subtreeFlags&14680064,x|=O.flags&14680064,O.return=l,O=O.sibling;else for(O=l.child;O!==null;)y|=O.lanes|O.childLanes,x|=O.subtreeFlags,x|=O.flags,O.return=l,O=O.sibling;return l.subtreeFlags|=x,l.childLanes=y,h}function S9(l,h,y){var x=h.pendingProps;switch(hA(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jr(h),null;case 1:return Di(h.type)&&B2(),Jr(h),null;case 3:return x=h.stateNode,Wf(),fn(Ii),fn(Gr),CA(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(l===null||l.child===null)&&(H2(h)?h.flags|=4:l===null||l.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,uo!==null&&(eE(uo),uo=null))),HA(l,h),Jr(h),null;case 5:AA(h);var O=Ah(Fg.current);if(y=h.type,l!==null&&h.stateNode!=null)tR(l,h,y,x,O),l.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!x){if(h.stateNode===null)throw Error(t(166));return Jr(h),null}if(l=Ah(Ho.current),H2(h)){x=h.stateNode,y=h.type;var j=h.memoizedProps;switch(x[Vo]=h,x[Rg]=j,l=(h.mode&1)!==0,y){case"dialog":dn("cancel",x),dn("close",x);break;case"iframe":case"object":case"embed":dn("load",x);break;case"video":case"audio":for(O=0;O<Ig.length;O++)dn(Ig[O],x);break;case"source":dn("error",x);break;case"img":case"image":case"link":dn("error",x),dn("load",x);break;case"details":dn("toggle",x);break;case"input":Be(x,j),dn("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!j.multiple},dn("invalid",x);break;case"textarea":rt(x,j),dn("invalid",x)}ag(y,j),O=null;for(var K in j)if(j.hasOwnProperty(K)){var oe=j[K];K==="children"?typeof oe=="string"?x.textContent!==oe&&(j.suppressHydrationWarning!==!0&&L2(x.textContent,oe,l),O=["children",oe]):typeof oe=="number"&&x.textContent!==""+oe&&(j.suppressHydrationWarning!==!0&&L2(x.textContent,oe,l),O=["children",""+oe]):r.hasOwnProperty(K)&&oe!=null&&K==="onScroll"&&dn("scroll",x)}switch(y){case"input":ye(x),fe(x,j,!0);break;case"textarea":ye(x),Ze(x);break;case"select":case"option":break;default:typeof j.onClick=="function"&&(x.onclick=F2)}x=O,h.updateQueue=x,x!==null&&(h.flags|=4)}else{K=O.nodeType===9?O:O.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=st(y)),l==="http://www.w3.org/1999/xhtml"?y==="script"?(l=K.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof x.is=="string"?l=K.createElement(y,{is:x.is}):(l=K.createElement(y),y==="select"&&(K=l,x.multiple?K.multiple=!0:x.size&&(K.size=x.size))):l=K.createElementNS(l,y),l[Vo]=h,l[Rg]=x,eR(l,h,!1,!1),h.stateNode=l;e:{switch(K=lg(y,x),y){case"dialog":dn("cancel",l),dn("close",l),O=x;break;case"iframe":case"object":case"embed":dn("load",l),O=x;break;case"video":case"audio":for(O=0;O<Ig.length;O++)dn(Ig[O],l);O=x;break;case"source":dn("error",l),O=x;break;case"img":case"image":case"link":dn("error",l),dn("load",l),O=x;break;case"details":dn("toggle",l),O=x;break;case"input":Be(l,x),O=Fe(l,x),dn("invalid",l);break;case"option":O=x;break;case"select":l._wrapperState={wasMultiple:!!x.multiple},O=J({},x,{value:void 0}),dn("invalid",l);break;case"textarea":rt(l,x),O=be(l,x),dn("invalid",l);break;default:O=x}ag(y,O),oe=O;for(j in oe)if(oe.hasOwnProperty(j)){var ce=oe[j];j==="style"?iu(l,ce):j==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ce!=null&&xi(l,ce)):j==="children"?typeof ce=="string"?(y!=="textarea"||ce!=="")&&Mt(l,ce):typeof ce=="number"&&Mt(l,""+ce):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(r.hasOwnProperty(j)?ce!=null&&j==="onScroll"&&dn("scroll",l):ce!=null&&I(l,j,ce,K))}switch(y){case"input":ye(l),fe(l,x,!1);break;case"textarea":ye(l),Ze(l);break;case"option":x.value!=null&&l.setAttribute("value",""+te(x.value));break;case"select":l.multiple=!!x.multiple,j=x.value,j!=null?Re(l,!!x.multiple,j,!1):x.defaultValue!=null&&Re(l,!!x.multiple,x.defaultValue,!0);break;default:typeof O.onClick=="function"&&(l.onclick=F2)}switch(y){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Jr(h),null;case 6:if(l&&h.stateNode!=null)nR(l,h,l.memoizedProps,x);else{if(typeof x!="string"&&h.stateNode===null)throw Error(t(166));if(y=Ah(Fg.current),Ah(Ho.current),H2(h)){if(x=h.stateNode,y=h.memoizedProps,x[Vo]=h,(j=x.nodeValue!==y)&&(l=Gi,l!==null))switch(l.tag){case 3:L2(x.nodeValue,y,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&L2(x.nodeValue,y,(l.mode&1)!==0)}j&&(h.flags|=4)}else x=(y.nodeType===9?y:y.ownerDocument).createTextNode(x),x[Vo]=h,h.stateNode=x}return Jr(h),null;case 13:if(fn(Sn),x=h.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(_n&&Ki!==null&&(h.mode&1)!==0&&(h.flags&128)===0)sk(),Vf(),h.flags|=98560,j=!1;else if(j=H2(h),x!==null&&x.dehydrated!==null){if(l===null){if(!j)throw Error(t(318));if(j=h.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(t(317));j[Vo]=h}else Vf(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Jr(h),j=!1}else uo!==null&&(eE(uo),uo=null),j=!0;if(!j)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=y,h):(x=x!==null,x!==(l!==null&&l.memoizedState!==null)&&x&&(h.child.flags|=8192,(h.mode&1)!==0&&(l===null||(Sn.current&1)!==0?rr===0&&(rr=3):rE())),h.updateQueue!==null&&(h.flags|=4),Jr(h),null);case 4:return Wf(),HA(l,h),l===null&&Dg(h.stateNode.containerInfo),Jr(h),null;case 10:return yA(h.type._context),Jr(h),null;case 17:return Di(h.type)&&B2(),Jr(h),null;case 19:if(fn(Sn),j=h.memoizedState,j===null)return Jr(h),null;if(x=(h.flags&128)!==0,K=j.rendering,K===null)if(x)Ug(j,!1);else{if(rr!==0||l!==null&&(l.flags&128)!==0)for(l=h.child;l!==null;){if(K=J2(l),K!==null){for(h.flags|=128,Ug(j,!1),x=K.updateQueue,x!==null&&(h.updateQueue=x,h.flags|=4),h.subtreeFlags=0,x=y,y=h.child;y!==null;)j=y,l=x,j.flags&=14680066,K=j.alternate,K===null?(j.childLanes=0,j.lanes=l,j.child=null,j.subtreeFlags=0,j.memoizedProps=null,j.memoizedState=null,j.updateQueue=null,j.dependencies=null,j.stateNode=null):(j.childLanes=K.childLanes,j.lanes=K.lanes,j.child=K.child,j.subtreeFlags=0,j.deletions=null,j.memoizedProps=K.memoizedProps,j.memoizedState=K.memoizedState,j.updateQueue=K.updateQueue,j.type=K.type,l=K.dependencies,j.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),y=y.sibling;return un(Sn,Sn.current&1|2),h.child}l=l.sibling}j.tail!==null&&ln()>Yf&&(h.flags|=128,x=!0,Ug(j,!1),h.lanes=4194304)}else{if(!x)if(l=J2(K),l!==null){if(h.flags|=128,x=!0,y=l.updateQueue,y!==null&&(h.updateQueue=y,h.flags|=4),Ug(j,!0),j.tail===null&&j.tailMode==="hidden"&&!K.alternate&&!_n)return Jr(h),null}else 2*ln()-j.renderingStartTime>Yf&&y!==1073741824&&(h.flags|=128,x=!0,Ug(j,!1),h.lanes=4194304);j.isBackwards?(K.sibling=h.child,h.child=K):(y=j.last,y!==null?y.sibling=K:h.child=K,j.last=K)}return j.tail!==null?(h=j.tail,j.rendering=h,j.tail=h.sibling,j.renderingStartTime=ln(),h.sibling=null,y=Sn.current,un(Sn,x?y&1|2:y&1),h):(Jr(h),null);case 22:case 23:return nE(),x=h.memoizedState!==null,l!==null&&l.memoizedState!==null!==x&&(h.flags|=8192),x&&(h.mode&1)!==0?(Ji&1073741824)!==0&&(Jr(h),h.subtreeFlags&6&&(h.flags|=8192)):Jr(h),null;case 24:return null;case 25:return null}throw Error(t(156,h.tag))}function T9(l,h){switch(hA(h),h.tag){case 1:return Di(h.type)&&B2(),l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 3:return Wf(),fn(Ii),fn(Gr),CA(),l=h.flags,(l&65536)!==0&&(l&128)===0?(h.flags=l&-65537|128,h):null;case 5:return AA(h),null;case 13:if(fn(Sn),l=h.memoizedState,l!==null&&l.dehydrated!==null){if(h.alternate===null)throw Error(t(340));Vf()}return l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 19:return fn(Sn),null;case 4:return Wf(),null;case 10:return yA(h.type._context),null;case 22:case 23:return nE(),null;case 24:return null;default:return null}}var iw=!1,Yr=!1,I9=typeof WeakSet=="function"?WeakSet:Set,Ge=null;function Kf(l,h){var y=l.ref;if(y!==null)if(typeof y=="function")try{y(null)}catch(x){Nn(l,h,x)}else y.current=null}function zA(l,h,y){try{y()}catch(x){Nn(l,h,x)}}var rR=!1;function D9(l,h){if(nA=du,l=LD(),Kb(l)){if("selectionStart"in l)var y={start:l.selectionStart,end:l.selectionEnd};else e:{y=(y=l.ownerDocument)&&y.defaultView||window;var x=y.getSelection&&y.getSelection();if(x&&x.rangeCount!==0){y=x.anchorNode;var O=x.anchorOffset,j=x.focusNode;x=x.focusOffset;try{y.nodeType,j.nodeType}catch{y=null;break e}var K=0,oe=-1,ce=-1,we=0,Te=0,De=l,Se=null;t:for(;;){for(var je;De!==y||O!==0&&De.nodeType!==3||(oe=K+O),De!==j||x!==0&&De.nodeType!==3||(ce=K+x),De.nodeType===3&&(K+=De.nodeValue.length),(je=De.firstChild)!==null;)Se=De,De=je;for(;;){if(De===l)break t;if(Se===y&&++we===O&&(oe=K),Se===j&&++Te===x&&(ce=K),(je=De.nextSibling)!==null)break;De=Se,Se=De.parentNode}De=je}y=oe===-1||ce===-1?null:{start:oe,end:ce}}else y=null}y=y||{start:0,end:0}}else y=null;for(rA={focusedElem:l,selectionRange:y},du=!1,Ge=h;Ge!==null;)if(h=Ge,l=h.child,(h.subtreeFlags&1028)!==0&&l!==null)l.return=h,Ge=l;else for(;Ge!==null;){h=Ge;try{var Xe=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(Xe!==null){var et=Xe.memoizedProps,Bn=Xe.memoizedState,me=h.stateNode,he=me.getSnapshotBeforeUpdate(h.elementType===h.type?et:co(h.type,et),Bn);me.__reactInternalSnapshotBeforeUpdate=he}break;case 3:var ge=h.stateNode.containerInfo;ge.nodeType===1?ge.textContent="":ge.nodeType===9&&ge.documentElement&&ge.removeChild(ge.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Pe){Nn(h,h.return,Pe)}if(l=h.sibling,l!==null){l.return=h.return,Ge=l;break}Ge=h.return}return Xe=rR,rR=!1,Xe}function Vg(l,h,y){var x=h.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var O=x=x.next;do{if((O.tag&l)===l){var j=O.destroy;O.destroy=void 0,j!==void 0&&zA(h,y,j)}O=O.next}while(O!==x)}}function sw(l,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var y=h=h.next;do{if((y.tag&l)===l){var x=y.create;y.destroy=x()}y=y.next}while(y!==h)}}function $A(l){var h=l.ref;if(h!==null){var y=l.stateNode;switch(l.tag){case 5:l=y;break;default:l=y}typeof h=="function"?h(l):h.current=l}}function iR(l){var h=l.alternate;h!==null&&(l.alternate=null,iR(h)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(h=l.stateNode,h!==null&&(delete h[Vo],delete h[Rg],delete h[aA],delete h[h9],delete h[d9])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function sR(l){return l.tag===5||l.tag===3||l.tag===4}function oR(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||sR(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function WA(l,h,y){var x=l.tag;if(x===5||x===6)l=l.stateNode,h?y.nodeType===8?y.parentNode.insertBefore(l,h):y.insertBefore(l,h):(y.nodeType===8?(h=y.parentNode,h.insertBefore(l,y)):(h=y,h.appendChild(l)),y=y._reactRootContainer,y!=null||h.onclick!==null||(h.onclick=F2));else if(x!==4&&(l=l.child,l!==null))for(WA(l,h,y),l=l.sibling;l!==null;)WA(l,h,y),l=l.sibling}function GA(l,h,y){var x=l.tag;if(x===5||x===6)l=l.stateNode,h?y.insertBefore(l,h):y.appendChild(l);else if(x!==4&&(l=l.child,l!==null))for(GA(l,h,y),l=l.sibling;l!==null;)GA(l,h,y),l=l.sibling}var kr=null,ho=!1;function bu(l,h,y){for(y=y.child;y!==null;)aR(l,h,y),y=y.sibling}function aR(l,h,y){if(Hi&&typeof Hi.onCommitFiberUnmount=="function")try{Hi.onCommitFiberUnmount(ch,y)}catch{}switch(y.tag){case 5:Yr||Kf(y,h);case 6:var x=kr,O=ho;kr=null,bu(l,h,y),kr=x,ho=O,kr!==null&&(ho?(l=kr,y=y.stateNode,l.nodeType===8?l.parentNode.removeChild(y):l.removeChild(y)):kr.removeChild(y.stateNode));break;case 18:kr!==null&&(ho?(l=kr,y=y.stateNode,l.nodeType===8?oA(l.parentNode,y):l.nodeType===1&&oA(l,y),oo(l)):oA(kr,y.stateNode));break;case 4:x=kr,O=ho,kr=y.stateNode.containerInfo,ho=!0,bu(l,h,y),kr=x,ho=O;break;case 0:case 11:case 14:case 15:if(!Yr&&(x=y.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){O=x=x.next;do{var j=O,K=j.destroy;j=j.tag,K!==void 0&&((j&2)!==0||(j&4)!==0)&&zA(y,h,K),O=O.next}while(O!==x)}bu(l,h,y);break;case 1:if(!Yr&&(Kf(y,h),x=y.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=y.memoizedProps,x.state=y.memoizedState,x.componentWillUnmount()}catch(oe){Nn(y,h,oe)}bu(l,h,y);break;case 21:bu(l,h,y);break;case 22:y.mode&1?(Yr=(x=Yr)||y.memoizedState!==null,bu(l,h,y),Yr=x):bu(l,h,y);break;default:bu(l,h,y)}}function lR(l){var h=l.updateQueue;if(h!==null){l.updateQueue=null;var y=l.stateNode;y===null&&(y=l.stateNode=new I9),h.forEach(function(x){var O=B9.bind(null,l,x);y.has(x)||(y.add(x),x.then(O,O))})}}function fo(l,h){var y=h.deletions;if(y!==null)for(var x=0;x<y.length;x++){var O=y[x];try{var j=l,K=h,oe=K;e:for(;oe!==null;){switch(oe.tag){case 5:kr=oe.stateNode,ho=!1;break e;case 3:kr=oe.stateNode.containerInfo,ho=!0;break e;case 4:kr=oe.stateNode.containerInfo,ho=!0;break e}oe=oe.return}if(kr===null)throw Error(t(160));aR(j,K,O),kr=null,ho=!1;var ce=O.alternate;ce!==null&&(ce.return=null),O.return=null}catch(we){Nn(O,h,we)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)uR(h,l),h=h.sibling}function uR(l,h){var y=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(fo(h,l),$o(l),x&4){try{Vg(3,l,l.return),sw(3,l)}catch(et){Nn(l,l.return,et)}try{Vg(5,l,l.return)}catch(et){Nn(l,l.return,et)}}break;case 1:fo(h,l),$o(l),x&512&&y!==null&&Kf(y,y.return);break;case 5:if(fo(h,l),$o(l),x&512&&y!==null&&Kf(y,y.return),l.flags&32){var O=l.stateNode;try{Mt(O,"")}catch(et){Nn(l,l.return,et)}}if(x&4&&(O=l.stateNode,O!=null)){var j=l.memoizedProps,K=y!==null?y.memoizedProps:j,oe=l.type,ce=l.updateQueue;if(l.updateQueue=null,ce!==null)try{oe==="input"&&j.type==="radio"&&j.name!=null&&We(O,j),lg(oe,K);var we=lg(oe,j);for(K=0;K<ce.length;K+=2){var Te=ce[K],De=ce[K+1];Te==="style"?iu(O,De):Te==="dangerouslySetInnerHTML"?xi(O,De):Te==="children"?Mt(O,De):I(O,Te,De,we)}switch(oe){case"input":mt(O,j);break;case"textarea":qe(O,j);break;case"select":var Se=O._wrapperState.wasMultiple;O._wrapperState.wasMultiple=!!j.multiple;var je=j.value;je!=null?Re(O,!!j.multiple,je,!1):Se!==!!j.multiple&&(j.defaultValue!=null?Re(O,!!j.multiple,j.defaultValue,!0):Re(O,!!j.multiple,j.multiple?[]:"",!1))}O[Rg]=j}catch(et){Nn(l,l.return,et)}}break;case 6:if(fo(h,l),$o(l),x&4){if(l.stateNode===null)throw Error(t(162));O=l.stateNode,j=l.memoizedProps;try{O.nodeValue=j}catch(et){Nn(l,l.return,et)}}break;case 3:if(fo(h,l),$o(l),x&4&&y!==null&&y.memoizedState.isDehydrated)try{oo(h.containerInfo)}catch(et){Nn(l,l.return,et)}break;case 4:fo(h,l),$o(l);break;case 13:fo(h,l),$o(l),O=l.child,O.flags&8192&&(j=O.memoizedState!==null,O.stateNode.isHidden=j,!j||O.alternate!==null&&O.alternate.memoizedState!==null||(YA=ln())),x&4&&lR(l);break;case 22:if(Te=y!==null&&y.memoizedState!==null,l.mode&1?(Yr=(we=Yr)||Te,fo(h,l),Yr=we):fo(h,l),$o(l),x&8192){if(we=l.memoizedState!==null,(l.stateNode.isHidden=we)&&!Te&&(l.mode&1)!==0)for(Ge=l,Te=l.child;Te!==null;){for(De=Ge=Te;Ge!==null;){switch(Se=Ge,je=Se.child,Se.tag){case 0:case 11:case 14:case 15:Vg(4,Se,Se.return);break;case 1:Kf(Se,Se.return);var Xe=Se.stateNode;if(typeof Xe.componentWillUnmount=="function"){x=Se,y=Se.return;try{h=x,Xe.props=h.memoizedProps,Xe.state=h.memoizedState,Xe.componentWillUnmount()}catch(et){Nn(x,y,et)}}break;case 5:Kf(Se,Se.return);break;case 22:if(Se.memoizedState!==null){dR(De);continue}}je!==null?(je.return=Se,Ge=je):dR(De)}Te=Te.sibling}e:for(Te=null,De=l;;){if(De.tag===5){if(Te===null){Te=De;try{O=De.stateNode,we?(j=O.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none"):(oe=De.stateNode,ce=De.memoizedProps.style,K=ce!=null&&ce.hasOwnProperty("display")?ce.display:null,oe.style.display=Qs("display",K))}catch(et){Nn(l,l.return,et)}}}else if(De.tag===6){if(Te===null)try{De.stateNode.nodeValue=we?"":De.memoizedProps}catch(et){Nn(l,l.return,et)}}else if((De.tag!==22&&De.tag!==23||De.memoizedState===null||De===l)&&De.child!==null){De.child.return=De,De=De.child;continue}if(De===l)break e;for(;De.sibling===null;){if(De.return===null||De.return===l)break e;Te===De&&(Te=null),De=De.return}Te===De&&(Te=null),De.sibling.return=De.return,De=De.sibling}}break;case 19:fo(h,l),$o(l),x&4&&lR(l);break;case 21:break;default:fo(h,l),$o(l)}}function $o(l){var h=l.flags;if(h&2){try{e:{for(var y=l.return;y!==null;){if(sR(y)){var x=y;break e}y=y.return}throw Error(t(160))}switch(x.tag){case 5:var O=x.stateNode;x.flags&32&&(Mt(O,""),x.flags&=-33);var j=oR(l);GA(l,j,O);break;case 3:case 4:var K=x.stateNode.containerInfo,oe=oR(l);WA(l,oe,K);break;default:throw Error(t(161))}}catch(ce){Nn(l,l.return,ce)}l.flags&=-3}h&4096&&(l.flags&=-4097)}function k9(l,h,y){Ge=l,cR(l)}function cR(l,h,y){for(var x=(l.mode&1)!==0;Ge!==null;){var O=Ge,j=O.child;if(O.tag===22&&x){var K=O.memoizedState!==null||iw;if(!K){var oe=O.alternate,ce=oe!==null&&oe.memoizedState!==null||Yr;oe=iw;var we=Yr;if(iw=K,(Yr=ce)&&!we)for(Ge=O;Ge!==null;)K=Ge,ce=K.child,K.tag===22&&K.memoizedState!==null?fR(O):ce!==null?(ce.return=K,Ge=ce):fR(O);for(;j!==null;)Ge=j,cR(j),j=j.sibling;Ge=O,iw=oe,Yr=we}hR(l)}else(O.subtreeFlags&8772)!==0&&j!==null?(j.return=O,Ge=j):hR(l)}}function hR(l){for(;Ge!==null;){var h=Ge;if((h.flags&8772)!==0){var y=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:Yr||sw(5,h);break;case 1:var x=h.stateNode;if(h.flags&4&&!Yr)if(y===null)x.componentDidMount();else{var O=h.elementType===h.type?y.memoizedProps:co(h.type,y.memoizedProps);x.componentDidUpdate(O,y.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var j=h.updateQueue;j!==null&&dk(h,j,x);break;case 3:var K=h.updateQueue;if(K!==null){if(y=null,h.child!==null)switch(h.child.tag){case 5:y=h.child.stateNode;break;case 1:y=h.child.stateNode}dk(h,K,y)}break;case 5:var oe=h.stateNode;if(y===null&&h.flags&4){y=oe;var ce=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":ce.autoFocus&&y.focus();break;case"img":ce.src&&(y.src=ce.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var we=h.alternate;if(we!==null){var Te=we.memoizedState;if(Te!==null){var De=Te.dehydrated;De!==null&&oo(De)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Yr||h.flags&512&&$A(h)}catch(Se){Nn(h,h.return,Se)}}if(h===l){Ge=null;break}if(y=h.sibling,y!==null){y.return=h.return,Ge=y;break}Ge=h.return}}function dR(l){for(;Ge!==null;){var h=Ge;if(h===l){Ge=null;break}var y=h.sibling;if(y!==null){y.return=h.return,Ge=y;break}Ge=h.return}}function fR(l){for(;Ge!==null;){var h=Ge;try{switch(h.tag){case 0:case 11:case 15:var y=h.return;try{sw(4,h)}catch(ce){Nn(h,y,ce)}break;case 1:var x=h.stateNode;if(typeof x.componentDidMount=="function"){var O=h.return;try{x.componentDidMount()}catch(ce){Nn(h,O,ce)}}var j=h.return;try{$A(h)}catch(ce){Nn(h,j,ce)}break;case 5:var K=h.return;try{$A(h)}catch(ce){Nn(h,K,ce)}}}catch(ce){Nn(h,h.return,ce)}if(h===l){Ge=null;break}var oe=h.sibling;if(oe!==null){oe.return=h.return,Ge=oe;break}Ge=h.return}}var R9=Math.ceil,ow=S.ReactCurrentDispatcher,KA=S.ReactCurrentOwner,Ps=S.ReactCurrentBatchConfig,Ut=0,yr=null,$n=null,Rr=0,Ji=0,Jf=gu(0),rr=0,Hg=null,Ch=0,aw=0,JA=0,zg=null,Ri=null,YA=0,Yf=1/0,Ka=null,lw=!1,XA=null,Au=null,uw=!1,Eu=null,cw=0,$g=0,QA=null,hw=-1,dw=0;function ui(){return(Ut&6)!==0?ln():hw!==-1?hw:hw=ln()}function Cu(l){return(l.mode&1)===0?1:(Ut&2)!==0&&Rr!==0?Rr&-Rr:p9.transition!==null?(dw===0&&(dw=dh()),dw):(l=Lt,l!==0||(l=window.event,l=l===void 0?16:wg(l.type)),l)}function po(l,h,y,x){if(50<$g)throw $g=0,QA=null,Error(t(185));lu(l,y,x),((Ut&2)===0||l!==yr)&&(l===yr&&((Ut&2)===0&&(aw|=y),rr===4&&xu(l,Rr)),Pi(l,x),y===1&&Ut===0&&(h.mode&1)===0&&(Yf=ln()+500,q2&&vu()))}function Pi(l,h){var y=l.callbackNode;Fa(l,h);var x=hh(l,l===yr?Rr:0);if(x===0)y!==null&&pg(y),l.callbackNode=null,l.callbackPriority=0;else if(h=x&-x,l.callbackPriority!==h){if(y!=null&&pg(y),h===1)l.tag===0?f9(mR.bind(null,l)):ek(mR.bind(null,l)),u9(function(){(Ut&6)===0&&vu()}),y=null;else{switch(cu(x)){case 1:y=uh;break;case 4:y=su;break;case 16:y=xs;break;case 536870912:y=d2;break;default:y=xs}y=ER(y,pR.bind(null,l))}l.callbackPriority=h,l.callbackNode=y}}function pR(l,h){if(hw=-1,dw=0,(Ut&6)!==0)throw Error(t(327));var y=l.callbackNode;if(Xf()&&l.callbackNode!==y)return null;var x=hh(l,l===yr?Rr:0);if(x===0)return null;if((x&30)!==0||(x&l.expiredLanes)!==0||h)h=fw(l,x);else{h=x;var O=Ut;Ut|=2;var j=yR();(yr!==l||Rr!==h)&&(Ka=null,Yf=ln()+500,Sh(l,h));do try{O9();break}catch(oe){gR(l,oe)}while(!0);gA(),ow.current=j,Ut=O,$n!==null?h=0:(yr=null,Rr=0,h=rr)}if(h!==0){if(h===2&&(O=zi(l),O!==0&&(x=O,h=ZA(l,O))),h===1)throw y=Hg,Sh(l,0),xu(l,x),Pi(l,ln()),y;if(h===6)xu(l,x);else{if(O=l.current.alternate,(x&30)===0&&!P9(O)&&(h=fw(l,x),h===2&&(j=zi(l),j!==0&&(x=j,h=ZA(l,j))),h===1))throw y=Hg,Sh(l,0),xu(l,x),Pi(l,ln()),y;switch(l.finishedWork=O,l.finishedLanes=x,h){case 0:case 1:throw Error(t(345));case 2:Th(l,Ri,Ka);break;case 3:if(xu(l,x),(x&130023424)===x&&(h=YA+500-ln(),10<h)){if(hh(l,0)!==0)break;if(O=l.suspendedLanes,(O&x)!==x){ui(),l.pingedLanes|=l.suspendedLanes&O;break}l.timeoutHandle=sA(Th.bind(null,l,Ri,Ka),h);break}Th(l,Ri,Ka);break;case 4:if(xu(l,x),(x&4194240)===x)break;for(h=l.eventTimes,O=-1;0<x;){var K=31-oi(x);j=1<<K,K=h[K],K>O&&(O=K),x&=~j}if(x=O,x=ln()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*R9(x/1960))-x,10<x){l.timeoutHandle=sA(Th.bind(null,l,Ri,Ka),x);break}Th(l,Ri,Ka);break;case 5:Th(l,Ri,Ka);break;default:throw Error(t(329))}}}return Pi(l,ln()),l.callbackNode===y?pR.bind(null,l):null}function ZA(l,h){var y=zg;return l.current.memoizedState.isDehydrated&&(Sh(l,h).flags|=256),l=fw(l,h),l!==2&&(h=Ri,Ri=y,h!==null&&eE(h)),l}function eE(l){Ri===null?Ri=l:Ri.push.apply(Ri,l)}function P9(l){for(var h=l;;){if(h.flags&16384){var y=h.updateQueue;if(y!==null&&(y=y.stores,y!==null))for(var x=0;x<y.length;x++){var O=y[x],j=O.getSnapshot;O=O.value;try{if(!lo(j(),O))return!1}catch{return!1}}}if(y=h.child,h.subtreeFlags&16384&&y!==null)y.return=h,h=y;else{if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function xu(l,h){for(h&=~JA,h&=~aw,l.suspendedLanes|=h,l.pingedLanes&=~h,l=l.expirationTimes;0<h;){var y=31-oi(h),x=1<<y;l[y]=-1,h&=~x}}function mR(l){if((Ut&6)!==0)throw Error(t(327));Xf();var h=hh(l,0);if((h&1)===0)return Pi(l,ln()),null;var y=fw(l,h);if(l.tag!==0&&y===2){var x=zi(l);x!==0&&(h=x,y=ZA(l,x))}if(y===1)throw y=Hg,Sh(l,0),xu(l,h),Pi(l,ln()),y;if(y===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=h,Th(l,Ri,Ka),Pi(l,ln()),null}function tE(l,h){var y=Ut;Ut|=1;try{return l(h)}finally{Ut=y,Ut===0&&(Yf=ln()+500,q2&&vu())}}function xh(l){Eu!==null&&Eu.tag===0&&(Ut&6)===0&&Xf();var h=Ut;Ut|=1;var y=Ps.transition,x=Lt;try{if(Ps.transition=null,Lt=1,l)return l()}finally{Lt=x,Ps.transition=y,Ut=h,(Ut&6)===0&&vu()}}function nE(){Ji=Jf.current,fn(Jf)}function Sh(l,h){l.finishedWork=null,l.finishedLanes=0;var y=l.timeoutHandle;if(y!==-1&&(l.timeoutHandle=-1,l9(y)),$n!==null)for(y=$n.return;y!==null;){var x=y;switch(hA(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&B2();break;case 3:Wf(),fn(Ii),fn(Gr),CA();break;case 5:AA(x);break;case 4:Wf();break;case 13:fn(Sn);break;case 19:fn(Sn);break;case 10:yA(x.type._context);break;case 22:case 23:nE()}y=y.return}if(yr=l,$n=l=Su(l.current,null),Rr=Ji=h,rr=0,Hg=null,JA=aw=Ch=0,Ri=zg=null,bh!==null){for(h=0;h<bh.length;h++)if(y=bh[h],x=y.interleaved,x!==null){y.interleaved=null;var O=x.next,j=y.pending;if(j!==null){var K=j.next;j.next=O,x.next=K}y.pending=x}bh=null}return l}function gR(l,h){do{var y=$n;try{if(gA(),Y2.current=ew,X2){for(var x=Tn.memoizedState;x!==null;){var O=x.queue;O!==null&&(O.pending=null),x=x.next}X2=!1}if(Eh=0,gr=nr=Tn=null,Mg=!1,Bg=0,KA.current=null,y===null||y.return===null){rr=1,Hg=h,$n=null;break}e:{var j=l,K=y.return,oe=y,ce=h;if(h=Rr,oe.flags|=32768,ce!==null&&typeof ce=="object"&&typeof ce.then=="function"){var we=ce,Te=oe,De=Te.tag;if((Te.mode&1)===0&&(De===0||De===11||De===15)){var Se=Te.alternate;Se?(Te.updateQueue=Se.updateQueue,Te.memoizedState=Se.memoizedState,Te.lanes=Se.lanes):(Te.updateQueue=null,Te.memoizedState=null)}var je=Uk(K);if(je!==null){je.flags&=-257,Vk(je,K,oe,j,h),je.mode&1&&qk(j,we,h),h=je,ce=we;var Xe=h.updateQueue;if(Xe===null){var et=new Set;et.add(ce),h.updateQueue=et}else Xe.add(ce);break e}else{if((h&1)===0){qk(j,we,h),rE();break e}ce=Error(t(426))}}else if(_n&&oe.mode&1){var Bn=Uk(K);if(Bn!==null){(Bn.flags&65536)===0&&(Bn.flags|=256),Vk(Bn,K,oe,j,h),pA(Gf(ce,oe));break e}}j=ce=Gf(ce,oe),rr!==4&&(rr=2),zg===null?zg=[j]:zg.push(j),j=K;do{switch(j.tag){case 3:j.flags|=65536,h&=-h,j.lanes|=h;var me=Bk(j,ce,h);hk(j,me);break e;case 1:oe=ce;var he=j.type,ge=j.stateNode;if((j.flags&128)===0&&(typeof he.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(Au===null||!Au.has(ge)))){j.flags|=65536,h&=-h,j.lanes|=h;var Pe=jk(j,oe,h);hk(j,Pe);break e}}j=j.return}while(j!==null)}wR(y)}catch(tt){h=tt,$n===y&&y!==null&&($n=y=y.return);continue}break}while(!0)}function yR(){var l=ow.current;return ow.current=ew,l===null?ew:l}function rE(){(rr===0||rr===3||rr===2)&&(rr=4),yr===null||(Ch&268435455)===0&&(aw&268435455)===0||xu(yr,Rr)}function fw(l,h){var y=Ut;Ut|=2;var x=yR();(yr!==l||Rr!==h)&&(Ka=null,Sh(l,h));do try{N9();break}catch(O){gR(l,O)}while(!0);if(gA(),Ut=y,ow.current=x,$n!==null)throw Error(t(261));return yr=null,Rr=0,rr}function N9(){for(;$n!==null;)vR($n)}function O9(){for(;$n!==null&&!c2();)vR($n)}function vR(l){var h=AR(l.alternate,l,Ji);l.memoizedProps=l.pendingProps,h===null?wR(l):$n=h,KA.current=null}function wR(l){var h=l;do{var y=h.alternate;if(l=h.return,(h.flags&32768)===0){if(y=S9(y,h,Ji),y!==null){$n=y;return}}else{if(y=T9(y,h),y!==null){y.flags&=32767,$n=y;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{rr=6,$n=null;return}}if(h=h.sibling,h!==null){$n=h;return}$n=h=l}while(h!==null);rr===0&&(rr=5)}function Th(l,h,y){var x=Lt,O=Ps.transition;try{Ps.transition=null,Lt=1,L9(l,h,y,x)}finally{Ps.transition=O,Lt=x}return null}function L9(l,h,y,x){do Xf();while(Eu!==null);if((Ut&6)!==0)throw Error(t(327));y=l.finishedWork;var O=l.finishedLanes;if(y===null)return null;if(l.finishedWork=null,l.finishedLanes=0,y===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var j=y.lanes|y.childLanes;if(sn(l,j),l===yr&&($n=yr=null,Rr=0),(y.subtreeFlags&2064)===0&&(y.flags&2064)===0||uw||(uw=!0,ER(xs,function(){return Xf(),null})),j=(y.flags&15990)!==0,(y.subtreeFlags&15990)!==0||j){j=Ps.transition,Ps.transition=null;var K=Lt;Lt=1;var oe=Ut;Ut|=4,KA.current=null,D9(l,y),uR(y,l),t9(rA),du=!!nA,rA=nA=null,l.current=y,k9(y),qb(),Ut=oe,Lt=K,Ps.transition=j}else l.current=y;if(uw&&(uw=!1,Eu=l,cw=O),j=l.pendingLanes,j===0&&(Au=null),f2(y.stateNode),Pi(l,ln()),h!==null)for(x=l.onRecoverableError,y=0;y<h.length;y++)O=h[y],x(O.value,{componentStack:O.stack,digest:O.digest});if(lw)throw lw=!1,l=XA,XA=null,l;return(cw&1)!==0&&l.tag!==0&&Xf(),j=l.pendingLanes,(j&1)!==0?l===QA?$g++:($g=0,QA=l):$g=0,vu(),null}function Xf(){if(Eu!==null){var l=cu(cw),h=Ps.transition,y=Lt;try{if(Ps.transition=null,Lt=16>l?16:l,Eu===null)var x=!1;else{if(l=Eu,Eu=null,cw=0,(Ut&6)!==0)throw Error(t(331));var O=Ut;for(Ut|=4,Ge=l.current;Ge!==null;){var j=Ge,K=j.child;if((Ge.flags&16)!==0){var oe=j.deletions;if(oe!==null){for(var ce=0;ce<oe.length;ce++){var we=oe[ce];for(Ge=we;Ge!==null;){var Te=Ge;switch(Te.tag){case 0:case 11:case 15:Vg(8,Te,j)}var De=Te.child;if(De!==null)De.return=Te,Ge=De;else for(;Ge!==null;){Te=Ge;var Se=Te.sibling,je=Te.return;if(iR(Te),Te===we){Ge=null;break}if(Se!==null){Se.return=je,Ge=Se;break}Ge=je}}}var Xe=j.alternate;if(Xe!==null){var et=Xe.child;if(et!==null){Xe.child=null;do{var Bn=et.sibling;et.sibling=null,et=Bn}while(et!==null)}}Ge=j}}if((j.subtreeFlags&2064)!==0&&K!==null)K.return=j,Ge=K;else e:for(;Ge!==null;){if(j=Ge,(j.flags&2048)!==0)switch(j.tag){case 0:case 11:case 15:Vg(9,j,j.return)}var me=j.sibling;if(me!==null){me.return=j.return,Ge=me;break e}Ge=j.return}}var he=l.current;for(Ge=he;Ge!==null;){K=Ge;var ge=K.child;if((K.subtreeFlags&2064)!==0&&ge!==null)ge.return=K,Ge=ge;else e:for(K=he;Ge!==null;){if(oe=Ge,(oe.flags&2048)!==0)try{switch(oe.tag){case 0:case 11:case 15:sw(9,oe)}}catch(tt){Nn(oe,oe.return,tt)}if(oe===K){Ge=null;break e}var Pe=oe.sibling;if(Pe!==null){Pe.return=oe.return,Ge=Pe;break e}Ge=oe.return}}if(Ut=O,vu(),Hi&&typeof Hi.onPostCommitFiberRoot=="function")try{Hi.onPostCommitFiberRoot(ch,l)}catch{}x=!0}return x}finally{Lt=y,Ps.transition=h}}return!1}function _R(l,h,y){h=Gf(y,h),h=Bk(l,h,1),l=_u(l,h,1),h=ui(),l!==null&&(lu(l,1,h),Pi(l,h))}function Nn(l,h,y){if(l.tag===3)_R(l,l,y);else for(;h!==null;){if(h.tag===3){_R(h,l,y);break}else if(h.tag===1){var x=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Au===null||!Au.has(x))){l=Gf(y,l),l=jk(h,l,1),h=_u(h,l,1),l=ui(),h!==null&&(lu(h,1,l),Pi(h,l));break}}h=h.return}}function F9(l,h,y){var x=l.pingCache;x!==null&&x.delete(h),h=ui(),l.pingedLanes|=l.suspendedLanes&y,yr===l&&(Rr&y)===y&&(rr===4||rr===3&&(Rr&130023424)===Rr&&500>ln()-YA?Sh(l,0):JA|=y),Pi(l,h)}function bR(l,h){h===0&&((l.mode&1)===0?h=1:(h=_f,_f<<=1,(_f&130023424)===0&&(_f=4194304)));var y=ui();l=$a(l,h),l!==null&&(lu(l,h,y),Pi(l,y))}function M9(l){var h=l.memoizedState,y=0;h!==null&&(y=h.retryLane),bR(l,y)}function B9(l,h){var y=0;switch(l.tag){case 13:var x=l.stateNode,O=l.memoizedState;O!==null&&(y=O.retryLane);break;case 19:x=l.stateNode;break;default:throw Error(t(314))}x!==null&&x.delete(h),bR(l,y)}var AR;AR=function(l,h,y){if(l!==null)if(l.memoizedProps!==h.pendingProps||Ii.current)ki=!0;else{if((l.lanes&y)===0&&(h.flags&128)===0)return ki=!1,x9(l,h,y);ki=(l.flags&131072)!==0}else ki=!1,_n&&(h.flags&1048576)!==0&&tk(h,V2,h.index);switch(h.lanes=0,h.tag){case 2:var x=h.type;rw(l,h),l=h.pendingProps;var O=jf(h,Gr.current);$f(h,y),O=TA(null,h,x,l,O,y);var j=IA();return h.flags|=1,typeof O=="object"&&O!==null&&typeof O.render=="function"&&O.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,Di(x)?(j=!0,j2(h)):j=!1,h.memoizedState=O.state!==null&&O.state!==void 0?O.state:null,_A(h),O.updater=tw,h.stateNode=O,O._reactInternals=h,OA(h,x,l,y),h=BA(null,h,x,!0,j,y)):(h.tag=0,_n&&j&&cA(h),li(null,h,O,y),h=h.child),h;case 16:x=h.elementType;e:{switch(rw(l,h),l=h.pendingProps,O=x._init,x=O(x._payload),h.type=x,O=h.tag=q9(x),l=co(x,l),O){case 0:h=MA(null,h,x,l,y);break e;case 1:h=Kk(null,h,x,l,y);break e;case 11:h=Hk(null,h,x,l,y);break e;case 14:h=zk(null,h,x,co(x.type,l),y);break e}throw Error(t(306,x,""))}return h;case 0:return x=h.type,O=h.pendingProps,O=h.elementType===x?O:co(x,O),MA(l,h,x,O,y);case 1:return x=h.type,O=h.pendingProps,O=h.elementType===x?O:co(x,O),Kk(l,h,x,O,y);case 3:e:{if(Jk(h),l===null)throw Error(t(387));x=h.pendingProps,j=h.memoizedState,O=j.element,ck(l,h),K2(h,x,null,y);var K=h.memoizedState;if(x=K.element,j.isDehydrated)if(j={element:x,isDehydrated:!1,cache:K.cache,pendingSuspenseBoundaries:K.pendingSuspenseBoundaries,transitions:K.transitions},h.updateQueue.baseState=j,h.memoizedState=j,h.flags&256){O=Gf(Error(t(423)),h),h=Yk(l,h,x,y,O);break e}else if(x!==O){O=Gf(Error(t(424)),h),h=Yk(l,h,x,y,O);break e}else for(Ki=mu(h.stateNode.containerInfo.firstChild),Gi=h,_n=!0,uo=null,y=lk(h,null,x,y),h.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling;else{if(Vf(),x===O){h=Ga(l,h,y);break e}li(l,h,x,y)}h=h.child}return h;case 5:return fk(h),l===null&&fA(h),x=h.type,O=h.pendingProps,j=l!==null?l.memoizedProps:null,K=O.children,iA(x,O)?K=null:j!==null&&iA(x,j)&&(h.flags|=32),Gk(l,h),li(l,h,K,y),h.child;case 6:return l===null&&fA(h),null;case 13:return Xk(l,h,y);case 4:return bA(h,h.stateNode.containerInfo),x=h.pendingProps,l===null?h.child=Hf(h,null,x,y):li(l,h,x,y),h.child;case 11:return x=h.type,O=h.pendingProps,O=h.elementType===x?O:co(x,O),Hk(l,h,x,O,y);case 7:return li(l,h,h.pendingProps,y),h.child;case 8:return li(l,h,h.pendingProps.children,y),h.child;case 12:return li(l,h,h.pendingProps.children,y),h.child;case 10:e:{if(x=h.type._context,O=h.pendingProps,j=h.memoizedProps,K=O.value,un($2,x._currentValue),x._currentValue=K,j!==null)if(lo(j.value,K)){if(j.children===O.children&&!Ii.current){h=Ga(l,h,y);break e}}else for(j=h.child,j!==null&&(j.return=h);j!==null;){var oe=j.dependencies;if(oe!==null){K=j.child;for(var ce=oe.firstContext;ce!==null;){if(ce.context===x){if(j.tag===1){ce=Wa(-1,y&-y),ce.tag=2;var we=j.updateQueue;if(we!==null){we=we.shared;var Te=we.pending;Te===null?ce.next=ce:(ce.next=Te.next,Te.next=ce),we.pending=ce}}j.lanes|=y,ce=j.alternate,ce!==null&&(ce.lanes|=y),vA(j.return,y,h),oe.lanes|=y;break}ce=ce.next}}else if(j.tag===10)K=j.type===h.type?null:j.child;else if(j.tag===18){if(K=j.return,K===null)throw Error(t(341));K.lanes|=y,oe=K.alternate,oe!==null&&(oe.lanes|=y),vA(K,y,h),K=j.sibling}else K=j.child;if(K!==null)K.return=j;else for(K=j;K!==null;){if(K===h){K=null;break}if(j=K.sibling,j!==null){j.return=K.return,K=j;break}K=K.return}j=K}li(l,h,O.children,y),h=h.child}return h;case 9:return O=h.type,x=h.pendingProps.children,$f(h,y),O=ks(O),x=x(O),h.flags|=1,li(l,h,x,y),h.child;case 14:return x=h.type,O=co(x,h.pendingProps),O=co(x.type,O),zk(l,h,x,O,y);case 15:return $k(l,h,h.type,h.pendingProps,y);case 17:return x=h.type,O=h.pendingProps,O=h.elementType===x?O:co(x,O),rw(l,h),h.tag=1,Di(x)?(l=!0,j2(h)):l=!1,$f(h,y),Fk(h,x,O),OA(h,x,O,y),BA(null,h,x,!0,l,y);case 19:return Zk(l,h,y);case 22:return Wk(l,h,y)}throw Error(t(156,h.tag))};function ER(l,h){return vf(l,h)}function j9(l,h,y,x){this.tag=l,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ns(l,h,y,x){return new j9(l,h,y,x)}function iE(l){return l=l.prototype,!(!l||!l.isReactComponent)}function q9(l){if(typeof l=="function")return iE(l)?1:0;if(l!=null){if(l=l.$$typeof,l===F)return 11;if(l===Q)return 14}return 2}function Su(l,h){var y=l.alternate;return y===null?(y=Ns(l.tag,h,l.key,l.mode),y.elementType=l.elementType,y.type=l.type,y.stateNode=l.stateNode,y.alternate=l,l.alternate=y):(y.pendingProps=h,y.type=l.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=l.flags&14680064,y.childLanes=l.childLanes,y.lanes=l.lanes,y.child=l.child,y.memoizedProps=l.memoizedProps,y.memoizedState=l.memoizedState,y.updateQueue=l.updateQueue,h=l.dependencies,y.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},y.sibling=l.sibling,y.index=l.index,y.ref=l.ref,y}function pw(l,h,y,x,O,j){var K=2;if(x=l,typeof l=="function")iE(l)&&(K=1);else if(typeof l=="string")K=5;else e:switch(l){case k:return Ih(y.children,O,j,h);case T:K=8,O|=8;break;case D:return l=Ns(12,y,h,O|2),l.elementType=D,l.lanes=j,l;case M:return l=Ns(13,y,h,O),l.elementType=M,l.lanes=j,l;case $:return l=Ns(19,y,h,O),l.elementType=$,l.lanes=j,l;case ee:return mw(y,O,j,h);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case P:K=10;break e;case N:K=9;break e;case F:K=11;break e;case Q:K=14;break e;case ie:K=16,x=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return h=Ns(K,y,h,O),h.elementType=l,h.type=x,h.lanes=j,h}function Ih(l,h,y,x){return l=Ns(7,l,x,h),l.lanes=y,l}function mw(l,h,y,x){return l=Ns(22,l,x,h),l.elementType=ee,l.lanes=y,l.stateNode={isHidden:!1},l}function sE(l,h,y){return l=Ns(6,l,null,h),l.lanes=y,l}function oE(l,h,y){return h=Ns(4,l.children!==null?l.children:[],l.key,h),h.lanes=y,h.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},h}function U9(l,h,y,x,O){this.tag=h,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=au(0),this.expirationTimes=au(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=au(0),this.identifierPrefix=x,this.onRecoverableError=O,this.mutableSourceEagerHydrationData=null}function aE(l,h,y,x,O,j,K,oe,ce){return l=new U9(l,h,y,oe,ce),h===1?(h=1,j===!0&&(h|=8)):h=0,j=Ns(3,null,null,h),l.current=j,j.stateNode=l,j.memoizedState={element:x,isDehydrated:y,cache:null,transitions:null,pendingSuspenseBoundaries:null},_A(j),l}function V9(l,h,y){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:x==null?null:""+x,children:l,containerInfo:h,implementation:y}}function CR(l){if(!l)return yu;l=l._reactInternals;e:{if(to(l)!==l||l.tag!==1)throw Error(t(170));var h=l;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(Di(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(t(171))}if(l.tag===1){var y=l.type;if(Di(y))return QD(l,y,h)}return h}function xR(l,h,y,x,O,j,K,oe,ce){return l=aE(y,x,!0,l,O,j,K,oe,ce),l.context=CR(null),y=l.current,x=ui(),O=Cu(y),j=Wa(x,O),j.callback=h??null,_u(y,j,O),l.current.lanes=O,lu(l,O,x),Pi(l,x),l}function gw(l,h,y,x){var O=h.current,j=ui(),K=Cu(O);return y=CR(y),h.context===null?h.context=y:h.pendingContext=y,h=Wa(j,K),h.payload={element:l},x=x===void 0?null:x,x!==null&&(h.callback=x),l=_u(O,h,K),l!==null&&(po(l,O,K,j),G2(l,O,K)),K}function yw(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function SR(l,h){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var y=l.retryLane;l.retryLane=y!==0&&y<h?y:h}}function lE(l,h){SR(l,h),(l=l.alternate)&&SR(l,h)}function H9(){return null}var TR=typeof reportError=="function"?reportError:function(l){console.error(l)};function uE(l){this._internalRoot=l}vw.prototype.render=uE.prototype.render=function(l){var h=this._internalRoot;if(h===null)throw Error(t(409));gw(l,h,null,null)},vw.prototype.unmount=uE.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var h=l.containerInfo;xh(function(){gw(null,l,null,null)}),h[Ua]=null}};function vw(l){this._internalRoot=l}vw.prototype.unstable_scheduleHydration=function(l){if(l){var h=v2();l={blockedOn:null,target:l,priority:h};for(var y=0;y<Bo.length&&h!==0&&h<Bo[y].priority;y++);Bo.splice(y,0,l),y===0&&b2(l)}};function cE(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function ww(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function IR(){}function z9(l,h,y,x,O){if(O){if(typeof x=="function"){var j=x;x=function(){var we=yw(K);j.call(we)}}var K=xR(h,x,l,0,null,!1,!1,"",IR);return l._reactRootContainer=K,l[Ua]=K.current,Dg(l.nodeType===8?l.parentNode:l),xh(),K}for(;O=l.lastChild;)l.removeChild(O);if(typeof x=="function"){var oe=x;x=function(){var we=yw(ce);oe.call(we)}}var ce=aE(l,0,!1,null,null,!1,!1,"",IR);return l._reactRootContainer=ce,l[Ua]=ce.current,Dg(l.nodeType===8?l.parentNode:l),xh(function(){gw(h,ce,y,x)}),ce}function _w(l,h,y,x,O){var j=y._reactRootContainer;if(j){var K=j;if(typeof O=="function"){var oe=O;O=function(){var ce=yw(K);oe.call(ce)}}gw(h,K,l,O)}else K=z9(y,h,l,O,x);return yw(K)}g2=function(l){switch(l.tag){case 3:var h=l.stateNode;if(h.current.memoizedState.isDehydrated){var y=ou(h.pendingLanes);y!==0&&(uu(h,y|1),Pi(h,ln()),(Ut&6)===0&&(Yf=ln()+500,vu()))}break;case 13:xh(function(){var x=$a(l,1);if(x!==null){var O=ui();po(x,l,1,O)}}),lE(l,1)}},bf=function(l){if(l.tag===13){var h=$a(l,134217728);if(h!==null){var y=ui();po(h,l,134217728,y)}lE(l,134217728)}},y2=function(l){if(l.tag===13){var h=Cu(l),y=$a(l,h);if(y!==null){var x=ui();po(y,l,h,x)}lE(l,h)}},v2=function(){return Lt},w2=function(l,h){var y=Lt;try{return Lt=l,h()}finally{Lt=y}},df=function(l,h,y){switch(h){case"input":if(mt(l,y),h=y.name,y.type==="radio"&&h!=null){for(y=l;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<y.length;h++){var x=y[h];if(x!==l&&x.form===l.form){var O=M2(x);if(!O)throw Error(t(90));xe(x),mt(x,O)}}}break;case"textarea":qe(l,y);break;case"select":h=y.value,h!=null&&Re(l,!!y.multiple,h,!1)}},sh=tE,cg=xh;var $9={usingClientEntryPoint:!1,Events:[Pg,Mf,M2,Fo,ug,tE]},Wg={findFiberByHostInstance:yh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},W9={bundleType:Wg.bundleType,version:Wg.version,rendererPackageName:Wg.rendererPackageName,rendererConfig:Wg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:S.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=fg(l),l===null?null:l.stateNode},findFiberByHostInstance:Wg.findFiberByHostInstance||H9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bw.isDisabled&&bw.supportsFiber)try{ch=bw.inject(W9),Hi=bw}catch{}}return Ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$9,Ni.createPortal=function(l,h){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cE(h))throw Error(t(200));return V9(l,h,null,y)},Ni.createRoot=function(l,h){if(!cE(l))throw Error(t(299));var y=!1,x="",O=TR;return h!=null&&(h.unstable_strictMode===!0&&(y=!0),h.identifierPrefix!==void 0&&(x=h.identifierPrefix),h.onRecoverableError!==void 0&&(O=h.onRecoverableError)),h=aE(l,1,!1,null,null,y,!1,x,O),l[Ua]=h.current,Dg(l.nodeType===8?l.parentNode:l),new uE(h)},Ni.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var h=l._reactInternals;if(h===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=fg(h),l=l===null?null:l.stateNode,l},Ni.flushSync=function(l){return xh(l)},Ni.hydrate=function(l,h,y){if(!ww(h))throw Error(t(200));return _w(null,l,h,!0,y)},Ni.hydrateRoot=function(l,h,y){if(!cE(l))throw Error(t(405));var x=y!=null&&y.hydratedSources||null,O=!1,j="",K=TR;if(y!=null&&(y.unstable_strictMode===!0&&(O=!0),y.identifierPrefix!==void 0&&(j=y.identifierPrefix),y.onRecoverableError!==void 0&&(K=y.onRecoverableError)),h=xR(h,null,l,1,y??null,O,!1,j,K),l[Ua]=h.current,Dg(l),x)for(l=0;l<x.length;l++)y=x[l],O=y._getVersion,O=O(y._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[y,O]:h.mutableSourceEagerHydrationData.push(y,O);return new vw(h)},Ni.render=function(l,h,y){if(!ww(h))throw Error(t(200));return _w(null,l,h,!1,y)},Ni.unmountComponentAtNode=function(l){if(!ww(l))throw Error(t(40));return l._reactRootContainer?(xh(function(){_w(null,null,l,!1,function(){l._reactRootContainer=null,l[Ua]=null})}),!0):!1},Ni.unstable_batchedUpdates=tE,Ni.unstable_renderSubtreeIntoContainer=function(l,h,y,x){if(!ww(y))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return _w(l,h,y,!1,x)},Ni.version="18.3.1-next-f1338f8080-20240426",Ni}var MR;function ST(){if(MR)return pE.exports;MR=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),pE.exports=t6(),pE.exports}var BR;function n6(){if(BR)return Aw;BR=1;var i=ST();return Aw.createRoot=i.createRoot,Aw.hydrateRoot=i.hydrateRoot,Aw}var r6=n6();const i6=()=>{};var jR={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let r=i.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},s6=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const r=i[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const s=i[t++];e[n++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=i[t++],o=i[t++],a=i[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const s=i[t++],o=i[t++];e[n++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},_F={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<i.length;r+=3){const s=i[r],o=r+1<i.length,a=o?i[r+1]:0,u=r+2<i.length,c=u?i[r+2]:0,d=s>>2,m=(s&3)<<4|a>>4;let p=(a&15)<<2|c>>6,g=c&63;u||(g=64,o||(p=64)),n.push(t[d],t[m],t[p],t[g])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(wF(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):s6(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<i.length;){const s=t[i.charAt(r++)],a=r<i.length?t[i.charAt(r)]:0;++r;const c=r<i.length?t[i.charAt(r)]:64;++r;const m=r<i.length?t[i.charAt(r)]:64;if(++r,s==null||a==null||c==null||m==null)throw new o6;const p=s<<2|a>>4;if(n.push(p),c!==64){const g=a<<4&240|c>>2;if(n.push(g),m!==64){const w=c<<6&192|m;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class o6 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a6=function(i){const e=wF(i);return _F.encodeByteArray(e,!0)},M_=function(i){return a6(i).replace(/\./g,"")},bF=function(i){try{return _F.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u6=()=>l6().__FIREBASE_DEFAULTS__,c6=()=>{if(typeof process>"u"||typeof jR>"u")return;const i=jR.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},h6=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&bF(i[1]);return e&&JSON.parse(e)},U1=()=>{try{return i6()||u6()||c6()||h6()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},AF=i=>{var e,t;return(t=(e=U1())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[i]},EF=i=>{const e=AF(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},CF=()=>{var i;return(i=U1())===null||i===void 0?void 0:i.config},xF=i=>{var e;return(e=U1())===null||e===void 0?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yc(i){return i.endsWith(".cloudworkstations.dev")}async function TT(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SF(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",r=i.iat||0,s=i.sub||i.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},i);return[M_(JSON.stringify(t)),M_(JSON.stringify(o)),""].join(".")}const ky={};function f6(){const i={prod:[],emulator:[]};for(const e of Object.keys(ky))ky[e]?i.emulator.push(e):i.prod.push(e);return i}function p6(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let qR=!1;function IT(i,e){if(typeof window>"u"||typeof document>"u"||!Yc(window.location.host)||ky[i]===e||ky[i]||qR)return;ky[i]=e;function t(p){return`__firebase__banner__${p}`}const n="__firebase__banner",s=f6().prod.length>0;function o(){const p=document.getElementById(n);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function u(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function c(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{qR=!0,o()},p}function d(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function m(){const p=p6(n),g=t("text"),w=document.getElementById(g)||document.createElement("span"),b=t("learnmore"),A=document.getElementById(b)||document.createElement("a"),_=t("preprendIcon"),C=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const I=p.element;a(I),d(A,b);const S=c();u(C,_),I.append(C,w,A,S),document.body.appendChild(I)}s?(w.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function m6(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(si())}function g6(){var i;const e=(i=U1())===null||i===void 0?void 0:i.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function y6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function v6(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function w6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _6(){const i=si();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function b6(){return!g6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function A6(){try{return typeof indexedDB=="object"}catch{return!1}}function E6(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6="FirebaseError";class Ra extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=C6,Object.setPrototypeOf(this,Ra.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,B0.prototype.create)}}class B0{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?x6(s,n):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Ra(r,a,n)}}function x6(i,e){return i.replace(S6,(t,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const S6=/\{\$([^}]+)}/g;function T6(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function zd(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const r of t){if(!n.includes(r))return!1;const s=i[r],o=e[r];if(UR(s)&&UR(o)){if(!zd(s,o))return!1}else if(s!==o)return!1}for(const r of n)if(!t.includes(r))return!1;return!0}function UR(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function ty(i){const e={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[r,s]=n.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function ny(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}function I6(i,e){const t=new D6(i,e);return t.subscribe.bind(t)}class D6{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");k6(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:n},r.next===void 0&&(r.next=yE),r.error===void 0&&(r.error=yE),r.complete===void 0&&(r.complete=yE);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function k6(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function yE(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(i){return i&&i._delegate?i._delegate:i}class Fc{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new d6;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(N6(e))try{this.getOrInitializeService({instanceIdentifier:Dh})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});n.resolve(s)}catch{}}}}clearInstance(e=Dh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Dh){return this.instances.has(e)}getOptions(e=Dh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);n===a&&o.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(r))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:P6(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Dh){return this.component?this.component.multipleInstances?e:Dh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function P6(i){return i===Dh?void 0:i}function N6(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new R6(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pt;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Pt||(Pt={}));const L6={debug:Pt.DEBUG,verbose:Pt.VERBOSE,info:Pt.INFO,warn:Pt.WARN,error:Pt.ERROR,silent:Pt.SILENT},F6=Pt.INFO,M6={[Pt.DEBUG]:"log",[Pt.VERBOSE]:"log",[Pt.INFO]:"info",[Pt.WARN]:"warn",[Pt.ERROR]:"error"},B6=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),r=M6[e];if(r)console[r](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class DT{constructor(e){this.name=e,this._logLevel=F6,this._logHandler=B6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?L6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pt.DEBUG,...e),this._logHandler(this,Pt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pt.VERBOSE,...e),this._logHandler(this,Pt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pt.INFO,...e),this._logHandler(this,Pt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pt.WARN,...e),this._logHandler(this,Pt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pt.ERROR,...e),this._logHandler(this,Pt.ERROR,...e)}}const j6=(i,e)=>e.some(t=>i instanceof t);let VR,HR;function q6(){return VR||(VR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function U6(){return HR||(HR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const TF=new WeakMap,Sx=new WeakMap,IF=new WeakMap,vE=new WeakMap,kT=new WeakMap;function V6(i){const e=new Promise((t,n)=>{const r=()=>{i.removeEventListener("success",s),i.removeEventListener("error",o)},s=()=>{t(Pc(i.result)),r()},o=()=>{n(i.error),r()};i.addEventListener("success",s),i.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&TF.set(t,i)}).catch(()=>{}),kT.set(e,i),e}function H6(i){if(Sx.has(i))return;const e=new Promise((t,n)=>{const r=()=>{i.removeEventListener("complete",s),i.removeEventListener("error",o),i.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{n(i.error||new DOMException("AbortError","AbortError")),r()};i.addEventListener("complete",s),i.addEventListener("error",o),i.addEventListener("abort",o)});Sx.set(i,e)}let Tx={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return Sx.get(i);if(e==="objectStoreNames")return i.objectStoreNames||IF.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Pc(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function z6(i){Tx=i(Tx)}function $6(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(wE(this),e,...t);return IF.set(n,e.sort?e.sort():[e]),Pc(n)}:U6().includes(i)?function(...e){return i.apply(wE(this),e),Pc(TF.get(this))}:function(...e){return Pc(i.apply(wE(this),e))}}function W6(i){return typeof i=="function"?$6(i):(i instanceof IDBTransaction&&H6(i),j6(i,q6())?new Proxy(i,Tx):i)}function Pc(i){if(i instanceof IDBRequest)return V6(i);if(vE.has(i))return vE.get(i);const e=W6(i);return e!==i&&(vE.set(i,e),kT.set(e,i)),e}const wE=i=>kT.get(i);function G6(i,e,{blocked:t,upgrade:n,blocking:r,terminated:s}={}){const o=indexedDB.open(i,e),a=Pc(o);return n&&o.addEventListener("upgradeneeded",u=>{n(Pc(o.result),u.oldVersion,u.newVersion,Pc(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const K6=["get","getKey","getAll","getAllKeys","count"],J6=["put","add","delete","clear"],_E=new Map;function zR(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(_E.get(e))return _E.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,r=J6.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(r||K6.includes(t)))return;const s=async function(o,...a){const u=this.transaction(o,r?"readwrite":"readonly");let c=u.store;return n&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),r&&u.done]))[0]};return _E.set(e,s),s}z6(i=>({...i,get:(e,t,n)=>zR(e,t)||i.get(e,t,n),has:(e,t)=>!!zR(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(X6(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function X6(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ix="@firebase/app",$R="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gl=new DT("@firebase/app"),Q6="@firebase/app-compat",Z6="@firebase/analytics-compat",e8="@firebase/analytics",t8="@firebase/app-check-compat",n8="@firebase/app-check",r8="@firebase/auth",i8="@firebase/auth-compat",s8="@firebase/database",o8="@firebase/data-connect",a8="@firebase/database-compat",l8="@firebase/functions",u8="@firebase/functions-compat",c8="@firebase/installations",h8="@firebase/installations-compat",d8="@firebase/messaging",f8="@firebase/messaging-compat",p8="@firebase/performance",m8="@firebase/performance-compat",g8="@firebase/remote-config",y8="@firebase/remote-config-compat",v8="@firebase/storage",w8="@firebase/storage-compat",_8="@firebase/firestore",b8="@firebase/ai",A8="@firebase/firestore-compat",E8="firebase",C8="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dx="[DEFAULT]",x8={[Ix]:"fire-core",[Q6]:"fire-core-compat",[e8]:"fire-analytics",[Z6]:"fire-analytics-compat",[n8]:"fire-app-check",[t8]:"fire-app-check-compat",[r8]:"fire-auth",[i8]:"fire-auth-compat",[s8]:"fire-rtdb",[o8]:"fire-data-connect",[a8]:"fire-rtdb-compat",[l8]:"fire-fn",[u8]:"fire-fn-compat",[c8]:"fire-iid",[h8]:"fire-iid-compat",[d8]:"fire-fcm",[f8]:"fire-fcm-compat",[p8]:"fire-perf",[m8]:"fire-perf-compat",[g8]:"fire-rc",[y8]:"fire-rc-compat",[v8]:"fire-gcs",[w8]:"fire-gcs-compat",[_8]:"fire-fst",[A8]:"fire-fst-compat",[b8]:"fire-vertex","fire-js":"fire-js",[E8]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_=new Map,S8=new Map,kx=new Map;function WR(i,e){try{i.container.addComponent(e)}catch(t){Gl.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function $d(i){const e=i.name;if(kx.has(e))return Gl.debug(`There were multiple attempts to register component ${e}.`),!1;kx.set(e,i);for(const t of B_.values())WR(t,i);for(const t of S8.values())WR(t,i);return!0}function V1(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function ys(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Nc=new B0("app","Firebase",T8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I8{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Fc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Nc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tf=C8;function DF(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Dx,automaticDataCollectionEnabled:!0},e),r=n.name;if(typeof r!="string"||!r)throw Nc.create("bad-app-name",{appName:String(r)});if(t||(t=CF()),!t)throw Nc.create("no-options");const s=B_.get(r);if(s){if(zd(t,s.options)&&zd(n,s.config))return s;throw Nc.create("duplicate-app",{appName:r})}const o=new O6(r);for(const u of kx.values())o.addComponent(u);const a=new I8(t,n,o);return B_.set(r,a),a}function RT(i=Dx){const e=B_.get(i);if(!e&&i===Dx&&CF())return DF();if(!e)throw Nc.create("no-app",{appName:i});return e}function ba(i,e,t){var n;let r=(n=x8[i])!==null&&n!==void 0?n:i;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gl.warn(a.join(" "));return}$d(new Fc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D8="firebase-heartbeat-database",k8=1,qy="firebase-heartbeat-store";let bE=null;function kF(){return bE||(bE=G6(D8,k8,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(qy)}catch(t){console.warn(t)}}}}).catch(i=>{throw Nc.create("idb-open",{originalErrorMessage:i.message})})),bE}async function R8(i){try{const t=(await kF()).transaction(qy),n=await t.objectStore(qy).get(RF(i));return await t.done,n}catch(e){if(e instanceof Ra)Gl.warn(e.message);else{const t=Nc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Gl.warn(t.message)}}}async function GR(i,e){try{const n=(await kF()).transaction(qy,"readwrite");await n.objectStore(qy).put(e,RF(i)),await n.done}catch(t){if(t instanceof Ra)Gl.warn(t.message);else{const n=Nc.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Gl.warn(n.message)}}}function RF(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P8=1024,N8=30;class O8{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new F8(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=KR();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>N8){const o=M8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Gl.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=KR(),{heartbeatsToSend:n,unsentEntries:r}=L8(this._heartbeatsCache.heartbeats),s=M_(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Gl.warn(t),""}}}function KR(){return new Date().toISOString().substring(0,10)}function L8(i,e=P8){const t=[];let n=i.slice();for(const r of i){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),JR(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),JR(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class F8{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return A6()?E6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await R8(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return GR(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return GR(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function JR(i){return M_(JSON.stringify({version:2,heartbeats:i})).length}function M8(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B8(i){$d(new Fc("platform-logger",e=>new Y6(e),"PRIVATE")),$d(new Fc("heartbeat",e=>new O8(e),"PRIVATE")),ba(Ix,$R,i),ba(Ix,$R,"esm2017"),ba("fire-js","")}B8("");var j8="firebase",q8="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ba(j8,q8,"app");var YR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Oc,PF;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,T){function D(){}D.prototype=T.prototype,k.D=T.prototype,k.prototype=new D,k.prototype.constructor=k,k.C=function(P,N,F){for(var M=Array(arguments.length-2),$=2;$<arguments.length;$++)M[$-2]=arguments[$];return T.prototype[N].apply(P,M)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,T,D){D||(D=0);var P=Array(16);if(typeof T=="string")for(var N=0;16>N;++N)P[N]=T.charCodeAt(D++)|T.charCodeAt(D++)<<8|T.charCodeAt(D++)<<16|T.charCodeAt(D++)<<24;else for(N=0;16>N;++N)P[N]=T[D++]|T[D++]<<8|T[D++]<<16|T[D++]<<24;T=k.g[0],D=k.g[1],N=k.g[2];var F=k.g[3],M=T+(F^D&(N^F))+P[0]+3614090360&4294967295;T=D+(M<<7&4294967295|M>>>25),M=F+(N^T&(D^N))+P[1]+3905402710&4294967295,F=T+(M<<12&4294967295|M>>>20),M=N+(D^F&(T^D))+P[2]+606105819&4294967295,N=F+(M<<17&4294967295|M>>>15),M=D+(T^N&(F^T))+P[3]+3250441966&4294967295,D=N+(M<<22&4294967295|M>>>10),M=T+(F^D&(N^F))+P[4]+4118548399&4294967295,T=D+(M<<7&4294967295|M>>>25),M=F+(N^T&(D^N))+P[5]+1200080426&4294967295,F=T+(M<<12&4294967295|M>>>20),M=N+(D^F&(T^D))+P[6]+2821735955&4294967295,N=F+(M<<17&4294967295|M>>>15),M=D+(T^N&(F^T))+P[7]+4249261313&4294967295,D=N+(M<<22&4294967295|M>>>10),M=T+(F^D&(N^F))+P[8]+1770035416&4294967295,T=D+(M<<7&4294967295|M>>>25),M=F+(N^T&(D^N))+P[9]+2336552879&4294967295,F=T+(M<<12&4294967295|M>>>20),M=N+(D^F&(T^D))+P[10]+4294925233&4294967295,N=F+(M<<17&4294967295|M>>>15),M=D+(T^N&(F^T))+P[11]+2304563134&4294967295,D=N+(M<<22&4294967295|M>>>10),M=T+(F^D&(N^F))+P[12]+1804603682&4294967295,T=D+(M<<7&4294967295|M>>>25),M=F+(N^T&(D^N))+P[13]+4254626195&4294967295,F=T+(M<<12&4294967295|M>>>20),M=N+(D^F&(T^D))+P[14]+2792965006&4294967295,N=F+(M<<17&4294967295|M>>>15),M=D+(T^N&(F^T))+P[15]+1236535329&4294967295,D=N+(M<<22&4294967295|M>>>10),M=T+(N^F&(D^N))+P[1]+4129170786&4294967295,T=D+(M<<5&4294967295|M>>>27),M=F+(D^N&(T^D))+P[6]+3225465664&4294967295,F=T+(M<<9&4294967295|M>>>23),M=N+(T^D&(F^T))+P[11]+643717713&4294967295,N=F+(M<<14&4294967295|M>>>18),M=D+(F^T&(N^F))+P[0]+3921069994&4294967295,D=N+(M<<20&4294967295|M>>>12),M=T+(N^F&(D^N))+P[5]+3593408605&4294967295,T=D+(M<<5&4294967295|M>>>27),M=F+(D^N&(T^D))+P[10]+38016083&4294967295,F=T+(M<<9&4294967295|M>>>23),M=N+(T^D&(F^T))+P[15]+3634488961&4294967295,N=F+(M<<14&4294967295|M>>>18),M=D+(F^T&(N^F))+P[4]+3889429448&4294967295,D=N+(M<<20&4294967295|M>>>12),M=T+(N^F&(D^N))+P[9]+568446438&4294967295,T=D+(M<<5&4294967295|M>>>27),M=F+(D^N&(T^D))+P[14]+3275163606&4294967295,F=T+(M<<9&4294967295|M>>>23),M=N+(T^D&(F^T))+P[3]+4107603335&4294967295,N=F+(M<<14&4294967295|M>>>18),M=D+(F^T&(N^F))+P[8]+1163531501&4294967295,D=N+(M<<20&4294967295|M>>>12),M=T+(N^F&(D^N))+P[13]+2850285829&4294967295,T=D+(M<<5&4294967295|M>>>27),M=F+(D^N&(T^D))+P[2]+4243563512&4294967295,F=T+(M<<9&4294967295|M>>>23),M=N+(T^D&(F^T))+P[7]+1735328473&4294967295,N=F+(M<<14&4294967295|M>>>18),M=D+(F^T&(N^F))+P[12]+2368359562&4294967295,D=N+(M<<20&4294967295|M>>>12),M=T+(D^N^F)+P[5]+4294588738&4294967295,T=D+(M<<4&4294967295|M>>>28),M=F+(T^D^N)+P[8]+2272392833&4294967295,F=T+(M<<11&4294967295|M>>>21),M=N+(F^T^D)+P[11]+1839030562&4294967295,N=F+(M<<16&4294967295|M>>>16),M=D+(N^F^T)+P[14]+4259657740&4294967295,D=N+(M<<23&4294967295|M>>>9),M=T+(D^N^F)+P[1]+2763975236&4294967295,T=D+(M<<4&4294967295|M>>>28),M=F+(T^D^N)+P[4]+1272893353&4294967295,F=T+(M<<11&4294967295|M>>>21),M=N+(F^T^D)+P[7]+4139469664&4294967295,N=F+(M<<16&4294967295|M>>>16),M=D+(N^F^T)+P[10]+3200236656&4294967295,D=N+(M<<23&4294967295|M>>>9),M=T+(D^N^F)+P[13]+681279174&4294967295,T=D+(M<<4&4294967295|M>>>28),M=F+(T^D^N)+P[0]+3936430074&4294967295,F=T+(M<<11&4294967295|M>>>21),M=N+(F^T^D)+P[3]+3572445317&4294967295,N=F+(M<<16&4294967295|M>>>16),M=D+(N^F^T)+P[6]+76029189&4294967295,D=N+(M<<23&4294967295|M>>>9),M=T+(D^N^F)+P[9]+3654602809&4294967295,T=D+(M<<4&4294967295|M>>>28),M=F+(T^D^N)+P[12]+3873151461&4294967295,F=T+(M<<11&4294967295|M>>>21),M=N+(F^T^D)+P[15]+530742520&4294967295,N=F+(M<<16&4294967295|M>>>16),M=D+(N^F^T)+P[2]+3299628645&4294967295,D=N+(M<<23&4294967295|M>>>9),M=T+(N^(D|~F))+P[0]+4096336452&4294967295,T=D+(M<<6&4294967295|M>>>26),M=F+(D^(T|~N))+P[7]+1126891415&4294967295,F=T+(M<<10&4294967295|M>>>22),M=N+(T^(F|~D))+P[14]+2878612391&4294967295,N=F+(M<<15&4294967295|M>>>17),M=D+(F^(N|~T))+P[5]+4237533241&4294967295,D=N+(M<<21&4294967295|M>>>11),M=T+(N^(D|~F))+P[12]+1700485571&4294967295,T=D+(M<<6&4294967295|M>>>26),M=F+(D^(T|~N))+P[3]+2399980690&4294967295,F=T+(M<<10&4294967295|M>>>22),M=N+(T^(F|~D))+P[10]+4293915773&4294967295,N=F+(M<<15&4294967295|M>>>17),M=D+(F^(N|~T))+P[1]+2240044497&4294967295,D=N+(M<<21&4294967295|M>>>11),M=T+(N^(D|~F))+P[8]+1873313359&4294967295,T=D+(M<<6&4294967295|M>>>26),M=F+(D^(T|~N))+P[15]+4264355552&4294967295,F=T+(M<<10&4294967295|M>>>22),M=N+(T^(F|~D))+P[6]+2734768916&4294967295,N=F+(M<<15&4294967295|M>>>17),M=D+(F^(N|~T))+P[13]+1309151649&4294967295,D=N+(M<<21&4294967295|M>>>11),M=T+(N^(D|~F))+P[4]+4149444226&4294967295,T=D+(M<<6&4294967295|M>>>26),M=F+(D^(T|~N))+P[11]+3174756917&4294967295,F=T+(M<<10&4294967295|M>>>22),M=N+(T^(F|~D))+P[2]+718787259&4294967295,N=F+(M<<15&4294967295|M>>>17),M=D+(F^(N|~T))+P[9]+3951481745&4294967295,k.g[0]=k.g[0]+T&4294967295,k.g[1]=k.g[1]+(N+(M<<21&4294967295|M>>>11))&4294967295,k.g[2]=k.g[2]+N&4294967295,k.g[3]=k.g[3]+F&4294967295}n.prototype.u=function(k,T){T===void 0&&(T=k.length);for(var D=T-this.blockSize,P=this.B,N=this.h,F=0;F<T;){if(N==0)for(;F<=D;)r(this,k,F),F+=this.blockSize;if(typeof k=="string"){for(;F<T;)if(P[N++]=k.charCodeAt(F++),N==this.blockSize){r(this,P),N=0;break}}else for(;F<T;)if(P[N++]=k[F++],N==this.blockSize){r(this,P),N=0;break}}this.h=N,this.o+=T},n.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var T=1;T<k.length-8;++T)k[T]=0;var D=8*this.o;for(T=k.length-8;T<k.length;++T)k[T]=D&255,D/=256;for(this.u(k),k=Array(16),T=D=0;4>T;++T)for(var P=0;32>P;P+=8)k[D++]=this.g[T]>>>P&255;return k};function s(k,T){var D=a;return Object.prototype.hasOwnProperty.call(D,k)?D[k]:D[k]=T(k)}function o(k,T){this.h=T;for(var D=[],P=!0,N=k.length-1;0<=N;N--){var F=k[N]|0;P&&F==T||(D[N]=F,P=!1)}this.g=D}var a={};function u(k){return-128<=k&&128>k?s(k,function(T){return new o([T|0],0>T?-1:0)}):new o([k|0],0>k?-1:0)}function c(k){if(isNaN(k)||!isFinite(k))return m;if(0>k)return A(c(-k));for(var T=[],D=1,P=0;k>=D;P++)T[P]=k/D|0,D*=4294967296;return new o(T,0)}function d(k,T){if(k.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(k.charAt(0)=="-")return A(d(k.substring(1),T));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var D=c(Math.pow(T,8)),P=m,N=0;N<k.length;N+=8){var F=Math.min(8,k.length-N),M=parseInt(k.substring(N,N+F),T);8>F?(F=c(Math.pow(T,F)),P=P.j(F).add(c(M))):(P=P.j(D),P=P.add(c(M)))}return P}var m=u(0),p=u(1),g=u(16777216);i=o.prototype,i.m=function(){if(b(this))return-A(this).m();for(var k=0,T=1,D=0;D<this.g.length;D++){var P=this.i(D);k+=(0<=P?P:4294967296+P)*T,T*=4294967296}return k},i.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(w(this))return"0";if(b(this))return"-"+A(this).toString(k);for(var T=c(Math.pow(k,6)),D=this,P="";;){var N=S(D,T).g;D=_(D,N.j(T));var F=((0<D.g.length?D.g[0]:D.h)>>>0).toString(k);if(D=N,w(D))return F+P;for(;6>F.length;)F="0"+F;P=F+P}},i.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function w(k){if(k.h!=0)return!1;for(var T=0;T<k.g.length;T++)if(k.g[T]!=0)return!1;return!0}function b(k){return k.h==-1}i.l=function(k){return k=_(this,k),b(k)?-1:w(k)?0:1};function A(k){for(var T=k.g.length,D=[],P=0;P<T;P++)D[P]=~k.g[P];return new o(D,~k.h).add(p)}i.abs=function(){return b(this)?A(this):this},i.add=function(k){for(var T=Math.max(this.g.length,k.g.length),D=[],P=0,N=0;N<=T;N++){var F=P+(this.i(N)&65535)+(k.i(N)&65535),M=(F>>>16)+(this.i(N)>>>16)+(k.i(N)>>>16);P=M>>>16,F&=65535,M&=65535,D[N]=M<<16|F}return new o(D,D[D.length-1]&-2147483648?-1:0)};function _(k,T){return k.add(A(T))}i.j=function(k){if(w(this)||w(k))return m;if(b(this))return b(k)?A(this).j(A(k)):A(A(this).j(k));if(b(k))return A(this.j(A(k)));if(0>this.l(g)&&0>k.l(g))return c(this.m()*k.m());for(var T=this.g.length+k.g.length,D=[],P=0;P<2*T;P++)D[P]=0;for(P=0;P<this.g.length;P++)for(var N=0;N<k.g.length;N++){var F=this.i(P)>>>16,M=this.i(P)&65535,$=k.i(N)>>>16,Q=k.i(N)&65535;D[2*P+2*N]+=M*Q,C(D,2*P+2*N),D[2*P+2*N+1]+=F*Q,C(D,2*P+2*N+1),D[2*P+2*N+1]+=M*$,C(D,2*P+2*N+1),D[2*P+2*N+2]+=F*$,C(D,2*P+2*N+2)}for(P=0;P<T;P++)D[P]=D[2*P+1]<<16|D[2*P];for(P=T;P<2*T;P++)D[P]=0;return new o(D,0)};function C(k,T){for(;(k[T]&65535)!=k[T];)k[T+1]+=k[T]>>>16,k[T]&=65535,T++}function I(k,T){this.g=k,this.h=T}function S(k,T){if(w(T))throw Error("division by zero");if(w(k))return new I(m,m);if(b(k))return T=S(A(k),T),new I(A(T.g),A(T.h));if(b(T))return T=S(k,A(T)),new I(A(T.g),T.h);if(30<k.g.length){if(b(k)||b(T))throw Error("slowDivide_ only works with positive integers.");for(var D=p,P=T;0>=P.l(k);)D=R(D),P=R(P);var N=L(D,1),F=L(P,1);for(P=L(P,2),D=L(D,2);!w(P);){var M=F.add(P);0>=M.l(k)&&(N=N.add(D),F=M),P=L(P,1),D=L(D,1)}return T=_(k,N.j(T)),new I(N,T)}for(N=m;0<=k.l(T);){for(D=Math.max(1,Math.floor(k.m()/T.m())),P=Math.ceil(Math.log(D)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),F=c(D),M=F.j(T);b(M)||0<M.l(k);)D-=P,F=c(D),M=F.j(T);w(F)&&(F=p),N=N.add(F),k=_(k,M)}return new I(N,k)}i.A=function(k){return S(this,k).h},i.and=function(k){for(var T=Math.max(this.g.length,k.g.length),D=[],P=0;P<T;P++)D[P]=this.i(P)&k.i(P);return new o(D,this.h&k.h)},i.or=function(k){for(var T=Math.max(this.g.length,k.g.length),D=[],P=0;P<T;P++)D[P]=this.i(P)|k.i(P);return new o(D,this.h|k.h)},i.xor=function(k){for(var T=Math.max(this.g.length,k.g.length),D=[],P=0;P<T;P++)D[P]=this.i(P)^k.i(P);return new o(D,this.h^k.h)};function R(k){for(var T=k.g.length+1,D=[],P=0;P<T;P++)D[P]=k.i(P)<<1|k.i(P-1)>>>31;return new o(D,k.h)}function L(k,T){var D=T>>5;T%=32;for(var P=k.g.length-D,N=[],F=0;F<P;F++)N[F]=0<T?k.i(F+D)>>>T|k.i(F+D+1)<<32-T:k.i(F+D);return new o(N,k.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,PF=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Oc=o}).apply(typeof YR<"u"?YR:typeof self<"u"?self:typeof window<"u"?window:{});var Ew=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var NF,ry,OF,zw,Rx,LF,FF,MF;(function(){var i,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(E,B,V){return E==Array.prototype||E==Object.prototype||(E[B]=V.value),E};function t(E){E=[typeof globalThis=="object"&&globalThis,E,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ew=="object"&&Ew];for(var B=0;B<E.length;++B){var V=E[B];if(V&&V.Math==Math)return V}throw Error("Cannot find global object")}var n=t(this);function r(E,B){if(B)e:{var V=n;E=E.split(".");for(var Z=0;Z<E.length-1;Z++){var pe=E[Z];if(!(pe in V))break e;V=V[pe]}E=E[E.length-1],Z=V[E],B=B(Z),B!=Z&&B!=null&&e(V,E,{configurable:!0,writable:!0,value:B})}}function s(E,B){E instanceof String&&(E+="");var V=0,Z=!1,pe={next:function(){if(!Z&&V<E.length){var _e=V++;return{value:B(_e,E[_e]),done:!1}}return Z=!0,{done:!0,value:void 0}}};return pe[Symbol.iterator]=function(){return pe},pe}r("Array.prototype.values",function(E){return E||function(){return s(this,function(B,V){return V})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function u(E){var B=typeof E;return B=B!="object"?B:E?Array.isArray(E)?"array":B:"null",B=="array"||B=="object"&&typeof E.length=="number"}function c(E){var B=typeof E;return B=="object"&&E!=null||B=="function"}function d(E,B,V){return E.call.apply(E.bind,arguments)}function m(E,B,V){if(!E)throw Error();if(2<arguments.length){var Z=Array.prototype.slice.call(arguments,2);return function(){var pe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(pe,Z),E.apply(B,pe)}}return function(){return E.apply(B,arguments)}}function p(E,B,V){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:m,p.apply(null,arguments)}function g(E,B){var V=Array.prototype.slice.call(arguments,1);return function(){var Z=V.slice();return Z.push.apply(Z,arguments),E.apply(this,Z)}}function w(E,B){function V(){}V.prototype=B.prototype,E.aa=B.prototype,E.prototype=new V,E.prototype.constructor=E,E.Qb=function(Z,pe,_e){for(var Le=Array(arguments.length-2),Yt=2;Yt<arguments.length;Yt++)Le[Yt-2]=arguments[Yt];return B.prototype[pe].apply(Z,Le)}}function b(E){const B=E.length;if(0<B){const V=Array(B);for(let Z=0;Z<B;Z++)V[Z]=E[Z];return V}return[]}function A(E,B){for(let V=1;V<arguments.length;V++){const Z=arguments[V];if(u(Z)){const pe=E.length||0,_e=Z.length||0;E.length=pe+_e;for(let Le=0;Le<_e;Le++)E[pe+Le]=Z[Le]}else E.push(Z)}}class _{constructor(B,V){this.i=B,this.j=V,this.h=0,this.g=null}get(){let B;return 0<this.h?(this.h--,B=this.g,this.g=B.next,B.next=null):B=this.i(),B}}function C(E){return/^[\s\xa0]*$/.test(E)}function I(){var E=a.navigator;return E&&(E=E.userAgent)?E:""}function S(E){return S[" "](E),E}S[" "]=function(){};var R=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function L(E,B,V){for(const Z in E)B.call(V,E[Z],Z,E)}function k(E,B){for(const V in E)B.call(void 0,E[V],V,E)}function T(E){const B={};for(const V in E)B[V]=E[V];return B}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(E,B){let V,Z;for(let pe=1;pe<arguments.length;pe++){Z=arguments[pe];for(V in Z)E[V]=Z[V];for(let _e=0;_e<D.length;_e++)V=D[_e],Object.prototype.hasOwnProperty.call(Z,V)&&(E[V]=Z[V])}}function N(E){var B=1;E=E.split(":");const V=[];for(;0<B&&E.length;)V.push(E.shift()),B--;return E.length&&V.push(E.join(":")),V}function F(E){a.setTimeout(()=>{throw E},0)}function M(){var E=Y;let B=null;return E.g&&(B=E.g,E.g=E.g.next,E.g||(E.h=null),B.next=null),B}class ${constructor(){this.h=this.g=null}add(B,V){const Z=Q.get();Z.set(B,V),this.h?this.h.next=Z:this.g=Z,this.h=Z}}var Q=new _(()=>new ie,E=>E.reset());class ie{constructor(){this.next=this.g=this.h=null}set(B,V){this.h=B,this.g=V,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,ue=!1,Y=new $,J=()=>{const E=a.Promise.resolve(void 0);ee=()=>{E.then(q)}};var q=()=>{for(var E;E=M();){try{E.h.call(E.g)}catch(V){F(V)}var B=Q;B.j(E),100>B.h&&(B.h++,E.next=B.g,B.g=E)}ue=!1};function H(){this.s=this.s,this.C=this.C}H.prototype.s=!1,H.prototype.ma=function(){this.s||(this.s=!0,this.N())},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(E,B){this.type=E,this.g=this.target=B,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var le=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var E=!1,B=Object.defineProperty({},"passive",{get:function(){E=!0}});try{const V=()=>{};a.addEventListener("test",V,B),a.removeEventListener("test",V,B)}catch{}return E}();function se(E,B){if(G.call(this,E?E.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,E){var V=this.type=E.type,Z=E.changedTouches&&E.changedTouches.length?E.changedTouches[0]:null;if(this.target=E.target||E.srcElement,this.g=B,B=E.relatedTarget){if(R){e:{try{S(B.nodeName);var pe=!0;break e}catch{}pe=!1}pe||(B=null)}}else V=="mouseover"?B=E.fromElement:V=="mouseout"&&(B=E.toElement);this.relatedTarget=B,Z?(this.clientX=Z.clientX!==void 0?Z.clientX:Z.pageX,this.clientY=Z.clientY!==void 0?Z.clientY:Z.pageY,this.screenX=Z.screenX||0,this.screenY=Z.screenY||0):(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0),this.button=E.button,this.key=E.key||"",this.ctrlKey=E.ctrlKey,this.altKey=E.altKey,this.shiftKey=E.shiftKey,this.metaKey=E.metaKey,this.pointerId=E.pointerId||0,this.pointerType=typeof E.pointerType=="string"?E.pointerType:X[E.pointerType]||"",this.state=E.state,this.i=E,E.defaultPrevented&&se.aa.h.call(this)}}w(se,G);var X={2:"touch",3:"pen",4:"mouse"};se.prototype.h=function(){se.aa.h.call(this);var E=this.i;E.preventDefault?E.preventDefault():E.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),te=0;function ae(E,B,V,Z,pe){this.listener=E,this.proxy=null,this.src=B,this.type=V,this.capture=!!Z,this.ha=pe,this.key=++te,this.da=this.fa=!1}function de(E){E.da=!0,E.listener=null,E.proxy=null,E.src=null,E.ha=null}function ye(E){this.src=E,this.g={},this.h=0}ye.prototype.add=function(E,B,V,Z,pe){var _e=E.toString();E=this.g[_e],E||(E=this.g[_e]=[],this.h++);var Le=Oe(E,B,Z,pe);return-1<Le?(B=E[Le],V||(B.fa=!1)):(B=new ae(B,this.src,_e,!!Z,pe),B.fa=V,E.push(B)),B};function xe(E,B){var V=B.type;if(V in E.g){var Z=E.g[V],pe=Array.prototype.indexOf.call(Z,B,void 0),_e;(_e=0<=pe)&&Array.prototype.splice.call(Z,pe,1),_e&&(de(B),E.g[V].length==0&&(delete E.g[V],E.h--))}}function Oe(E,B,V,Z){for(var pe=0;pe<E.length;++pe){var _e=E[pe];if(!_e.da&&_e.listener==B&&_e.capture==!!V&&_e.ha==Z)return pe}return-1}var Fe="closure_lm_"+(1e6*Math.random()|0),Be={};function We(E,B,V,Z,pe){if(Array.isArray(B)){for(var _e=0;_e<B.length;_e++)We(E,B[_e],V,Z,pe);return null}return V=Ze(V),E&&E[ne]?E.K(B,V,c(Z)?!!Z.capture:!1,pe):mt(E,B,V,!1,Z,pe)}function mt(E,B,V,Z,pe,_e){if(!B)throw Error("Invalid event type");var Le=c(pe)?!!pe.capture:!!pe,Yt=rt(E);if(Yt||(E[Fe]=Yt=new ye(E)),V=Yt.add(B,V,Z,Le,_e),V.proxy)return V;if(Z=fe(),V.proxy=Z,Z.src=E,Z.listener=V,E.addEventListener)le||(pe=Le),pe===void 0&&(pe=!1),E.addEventListener(B.toString(),Z,pe);else if(E.attachEvent)E.attachEvent(Re(B.toString()),Z);else if(E.addListener&&E.removeListener)E.addListener(Z);else throw Error("addEventListener and attachEvent are unavailable.");return V}function fe(){function E(V){return B.call(E.src,E.listener,V)}const B=be;return E}function ve(E,B,V,Z,pe){if(Array.isArray(B))for(var _e=0;_e<B.length;_e++)ve(E,B[_e],V,Z,pe);else Z=c(Z)?!!Z.capture:!!Z,V=Ze(V),E&&E[ne]?(E=E.i,B=String(B).toString(),B in E.g&&(_e=E.g[B],V=Oe(_e,V,Z,pe),-1<V&&(de(_e[V]),Array.prototype.splice.call(_e,V,1),_e.length==0&&(delete E.g[B],E.h--)))):E&&(E=rt(E))&&(B=E.g[B.toString()],E=-1,B&&(E=Oe(B,V,Z,pe)),(V=-1<E?B[E]:null)&&Ie(V))}function Ie(E){if(typeof E!="number"&&E&&!E.da){var B=E.src;if(B&&B[ne])xe(B.i,E);else{var V=E.type,Z=E.proxy;B.removeEventListener?B.removeEventListener(V,Z,E.capture):B.detachEvent?B.detachEvent(Re(V),Z):B.addListener&&B.removeListener&&B.removeListener(Z),(V=rt(B))?(xe(V,E),V.h==0&&(V.src=null,B[Fe]=null)):de(E)}}}function Re(E){return E in Be?Be[E]:Be[E]="on"+E}function be(E,B){if(E.da)E=!0;else{B=new se(B,this);var V=E.listener,Z=E.ha||E.src;E.fa&&Ie(E),E=V.call(Z,B)}return E}function rt(E){return E=E[Fe],E instanceof ye?E:null}var qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ze(E){return typeof E=="function"?E:(E[qe]||(E[qe]=function(B){return E.handleEvent(B)}),E[qe])}function st(){H.call(this),this.i=new ye(this),this.M=this,this.F=null}w(st,H),st.prototype[ne]=!0,st.prototype.removeEventListener=function(E,B,V,Z){ve(this,E,B,V,Z)};function ft(E,B){var V,Z=E.F;if(Z)for(V=[];Z;Z=Z.F)V.push(Z);if(E=E.M,Z=B.type||B,typeof B=="string")B=new G(B,E);else if(B instanceof G)B.target=B.target||E;else{var pe=B;B=new G(Z,E),P(B,pe)}if(pe=!0,V)for(var _e=V.length-1;0<=_e;_e--){var Le=B.g=V[_e];pe=gt(Le,Z,!0,B)&&pe}if(Le=B.g=E,pe=gt(Le,Z,!0,B)&&pe,pe=gt(Le,Z,!1,B)&&pe,V)for(_e=0;_e<V.length;_e++)Le=B.g=V[_e],pe=gt(Le,Z,!1,B)&&pe}st.prototype.N=function(){if(st.aa.N.call(this),this.i){var E=this.i,B;for(B in E.g){for(var V=E.g[B],Z=0;Z<V.length;Z++)de(V[Z]);delete E.g[B],E.h--}}this.F=null},st.prototype.K=function(E,B,V,Z){return this.i.add(String(E),B,!1,V,Z)},st.prototype.L=function(E,B,V,Z){return this.i.add(String(E),B,!0,V,Z)};function gt(E,B,V,Z){if(B=E.i.g[String(B)],!B)return!0;B=B.concat();for(var pe=!0,_e=0;_e<B.length;++_e){var Le=B[_e];if(Le&&!Le.da&&Le.capture==V){var Yt=Le.listener,tr=Le.ha||Le.src;Le.fa&&xe(E.i,Le),pe=Yt.call(tr,Z)!==!1&&pe}}return pe&&!Z.defaultPrevented}function xi(E,B,V){if(typeof E=="function")V&&(E=p(E,V));else if(E&&typeof E.handleEvent=="function")E=p(E.handleEvent,E);else throw Error("Invalid listener argument");return 2147483647<Number(B)?-1:a.setTimeout(E,B||0)}function Mt(E){E.g=xi(()=>{E.g=null,E.i&&(E.i=!1,Mt(E))},E.l);const B=E.h;E.h=null,E.m.apply(null,B)}class an extends H{constructor(B,V){super(),this.m=B,this.l=V,this.h=null,this.i=!1,this.g=null}j(B){this.h=arguments,this.g?this.i=!0:Mt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hn(E){H.call(this),this.h=E,this.g={}}w(Hn,H);var Qs=[];function iu(E){L(E.g,function(B,V){this.g.hasOwnProperty(V)&&Ie(B)},E),E.g={}}Hn.prototype.N=function(){Hn.aa.N.call(this),iu(this)},Hn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var og=a.JSON.stringify,ag=a.JSON.parse,lg=class{stringify(E){return a.JSON.stringify(E,void 0)}parse(E){return a.JSON.parse(E,void 0)}};function ih(){}ih.prototype.h=null;function hf(E){return E.h||(E.h=E.i())}function df(){}var Cs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Lo(){G.call(this,"d")}w(Lo,G);function ff(){G.call(this,"c")}w(ff,G);var Fo={},ug=null;function sh(){return ug=ug||new st}Fo.La="serverreachability";function cg(E){G.call(this,Fo.La,E)}w(cg,G);function La(E){const B=sh();ft(B,new cg(B))}Fo.STAT_EVENT="statevent";function hg(E,B){G.call(this,Fo.STAT_EVENT,E),this.stat=B}w(hg,G);function Mn(E){const B=sh();ft(B,new hg(B,E))}Fo.Ma="timingevent";function pf(E,B){G.call(this,Fo.Ma,E),this.size=B}w(pf,G);function Zs(E,B){if(typeof E!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){E()},B)}function oh(){this.g=!0}oh.prototype.xa=function(){this.g=!1};function ah(E,B,V,Z,pe,_e){E.info(function(){if(E.g)if(_e)for(var Le="",Yt=_e.split("&"),tr=0;tr<Yt.length;tr++){var Bt=Yt[tr].split("=");if(1<Bt.length){var mr=Bt[0];Bt=Bt[1];var zn=mr.split("_");Le=2<=zn.length&&zn[1]=="type"?Le+(mr+"="+Bt+"&"):Le+(mr+"=redacted&")}}else Le=null;else Le=_e;return"XMLHTTP REQ ("+Z+") [attempt "+pe+"]: "+B+`
`+V+`
`+Le})}function mf(E,B,V,Z,pe,_e,Le){E.info(function(){return"XMLHTTP RESP ("+Z+") [ attempt "+pe+"]: "+B+`
`+V+`
`+_e+" "+Le})}function eo(E,B,V,Z){E.info(function(){return"XMLHTTP TEXT ("+B+"): "+jb(E,V)+(Z?" "+Z:"")})}function dg(E,B){E.info(function(){return"TIMEOUT: "+B})}oh.prototype.info=function(){};function jb(E,B){if(!E.g)return B;if(!B)return null;try{var V=JSON.parse(B);if(V){for(E=0;E<V.length;E++)if(Array.isArray(V[E])){var Z=V[E];if(!(2>Z.length)){var pe=Z[1];if(Array.isArray(pe)&&!(1>pe.length)){var _e=pe[0];if(_e!="noop"&&_e!="stop"&&_e!="close")for(var Le=1;Le<pe.length;Le++)pe[Le]=""}}}}return og(V)}catch{return B}}var gf={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},l2={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},to;function lh(){}w(lh,ih),lh.prototype.g=function(){return new XMLHttpRequest},lh.prototype.i=function(){return{}},to=new lh;function no(E,B,V,Z){this.j=E,this.i=B,this.l=V,this.R=Z||1,this.U=new Hn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new u2}function u2(){this.i=null,this.g="",this.h=!1}var fg={},yf={};function vf(E,B,V){E.L=1,E.v=uu(zi(B)),E.m=V,E.P=!0,pg(E,null)}function pg(E,B){E.F=Date.now(),ln(E),E.A=zi(E.v);var V=E.A,Z=E.R;Array.isArray(Z)||(Z=[String(Z)]),hu(V.i,"t",Z),E.C=0,V=E.j.J,E.h=new u2,E.g=T2(E.j,V?B:null,!E.m),0<E.O&&(E.M=new an(p(E.Y,E,E.g),E.O)),B=E.U,V=E.g,Z=E.ca;var pe="readystatechange";Array.isArray(pe)||(pe&&(Qs[0]=pe.toString()),pe=Qs);for(var _e=0;_e<pe.length;_e++){var Le=We(V,pe[_e],Z||B.handleEvent,!1,B.h||B);if(!Le)break;B.g[Le.key]=Le}B=E.H?T(E.H):{},E.m?(E.u||(E.u="POST"),B["Content-Type"]="application/x-www-form-urlencoded",E.g.ea(E.A,E.u,E.m,B)):(E.u="GET",E.g.ea(E.A,E.u,null,B)),La(),ah(E.i,E.u,E.A,E.l,E.R,E.m)}no.prototype.ca=function(E){E=E.target;const B=this.M;B&&Ti(E)==3?B.j():this.Y(E)},no.prototype.Y=function(E){try{if(E==this.g)e:{const zn=Ti(this.g);var B=this.g.Ba();const Ts=this.g.Z();if(!(3>zn)&&(zn!=3||this.g&&(this.h.h||this.g.oa()||_g(this.g)))){this.J||zn!=4||B==7||(B==8||0>=Ts?La(3):La(2)),uh(this);var V=this.g.Z();this.X=V;t:if(c2(this)){var Z=_g(this.g);E="";var pe=Z.length,_e=Ti(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xs(this),su(this);var Le="";break t}this.h.i=new a.TextDecoder}for(B=0;B<pe;B++)this.h.h=!0,E+=this.h.i.decode(Z[B],{stream:!(_e&&B==pe-1)});Z.length=0,this.h.g+=E,this.C=0,Le=this.h.g}else Le=this.g.oa();if(this.o=V==200,mf(this.i,this.u,this.A,this.l,this.R,zn,V),this.o){if(this.T&&!this.K){t:{if(this.g){var Yt,tr=this.g;if((Yt=tr.g?tr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(Yt)){var Bt=Yt;break t}}Bt=null}if(V=Bt)eo(this.i,this.l,V,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,mg(this,V);else{this.o=!1,this.s=3,Mn(12),xs(this),su(this);break e}}if(this.P){V=!0;let Wi;for(;!this.J&&this.C<Le.length;)if(Wi=qb(this,Le),Wi==yf){zn==4&&(this.s=4,Mn(14),V=!1),eo(this.i,this.l,null,"[Incomplete Response]");break}else if(Wi==fg){this.s=4,Mn(15),eo(this.i,this.l,Le,"[Invalid Chunk]"),V=!1;break}else eo(this.i,this.l,Wi,null),mg(this,Wi);if(c2(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),zn!=4||Le.length!=0||this.h.h||(this.s=1,Mn(16),V=!1),this.o=this.o&&V,!V)eo(this.i,this.l,Le,"[Invalid Chunked Response]"),xs(this),su(this);else if(0<Le.length&&!this.W){this.W=!0;var mr=this.j;mr.g==this&&mr.ba&&!mr.M&&(mr.j.info("Great, no buffering proxy detected. Bytes received: "+Le.length),Ag(mr),mr.M=!0,Mn(11))}}else eo(this.i,this.l,Le,null),mg(this,Le);zn==4&&xs(this),this.o&&!this.J&&(zn==4?Df(this.j,this):(this.o=!1,ln(this)))}else Cf(this.g),V==400&&0<Le.indexOf("Unknown SID")?(this.s=3,Mn(12)):(this.s=0,Mn(13)),xs(this),su(this)}}}catch{}finally{}};function c2(E){return E.g?E.u=="GET"&&E.L!=2&&E.j.Ca:!1}function qb(E,B){var V=E.C,Z=B.indexOf(`
`,V);return Z==-1?yf:(V=Number(B.substring(V,Z)),isNaN(V)?fg:(Z+=1,Z+V>B.length?yf:(B=B.slice(Z,Z+V),E.C=Z+V,B)))}no.prototype.cancel=function(){this.J=!0,xs(this)};function ln(E){E.S=Date.now()+E.I,h2(E,E.I)}function h2(E,B){if(E.B!=null)throw Error("WatchDog timer not null");E.B=Zs(p(E.ba,E),B)}function uh(E){E.B&&(a.clearTimeout(E.B),E.B=null)}no.prototype.ba=function(){this.B=null;const E=Date.now();0<=E-this.S?(dg(this.i,this.A),this.L!=2&&(La(),Mn(17)),xs(this),this.s=2,su(this)):h2(this,this.S-E)};function su(E){E.j.G==0||E.J||Df(E.j,E)}function xs(E){uh(E);var B=E.M;B&&typeof B.ma=="function"&&B.ma(),E.M=null,iu(E.U),E.g&&(B=E.g,E.g=null,B.abort(),B.ma())}function mg(E,B){try{var V=E.j;if(V.G!=0&&(V.g==E||oi(V.h,E))){if(!E.K&&oi(V.h,E)&&V.G==3){try{var Z=V.Da.g.parse(B)}catch{Z=null}if(Array.isArray(Z)&&Z.length==3){var pe=Z;if(pe[0]==0){e:if(!V.u){if(V.g)if(V.g.F+3e3<E.F)If(V),ao(V);else break e;Tf(V),Mn(18)}}else V.za=pe[1],0<V.za-V.T&&37500>pe[2]&&V.F&&V.v==0&&!V.C&&(V.C=Zs(p(V.Za,V),6e3));if(1>=f2(V.h)&&V.ca){try{V.ca()}catch{}V.ca=void 0}}else qa(V,11)}else if((E.K||V.g==E)&&If(V),!C(B))for(pe=V.Da.g.parse(B),B=0;B<pe.length;B++){let Bt=pe[B];if(V.T=Bt[0],Bt=Bt[1],V.G==2)if(Bt[0]=="c"){V.K=Bt[1],V.ia=Bt[2];const mr=Bt[3];mr!=null&&(V.la=mr,V.j.info("VER="+V.la));const zn=Bt[4];zn!=null&&(V.Aa=zn,V.j.info("SVER="+V.Aa));const Ts=Bt[5];Ts!=null&&typeof Ts=="number"&&0<Ts&&(Z=1.5*Ts,V.L=Z,V.j.info("backChannelRequestTimeoutMs_="+Z)),Z=V;const Wi=E.g;if(Wi){const gh=Wi.g?Wi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gh){var _e=Z.h;_e.g||gh.indexOf("spdy")==-1&&gh.indexOf("quic")==-1&&gh.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(gg(_e,_e.h),_e.h=null))}if(Z.D){const Rf=Wi.g?Wi.g.getResponseHeader("X-HTTP-Session-Id"):null;Rf&&(Z.ya=Rf,sn(Z.I,Z.D,Rf))}}V.G=3,V.l&&V.l.ua(),V.ba&&(V.R=Date.now()-E.F,V.j.info("Handshake RTT: "+V.R+"ms")),Z=V;var Le=E;if(Z.qa=S2(Z,Z.J?Z.ia:null,Z.W),Le.K){p2(Z.h,Le);var Yt=Le,tr=Z.L;tr&&(Yt.I=tr),Yt.B&&(uh(Yt),ln(Yt)),Z.g=Le}else mh(Z);0<V.i.length&&qo(V)}else Bt[0]!="stop"&&Bt[0]!="close"||qa(V,7);else V.G==3&&(Bt[0]=="stop"||Bt[0]=="close"?Bt[0]=="stop"?qa(V,7):Dr(V):Bt[0]!="noop"&&V.l&&V.l.ta(Bt),V.v=0)}}La(4)}catch{}}var d2=class{constructor(E,B){this.g=E,this.map=B}};function ch(E){this.l=E||10,a.PerformanceNavigationTiming?(E=a.performance.getEntriesByType("navigation"),E=0<E.length&&(E[0].nextHopProtocol=="hq"||E[0].nextHopProtocol=="h2")):E=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=E?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Hi(E){return E.h?!0:E.g?E.g.size>=E.j:!1}function f2(E){return E.h?1:E.g?E.g.size:0}function oi(E,B){return E.h?E.h==B:E.g?E.g.has(B):!1}function gg(E,B){E.g?E.g.add(B):E.h=B}function p2(E,B){E.h&&E.h==B?E.h=null:E.g&&E.g.has(B)&&E.g.delete(B)}ch.prototype.cancel=function(){if(this.i=m2(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const E of this.g.values())E.cancel();this.g.clear()}};function m2(E){if(E.h!=null)return E.i.concat(E.h.D);if(E.g!=null&&E.g.size!==0){let B=E.i;for(const V of E.g.values())B=B.concat(V.D);return B}return b(E.i)}function wf(E){if(E.V&&typeof E.V=="function")return E.V();if(typeof Map<"u"&&E instanceof Map||typeof Set<"u"&&E instanceof Set)return Array.from(E.values());if(typeof E=="string")return E.split("");if(u(E)){for(var B=[],V=E.length,Z=0;Z<V;Z++)B.push(E[Z]);return B}B=[],V=0;for(Z in E)B[V++]=E[Z];return B}function _f(E){if(E.na&&typeof E.na=="function")return E.na();if(!E.V||typeof E.V!="function"){if(typeof Map<"u"&&E instanceof Map)return Array.from(E.keys());if(!(typeof Set<"u"&&E instanceof Set)){if(u(E)||typeof E=="string"){var B=[];E=E.length;for(var V=0;V<E;V++)B.push(V);return B}B=[],V=0;for(const Z in E)B[V++]=Z;return B}}}function ou(E,B){if(E.forEach&&typeof E.forEach=="function")E.forEach(B,void 0);else if(u(E)||typeof E=="string")Array.prototype.forEach.call(E,B,void 0);else for(var V=_f(E),Z=wf(E),pe=Z.length,_e=0;_e<pe;_e++)B.call(void 0,Z[_e],V&&V[_e],E)}var hh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ub(E,B){if(E){E=E.split("&");for(var V=0;V<E.length;V++){var Z=E[V].indexOf("="),pe=null;if(0<=Z){var _e=E[V].substring(0,Z);pe=E[V].substring(Z+1)}else _e=E[V];B(_e,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function Fa(E){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,E instanceof Fa){this.h=E.h,dh(this,E.j),this.o=E.o,this.g=E.g,au(this,E.s),this.l=E.l;var B=E.i,V=new Mo;V.i=B.i,B.g&&(V.g=new Map(B.g),V.h=B.h),lu(this,V),this.m=E.m}else E&&(B=String(E).match(hh))?(this.h=!1,dh(this,B[1]||"",!0),this.o=Lt(B[2]||""),this.g=Lt(B[3]||"",!0),au(this,B[4]),this.l=Lt(B[5]||"",!0),lu(this,B[6]||"",!0),this.m=Lt(B[7]||"")):(this.h=!1,this.i=new Mo(null,this.h))}Fa.prototype.toString=function(){var E=[],B=this.j;B&&E.push(cu(B,bf,!0),":");var V=this.g;return(V||B=="file")&&(E.push("//"),(B=this.o)&&E.push(cu(B,bf,!0),"@"),E.push(encodeURIComponent(String(V)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),V=this.s,V!=null&&E.push(":",String(V))),(V=this.l)&&(this.g&&V.charAt(0)!="/"&&E.push("/"),E.push(cu(V,V.charAt(0)=="/"?v2:y2,!0))),(V=this.i.toString())&&E.push("?",V),(V=this.m)&&E.push("#",cu(V,yg)),E.join("")};function zi(E){return new Fa(E)}function dh(E,B,V){E.j=V?Lt(B,!0):B,E.j&&(E.j=E.j.replace(/:$/,""))}function au(E,B){if(B){if(B=Number(B),isNaN(B)||0>B)throw Error("Bad port number "+B);E.s=B}else E.s=null}function lu(E,B,V){B instanceof Mo?(E.i=B,Bo(E.i,E.h)):(V||(B=cu(B,w2)),E.i=new Mo(B,E.h))}function sn(E,B,V){E.i.set(B,V)}function uu(E){return sn(E,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),E}function Lt(E,B){return E?B?decodeURI(E.replace(/%25/g,"%2525")):decodeURIComponent(E):""}function cu(E,B,V){return typeof E=="string"?(E=encodeURI(E).replace(B,g2),V&&(E=E.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E):null}function g2(E){return E=E.charCodeAt(0),"%"+(E>>4&15).toString(16)+(E&15).toString(16)}var bf=/[#\/\?@]/g,y2=/[#\?:]/g,v2=/[#\?]/g,w2=/[#\?@]/g,yg=/#/g;function Mo(E,B){this.h=this.g=null,this.i=E||null,this.j=!!B}function Ir(E){E.g||(E.g=new Map,E.h=0,E.i&&Ub(E.i,function(B,V){E.add(decodeURIComponent(B.replace(/\+/g," ")),V)}))}i=Mo.prototype,i.add=function(E,B){Ir(this),this.i=null,E=Ss(this,E);var V=this.g.get(E);return V||this.g.set(E,V=[]),V.push(B),this.h+=1,this};function ro(E,B){Ir(E),B=Ss(E,B),E.g.has(B)&&(E.i=null,E.h-=E.g.get(B).length,E.g.delete(B))}function io(E,B){return Ir(E),B=Ss(E,B),E.g.has(B)}i.forEach=function(E,B){Ir(this),this.g.forEach(function(V,Z){V.forEach(function(pe){E.call(B,pe,Z,this)},this)},this)},i.na=function(){Ir(this);const E=Array.from(this.g.values()),B=Array.from(this.g.keys()),V=[];for(let Z=0;Z<B.length;Z++){const pe=E[Z];for(let _e=0;_e<pe.length;_e++)V.push(B[Z])}return V},i.V=function(E){Ir(this);let B=[];if(typeof E=="string")io(this,E)&&(B=B.concat(this.g.get(Ss(this,E))));else{E=Array.from(this.g.values());for(let V=0;V<E.length;V++)B=B.concat(E[V])}return B},i.set=function(E,B){return Ir(this),this.i=null,E=Ss(this,E),io(this,E)&&(this.h-=this.g.get(E).length),this.g.set(E,[B]),this.h+=1,this},i.get=function(E,B){return E?(E=this.V(E),0<E.length?String(E[0]):B):B};function hu(E,B,V){ro(E,B),0<V.length&&(E.i=null,E.g.set(Ss(E,B),b(V)),E.h+=V.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const E=[],B=Array.from(this.g.keys());for(var V=0;V<B.length;V++){var Z=B[V];const _e=encodeURIComponent(String(Z)),Le=this.V(Z);for(Z=0;Z<Le.length;Z++){var pe=_e;Le[Z]!==""&&(pe+="="+encodeURIComponent(String(Le[Z]))),E.push(pe)}}return this.i=E.join("&")};function Ss(E,B){return B=String(B),E.j&&(B=B.toLowerCase()),B}function Bo(E,B){B&&!E.j&&(Ir(E),E.i=null,E.g.forEach(function(V,Z){var pe=Z.toLowerCase();Z!=pe&&(ro(this,Z),hu(this,pe,V))},E)),E.j=B}function Vb(E,B){const V=new oh;if(a.Image){const Z=new Image;Z.onload=g(Si,V,"TestLoadImage: loaded",!0,B,Z),Z.onerror=g(Si,V,"TestLoadImage: error",!1,B,Z),Z.onabort=g(Si,V,"TestLoadImage: abort",!1,B,Z),Z.ontimeout=g(Si,V,"TestLoadImage: timeout",!1,B,Z),a.setTimeout(function(){Z.ontimeout&&Z.ontimeout()},1e4),Z.src=E}else B(!1)}function _2(E,B){const V=new oh,Z=new AbortController,pe=setTimeout(()=>{Z.abort(),Si(V,"TestPingServer: timeout",!1,B)},1e4);fetch(E,{signal:Z.signal}).then(_e=>{clearTimeout(pe),_e.ok?Si(V,"TestPingServer: ok",!0,B):Si(V,"TestPingServer: server error",!1,B)}).catch(()=>{clearTimeout(pe),Si(V,"TestPingServer: error",!1,B)})}function Si(E,B,V,Z,pe){try{pe&&(pe.onload=null,pe.onerror=null,pe.onabort=null,pe.ontimeout=null),Z(V)}catch{}}function Hb(){this.g=new lg}function b2(E,B,V){const Z=V||"";try{ou(E,function(pe,_e){let Le=pe;c(pe)&&(Le=og(pe)),B.push(Z+_e+"="+encodeURIComponent(Le))})}catch(pe){throw B.push(Z+"type="+encodeURIComponent("_badmap")),pe}}function Ma(E){this.l=E.Ub||null,this.j=E.eb||!1}w(Ma,ih),Ma.prototype.g=function(){return new fh(this.l,this.j)},Ma.prototype.i=function(E){return function(){return E}}({});function fh(E,B){st.call(this),this.D=E,this.o=B,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(fh,st),i=fh.prototype,i.open=function(E,B){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=E,this.A=B,this.readyState=1,oo(this)},i.send=function(E){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const B={headers:this.u,method:this.B,credentials:this.m,cache:void 0};E&&(B.body=E),(this.D||a).fetch(new Request(this.A,B)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,so(this)),this.readyState=0},i.Sa=function(E){if(this.g&&(this.l=E,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=E.headers,this.readyState=2,oo(this)),this.g&&(this.readyState=3,oo(this),this.g)))if(this.responseType==="arraybuffer")E.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in E){if(this.j=E.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;A2(this)}else E.text().then(this.Ra.bind(this),this.ga.bind(this))};function A2(E){E.j.read().then(E.Pa.bind(E)).catch(E.ga.bind(E))}i.Pa=function(E){if(this.g){if(this.o&&E.value)this.response.push(E.value);else if(!this.o){var B=E.value?E.value:new Uint8Array(0);(B=this.v.decode(B,{stream:!E.done}))&&(this.response=this.responseText+=B)}E.done?so(this):oo(this),this.readyState==3&&A2(this)}},i.Ra=function(E){this.g&&(this.response=this.responseText=E,so(this))},i.Qa=function(E){this.g&&(this.response=E,so(this))},i.ga=function(){this.g&&so(this)};function so(E){E.readyState=4,E.l=null,E.j=null,E.v=null,oo(E)}i.setRequestHeader=function(E,B){this.u.append(E,B)},i.getResponseHeader=function(E){return this.h&&this.h.get(E.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const E=[],B=this.h.entries();for(var V=B.next();!V.done;)V=V.value,E.push(V[0]+": "+V[1]),V=B.next();return E.join(`\r
`)};function oo(E){E.onreadystatechange&&E.onreadystatechange.call(E)}Object.defineProperty(fh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(E){this.m=E?"include":"same-origin"}});function Ba(E){let B="";return L(E,function(V,Z){B+=Z,B+=":",B+=V,B+=`\r
`}),B}function du(E,B,V){e:{for(Z in V){var Z=!1;break e}Z=!0}Z||(V=Ba(V),typeof E=="string"?V!=null&&encodeURIComponent(String(V)):sn(E,B,V))}function wn(E){st.call(this),this.headers=new Map,this.o=E||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(wn,st);var zb=/^https?$/i,vg=["POST","PUT"];i=wn.prototype,i.Ha=function(E){this.J=E},i.ea=function(E,B,V,Z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+E);B=B?B.toUpperCase():"GET",this.D=E,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():to.g(),this.v=this.o?hf(this.o):hf(to),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(B,String(E),!0),this.B=!1}catch(_e){ph(this,_e);return}if(E=V||"",V=new Map(this.headers),Z)if(Object.getPrototypeOf(Z)===Object.prototype)for(var pe in Z)V.set(pe,Z[pe]);else if(typeof Z.keys=="function"&&typeof Z.get=="function")for(const _e of Z.keys())V.set(_e,Z.get(_e));else throw Error("Unknown input type for opt_headers: "+String(Z));Z=Array.from(V.keys()).find(_e=>_e.toLowerCase()=="content-type"),pe=a.FormData&&E instanceof a.FormData,!(0<=Array.prototype.indexOf.call(vg,B,void 0))||Z||pe||V.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,Le]of V)this.g.setRequestHeader(_e,Le);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ef(this),this.u=!0,this.g.send(E),this.u=!1}catch(_e){ph(this,_e)}};function ph(E,B){E.h=!1,E.g&&(E.j=!0,E.g.abort(),E.j=!1),E.l=B,E.m=5,Af(E),$i(E)}function Af(E){E.A||(E.A=!0,ft(E,"complete"),ft(E,"error"))}i.abort=function(E){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=E||7,ft(this,"complete"),ft(this,"abort"),$i(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$i(this,!0)),wn.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?wg(this):this.bb())},i.bb=function(){wg(this)};function wg(E){if(E.h&&typeof o<"u"&&(!E.v[1]||Ti(E)!=4||E.Z()!=2)){if(E.u&&Ti(E)==4)xi(E.Ea,0,E);else if(ft(E,"readystatechange"),Ti(E)==4){E.h=!1;try{const Le=E.Z();e:switch(Le){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var B=!0;break e;default:B=!1}var V;if(!(V=B)){var Z;if(Z=Le===0){var pe=String(E.D).match(hh)[1]||null;!pe&&a.self&&a.self.location&&(pe=a.self.location.protocol.slice(0,-1)),Z=!zb.test(pe?pe.toLowerCase():"")}V=Z}if(V)ft(E,"complete"),ft(E,"success");else{E.m=6;try{var _e=2<Ti(E)?E.g.statusText:""}catch{_e=""}E.l=_e+" ["+E.Z()+"]",Af(E)}}finally{$i(E)}}}}function $i(E,B){if(E.g){Ef(E);const V=E.g,Z=E.v[0]?()=>{}:null;E.g=null,E.v=null,B||ft(E,"ready");try{V.onreadystatechange=Z}catch{}}}function Ef(E){E.I&&(a.clearTimeout(E.I),E.I=null)}i.isActive=function(){return!!this.g};function Ti(E){return E.g?E.g.readyState:0}i.Z=function(){try{return 2<Ti(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(E){if(this.g){var B=this.g.responseText;return E&&B.indexOf(E)==0&&(B=B.substring(E.length)),ag(B)}};function _g(E){try{if(!E.g)return null;if("response"in E.g)return E.g.response;switch(E.H){case"":case"text":return E.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in E.g)return E.g.mozResponseArrayBuffer}return null}catch{return null}}function Cf(E){const B={};E=(E.g&&2<=Ti(E)&&E.g.getAllResponseHeaders()||"").split(`\r
`);for(let Z=0;Z<E.length;Z++){if(C(E[Z]))continue;var V=N(E[Z]);const pe=V[0];if(V=V[1],typeof V!="string")continue;V=V.trim();const _e=B[pe]||[];B[pe]=_e,_e.push(V)}k(B,function(Z){return Z.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function jo(E,B,V){return V&&V.internalChannelParams&&V.internalChannelParams[E]||B}function bg(E){this.Aa=0,this.i=[],this.j=new oh,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=jo("failFast",!1,E),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=jo("baseRetryDelayMs",5e3,E),this.cb=jo("retryDelaySeedMs",1e4,E),this.Wa=jo("forwardChannelMaxRetries",2,E),this.wa=jo("forwardChannelRequestTimeoutMs",2e4,E),this.pa=E&&E.xmlHttpFactory||void 0,this.Xa=E&&E.Tb||void 0,this.Ca=E&&E.useFetchStreams||!1,this.L=void 0,this.J=E&&E.supportsCrossDomainXhr||!1,this.K="",this.h=new ch(E&&E.concurrentRequestLimit),this.Da=new Hb,this.P=E&&E.fastHandshake||!1,this.O=E&&E.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=E&&E.Rb||!1,E&&E.xa&&this.j.xa(),E&&E.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&E&&E.detectBufferingProxy||!1,this.ja=void 0,E&&E.longPollingTimeout&&0<E.longPollingTimeout&&(this.ja=E.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=bg.prototype,i.la=8,i.G=1,i.connect=function(E,B,V,Z){Mn(0),this.W=E,this.H=B||{},V&&Z!==void 0&&(this.H.OSID=V,this.H.OAID=Z),this.F=this.X,this.I=S2(this,null,this.W),qo(this)};function Dr(E){if(xf(E),E.G==3){var B=E.U++,V=zi(E.I);if(sn(V,"SID",E.K),sn(V,"RID",B),sn(V,"TYPE","terminate"),ja(E,V),B=new no(E,E.j,B),B.L=2,B.v=uu(zi(V)),V=!1,a.navigator&&a.navigator.sendBeacon)try{V=a.navigator.sendBeacon(B.v.toString(),"")}catch{}!V&&a.Image&&(new Image().src=B.v,V=!0),V||(B.g=T2(B.j,null),B.g.ea(B.v)),B.F=Date.now(),ln(B)}x2(E)}function ao(E){E.g&&(Ag(E),E.g.cancel(),E.g=null)}function xf(E){ao(E),E.u&&(a.clearTimeout(E.u),E.u=null),If(E),E.h.cancel(),E.s&&(typeof E.s=="number"&&a.clearTimeout(E.s),E.s=null)}function qo(E){if(!Hi(E.h)&&!E.s){E.s=!0;var B=E.Ga;ee||J(),ue||(ee(),ue=!0),Y.add(B,E),E.B=0}}function $b(E,B){return f2(E.h)>=E.h.j-(E.s?1:0)?!1:E.s?(E.i=B.D.concat(E.i),!0):E.G==1||E.G==2||E.B>=(E.Va?0:E.Wa)?!1:(E.s=Zs(p(E.Ga,E,B),C2(E,E.B)),E.B++,!0)}i.Ga=function(E){if(this.s)if(this.s=null,this.G==1){if(!E){this.U=Math.floor(1e5*Math.random()),E=this.U++;const pe=new no(this,this.j,E);let _e=this.o;if(this.S&&(_e?(_e=T(_e),P(_e,this.S)):_e=this.S),this.m!==null||this.O||(pe.H=_e,_e=null),this.P)e:{for(var B=0,V=0;V<this.i.length;V++){t:{var Z=this.i[V];if("__data__"in Z.map&&(Z=Z.map.__data__,typeof Z=="string")){Z=Z.length;break t}Z=void 0}if(Z===void 0)break;if(B+=Z,4096<B){B=V;break e}if(B===4096||V===this.i.length-1){B=V+1;break e}}B=1e3}else B=1e3;B=fu(this,pe,B),V=zi(this.I),sn(V,"RID",E),sn(V,"CVER",22),this.D&&sn(V,"X-HTTP-Session-Id",this.D),ja(this,V),_e&&(this.O?B="headers="+encodeURIComponent(String(Ba(_e)))+"&"+B:this.m&&du(V,this.m,_e)),gg(this.h,pe),this.Ua&&sn(V,"TYPE","init"),this.P?(sn(V,"$req",B),sn(V,"SID","null"),pe.T=!0,vf(pe,V,null)):vf(pe,V,B),this.G=2}}else this.G==3&&(E?Sf(this,E):this.i.length==0||Hi(this.h)||Sf(this))};function Sf(E,B){var V;B?V=B.l:V=E.U++;const Z=zi(E.I);sn(Z,"SID",E.K),sn(Z,"RID",V),sn(Z,"AID",E.T),ja(E,Z),E.m&&E.o&&du(Z,E.m,E.o),V=new no(E,E.j,V,E.B+1),E.m===null&&(V.H=E.o),B&&(E.i=B.D.concat(E.i)),B=fu(E,V,1e3),V.I=Math.round(.5*E.wa)+Math.round(.5*E.wa*Math.random()),gg(E.h,V),vf(V,Z,B)}function ja(E,B){E.H&&L(E.H,function(V,Z){sn(B,Z,V)}),E.l&&ou({},function(V,Z){sn(B,Z,V)})}function fu(E,B,V){V=Math.min(E.i.length,V);var Z=E.l?p(E.l.Na,E.l,E):null;e:{var pe=E.i;let _e=-1;for(;;){const Le=["count="+V];_e==-1?0<V?(_e=pe[0].g,Le.push("ofs="+_e)):_e=0:Le.push("ofs="+_e);let Yt=!0;for(let tr=0;tr<V;tr++){let Bt=pe[tr].g;const mr=pe[tr].map;if(Bt-=_e,0>Bt)_e=Math.max(0,pe[tr].g-100),Yt=!1;else try{b2(mr,Le,"req"+Bt+"_")}catch{Z&&Z(mr)}}if(Yt){Z=Le.join("&");break e}}}return E=E.i.splice(0,V),B.D=E,Z}function mh(E){if(!E.g&&!E.u){E.Y=1;var B=E.Fa;ee||J(),ue||(ee(),ue=!0),Y.add(B,E),E.v=0}}function Tf(E){return E.g||E.u||3<=E.v?!1:(E.Y++,E.u=Zs(p(E.Fa,E),C2(E,E.v)),E.v++,!0)}i.Fa=function(){if(this.u=null,E2(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var E=2*this.R;this.j.info("BP detection timer enabled: "+E),this.A=Zs(p(this.ab,this),E)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Mn(10),ao(this),E2(this))};function Ag(E){E.A!=null&&(a.clearTimeout(E.A),E.A=null)}function E2(E){E.g=new no(E,E.j,"rpc",E.Y),E.m===null&&(E.g.H=E.o),E.g.O=0;var B=zi(E.qa);sn(B,"RID","rpc"),sn(B,"SID",E.K),sn(B,"AID",E.T),sn(B,"CI",E.F?"0":"1"),!E.F&&E.ja&&sn(B,"TO",E.ja),sn(B,"TYPE","xmlhttp"),ja(E,B),E.m&&E.o&&du(B,E.m,E.o),E.L&&(E.g.I=E.L);var V=E.g;E=E.ia,V.L=1,V.v=uu(zi(B)),V.m=null,V.P=!0,pg(V,E)}i.Za=function(){this.C!=null&&(this.C=null,ao(this),Tf(this),Mn(19))};function If(E){E.C!=null&&(a.clearTimeout(E.C),E.C=null)}function Df(E,B){var V=null;if(E.g==B){If(E),Ag(E),E.g=null;var Z=2}else if(oi(E.h,B))V=B.D,p2(E.h,B),Z=1;else return;if(E.G!=0){if(B.o)if(Z==1){V=B.m?B.m.length:0,B=Date.now()-B.F;var pe=E.B;Z=sh(),ft(Z,new pf(Z,V)),qo(E)}else mh(E);else if(pe=B.s,pe==3||pe==0&&0<B.X||!(Z==1&&$b(E,B)||Z==2&&Tf(E)))switch(V&&0<V.length&&(B=E.h,B.i=B.i.concat(V)),pe){case 1:qa(E,5);break;case 4:qa(E,10);break;case 3:qa(E,6);break;default:qa(E,2)}}}function C2(E,B){let V=E.Ta+Math.floor(Math.random()*E.cb);return E.isActive()||(V*=2),V*B}function qa(E,B){if(E.j.info("Error code "+B),B==2){var V=p(E.fb,E),Z=E.Xa;const pe=!Z;Z=new Fa(Z||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||dh(Z,"https"),uu(Z),pe?Vb(Z.toString(),V):_2(Z.toString(),V)}else Mn(2);E.G=0,E.l&&E.l.sa(B),x2(E),xf(E)}i.fb=function(E){E?(this.j.info("Successfully pinged google.com"),Mn(2)):(this.j.info("Failed to ping google.com"),Mn(1))};function x2(E){if(E.G=0,E.ka=[],E.l){const B=m2(E.h);(B.length!=0||E.i.length!=0)&&(A(E.ka,B),A(E.ka,E.i),E.h.i.length=0,b(E.i),E.i.length=0),E.l.ra()}}function S2(E,B,V){var Z=V instanceof Fa?zi(V):new Fa(V);if(Z.g!="")B&&(Z.g=B+"."+Z.g),au(Z,Z.s);else{var pe=a.location;Z=pe.protocol,B=B?B+"."+pe.hostname:pe.hostname,pe=+pe.port;var _e=new Fa(null);Z&&dh(_e,Z),B&&(_e.g=B),pe&&au(_e,pe),V&&(_e.l=V),Z=_e}return V=E.D,B=E.ya,V&&B&&sn(Z,V,B),sn(Z,"VER",E.la),ja(E,Z),Z}function T2(E,B,V){if(B&&!E.J)throw Error("Can't create secondary domain capable XhrIo object.");return B=E.Ca&&!E.pa?new wn(new Ma({eb:V})):new wn(E.pa),B.Ha(E.J),B}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function Eg(){}i=Eg.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function kf(){}kf.prototype.g=function(E,B){return new ai(E,B)};function ai(E,B){st.call(this),this.g=new bg(B),this.l=E,this.h=B&&B.messageUrlParams||null,E=B&&B.messageHeaders||null,B&&B.clientProtocolHeaderRequired&&(E?E["X-Client-Protocol"]="webchannel":E={"X-Client-Protocol":"webchannel"}),this.g.o=E,E=B&&B.initMessageHeaders||null,B&&B.messageContentType&&(E?E["X-WebChannel-Content-Type"]=B.messageContentType:E={"X-WebChannel-Content-Type":B.messageContentType}),B&&B.va&&(E?E["X-WebChannel-Client-Profile"]=B.va:E={"X-WebChannel-Client-Profile":B.va}),this.g.S=E,(E=B&&B.Sb)&&!C(E)&&(this.g.m=E),this.v=B&&B.supportsCrossDomainXhr||!1,this.u=B&&B.sendRawJson||!1,(B=B&&B.httpSessionIdParam)&&!C(B)&&(this.g.D=B,E=this.h,E!==null&&B in E&&(E=this.h,B in E&&delete E[B])),this.j=new Uo(this)}w(ai,st),ai.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ai.prototype.close=function(){Dr(this.g)},ai.prototype.o=function(E){var B=this.g;if(typeof E=="string"){var V={};V.__data__=E,E=V}else this.u&&(V={},V.__data__=og(E),E=V);B.i.push(new d2(B.Ya++,E)),B.G==3&&qo(B)},ai.prototype.N=function(){this.g.l=null,delete this.j,Dr(this.g),delete this.g,ai.aa.N.call(this)};function I2(E){Lo.call(this),E.__headers__&&(this.headers=E.__headers__,this.statusCode=E.__status__,delete E.__headers__,delete E.__status__);var B=E.__sm__;if(B){e:{for(const V in B){E=V;break e}E=void 0}(this.i=E)&&(E=this.i,B=B!==null&&E in B?B[E]:void 0),this.data=B}else this.data=E}w(I2,Lo);function D2(){ff.call(this),this.status=1}w(D2,ff);function Uo(E){this.g=E}w(Uo,Eg),Uo.prototype.ua=function(){ft(this.g,"a")},Uo.prototype.ta=function(E){ft(this.g,new I2(E))},Uo.prototype.sa=function(E){ft(this.g,new D2)},Uo.prototype.ra=function(){ft(this.g,"b")},kf.prototype.createWebChannel=kf.prototype.g,ai.prototype.send=ai.prototype.o,ai.prototype.open=ai.prototype.m,ai.prototype.close=ai.prototype.close,MF=function(){return new kf},FF=function(){return sh()},LF=Fo,Rx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},gf.NO_ERROR=0,gf.TIMEOUT=8,gf.HTTP_ERROR=6,zw=gf,l2.COMPLETE="complete",OF=l2,df.EventType=Cs,Cs.OPEN="a",Cs.CLOSE="b",Cs.ERROR="c",Cs.MESSAGE="d",st.prototype.listen=st.prototype.K,ry=df,wn.prototype.listenOnce=wn.prototype.L,wn.prototype.getLastError=wn.prototype.Ka,wn.prototype.getLastErrorCode=wn.prototype.Ba,wn.prototype.getStatus=wn.prototype.Z,wn.prototype.getResponseJson=wn.prototype.Oa,wn.prototype.getResponseText=wn.prototype.oa,wn.prototype.send=wn.prototype.ea,wn.prototype.setWithCredentials=wn.prototype.Ha,NF=wn}).apply(typeof Ew<"u"?Ew:typeof self<"u"?self:typeof window<"u"?window:{});const XR="@firebase/firestore",QR="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ni=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ni.UNAUTHENTICATED=new ni(null),ni.GOOGLE_CREDENTIALS=new ni("google-credentials-uid"),ni.FIRST_PARTY=new ni("first-party-uid"),ni.MOCK_USER=new ni("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wm="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd=new DT("@firebase/firestore");function Zf(){return Wd.logLevel}function Ue(i,...e){if(Wd.logLevel<=Pt.DEBUG){const t=e.map(PT);Wd.debug(`Firestore (${Wm}): ${i}`,...t)}}function Kl(i,...e){if(Wd.logLevel<=Pt.ERROR){const t=e.map(PT);Wd.error(`Firestore (${Wm}): ${i}`,...t)}}function Mm(i,...e){if(Wd.logLevel<=Pt.WARN){const t=e.map(PT);Wd.warn(`Firestore (${Wm}): ${i}`,...t)}}function PT(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,BF(i,n,t)}function BF(i,e,t){let n=`FIRESTORE (${Wm}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Kl(n),new Error(n)}function Wt(i,e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,i||BF(e,r,n)}function wt(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends Ra{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class U8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ni.UNAUTHENTICATED))}shutdown(){}}class V8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class H8{constructor(e){this.t=e,this.currentUser=ni.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Wt(this.o===void 0,42304);let n=this.i;const r=u=>this.i!==n?(n=this.i,t(u)):Promise.resolve();let s=new Ul;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ul,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},a=u=>{Ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(Ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ul)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Wt(typeof n.accessToken=="string",31837,{l:n}),new jF(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Wt(e===null||typeof e=="string",2055,{h:e}),new ni(e)}}class z8{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=ni.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class $8{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new z8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ni.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ZR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class W8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ys(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Wt(this.o===void 0,3512);const n=s=>{s.error!=null&&Ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,Ue("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const r=s=>{Ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):Ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ZR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Wt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ZR(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G8(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qF(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=G8(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%62))}return n}}function Tt(i,e){return i<e?-1:i>e?1:0}function Px(i,e){let t=0;for(;t<i.length&&t<e.length;){const n=i.codePointAt(t),r=e.codePointAt(t);if(n!==r){if(n<128&&r<128)return Tt(n,r);{const s=qF(),o=K8(s.encode(eP(i,t)),s.encode(eP(e,t)));return o!==0?o:Tt(n,r)}}t+=n>65535?2:1}return Tt(i.length,e.length)}function eP(i,e){return i.codePointAt(e)>65535?i.substring(e,e+2):i.substring(e,e+1)}function K8(i,e){for(let t=0;t<i.length&&t<e.length;++t)if(i[t]!==e[t])return Tt(i[t],e[t]);return Tt(i.length,e.length)}function Bm(i,e,t){return i.length===e.length&&i.every((n,r)=>t(n,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=-62135596800,nP=1e6;class Qn{static now(){return Qn.fromMillis(Date.now())}static fromDate(e){return Qn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*nP);return new Qn(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new $e(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new $e(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<tP)throw new $e(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/nP}_compareTo(e){return this.seconds===e.seconds?Tt(this.nanoseconds,e.nanoseconds):Tt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-tP;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{static fromTimestamp(e){return new bt(e)}static min(){return new bt(new Qn(0,0))}static max(){return new bt(new Qn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP="__name__";class Jo{constructor(e,t,n){t===void 0?t=0:t>e.length&&dt(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&dt(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Jo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Jo?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const s=Jo.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Tt(e.length,t.length)}static compareSegments(e,t){const n=Jo.isNumericId(e),r=Jo.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Jo.extractNumericId(e).compare(Jo.extractNumericId(t)):Px(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Oc.fromString(e.substring(4,e.length-2))}}class mn extends Jo{construct(e,t,n){return new mn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new $e(Ee.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new mn(t)}static emptyPath(){return new mn([])}}const J8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vr extends Jo{construct(e,t,n){return new Vr(e,t,n)}static isValidIdentifier(e){return J8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rP}static keyField(){return new Vr([rP])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(n.length===0)throw new $e(Ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new $e(Ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new $e(Ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(n+=a,r++):(s(),r++)}if(s(),o)throw new $e(Ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Vr(t)}static emptyPath(){return new Vr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e){this.path=e}static fromPath(e){return new ot(mn.fromString(e))}static fromName(e){return new ot(mn.fromString(e).popFirst(5))}static empty(){return new ot(mn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return mn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ot(new mn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy=-1;function Y8(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=bt.fromTimestamp(n===1e9?new Qn(t+1,0):new Qn(t,n));return new Mc(r,ot.empty(),e)}function X8(i){return new Mc(i.readTime,i.key,Uy)}class Mc{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Mc(bt.min(),ot.empty(),Uy)}static max(){return new Mc(bt.max(),ot.empty(),Uy)}}function Q8(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=ot.comparator(i.documentKey,e.documentKey),t!==0?t:Tt(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eq{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gm(i){if(i.code!==Ee.FAILED_PRECONDITION||i.message!==Z8)throw i;Ue("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&dt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ce((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Ce?t:Ce.resolve(t)}catch(t){return Ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Ce.reject(t)}static resolve(e){return new Ce((t,n)=>{t(e)})}static reject(e){return new Ce((t,n)=>{n(e)})}static waitFor(e){return new Ce((t,n)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},u=>n(u))}),o=!0,s===r&&t()})}static or(e){let t=Ce.resolve(!1);for(const n of e)t=t.next(r=>r?Ce.resolve(r):n());return t}static forEach(e,t){const n=[];return e.forEach((r,s)=>{n.push(t.call(this,r,s))}),this.waitFor(n)}static mapArray(e,t){return new Ce((n,r)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const c=u;t(e[c]).next(d=>{o[c]=d,++a,a===s&&n(o)},d=>r(d))}})}static doWhile(e,t){return new Ce((n,r)=>{const s=()=>{e()===!0?t().next(()=>{s()},r):n()};s()})}}function tq(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Km(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ue(n),this.ce=n=>t.writeSequenceNumber(n))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}H1.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT=-1;function z1(i){return i==null}function j_(i){return i===0&&1/i==-1/0}function nq(i){return typeof i=="number"&&Number.isInteger(i)&&!j_(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VF="";function rq(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=iP(e)),e=iq(i.get(t),e);return iP(e)}function iq(i,e){let t=e;const n=i.length;for(let r=0;r<n;r++){const s=i.charAt(r);switch(s){case"\0":t+="";break;case VF:t+="";break;default:t+=s}}return t}function iP(i){return i+VF+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Xc(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function sq(i,e){const t=[];for(const n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.push(e(i[n],n,i));return t}function HF(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e,t){this.comparator=e,this.root=t||jr.EMPTY}insert(e,t){return new Pn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,jr.BLACK,null,null))}remove(e){return new Pn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cw(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cw(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cw(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cw(this.root,e,this.comparator,!0)}}class Cw{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jr{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=n??jr.RED,this.left=r??jr.EMPTY,this.right=s??jr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new jr(e??this.key,t??this.value,n??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return jr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return jr.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw dt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw dt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw dt(27949);return e+(this.isRed()?0:1)}}jr.EMPTY=null,jr.RED=!0,jr.BLACK=!1;jr.EMPTY=new class{constructor(){this.size=0}get key(){throw dt(57766)}get value(){throw dt(16141)}get color(){throw dt(16727)}get left(){throw dt(29726)}get right(){throw dt(36894)}copy(e,t,n,r,s){return this}insert(e,t,n){return new jr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e){this.comparator=e,this.data=new Pn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new oP(this.data.getIterator())}getIteratorFrom(e){return new oP(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof fr)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new fr(this.comparator);return t.data=e,t}}class oP{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this.fields=e,e.sort(Vr.comparator)}static empty(){return new ws([])}unionWith(e){let t=new fr(Vr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ws(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Bm(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new zF("Invalid base64 string: "+s):s}}(e);return new Wr(t)}static fromUint8Array(e){const t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new Wr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Tt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wr.EMPTY_BYTE_STRING=new Wr("");const oq=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bc(i){if(Wt(!!i,39018),typeof i=="string"){let e=0;const t=oq.exec(i);if(Wt(!!t,46558,{timestamp:i}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Un(i.seconds),nanos:Un(i.nanos)}}function Un(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function jc(i){return typeof i=="string"?Wr.fromBase64String(i):Wr.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $F="server_timestamp",WF="__type__",GF="__previous_value__",KF="__local_write_time__";function OT(i){var e,t;return((t=(((e=i==null?void 0:i.mapValue)===null||e===void 0?void 0:e.fields)||{})[WF])===null||t===void 0?void 0:t.stringValue)===$F}function $1(i){const e=i.mapValue.fields[GF];return OT(e)?$1(e):e}function Vy(i){const e=Bc(i.mapValue.fields[KF].timestampValue);return new Qn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aq{constructor(e,t,n,r,s,o,a,u,c,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c,this.isUsingEmulator=d}}const q_="(default)";class Hy{constructor(e,t){this.projectId=e,this.database=t||q_}static empty(){return new Hy("","")}get isDefaultDatabase(){return this.database===q_}isEqual(e){return e instanceof Hy&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF="__type__",lq="__max__",xw={mapValue:{}},YF="__vector__",U_="value";function qc(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?OT(i)?4:cq(i)?9007199254740991:uq(i)?10:11:dt(28295,{value:i})}function Sa(i,e){if(i===e)return!0;const t=qc(i);if(t!==qc(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return Vy(i).isEqual(Vy(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Bc(r.timestampValue),a=Bc(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(r,s){return jc(r.bytesValue).isEqual(jc(s.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(r,s){return Un(r.geoPointValue.latitude)===Un(s.geoPointValue.latitude)&&Un(r.geoPointValue.longitude)===Un(s.geoPointValue.longitude)}(i,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Un(r.integerValue)===Un(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Un(r.doubleValue),a=Un(s.doubleValue);return o===a?j_(o)===j_(a):isNaN(o)&&isNaN(a)}return!1}(i,e);case 9:return Bm(i.arrayValue.values||[],e.arrayValue.values||[],Sa);case 10:case 11:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(sP(o)!==sP(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!Sa(o[u],a[u])))return!1;return!0}(i,e);default:return dt(52216,{left:i})}}function zy(i,e){return(i.values||[]).find(t=>Sa(t,e))!==void 0}function jm(i,e){if(i===e)return 0;const t=qc(i),n=qc(e);if(t!==n)return Tt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Tt(i.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Un(s.integerValue||s.doubleValue),u=Un(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(i,e);case 3:return aP(i.timestampValue,e.timestampValue);case 4:return aP(Vy(i),Vy(e));case 5:return Px(i.stringValue,e.stringValue);case 6:return function(s,o){const a=jc(s),u=jc(o);return a.compareTo(u)}(i.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){const d=Tt(a[c],u[c]);if(d!==0)return d}return Tt(a.length,u.length)}(i.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Tt(Un(s.latitude),Un(o.latitude));return a!==0?a:Tt(Un(s.longitude),Un(o.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return lP(i.arrayValue,e.arrayValue);case 10:return function(s,o){var a,u,c,d;const m=s.fields||{},p=o.fields||{},g=(a=m[U_])===null||a===void 0?void 0:a.arrayValue,w=(u=p[U_])===null||u===void 0?void 0:u.arrayValue,b=Tt(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((d=w==null?void 0:w.values)===null||d===void 0?void 0:d.length)||0);return b!==0?b:lP(g,w)}(i.mapValue,e.mapValue);case 11:return function(s,o){if(s===xw.mapValue&&o===xw.mapValue)return 0;if(s===xw.mapValue)return 1;if(o===xw.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),c=o.fields||{},d=Object.keys(c);u.sort(),d.sort();for(let m=0;m<u.length&&m<d.length;++m){const p=Px(u[m],d[m]);if(p!==0)return p;const g=jm(a[u[m]],c[d[m]]);if(g!==0)return g}return Tt(u.length,d.length)}(i.mapValue,e.mapValue);default:throw dt(23264,{Pe:t})}}function aP(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return Tt(i,e);const t=Bc(i),n=Bc(e),r=Tt(t.seconds,n.seconds);return r!==0?r:Tt(t.nanos,n.nanos)}function lP(i,e){const t=i.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){const s=jm(t[r],n[r]);if(s)return s}return Tt(t.length,n.length)}function qm(i){return Nx(i)}function Nx(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(t){const n=Bc(t);return`time(${n.seconds},${n.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?function(t){return jc(t).toBase64()}(i.bytesValue):"referenceValue"in i?function(t){return ot.fromName(t).toString()}(i.referenceValue):"geoPointValue"in i?function(t){return`geo(${t.latitude},${t.longitude})`}(i.geoPointValue):"arrayValue"in i?function(t){let n="[",r=!0;for(const s of t.values||[])r?r=!1:n+=",",n+=Nx(s);return n+"]"}(i.arrayValue):"mapValue"in i?function(t){const n=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of n)s?s=!1:r+=",",r+=`${o}:${Nx(t.fields[o])}`;return r+"}"}(i.mapValue):dt(61005,{value:i})}function $w(i){switch(qc(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$1(i);return e?16+$w(e):16;case 5:return 2*i.stringValue.length;case 6:return jc(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((r,s)=>r+$w(s),0)}(i.arrayValue);case 10:case 11:return function(n){let r=0;return Xc(n.fields,(s,o)=>{r+=s.length+$w(o)}),r}(i.mapValue);default:throw dt(13486,{value:i})}}function uP(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function Ox(i){return!!i&&"integerValue"in i}function LT(i){return!!i&&"arrayValue"in i}function cP(i){return!!i&&"nullValue"in i}function hP(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function Ww(i){return!!i&&"mapValue"in i}function uq(i){var e,t;return((t=(((e=i==null?void 0:i.mapValue)===null||e===void 0?void 0:e.fields)||{})[JF])===null||t===void 0?void 0:t.stringValue)===YF}function Ry(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return Xc(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Ry(n)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ry(i.arrayValue.values[t]);return e}return Object.assign({},i)}function cq(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===lq}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e){this.value=e}static empty(){return new Ui({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Ww(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ry(t)}setAll(e){let t=Vr.emptyPath(),n={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,n,r),n={},r=[],t=a.popLast()}o?n[a.lastSegment()]=Ry(o):r.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());Ww(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Sa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Ww(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Xc(t,(r,s)=>e[r]=s);for(const r of n)delete e[r]}clone(){return new Ui(Ry(this.value))}}function XF(i){const e=[];return Xc(i.fields,(t,n)=>{const r=new Vr([t]);if(Ww(n)){const s=XF(n.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new ws(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,t,n,r,s,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ri(e,0,bt.min(),bt.min(),bt.min(),Ui.empty(),0)}static newFoundDocument(e,t,n,r){return new ri(e,1,t,bt.min(),n,r,0)}static newNoDocument(e,t){return new ri(e,2,t,bt.min(),bt.min(),Ui.empty(),0)}static newUnknownDocument(e,t){return new ri(e,3,t,bt.min(),bt.min(),Ui.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(bt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ui.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ui.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=bt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ri&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ri(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e,t){this.position=e,this.inclusive=t}}function dP(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){const s=e[r],o=i.position[r];if(s.field.isKeyField()?n=ot.comparator(ot.fromName(o.referenceValue),t.key):n=jm(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function fP(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Sa(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e,t="asc"){this.field=e,this.dir=t}}function hq(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{}class Yn extends QF{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new fq(e,t,n):t==="array-contains"?new gq(e,n):t==="in"?new yq(e,n):t==="not-in"?new vq(e,n):t==="array-contains-any"?new wq(e,n):new Yn(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new pq(e,n):new mq(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(jm(t,this.value)):t!==null&&qc(this.value)===qc(t)&&this.matchesComparison(jm(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ko extends QF{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new ko(e,t)}matches(e){return ZF(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function ZF(i){return i.op==="and"}function e3(i){return dq(i)&&ZF(i)}function dq(i){for(const e of i.filters)if(e instanceof ko)return!1;return!0}function Lx(i){if(i instanceof Yn)return i.field.canonicalString()+i.op.toString()+qm(i.value);if(e3(i))return i.filters.map(e=>Lx(e)).join(",");{const e=i.filters.map(t=>Lx(t)).join(",");return`${i.op}(${e})`}}function t3(i,e){return i instanceof Yn?function(n,r){return r instanceof Yn&&n.op===r.op&&n.field.isEqual(r.field)&&Sa(n.value,r.value)}(i,e):i instanceof ko?function(n,r){return r instanceof ko&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((s,o,a)=>s&&t3(o,r.filters[a]),!0):!1}(i,e):void dt(19439)}function n3(i){return i instanceof Yn?function(t){return`${t.field.canonicalString()} ${t.op} ${qm(t.value)}`}(i):i instanceof ko?function(t){return t.op.toString()+" {"+t.getFilters().map(n3).join(" ,")+"}"}(i):"Filter"}class fq extends Yn{constructor(e,t,n){super(e,t,n),this.key=ot.fromName(n.referenceValue)}matches(e){const t=ot.comparator(e.key,this.key);return this.matchesComparison(t)}}class pq extends Yn{constructor(e,t){super(e,"in",t),this.keys=r3("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class mq extends Yn{constructor(e,t){super(e,"not-in",t),this.keys=r3("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function r3(i,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>ot.fromName(n.referenceValue))}class gq extends Yn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return LT(t)&&zy(t.arrayValue,this.value)}}class yq extends Yn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&zy(this.value.arrayValue,t)}}class vq extends Yn{constructor(e,t){super(e,"not-in",t)}matches(e){if(zy(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!zy(this.value.arrayValue,t)}}class wq extends Yn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!LT(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>zy(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _q{constructor(e,t=null,n=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Ie=null}}function pP(i,e=null,t=[],n=[],r=null,s=null,o=null){return new _q(i,e,t,n,r,s,o)}function FT(i){const e=wt(i);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>Lx(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),z1(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>qm(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>qm(n)).join(",")),e.Ie=t}return e.Ie}function MT(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!hq(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!t3(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!fP(i.startAt,e.startAt)&&fP(i.endAt,e.endAt)}function Fx(i){return ot.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{constructor(e,t=null,n=[],r=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function bq(i,e,t,n,r,s,o,a){return new Jm(i,e,t,n,r,s,o,a)}function BT(i){return new Jm(i)}function mP(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function i3(i){return i.collectionGroup!==null}function Py(i){const e=wt(i);if(e.Ee===null){e.Ee=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ee.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new fr(Vr.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new $y(s,n))}),t.has(Vr.keyField().canonicalString())||e.Ee.push(new $y(Vr.keyField(),n))}return e.Ee}function Aa(i){const e=wt(i);return e.de||(e.de=s3(e,Py(i))),e.de}function Aq(i){const e=wt(i);return e.Ae||(e.Ae=s3(e,i.explicitOrderBy)),e.Ae}function s3(i,e){if(i.limitType==="F")return pP(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new $y(r.field,s)});const t=i.endAt?new V_(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new V_(i.startAt.position,i.startAt.inclusive):null;return pP(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function Mx(i,e){const t=i.filters.concat([e]);return new Jm(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function H_(i,e,t){return new Jm(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function W1(i,e){return MT(Aa(i),Aa(e))&&i.limitType===e.limitType}function o3(i){return`${FT(Aa(i))}|lt:${i.limitType}`}function ep(i){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(r=>n3(r)).join(", ")}]`),z1(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>qm(r)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>qm(r)).join(",")),`Target(${n})`}(Aa(i))}; limitType=${i.limitType})`}function G1(i,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):ot.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(i,e)&&function(n,r){for(const s of Py(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(i,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(i,e)&&function(n,r){return!(n.startAt&&!function(o,a,u){const c=dP(o,a,u);return o.inclusive?c<=0:c<0}(n.startAt,Py(n),r)||n.endAt&&!function(o,a,u){const c=dP(o,a,u);return o.inclusive?c>=0:c>0}(n.endAt,Py(n),r))}(i,e)}function Eq(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function a3(i){return(e,t)=>{let n=!1;for(const r of Py(i)){const s=Cq(r,e,t);if(s!==0)return s;n=n||r.field.isKeyField()}return 0}}function Cq(i,e,t){const n=i.field.isKeyField()?ot.comparator(e.key,t.key):function(s,o,a){const u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?jm(u,c):dt(42886)}(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return dt(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[r,s]of n)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Xc(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return HF(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xq=new Pn(ot.comparator);function Jl(){return xq}const l3=new Pn(ot.comparator);function iy(...i){let e=l3;for(const t of i)e=e.insert(t.key,t);return e}function u3(i){let e=l3;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Fh(){return Ny()}function c3(){return Ny()}function Ny(){return new nf(i=>i.toString(),(i,e)=>i.isEqual(e))}const Sq=new Pn(ot.comparator),Tq=new fr(ot.comparator);function Nt(...i){let e=Tq;for(const t of i)e=e.add(t);return e}const Iq=new fr(Tt);function Dq(){return Iq}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:j_(e)?"-0":e}}function h3(i){return{integerValue:""+i}}function kq(i,e){return nq(e)?h3(e):jT(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(){this._=void 0}}function Rq(i,e,t){return i instanceof Wy?function(r,s){const o={fields:{[WF]:{stringValue:$F},[KF]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&OT(s)&&(s=$1(s)),s&&(o.fields[GF]=s),{mapValue:o}}(t,e):i instanceof Gy?f3(i,e):i instanceof Ky?p3(i,e):function(r,s){const o=d3(r,s),a=gP(o)+gP(r.Re);return Ox(o)&&Ox(r.Re)?h3(a):jT(r.serializer,a)}(i,e)}function Pq(i,e,t){return i instanceof Gy?f3(i,e):i instanceof Ky?p3(i,e):t}function d3(i,e){return i instanceof z_?function(n){return Ox(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Wy extends K1{}class Gy extends K1{constructor(e){super(),this.elements=e}}function f3(i,e){const t=m3(e);for(const n of i.elements)t.some(r=>Sa(r,n))||t.push(n);return{arrayValue:{values:t}}}class Ky extends K1{constructor(e){super(),this.elements=e}}function p3(i,e){let t=m3(e);for(const n of i.elements)t=t.filter(r=>!Sa(r,n));return{arrayValue:{values:t}}}class z_ extends K1{constructor(e,t){super(),this.serializer=e,this.Re=t}}function gP(i){return Un(i.integerValue||i.doubleValue)}function m3(i){return LT(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nq{constructor(e,t){this.field=e,this.transform=t}}function Oq(i,e){return i.field.isEqual(e.field)&&function(n,r){return n instanceof Gy&&r instanceof Gy||n instanceof Ky&&r instanceof Ky?Bm(n.elements,r.elements,Sa):n instanceof z_&&r instanceof z_?Sa(n.Re,r.Re):n instanceof Wy&&r instanceof Wy}(i.transform,e.transform)}class Lq{constructor(e,t){this.version=e,this.transformResults=t}}class Do{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Do}static exists(e){return new Do(void 0,e)}static updateTime(e){return new Do(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Gw(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class J1{}function g3(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new qT(i.key,Do.none()):new q0(i.key,i.data,Do.none());{const t=i.data,n=Ui.empty();let r=new fr(Vr.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),r=r.add(s)}return new Qc(i.key,n,new ws(r.toArray()),Do.none())}}function Fq(i,e,t){i instanceof q0?function(r,s,o){const a=r.value.clone(),u=vP(r.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(i,e,t):i instanceof Qc?function(r,s,o){if(!Gw(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=vP(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(y3(r)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(i,e,t):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Oy(i,e,t,n){return i instanceof q0?function(s,o,a,u){if(!Gw(s.precondition,o))return a;const c=s.value.clone(),d=wP(s.fieldTransforms,u,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(i,e,t,n):i instanceof Qc?function(s,o,a,u){if(!Gw(s.precondition,o))return a;const c=wP(s.fieldTransforms,u,o),d=o.data;return d.setAll(y3(s)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(i,e,t,n):function(s,o,a){return Gw(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(i,e,t)}function Mq(i,e){let t=null;for(const n of i.fieldTransforms){const r=e.data.field(n.field),s=d3(n.transform,r||null);s!=null&&(t===null&&(t=Ui.empty()),t.set(n.field,s))}return t||null}function yP(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Bm(n,r,(s,o)=>Oq(s,o))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class q0 extends J1{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Qc extends J1{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function y3(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}}),e}function vP(i,e,t){const n=new Map;Wt(i.length===t.length,32656,{Ve:t.length,me:i.length});for(let r=0;r<t.length;r++){const s=i[r],o=s.transform,a=e.data.field(s.field);n.set(s.field,Pq(o,a,t[r]))}return n}function wP(i,e,t){const n=new Map;for(const r of i){const s=r.transform,o=t.data.field(r.field);n.set(r.field,Rq(s,o,e))}return n}class qT extends J1{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Bq extends J1{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jq{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Fq(s,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Oy(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Oy(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=c3();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const u=g3(o,a);u!==null&&n.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(bt.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Nt())}isEqual(e){return this.batchId===e.batchId&&Bm(this.mutations,e.mutations,(t,n)=>yP(t,n))&&Bm(this.baseMutations,e.baseMutations,(t,n)=>yP(t,n))}}class UT{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Wt(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let r=function(){return Sq}();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,n[o].version);return new UT(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qq{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uq{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vq{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kn,jt;function Hq(i){switch(i){case Ee.OK:return dt(64938);case Ee.CANCELLED:case Ee.UNKNOWN:case Ee.DEADLINE_EXCEEDED:case Ee.RESOURCE_EXHAUSTED:case Ee.INTERNAL:case Ee.UNAVAILABLE:case Ee.UNAUTHENTICATED:return!1;case Ee.INVALID_ARGUMENT:case Ee.NOT_FOUND:case Ee.ALREADY_EXISTS:case Ee.PERMISSION_DENIED:case Ee.FAILED_PRECONDITION:case Ee.ABORTED:case Ee.OUT_OF_RANGE:case Ee.UNIMPLEMENTED:case Ee.DATA_LOSS:return!0;default:return dt(15467,{code:i})}}function v3(i){if(i===void 0)return Kl("GRPC error has no .code"),Ee.UNKNOWN;switch(i){case Kn.OK:return Ee.OK;case Kn.CANCELLED:return Ee.CANCELLED;case Kn.UNKNOWN:return Ee.UNKNOWN;case Kn.DEADLINE_EXCEEDED:return Ee.DEADLINE_EXCEEDED;case Kn.RESOURCE_EXHAUSTED:return Ee.RESOURCE_EXHAUSTED;case Kn.INTERNAL:return Ee.INTERNAL;case Kn.UNAVAILABLE:return Ee.UNAVAILABLE;case Kn.UNAUTHENTICATED:return Ee.UNAUTHENTICATED;case Kn.INVALID_ARGUMENT:return Ee.INVALID_ARGUMENT;case Kn.NOT_FOUND:return Ee.NOT_FOUND;case Kn.ALREADY_EXISTS:return Ee.ALREADY_EXISTS;case Kn.PERMISSION_DENIED:return Ee.PERMISSION_DENIED;case Kn.FAILED_PRECONDITION:return Ee.FAILED_PRECONDITION;case Kn.ABORTED:return Ee.ABORTED;case Kn.OUT_OF_RANGE:return Ee.OUT_OF_RANGE;case Kn.UNIMPLEMENTED:return Ee.UNIMPLEMENTED;case Kn.DATA_LOSS:return Ee.DATA_LOSS;default:return dt(39323,{code:i})}}(jt=Kn||(Kn={}))[jt.OK=0]="OK",jt[jt.CANCELLED=1]="CANCELLED",jt[jt.UNKNOWN=2]="UNKNOWN",jt[jt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",jt[jt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",jt[jt.NOT_FOUND=5]="NOT_FOUND",jt[jt.ALREADY_EXISTS=6]="ALREADY_EXISTS",jt[jt.PERMISSION_DENIED=7]="PERMISSION_DENIED",jt[jt.UNAUTHENTICATED=16]="UNAUTHENTICATED",jt[jt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",jt[jt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",jt[jt.ABORTED=10]="ABORTED",jt[jt.OUT_OF_RANGE=11]="OUT_OF_RANGE",jt[jt.UNIMPLEMENTED=12]="UNIMPLEMENTED",jt[jt.INTERNAL=13]="INTERNAL",jt[jt.UNAVAILABLE=14]="UNAVAILABLE",jt[jt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zq=new Oc([4294967295,4294967295],0);function _P(i){const e=qF().encode(i),t=new PF;return t.update(e),new Uint8Array(t.digest())}function bP(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Oc([t,n],0),new Oc([r,s],0)]}class VT{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new sy(`Invalid padding: ${t}`);if(n<0)throw new sy(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new sy(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new sy(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Oc.fromNumber(this.pe)}we(e,t,n){let r=e.add(t.multiply(Oc.fromNumber(n)));return r.compare(zq)===1&&(r=new Oc([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=_P(e),[n,r]=bP(t);for(let s=0;s<this.hashCount;s++){const o=this.we(n,r,s);if(!this.be(o))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new VT(s,r,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(this.pe===0)return;const t=_P(e),[n,r]=bP(t);for(let s=0;s<this.hashCount;s++){const o=this.we(n,r,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class sy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,U0.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Y1(bt.min(),r,new Pn(Tt),Jl(),Nt())}}class U0{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new U0(n,t,Nt(),Nt(),Nt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e,t,n,r){this.De=e,this.removedTargetIds=t,this.key=n,this.ve=r}}class w3{constructor(e,t){this.targetId=e,this.Ce=t}}class _3{constructor(e,t,n=Wr.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class AP{constructor(){this.Fe=0,this.Me=EP(),this.xe=Wr.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Nt(),t=Nt(),n=Nt();return this.Me.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:dt(38017,{changeType:s})}}),new U0(this.xe,this.Oe,e,t,n)}Qe(){this.Ne=!1,this.Me=EP()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Wt(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class $q{constructor(e){this.ze=e,this.je=new Map,this.He=Jl(),this.Je=Sw(),this.Ye=Sw(),this.Ze=new Pn(Tt)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const n=this.rt(t);switch(e.state){case 0:this.it(t)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(t);break;case 3:this.it(t)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),n.ke(e.resumeToken));break;default:dt(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((n,r)=>{this.it(r)&&t(r)})}ot(e){const t=e.targetId,n=e.Ce.count,r=this._t(t);if(r){const s=r.target;if(Fx(s))if(n===0){const o=new ot(s.path);this.tt(t,o,ri.newNoDocument(o,bt.min()))}else Wt(n===1,20013,{expectedCount:n});else{const o=this.ut(t);if(o!==n){const a=this.ct(e),u=a?this.lt(a,e,o):1;if(u!==0){this.st(t);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,c)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=jc(n).toUint8Array()}catch(u){if(u instanceof zF)return Mm("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new VT(o,r,s)}catch(u){return Mm(u instanceof sy?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.pe===0?null:a}lt(e,t,n){return t.Ce.count===n-this.Tt(e,t.targetId)?0:2}Tt(e,t){const n=this.ze.getRemoteKeysForTarget(t);let r=0;return n.forEach(s=>{const o=this.ze.Pt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.tt(t,s,null),r++)}),r}It(e){const t=new Map;this.je.forEach((s,o)=>{const a=this._t(o);if(a){if(s.current&&Fx(a.target)){const u=new ot(a.target.path);this.Et(u).has(o)||this.dt(o,u)||this.tt(o,u,ri.newNoDocument(u,e))}s.Le&&(t.set(o,s.qe()),s.Qe())}});let n=Nt();this.Ye.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const c=this._t(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(s))}),this.He.forEach((s,o)=>o.setReadTime(e));const r=new Y1(e,t,this.Ze,this.He,n);return this.He=Jl(),this.Je=Sw(),this.Ye=Sw(),this.Ze=new Pn(Tt),r}et(e,t){if(!this.it(e))return;const n=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,n),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,n){if(!this.it(e))return;const r=this.rt(e);this.dt(e,t)?r.$e(t,1):r.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),n&&(this.He=this.He.insert(t,n))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new AP,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new fr(Tt),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new fr(Tt),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||Ue("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new AP),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Sw(){return new Pn(ot.comparator)}function EP(){return new Pn(ot.comparator)}const Wq={asc:"ASCENDING",desc:"DESCENDING"},Gq={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Kq={and:"AND",or:"OR"};class Jq{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Bx(i,e){return i.useProto3Json||z1(e)?e:{value:e}}function $_(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function b3(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function Yq(i,e){return $_(i,e.toTimestamp())}function Ea(i){return Wt(!!i,49232),bt.fromTimestamp(function(t){const n=Bc(t);return new Qn(n.seconds,n.nanos)}(i))}function HT(i,e){return jx(i,e).canonicalString()}function jx(i,e){const t=function(r){return new mn(["projects",r.projectId,"databases",r.database])}(i).child("documents");return e===void 0?t:t.child(e)}function A3(i){const e=mn.fromString(i);return Wt(I3(e),10190,{key:e.toString()}),e}function qx(i,e){return HT(i.databaseId,e.path)}function AE(i,e){const t=A3(e);if(t.get(1)!==i.databaseId.projectId)throw new $e(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new $e(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new ot(C3(t))}function E3(i,e){return HT(i.databaseId,e)}function Xq(i){const e=A3(i);return e.length===4?mn.emptyPath():C3(e)}function Ux(i){return new mn(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function C3(i){return Wt(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function CP(i,e,t){return{name:qx(i,e),fields:t.value.mapValue.fields}}function Qq(i,e){let t;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:dt(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(Wt(d===void 0||typeof d=="string",58123),Wr.fromBase64String(d||"")):(Wt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Wr.fromUint8Array(d||new Uint8Array))}(i,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?Ee.UNKNOWN:v3(c.code);return new $e(d,c.message||"")}(o);t=new _3(n,r,s,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=AE(i,n.document.name),s=Ea(n.document.updateTime),o=n.document.createTime?Ea(n.document.createTime):bt.min(),a=new Ui({mapValue:{fields:n.document.fields}}),u=ri.newFoundDocument(r,s,o,a),c=n.targetIds||[],d=n.removedTargetIds||[];t=new Kw(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=AE(i,n.document),s=n.readTime?Ea(n.readTime):bt.min(),o=ri.newNoDocument(r,s),a=n.removedTargetIds||[];t=new Kw([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=AE(i,n.document),s=n.removedTargetIds||[];t=new Kw([],s,r,null)}else{if(!("filter"in e))return dt(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:s}=n,o=new Vq(r,s),a=n.targetId;t=new w3(a,o)}}return t}function Zq(i,e){let t;if(e instanceof q0)t={update:CP(i,e.key,e.value)};else if(e instanceof qT)t={delete:qx(i,e.key)};else if(e instanceof Qc)t={update:CP(i,e.key,e.data),updateMask:lU(e.fieldMask)};else{if(!(e instanceof Bq))return dt(16599,{ft:e.type});t={verify:qx(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const a=o.transform;if(a instanceof Wy)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Gy)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ky)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof z_)return{fieldPath:o.field.canonicalString(),increment:a.Re};throw dt(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:Yq(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:dt(27497)}(i,e.precondition)),t}function eU(i,e){return i&&i.length>0?(Wt(e!==void 0,14353),i.map(t=>function(r,s){let o=r.updateTime?Ea(r.updateTime):Ea(s);return o.isEqual(bt.min())&&(o=Ea(s)),new Lq(o,r.transformResults||[])}(t,e))):[]}function tU(i,e){return{documents:[E3(i,e.path)]}}function x3(i,e){const t={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=E3(i,r);const s=function(c){if(c.length!==0)return T3(ko.create(c,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(d=>function(p){return{field:Ru(p.field),direction:sU(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Bx(i,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{gt:t,parent:r}}function nU(i,e,t,n){const{gt:r,parent:s}=x3(i,e),o={},a=[];let u=0;return t.forEach(c=>{const d="aggregate_"+u++;o[d]=c.alias,c.aggregateType==="count"?a.push({alias:d,count:{}}):c.aggregateType==="avg"?a.push({alias:d,avg:{field:Ru(c.fieldPath)}}):c.aggregateType==="sum"&&a.push({alias:d,sum:{field:Ru(c.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:r.structuredQuery},parent:r.parent},yt:o,parent:s}}function rU(i){let e=Xq(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){Wt(n===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(m){const p=S3(m);return p instanceof ko&&e3(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(m){return m.map(p=>function(w){return new $y(tp(w.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(m){let p;return p=typeof m=="object"?m.value:m,z1(p)?null:p}(t.limit));let u=null;t.startAt&&(u=function(m){const p=!!m.before,g=m.values||[];return new V_(g,p)}(t.startAt));let c=null;return t.endAt&&(c=function(m){const p=!m.before,g=m.values||[];return new V_(g,p)}(t.endAt)),bq(e,r,o,s,a,"F",u,c)}function iU(i,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return dt(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function S3(i){return i.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=tp(t.unaryFilter.field);return Yn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=tp(t.unaryFilter.field);return Yn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=tp(t.unaryFilter.field);return Yn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=tp(t.unaryFilter.field);return Yn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return dt(61313);default:return dt(60726)}}(i):i.fieldFilter!==void 0?function(t){return Yn.create(tp(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return dt(58110);default:return dt(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(t){return ko.create(t.compositeFilter.filters.map(n=>S3(n)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return dt(1026)}}(t.compositeFilter.op))}(i):dt(30097,{filter:i})}function sU(i){return Wq[i]}function oU(i){return Gq[i]}function aU(i){return Kq[i]}function Ru(i){return{fieldPath:i.canonicalString()}}function tp(i){return Vr.fromServerFormat(i.fieldPath)}function T3(i){return i instanceof Yn?function(t){if(t.op==="=="){if(hP(t.value))return{unaryFilter:{field:Ru(t.field),op:"IS_NAN"}};if(cP(t.value))return{unaryFilter:{field:Ru(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(hP(t.value))return{unaryFilter:{field:Ru(t.field),op:"IS_NOT_NAN"}};if(cP(t.value))return{unaryFilter:{field:Ru(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ru(t.field),op:oU(t.op),value:t.value}}}(i):i instanceof ko?function(t){const n=t.getFilters().map(r=>T3(r));return n.length===1?n[0]:{compositeFilter:{op:aU(t.op),filters:n}}}(i):dt(54877,{filter:i})}function lU(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function I3(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e,t,n,r,s=bt.min(),o=bt.min(),a=Wr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new kc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new kc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new kc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new kc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(e){this.wt=e}}function cU(i){const e=rU({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?H_(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{constructor(){this.Cn=new dU}addToCollectionParentIndex(e,t){return this.Cn.add(t),Ce.resolve()}getCollectionParents(e,t){return Ce.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Ce.resolve()}deleteFieldIndex(e,t){return Ce.resolve()}deleteAllFieldIndexes(e){return Ce.resolve()}createTargetIndexes(e,t){return Ce.resolve()}getDocumentsMatchingTarget(e,t){return Ce.resolve(null)}getIndexType(e,t){return Ce.resolve(0)}getFieldIndexes(e,t){return Ce.resolve([])}getNextCollectionGroupToUpdate(e){return Ce.resolve(null)}getMinOffset(e,t){return Ce.resolve(Mc.min())}getMinOffsetFromCollectionGroup(e,t){return Ce.resolve(Mc.min())}updateCollectionGroup(e,t,n){return Ce.resolve()}updateIndexEntries(e,t){return Ce.resolve()}}class dU{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new fr(mn.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new fr(mn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},D3=41943040;class qi{static withCacheSize(e){return new qi(e,qi.DEFAULT_COLLECTION_PERCENTILE,qi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qi.DEFAULT_COLLECTION_PERCENTILE=10,qi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qi.DEFAULT=new qi(D3,qi.DEFAULT_COLLECTION_PERCENTILE,qi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qi.DISABLED=new qi(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Um(0)}static lr(){return new Um(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SP="LruGarbageCollector",fU=1048576;function TP([i,e],[t,n]){const r=Tt(i,t);return r===0?Tt(e,n):r}class pU{constructor(e){this.Er=e,this.buffer=new fr(TP),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();TP(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class mU{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Ue(SP,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Km(t)?Ue(SP,"Ignoring IndexedDB error during garbage collection: ",t):await Gm(t)}await this.mr(3e5)})}}class gU{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return Ce.resolve(H1.le);const n=new pU(t);return this.gr.forEachTarget(e,r=>n.Rr(r.sequenceNumber)).next(()=>this.gr.yr(e,r=>n.Rr(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.gr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ue("LruGarbageCollector","Garbage collection skipped; disabled"),Ce.resolve(xP)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ue("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xP):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let n,r,s,o,a,u,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(Ue("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,o=Date.now(),this.nthSequenceNumber(e,r))).next(m=>(n=m,a=Date.now(),this.removeTargets(e,n,t))).next(m=>(s=m,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(m=>(c=Date.now(),Zf()<=Pt.DEBUG&&Ue("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${m} documents in `+(c-u)+`ms
Total Duration: ${c-d}ms`),Ce.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:m})))}}function yU(i,e){return new gU(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(){this.changes=new nf(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ri.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?Ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(n!==null&&Oy(n.mutation,r,ws.empty(),Qn.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Nt()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Nt()){const r=Fh();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(s=>{let o=iy();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Fh();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Nt()))}populateOverlays(e,t,n){const r=[];return n.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,r){let s=Jl();const o=Ny(),a=function(){return Ny()}();return t.forEach((u,c)=>{const d=n.get(c.key);r.has(c.key)&&(d===void 0||d.mutation instanceof Qc)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Oy(d.mutation,c,d.mutation.getFieldMask(),Qn.now())):o.set(c.key,ws.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,d)=>o.set(c,d)),t.forEach((c,d)=>{var m;return a.set(c,new wU(d,(m=o.get(c))!==null&&m!==void 0?m:null))}),a))}recalculateAndSaveOverlays(e,t){const n=Ny();let r=new Pn((o,a)=>o-a),s=Nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=t.get(u);if(c===null)return;let d=n.get(u)||ws.empty();d=a.applyToLocalView(c,d),n.set(u,d);const m=(r.get(a.batchId)||Nt()).add(u);r=r.insert(a.batchId,m)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,d=u.value,m=c3();d.forEach(p=>{if(!s.has(p)){const g=g3(t.get(p),n.get(p));g!==null&&m.set(p,g),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,m))}return Ce.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,r){return function(o){return ot.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):i3(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):Ce.resolve(Fh());let a=Uy,u=s;return o.next(c=>Ce.forEach(c,(d,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),s.get(d)?Ce.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{u=u.insert(d,p)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,Nt())).next(d=>({batchId:a,changes:u3(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ot(t)).next(n=>{let r=iy();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let o=iy();return this.indexManager.getCollectionParents(e,s).next(a=>Ce.forEach(a,u=>{const c=function(m,p){return new Jm(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,r).next(d=>{d.forEach((m,p)=>{o=o.insert(m,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(o=>{s.forEach((u,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,ri.newInvalidDocument(d)))});let a=iy();return o.forEach((u,c)=>{const d=s.get(u);d!==void 0&&Oy(d.mutation,c,ws.empty(),Qn.now()),G1(t,c)&&(a=a.insert(u,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bU{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return Ce.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:Ea(r.createTime)}}(t)),Ce.resolve()}getNamedQuery(e,t){return Ce.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(r){return{name:r.name,query:cU(r.bundledQuery),readTime:Ea(r.readTime)}}(t)),Ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(){this.overlays=new Pn(ot.comparator),this.Qr=new Map}getOverlay(e,t){return Ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Fh();return Ce.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,s)=>{this.St(e,t,s)}),Ce.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Qr.get(n);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Qr.delete(n)),Ce.resolve()}getOverlaysForCollection(e,t,n){const r=Fh(),s=t.length+1,o=new ot(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>n&&r.set(u.getKey(),u)}return Ce.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Pn((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>n){let d=s.get(c.largestBatchId);d===null&&(d=Fh(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Fh(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=r)););return Ce.resolve(a)}St(e,t,n){const r=this.overlays.get(n.key);if(r!==null){const o=this.Qr.get(r.largestBatchId).delete(n.key);this.Qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new qq(t,n));let s=this.Qr.get(t);s===void 0&&(s=Nt(),this.Qr.set(t,s)),this.Qr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(){this.sessionToken=Wr.EMPTY_BYTE_STRING}getSessionToken(e){return Ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(){this.$r=new fr(xr.Ur),this.Kr=new fr(xr.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const n=new xr(e,t);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.zr(new xr(e,t))}jr(e,t){e.forEach(n=>this.removeReference(n,t))}Hr(e){const t=new ot(new mn([])),n=new xr(t,e),r=new xr(t,e+1),s=[];return this.Kr.forEachInRange([n,r],o=>{this.zr(o),s.push(o.key)}),s}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new ot(new mn([])),n=new xr(t,e),r=new xr(t,e+1);let s=Nt();return this.Kr.forEachInRange([n,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new xr(e,0),n=this.$r.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class xr{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return ot.comparator(e.key,t.key)||Tt(e.Zr,t.Zr)}static Wr(e,t){return Tt(e.Zr,t.Zr)||ot.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new fr(xr.Ur)}checkEmpty(e){return Ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){const s=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new jq(s,t,n,r);this.mutationQueue.push(o);for(const a of r)this.Xr=this.Xr.add(new xr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Ce.resolve(o)}lookupMutationBatch(e,t){return Ce.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ti(n),s=r<0?0:r;return Ce.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Ce.resolve(this.mutationQueue.length===0?NT:this.nr-1)}getAllMutationBatches(e){return Ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new xr(t,0),r=new xr(t,Number.POSITIVE_INFINITY),s=[];return this.Xr.forEachInRange([n,r],o=>{const a=this.ei(o.Zr);s.push(a)}),Ce.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new fr(Tt);return t.forEach(r=>{const s=new xr(r,0),o=new xr(r,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([s,o],a=>{n=n.add(a.Zr)})}),Ce.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;ot.isDocumentKey(s)||(s=s.child(""));const o=new xr(new ot(s),0);let a=new fr(Tt);return this.Xr.forEachWhile(u=>{const c=u.key.path;return!!n.isPrefixOf(c)&&(c.length===r&&(a=a.add(u.Zr)),!0)},o),Ce.resolve(this.ni(a))}ni(e){const t=[];return e.forEach(n=>{const r=this.ei(n);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Wt(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Xr;return Ce.forEach(t.mutations,r=>{const s=new xr(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Xr=n})}sr(e){}containsKey(e,t){const n=new xr(t,0),r=this.Xr.firstAfterOrEqual(n);return Ce.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ce.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e){this.ii=e,this.docs=function(){return new Pn(ot.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,o=this.ii(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Ce.resolve(n?n.document.mutableCopy():ri.newInvalidDocument(t))}getEntries(e,t){let n=Jl();return t.forEach(r=>{const s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():ri.newInvalidDocument(r))}),Ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=Jl();const o=t.path,a=new ot(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Q8(X8(d),n)<=0||(r.has(d.key)||G1(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Ce.resolve(s)}getAllFromCollectionGroup(e,t,n,r){dt(9500)}si(e,t){return Ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new SU(this)}getSize(e){return Ce.resolve(this.size)}}class SU extends vU{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Br.addEntry(e,r)):this.Br.removeEntry(n)}),Ce.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TU{constructor(e){this.persistence=e,this.oi=new nf(t=>FT(t),MT),this.lastRemoteSnapshotVersion=bt.min(),this.highestTargetId=0,this._i=0,this.ai=new zT,this.targetCount=0,this.ui=Um.cr()}forEachTarget(e,t){return this.oi.forEach((n,r)=>t(r)),Ce.resolve()}getLastRemoteSnapshotVersion(e){return Ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ce.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),Ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this._i&&(this._i=t),Ce.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Um(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,Ce.resolve()}updateTargetData(e,t){return this.Tr(t),Ce.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,Ce.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.oi.forEach((o,a)=>{a.sequenceNumber<=t&&n.get(a.targetId)===null&&(this.oi.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),Ce.waitFor(s).next(()=>r)}getTargetCount(e){return Ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.oi.get(t)||null;return Ce.resolve(n)}addMatchingKeys(e,t,n){return this.ai.Gr(t,n),Ce.resolve()}removeMatchingKeys(e,t,n){this.ai.jr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),Ce.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),Ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ai.Yr(t);return Ce.resolve(n)}containsKey(e,t){return Ce.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(e,t){this.ci={},this.overlays={},this.li=new H1(0),this.hi=!1,this.hi=!0,this.Pi=new EU,this.referenceDelegate=e(this),this.Ti=new TU(this),this.indexManager=new hU,this.remoteDocumentCache=function(r){return new xU(r)}(n=>this.referenceDelegate.Ii(n)),this.serializer=new uU(t),this.Ei=new bU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new AU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ci[e.toKey()];return n||(n=new CU(t,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,n){Ue("MemoryPersistence","Starting transaction:",e);const r=new IU(this.li.next());return this.referenceDelegate.di(),n(r).next(s=>this.referenceDelegate.Ai(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ri(e,t){return Ce.or(Object.values(this.ci).map(n=>()=>n.containsKey(e,t)))}}class IU extends eq{constructor(e){super(),this.currentSequenceNumber=e}}class $T{constructor(e){this.persistence=e,this.Vi=new zT,this.mi=null}static fi(e){return new $T(e)}get gi(){if(this.mi)return this.mi;throw dt(60996)}addReference(e,t,n){return this.Vi.addReference(n,t),this.gi.delete(n.toString()),Ce.resolve()}removeReference(e,t,n){return this.Vi.removeReference(n,t),this.gi.add(n.toString()),Ce.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),Ce.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(r=>this.gi.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.gi.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ce.forEach(this.gi,n=>{const r=ot.fromPath(n);return this.pi(e,r).next(s=>{s||t.removeEntry(r,bt.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(n=>{n?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return Ce.or([()=>Ce.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class W_{constructor(e,t){this.persistence=e,this.yi=new nf(n=>rq(n.path),(n,r)=>n.isEqual(r)),this.garbageCollector=yU(this,t)}static fi(e,t){return new W_(e,t)}di(){}Ai(e){return Ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}br(e){let t=0;return this.yr(e,n=>{t++}).next(()=>t)}yr(e,t){return Ce.forEach(this.yi,(n,r)=>this.Dr(e,n,r).next(s=>s?Ce.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.si(e,o=>this.Dr(e,o,t).next(a=>{a||(n++,s.removeEntry(o,bt.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),Ce.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),Ce.resolve()}removeReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),Ce.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),Ce.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=$w(e.data.value)),t}Dr(e,t,n){return Ce.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.yi.get(t);return Ce.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.ds=n,this.As=r}static Rs(e,t){let n=Nt(),r=Nt();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new WT(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return b6()?8:tq(si())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.ws(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.bs(e,t,r,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new DU;return this.Ss(e,t,o).next(a=>{if(s.result=a,this.fs)return this.Ds(e,t,o,a.size)})}).next(()=>s.result)}Ds(e,t,n,r){return n.documentReadCount<this.gs?(Zf()<=Pt.DEBUG&&Ue("QueryEngine","SDK will not create cache indexes for query:",ep(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),Ce.resolve()):(Zf()<=Pt.DEBUG&&Ue("QueryEngine","Query:",ep(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ps*r?(Zf()<=Pt.DEBUG&&Ue("QueryEngine","The SDK decides to create cache indexes for query:",ep(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Aa(t))):Ce.resolve())}ws(e,t){if(mP(t))return Ce.resolve(null);let n=Aa(t);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=H_(t,null,"F"),n=Aa(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=Nt(...s);return this.ys.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(u=>{const c=this.vs(t,a);return this.Cs(t,c,o,u.readTime)?this.ws(e,H_(t,null,"F")):this.Fs(e,c,t,u)}))})))}bs(e,t,n,r){return mP(t)||r.isEqual(bt.min())?Ce.resolve(null):this.ys.getDocuments(e,n).next(s=>{const o=this.vs(t,s);return this.Cs(t,o,n,r)?Ce.resolve(null):(Zf()<=Pt.DEBUG&&Ue("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ep(t)),this.Fs(e,o,t,Y8(r,Uy)).next(a=>a))})}vs(e,t){let n=new fr(a3(e));return t.forEach((r,s)=>{G1(e,s)&&(n=n.add(s))}),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,n){return Zf()<=Pt.DEBUG&&Ue("QueryEngine","Using full collection scan to execute query:",ep(t)),this.ys.getDocumentsMatchingQuery(e,t,Mc.min(),n)}Fs(e,t,n,r){return this.ys.getDocumentsMatchingQuery(e,n,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT="LocalStore",RU=3e8;class PU{constructor(e,t,n,r){this.persistence=e,this.Ms=t,this.serializer=r,this.xs=new Pn(Tt),this.Os=new nf(s=>FT(s),MT),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _U(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function NU(i,e,t,n){return new PU(i,e,t,n)}async function R3(i,e){const t=wt(i);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(s=>(r=s,t.Ls(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let u=Nt();for(const c of r){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of s){a.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(n,u).next(c=>({ks:c,removedBatchIds:o,addedBatchIds:a}))})})}function OU(i,e){const t=wt(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),s=t.Bs.newChangeBuffer({trackRemovals:!0});return function(a,u,c,d){const m=c.batch,p=m.keys();let g=Ce.resolve();return p.forEach(w=>{g=g.next(()=>d.getEntry(u,w)).next(b=>{const A=c.docVersions.get(w);Wt(A!==null,48541),b.version.compareTo(A)<0&&(m.applyToRemoteDocument(b,c),b.isValidDocument()&&(b.setReadTime(c.commitVersion),d.addEntry(b)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(u,m))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let u=Nt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function P3(i){const e=wt(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function LU(i,e){const t=wt(i),n=e.snapshotVersion;let r=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Bs.newChangeBuffer({trackRemovals:!0});r=t.xs;const a=[];e.targetChanges.forEach((d,m)=>{const p=r.get(m);if(!p)return;a.push(t.Ti.removeMatchingKeys(s,d.removedDocuments,m).next(()=>t.Ti.addMatchingKeys(s,d.addedDocuments,m)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?g=g.withResumeToken(Wr.EMPTY_BYTE_STRING,bt.min()).withLastLimboFreeSnapshotVersion(bt.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,n)),r=r.insert(m,g),function(b,A,_){return b.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=RU?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(p,g,d)&&a.push(t.Ti.updateTargetData(s,g))});let u=Jl(),c=Nt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(FU(s,o,e.documentUpdates).next(d=>{u=d.qs,c=d.Qs})),!n.isEqual(bt.min())){const d=t.Ti.getLastRemoteSnapshotVersion(s).next(m=>t.Ti.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(d)}return Ce.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(t.xs=r,s))}function FU(i,e,t){let n=Nt(),r=Nt();return t.forEach(s=>n=n.add(s)),e.getEntries(i,n).next(s=>{let o=Jl();return t.forEach((a,u)=>{const c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),u.isNoDocument()&&u.version.isEqual(bt.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):Ue(GT,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{qs:o,Qs:r}})}function MU(i,e){const t=wt(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=NT),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function BU(i,e){const t=wt(i);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.Ti.getTargetData(n,e).next(s=>s?(r=s,Ce.resolve(r)):t.Ti.allocateTargetId(n).next(o=>(r=new kc(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Ti.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=t.xs.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.xs=t.xs.insert(n.targetId,n),t.Os.set(e,n.targetId)),n})}async function Vx(i,e,t){const n=wt(i),r=n.xs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Km(o))throw o;Ue(GT,`Failed to update sequence numbers for target ${e}: ${o}`)}n.xs=n.xs.remove(e),n.Os.delete(r.target)}function IP(i,e,t){const n=wt(i);let r=bt.min(),s=Nt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,d){const m=wt(u),p=m.Os.get(d);return p!==void 0?Ce.resolve(m.xs.get(p)):m.Ti.getTargetData(c,d)}(n,o,Aa(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,n.Ti.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>n.Ms.getDocumentsMatchingQuery(o,e,t?r:bt.min(),t?s:Nt())).next(a=>(jU(n,Eq(e),a),{documents:a,$s:s})))}function jU(i,e,t){let n=i.Ns.get(e)||bt.min();t.forEach((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),i.Ns.set(e,n)}class DP{constructor(){this.activeTargetIds=Dq()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qU{constructor(){this.xo=new DP,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,n){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new DP,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kP="ConnectivityMonitor";class RP{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Ue(kP,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Ue(kP,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tw=null;function Hx(){return Tw===null?Tw=function(){return 268435456+Math.round(2147483648*Math.random())}():Tw++,"0x"+Tw.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE="RestConnection",VU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class HU{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${n}/databases/${r}`,this.Go=this.databaseId.database===q_?`project_id=${n}`:`project_id=${n}&database_id=${r}`}zo(e,t,n,r,s){const o=Hx(),a=this.jo(e,t.toUriEncodedString());Ue(EE,`Sending RPC '${e}' ${o}:`,a,n);const u={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(u,r,s);const{host:c}=new URL(a),d=Yc(c);return this.Jo(e,a,u,n,d).then(m=>(Ue(EE,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Mm(EE,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",n),m})}Yo(e,t,n,r,s,o){return this.zo(e,t,n,r,s)}Ho(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Wm}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),n&&n.headers.forEach((r,s)=>e[s]=r)}jo(e,t){const n=VU[e];return`${this.Ko}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr="WebChannelConnection";class $U extends HU{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,s){const o=Hx();return new Promise((a,u)=>{const c=new NF;c.setWithCredentials(!0),c.listenOnce(OF.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case zw.NO_ERROR:const m=c.getResponseJson();Ue(Xr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case zw.TIMEOUT:Ue(Xr,`RPC '${e}' ${o} timed out`),u(new $e(Ee.DEADLINE_EXCEEDED,"Request time out"));break;case zw.HTTP_ERROR:const p=c.getStatus();if(Ue(Xr,`RPC '${e}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const w=g==null?void 0:g.error;if(w&&w.status&&w.message){const b=function(_){const C=_.toLowerCase().replace(/_/g,"-");return Object.values(Ee).indexOf(C)>=0?C:Ee.UNKNOWN}(w.status);u(new $e(b,w.message))}else u(new $e(Ee.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new $e(Ee.UNAVAILABLE,"Connection failed."));break;default:dt(9055,{h_:e,streamId:o,P_:c.getLastErrorCode(),T_:c.getLastError()})}}finally{Ue(Xr,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);Ue(Xr,`RPC '${e}' ${o} sending request:`,r),c.send(t,"POST",d,n,15)})}I_(e,t,n){const r=Hx(),s=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=MF(),a=FF(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Ho(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const d=s.join("");Ue(Xr,`Creating RPC '${e}' stream ${r}: ${d}`,u);const m=o.createWebChannel(d,u);this.E_(m);let p=!1,g=!1;const w=new zU({Zo:A=>{g?Ue(Xr,`Not sending because RPC '${e}' stream ${r} is closed:`,A):(p||(Ue(Xr,`Opening RPC '${e}' stream ${r} transport.`),m.open(),p=!0),Ue(Xr,`RPC '${e}' stream ${r} sending:`,A),m.send(A))},Xo:()=>m.close()}),b=(A,_,C)=>{A.listen(_,I=>{try{C(I)}catch(S){setTimeout(()=>{throw S},0)}})};return b(m,ry.EventType.OPEN,()=>{g||(Ue(Xr,`RPC '${e}' stream ${r} transport opened.`),w.__())}),b(m,ry.EventType.CLOSE,()=>{g||(g=!0,Ue(Xr,`RPC '${e}' stream ${r} transport closed`),w.u_(),this.d_(m))}),b(m,ry.EventType.ERROR,A=>{g||(g=!0,Mm(Xr,`RPC '${e}' stream ${r} transport errored. Name:`,A.name,"Message:",A.message),w.u_(new $e(Ee.UNAVAILABLE,"The operation could not be completed")))}),b(m,ry.EventType.MESSAGE,A=>{var _;if(!g){const C=A.data[0];Wt(!!C,16349);const I=C,S=(I==null?void 0:I.error)||((_=I[0])===null||_===void 0?void 0:_.error);if(S){Ue(Xr,`RPC '${e}' stream ${r} received error:`,S);const R=S.status;let L=function(D){const P=Kn[D];if(P!==void 0)return v3(P)}(R),k=S.message;L===void 0&&(L=Ee.INTERNAL,k="Unknown error status: "+R+" with message "+S.message),g=!0,w.u_(new $e(L,k)),m.close()}else Ue(Xr,`RPC '${e}' stream ${r} received:`,C),w.c_(C)}}),b(a,LF.STAT_EVENT,A=>{A.stat===Rx.PROXY?Ue(Xr,`RPC '${e}' stream ${r} detected buffering proxy`):A.stat===Rx.NOPROXY&&Ue(Xr,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{w.a_()},0),w}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function CE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X1(i){return new Jq(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(e,t,n=1e3,r=1.5,s=6e4){this.xi=e,this.timerId=t,this.A_=n,this.R_=r,this.V_=s,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),r=Math.max(0,t-n);r>0&&Ue("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,r,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PP="PersistentStream";class O3{constructor(e,t,n,r,s,o,a,u){this.xi=e,this.S_=n,this.D_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new N3(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===Ee.RESOURCE_EXHAUSTED?(Kl(t.toString()),Kl("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===Ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.v_===t&&this.z_(n,r)},n=>{e(()=>{const r=new $e(Ee.UNKNOWN,"Fetching auth token failed: "+n.message);return this.j_(r)})})}z_(e,t){const n=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{n(()=>this.listener.e_())}),this.stream.n_(()=>{n(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(r=>{n(()=>this.j_(r))}),this.stream.onMessage(r=>{n(()=>++this.M_==1?this.J_(r):this.onNext(r))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Ue(PP,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(Ue(PP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class WU extends O3{constructor(e,t,n,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=Qq(this.serializer,e),n=function(s){if(!("targetChange"in s))return bt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?bt.min():o.readTime?Ea(o.readTime):bt.min()}(e);return this.listener.Y_(t,n)}Z_(e){const t={};t.database=Ux(this.serializer),t.addTarget=function(s,o){let a;const u=o.target;if(a=Fx(u)?{documents:tU(s,u)}:{query:x3(s,u).gt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=b3(s,o.resumeToken);const c=Bx(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(bt.min())>0){a.readTime=$_(s,o.snapshotVersion.toTimestamp());const c=Bx(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const n=iU(this.serializer,e);n&&(t.labels=n),this.Q_(t)}X_(e){const t={};t.database=Ux(this.serializer),t.removeTarget=e,this.Q_(t)}}class GU extends O3{constructor(e,t,n,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Wt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Wt(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Wt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=eU(e.writeResults,e.commitTime),n=Ea(e.commitTime);return this.listener.ra(n,t)}ia(){const e={};e.database=Ux(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>Zq(this.serializer,n))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KU{}class JU extends KU{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.sa=!1}oa(){if(this.sa)throw new $e(Ee.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,n,r){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.zo(e,jx(t,n),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $e(Ee.UNKNOWN,s.toString())})}Yo(e,t,n,r,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Yo(e,jx(t,n),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $e(Ee.UNKNOWN,o.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class YU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Kl(t),this.ua=!1):Ue("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gd="RemoteStore";class XU{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=s,this.Ra.No(o=>{n.enqueueAndForget(async()=>{rf(this)&&(Ue(Gd,"Restarting streams for network reachability change."),await async function(u){const c=wt(u);c.da.add(4),await V0(c),c.Va.set("Unknown"),c.da.delete(4),await Q1(c)}(this))})}),this.Va=new YU(n,r)}}async function Q1(i){if(rf(i))for(const e of i.Aa)await e(!0)}async function V0(i){for(const e of i.Aa)await e(!1)}function L3(i,e){const t=wt(i);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),XT(t)?YT(t):Ym(t).N_()&&JT(t,e))}function KT(i,e){const t=wt(i),n=Ym(t);t.Ea.delete(e),n.N_()&&F3(t,e),t.Ea.size===0&&(n.N_()?n.k_():rf(t)&&t.Va.set("Unknown"))}function JT(i,e){if(i.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(bt.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ym(i).Z_(e)}function F3(i,e){i.ma.Ke(e),Ym(i).X_(e)}function YT(i){i.ma=new $q({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>i.Ea.get(e)||null,Pt:()=>i.datastore.serializer.databaseId}),Ym(i).start(),i.Va.ca()}function XT(i){return rf(i)&&!Ym(i).O_()&&i.Ea.size>0}function rf(i){return wt(i).da.size===0}function M3(i){i.ma=void 0}async function QU(i){i.Va.set("Online")}async function ZU(i){i.Ea.forEach((e,t)=>{JT(i,e)})}async function eV(i,e){M3(i),XT(i)?(i.Va.Pa(e),YT(i)):i.Va.set("Unknown")}async function tV(i,e,t){if(i.Va.set("Online"),e instanceof _3&&e.state===2&&e.cause)try{await async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ea.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ea.delete(a),r.ma.removeTarget(a))}(i,e)}catch(n){Ue(Gd,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await G_(i,n)}else if(e instanceof Kw?i.ma.Xe(e):e instanceof w3?i.ma.ot(e):i.ma.nt(e),!t.isEqual(bt.min()))try{const n=await P3(i.localStore);t.compareTo(n)>=0&&await function(s,o){const a=s.ma.It(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.Ea.get(c);d&&s.Ea.set(c,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{const d=s.Ea.get(u);if(!d)return;s.Ea.set(u,d.withResumeToken(Wr.EMPTY_BYTE_STRING,d.snapshotVersion)),F3(s,u);const m=new kc(d.target,u,c,d.sequenceNumber);JT(s,m)}),s.remoteSyncer.applyRemoteEvent(a)}(i,t)}catch(n){Ue(Gd,"Failed to raise snapshot:",n),await G_(i,n)}}async function G_(i,e,t){if(!Km(e))throw e;i.da.add(1),await V0(i),i.Va.set("Offline"),t||(t=()=>P3(i.localStore)),i.asyncQueue.enqueueRetryable(async()=>{Ue(Gd,"Retrying IndexedDB access"),await t(),i.da.delete(1),await Q1(i)})}function B3(i,e){return e().catch(t=>G_(i,t,e))}async function Z1(i){const e=wt(i),t=Uc(e);let n=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:NT;for(;nV(e);)try{const r=await MU(e.localStore,n);if(r===null){e.Ia.length===0&&t.k_();break}n=r.batchId,rV(e,r)}catch(r){await G_(e,r)}j3(e)&&q3(e)}function nV(i){return rf(i)&&i.Ia.length<10}function rV(i,e){i.Ia.push(e);const t=Uc(i);t.N_()&&t.ea&&t.ta(e.mutations)}function j3(i){return rf(i)&&!Uc(i).O_()&&i.Ia.length>0}function q3(i){Uc(i).start()}async function iV(i){Uc(i).ia()}async function sV(i){const e=Uc(i);for(const t of i.Ia)e.ta(t.mutations)}async function oV(i,e,t){const n=i.Ia.shift(),r=UT.from(n,e,t);await B3(i,()=>i.remoteSyncer.applySuccessfulWrite(r)),await Z1(i)}async function aV(i,e){e&&Uc(i).ea&&await async function(n,r){if(function(o){return Hq(o)&&o!==Ee.ABORTED}(r.code)){const s=n.Ia.shift();Uc(n).L_(),await B3(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r)),await Z1(n)}}(i,e),j3(i)&&q3(i)}async function NP(i,e){const t=wt(i);t.asyncQueue.verifyOperationInProgress(),Ue(Gd,"RemoteStore received new credentials");const n=rf(t);t.da.add(3),await V0(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await Q1(t)}async function lV(i,e){const t=wt(i);e?(t.da.delete(2),await Q1(t)):e||(t.da.add(2),await V0(t),t.Va.set("Unknown"))}function Ym(i){return i.fa||(i.fa=function(t,n,r){const s=wt(t);return s.oa(),new WU(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(i.datastore,i.asyncQueue,{e_:QU.bind(null,i),n_:ZU.bind(null,i),i_:eV.bind(null,i),Y_:tV.bind(null,i)}),i.Aa.push(async e=>{e?(i.fa.L_(),XT(i)?YT(i):i.Va.set("Unknown")):(await i.fa.stop(),M3(i))})),i.fa}function Uc(i){return i.ga||(i.ga=function(t,n,r){const s=wt(t);return s.oa(),new GU(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(i.datastore,i.asyncQueue,{e_:()=>Promise.resolve(),n_:iV.bind(null,i),i_:aV.bind(null,i),na:sV.bind(null,i),ra:oV.bind(null,i)}),i.Aa.push(async e=>{e?(i.ga.L_(),await Z1(i)):(await i.ga.stop(),i.Ia.length>0&&(Ue(Gd,`Stopping write stream with ${i.Ia.length} pending writes`),i.Ia=[]))})),i.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new Ul,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const o=Date.now()+n,a=new QT(e,t,o,r,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(Ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ZT(i,e){if(Kl("AsyncQueue",`${e}: ${i}`),Km(i))return new $e(Ee.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{static emptySet(e){return new mp(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||ot.comparator(t.key,n.key):(t,n)=>ot.comparator(t.key,n.key),this.keyedMap=iy(),this.sortedSet=new Pn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof mp)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new mp;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(){this.pa=new Pn(ot.comparator)}track(e){const t=e.doc.key,n=this.pa.get(t);n?e.type!==0&&n.type===3?this.pa=this.pa.insert(t,e):e.type===3&&n.type!==1?this.pa=this.pa.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.pa=this.pa.remove(t):e.type===1&&n.type===2?this.pa=this.pa.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):dt(63341,{Vt:e,ya:n}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,n)=>{e.push(n)}),e}}class Vm{constructor(e,t,n,r,s,o,a,u,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Vm(e,t,mp.emptySet(t),o,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&W1(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class cV{constructor(){this.queries=LP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const r=wt(t),s=r.queries;r.queries=LP(),s.forEach((o,a)=>{for(const u of a.Sa)u.onError(n)})})(this,new $e(Ee.ABORTED,"Firestore shutting down"))}}function LP(){return new nf(i=>o3(i),W1)}async function U3(i,e){const t=wt(i);let n=3;const r=e.query;let s=t.queries.get(r);s?!s.Da()&&e.va()&&(n=2):(s=new uV,n=e.va()?0:1);try{switch(n){case 0:s.ba=await t.onListen(r,!0);break;case 1:s.ba=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=ZT(o,`Initialization of query '${ep(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.Sa.push(e),e.Fa(t.onlineState),s.ba&&e.Ma(s.ba)&&eI(t)}async function V3(i,e){const t=wt(i),n=e.query;let r=3;const s=t.queries.get(n);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?r=e.va()?0:1:!s.Da()&&e.va()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function hV(i,e){const t=wt(i);let n=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.Sa)a.Ma(r)&&(n=!0);o.ba=r}}n&&eI(t)}function dV(i,e,t){const n=wt(i),r=n.queries.get(e);if(r)for(const s of r.Sa)s.onError(t);n.queries.delete(e)}function eI(i){i.Ca.forEach(e=>{e.next()})}var zx,FP;(FP=zx||(zx={})).xa="default",FP.Cache="cache";class H3{constructor(e,t,n){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new Vm(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const n=t!=="Offline";return(!this.options.Qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=Vm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==zx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e){this.key=e}}class $3{constructor(e){this.key=e}}class fV{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Nt(),this.mutatedKeys=Nt(),this.Za=a3(e),this.Xa=new mp(this.Za)}get eu(){return this.Ha}tu(e,t){const n=t?t.nu:new OP,r=t?t.Xa:this.Xa;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,m)=>{const p=r.get(d),g=G1(this.query,m)?m:null,w=!!p&&this.mutatedKeys.has(p.key),b=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let A=!1;p&&g?p.data.isEqual(g.data)?w!==b&&(n.track({type:3,doc:g}),A=!0):this.ru(p,g)||(n.track({type:2,doc:g}),A=!0,(u&&this.Za(g,u)>0||c&&this.Za(g,c)<0)&&(a=!0)):!p&&g?(n.track({type:0,doc:g}),A=!0):p&&!g&&(n.track({type:1,doc:p}),A=!0,(u||c)&&(a=!0)),A&&(g?(o=o.add(g),s=b?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Xa:o,nu:n,Cs:a,mutatedKeys:s}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const o=e.nu.wa();o.sort((d,m)=>function(g,w){const b=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dt(20277,{Vt:A})}};return b(g)-b(w)}(d.type,m.type)||this.Za(d.doc,m.doc)),this.iu(n),r=r!=null&&r;const a=t&&!r?this.su():[],u=this.Ya.size===0&&this.current&&!r?1:0,c=u!==this.Ja;return this.Ja=u,o.length!==0||c?{snapshot:new Vm(this.query,e.Xa,s,o,e.mutatedKeys,u===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:a}:{ou:a}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new OP,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Nt(),this.Xa.forEach(n=>{this._u(n.key)&&(this.Ya=this.Ya.add(n.key))});const t=[];return e.forEach(n=>{this.Ya.has(n)||t.push(new $3(n))}),this.Ya.forEach(n=>{e.has(n)||t.push(new z3(n))}),t}au(e){this.Ha=e.$s,this.Ya=Nt();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return Vm.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const tI="SyncEngine";class pV{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class mV{constructor(e){this.key=e,this.cu=!1}}class gV{constructor(e,t,n,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.lu={},this.hu=new nf(a=>o3(a),W1),this.Pu=new Map,this.Tu=new Set,this.Iu=new Pn(ot.comparator),this.Eu=new Map,this.du=new zT,this.Au={},this.Ru=new Map,this.Vu=Um.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function yV(i,e,t=!0){const n=X3(i);let r;const s=n.hu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.uu()):r=await W3(n,e,t,!0),r}async function vV(i,e){const t=X3(i);await W3(t,e,!0,!1)}async function W3(i,e,t,n){const r=await BU(i.localStore,Aa(e)),s=r.targetId,o=i.sharedClientState.addLocalQueryTarget(s,t);let a;return n&&(a=await wV(i,e,s,o==="current",r.resumeToken)),i.isPrimaryClient&&t&&L3(i.remoteStore,r),a}async function wV(i,e,t,n,r){i.fu=(m,p,g)=>async function(b,A,_,C){let I=A.view.tu(_);I.Cs&&(I=await IP(b.localStore,A.query,!1).then(({documents:k})=>A.view.tu(k,I)));const S=C&&C.targetChanges.get(A.targetId),R=C&&C.targetMismatches.get(A.targetId)!=null,L=A.view.applyChanges(I,b.isPrimaryClient,S,R);return BP(b,A.targetId,L.ou),L.snapshot}(i,m,p,g);const s=await IP(i.localStore,e,!0),o=new fV(e,s.$s),a=o.tu(s.documents),u=U0.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",r),c=o.applyChanges(a,i.isPrimaryClient,u);BP(i,t,c.ou);const d=new pV(e,t,o);return i.hu.set(e,d),i.Pu.has(t)?i.Pu.get(t).push(e):i.Pu.set(t,[e]),c.snapshot}async function _V(i,e,t){const n=wt(i),r=n.hu.get(e),s=n.Pu.get(r.targetId);if(s.length>1)return n.Pu.set(r.targetId,s.filter(o=>!W1(o,e))),void n.hu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Vx(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),t&&KT(n.remoteStore,r.targetId),$x(n,r.targetId)}).catch(Gm)):($x(n,r.targetId),await Vx(n.localStore,r.targetId,!0))}async function bV(i,e){const t=wt(i),n=t.hu.get(e),r=t.Pu.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),KT(t.remoteStore,n.targetId))}async function AV(i,e,t){const n=DV(i);try{const r=await function(o,a){const u=wt(o),c=Qn.now(),d=a.reduce((g,w)=>g.add(w.key),Nt());let m,p;return u.persistence.runTransaction("Locally write mutations","readwrite",g=>{let w=Jl(),b=Nt();return u.Bs.getEntries(g,d).next(A=>{w=A,w.forEach((_,C)=>{C.isValidDocument()||(b=b.add(_))})}).next(()=>u.localDocuments.getOverlayedDocuments(g,w)).next(A=>{m=A;const _=[];for(const C of a){const I=Mq(C,m.get(C.key).overlayedDocument);I!=null&&_.push(new Qc(C.key,I,XF(I.value.mapValue),Do.exists(!0)))}return u.mutationQueue.addMutationBatch(g,c,_,a)}).next(A=>{p=A;const _=A.applyToLocalDocumentSet(m,b);return u.documentOverlayCache.saveOverlays(g,A.batchId,_)})}).then(()=>({batchId:p.batchId,changes:u3(m)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(o,a,u){let c=o.Au[o.currentUser.toKey()];c||(c=new Pn(Tt)),c=c.insert(a,u),o.Au[o.currentUser.toKey()]=c}(n,r.batchId,t),await H0(n,r.changes),await Z1(n.remoteStore)}catch(r){const s=ZT(r,"Failed to persist write");t.reject(s)}}async function G3(i,e){const t=wt(i);try{const n=await LU(t.localStore,e);e.targetChanges.forEach((r,s)=>{const o=t.Eu.get(s);o&&(Wt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.cu=!0:r.modifiedDocuments.size>0?Wt(o.cu,14607):r.removedDocuments.size>0&&(Wt(o.cu,42227),o.cu=!1))}),await H0(t,n,e)}catch(n){await Gm(n)}}function MP(i,e,t){const n=wt(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const r=[];n.hu.forEach((s,o)=>{const a=o.view.Fa(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const u=wt(o);u.onlineState=a;let c=!1;u.queries.forEach((d,m)=>{for(const p of m.Sa)p.Fa(a)&&(c=!0)}),c&&eI(u)}(n.eventManager,e),r.length&&n.lu.Y_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function EV(i,e,t){const n=wt(i);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.Eu.get(e),s=r&&r.key;if(s){let o=new Pn(ot.comparator);o=o.insert(s,ri.newNoDocument(s,bt.min()));const a=Nt().add(s),u=new Y1(bt.min(),new Map,new Pn(Tt),o,a);await G3(n,u),n.Iu=n.Iu.remove(s),n.Eu.delete(e),nI(n)}else await Vx(n.localStore,e,!1).then(()=>$x(n,e,t)).catch(Gm)}async function CV(i,e){const t=wt(i),n=e.batch.batchId;try{const r=await OU(t.localStore,e);J3(t,n,null),K3(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await H0(t,r)}catch(r){await Gm(r)}}async function xV(i,e,t){const n=wt(i);try{const r=await function(o,a){const u=wt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return u.mutationQueue.lookupMutationBatch(c,a).next(m=>(Wt(m!==null,37113),d=m.keys(),u.mutationQueue.removeMutationBatch(c,m))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>u.localDocuments.getDocuments(c,d))})}(n.localStore,e);J3(n,e,t),K3(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await H0(n,r)}catch(r){await Gm(r)}}function K3(i,e){(i.Ru.get(e)||[]).forEach(t=>{t.resolve()}),i.Ru.delete(e)}function J3(i,e,t){const n=wt(i);let r=n.Au[n.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),n.Au[n.currentUser.toKey()]=r}}function $x(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.Pu.get(e))i.hu.delete(n),t&&i.lu.gu(n,t);i.Pu.delete(e),i.isPrimaryClient&&i.du.Hr(e).forEach(n=>{i.du.containsKey(n)||Y3(i,n)})}function Y3(i,e){i.Tu.delete(e.path.canonicalString());const t=i.Iu.get(e);t!==null&&(KT(i.remoteStore,t),i.Iu=i.Iu.remove(e),i.Eu.delete(t),nI(i))}function BP(i,e,t){for(const n of t)n instanceof z3?(i.du.addReference(n.key,e),SV(i,n)):n instanceof $3?(Ue(tI,"Document no longer in limbo: "+n.key),i.du.removeReference(n.key,e),i.du.containsKey(n.key)||Y3(i,n.key)):dt(19791,{pu:n})}function SV(i,e){const t=e.key,n=t.path.canonicalString();i.Iu.get(t)||i.Tu.has(n)||(Ue(tI,"New document in limbo: "+t),i.Tu.add(n),nI(i))}function nI(i){for(;i.Tu.size>0&&i.Iu.size<i.maxConcurrentLimboResolutions;){const e=i.Tu.values().next().value;i.Tu.delete(e);const t=new ot(mn.fromString(e)),n=i.Vu.next();i.Eu.set(n,new mV(t)),i.Iu=i.Iu.insert(t,n),L3(i.remoteStore,new kc(Aa(BT(t.path)),n,"TargetPurposeLimboResolution",H1.le))}}async function H0(i,e,t){const n=wt(i),r=[],s=[],o=[];n.hu.isEmpty()||(n.hu.forEach((a,u)=>{o.push(n.fu(u,e,t).then(c=>{var d;if((c||t)&&n.isPrimaryClient){const m=c?!c.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(c){r.push(c);const m=WT.Rs(u.targetId,c);s.push(m)}}))}),await Promise.all(o),n.lu.Y_(r),await async function(u,c){const d=wt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Ce.forEach(c,p=>Ce.forEach(p.ds,g=>d.persistence.referenceDelegate.addReference(m,p.targetId,g)).next(()=>Ce.forEach(p.As,g=>d.persistence.referenceDelegate.removeReference(m,p.targetId,g)))))}catch(m){if(!Km(m))throw m;Ue(GT,"Failed to update sequence numbers: "+m)}for(const m of c){const p=m.targetId;if(!m.fromCache){const g=d.xs.get(p),w=g.snapshotVersion,b=g.withLastLimboFreeSnapshotVersion(w);d.xs=d.xs.insert(p,b)}}}(n.localStore,s))}async function TV(i,e){const t=wt(i);if(!t.currentUser.isEqual(e)){Ue(tI,"User change. New user:",e.toKey());const n=await R3(t.localStore,e);t.currentUser=e,function(s,o){s.Ru.forEach(a=>{a.forEach(u=>{u.reject(new $e(Ee.CANCELLED,o))})}),s.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await H0(t,n.ks)}}function IV(i,e){const t=wt(i),n=t.Eu.get(e);if(n&&n.cu)return Nt().add(n.key);{let r=Nt();const s=t.Pu.get(e);if(!s)return r;for(const o of s){const a=t.hu.get(o);r=r.unionWith(a.view.eu)}return r}}function X3(i){const e=wt(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=G3.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=IV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=EV.bind(null,e),e.lu.Y_=hV.bind(null,e.eventManager),e.lu.gu=dV.bind(null,e.eventManager),e}function DV(i){const e=wt(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xV.bind(null,e),e}class K_{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=X1(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return NU(this.persistence,new kU,e.initialUser,this.serializer)}Su(e){return new k3($T.fi,this.serializer)}bu(e){return new qU}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}K_.provider={build:()=>new K_};class kV extends K_{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Wt(this.persistence.referenceDelegate instanceof W_,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new mU(n,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?qi.withCacheSize(this.cacheSizeBytes):qi.DEFAULT;return new k3(n=>W_.fi(n,t),this.serializer)}}class Wx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>MP(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=TV.bind(null,this.syncEngine),await lV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new cV}()}createDatastore(e){const t=X1(e.databaseInfo.databaseId),n=function(s){return new $U(s)}(e.databaseInfo);return function(s,o,a,u){return new JU(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,r,s,o,a){return new XU(n,r,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>MP(this.syncEngine,t,0),function(){return RP.C()?new RP:new UU}())}createSyncEngine(e,t){return function(r,s,o,a,u,c,d){const m=new gV(r,s,o,a,u,c);return d&&(m.mu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const s=wt(r);Ue(Gd,"RemoteStore shutting down."),s.da.add(5),await V0(s),s.Ra.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Wx.provider={build:()=>new Wx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Kl("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc="FirestoreClient";class RV{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ni.UNAUTHENTICATED,this.clientId=UF.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{Ue(Vc,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Ue(Vc,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ul;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=ZT(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function xE(i,e){i.asyncQueue.verifyOperationInProgress(),Ue(Vc,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener(async r=>{n.isEqual(r)||(await R3(e.localStore,r),n=r)}),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i._offlineComponents=e}async function jP(i,e){i.asyncQueue.verifyOperationInProgress();const t=await PV(i);Ue(Vc,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener(n=>NP(e.remoteStore,n)),i.setAppCheckTokenChangeListener((n,r)=>NP(e.remoteStore,r)),i._onlineComponents=e}async function PV(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){Ue(Vc,"Using user provided OfflineComponentProvider");try{await xE(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===Ee.FAILED_PRECONDITION||r.code===Ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Mm("Error using user provided cache. Falling back to memory cache: "+t),await xE(i,new K_)}}else Ue(Vc,"Using default OfflineComponentProvider"),await xE(i,new kV(void 0));return i._offlineComponents}async function rI(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(Ue(Vc,"Using user provided OnlineComponentProvider"),await jP(i,i._uninitializedComponentsProvider._online)):(Ue(Vc,"Using default OnlineComponentProvider"),await jP(i,new Wx))),i._onlineComponents}function NV(i){return rI(i).then(e=>e.syncEngine)}function OV(i){return rI(i).then(e=>e.datastore)}async function Gx(i){const e=await rI(i),t=e.eventManager;return t.onListen=yV.bind(null,e.syncEngine),t.onUnlisten=_V.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=vV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=bV.bind(null,e.syncEngine),t}function LV(i,e,t={}){const n=new Ul;return i.asyncQueue.enqueueAndForget(async()=>function(s,o,a,u,c){const d=new Q3({next:p=>{d.xu(),o.enqueueAndForget(()=>V3(s,m)),p.fromCache&&u.source==="server"?c.reject(new $e(Ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),m=new H3(a,d,{includeMetadataChanges:!0,Qa:!0});return U3(s,m)}(await Gx(i),i.asyncQueue,e,t,n)),n.promise}function FV(i,e,t){const n=new Ul;return i.asyncQueue.enqueueAndForget(async()=>{try{const r=await OV(i);n.resolve(async function(o,a,u){var c;const d=wt(o),{request:m,yt:p,parent:g}=nU(d.serializer,Aq(a),u);d.connection.Uo||delete m.parent;const w=(await d.Yo("RunAggregationQuery",d.serializer.databaseId,g,m,1)).filter(A=>!!A.result);Wt(w.length===1,64727);const b=(c=w[0].result)===null||c===void 0?void 0:c.aggregateFields;return Object.keys(b).reduce((A,_)=>(A[p[_]]=b[_],A),{})}(r,e,t))}catch(r){n.reject(r)}}),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z3(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qP=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eM(i,e,t){if(!t)throw new $e(Ee.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function MV(i,e,t,n){if(e===!0&&n===!0)throw new $e(Ee.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function UP(i){if(!ot.isDocumentKey(i))throw new $e(Ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function VP(i){if(ot.isDocumentKey(i))throw new $e(Ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function eb(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":dt(12329,{type:typeof i})}function Ks(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new $e(Ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=eb(i);throw new $e(Ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function BV(i,e){if(e<=0)throw new $e(Ee.INVALID_ARGUMENT,`Function ${i}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM="firestore.googleapis.com",HP=!0;class zP{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new $e(Ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=tM,this.ssl=HP}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:HP;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=D3;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<fU)throw new $e(Ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}MV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Z3((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new $e(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new $e(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new $e(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tb{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zP({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $e(Ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $e(Ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zP(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new U8;switch(n.type){case"firstParty":return new $8(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $e(Ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=qP.get(t);n&&(Ue("ComponentProvider","Removing Datastore"),qP.delete(t),n.terminate())}(this),Promise.resolve()}}function jV(i,e,t,n={}){var r;i=Ks(i,tb);const s=Yc(e),o=i._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:i._getEmulatorOptions()}),u=`${e}:${t}`;s&&(TT(`https://${u}`),IT("Firestore",!0)),o.host!==tM&&o.host!==u&&Mm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:u,ssl:s,emulatorOptions:n});if(!zd(c,a)&&(i._setSettings(c),n.mockUserToken)){let d,m;if(typeof n.mockUserToken=="string")d=n.mockUserToken,m=ni.MOCK_USER;else{d=SF(n.mockUserToken,(r=i._app)===null||r===void 0?void 0:r.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new $e(Ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new ni(p)}i._authCredentials=new V8(new jF(d,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new eu(this.firestore,e,this._query)}}class _i{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _i(this.firestore,e,this._key)}}class Lc extends eu{constructor(e,t,n){super(e,t,BT(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _i(this.firestore,null,new ot(e))}withConverter(e){return new Lc(this.firestore,e,this._path)}}function qV(i,e,...t){if(i=hn(i),eM("collection","path",e),i instanceof tb){const n=mn.fromString(e,...t);return VP(n),new Lc(i,null,n)}{if(!(i instanceof _i||i instanceof Lc))throw new $e(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(mn.fromString(e,...t));return VP(n),new Lc(i.firestore,null,n)}}function UV(i,e,...t){if(i=hn(i),arguments.length===1&&(e=UF.newId()),eM("doc","path",e),i instanceof tb){const n=mn.fromString(e,...t);return UP(n),new _i(i,null,new ot(n))}{if(!(i instanceof _i||i instanceof Lc))throw new $e(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(mn.fromString(e,...t));return UP(n),new _i(i.firestore,i instanceof Lc?i.converter:null,new ot(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $P="AsyncQueue";class WP{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new N3(this,"async_queue_retry"),this.rc=()=>{const n=CE();n&&Ue($P,"Visibility state changed to "+n.visibilityState),this.x_.b_()},this.sc=e;const t=CE();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=CE();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Ul;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!Km(e))throw e;Ue($P,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(n=>{throw this.Xu=n,this.ec=!1,Kl("INTERNAL UNHANDLED ERROR: ",GP(n)),n}).then(n=>(this.ec=!1,n))));return this.sc=t,t}enqueueAfterDelay(e,t,n){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const r=QT.createAndSchedule(this,e,t,n,s=>this.uc(s));return this.Zu.push(r),r}oc(){this.Xu&&dt(47125,{cc:GP(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function GP(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KP(i){return function(t,n){if(typeof t!="object"||t===null)return!1;const r=t;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(i,["next","error","complete"])}class Hc extends tb{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new WP,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new WP(e),this._firestoreClient=void 0,await e}}}function VV(i,e){const t=typeof i=="object"?i:RT(),n=typeof i=="string"?i:q_,r=V1(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const s=EF("firestore");s&&jV(r,...s)}return r}function nb(i){if(i._terminated)throw new $e(Ee.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||HV(i),i._firestoreClient}function HV(i){var e,t,n;const r=i._freezeSettings(),s=function(a,u,c,d){return new aq(a,u,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Z3(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(i._databaseId,((e=i._app)===null||e===void 0?void 0:e.options.appId)||"",i._persistenceKey,r);i._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=r.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(i._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),i._firestoreClient=new RV(i._authCredentials,i._appCheckCredentials,i._queue,s,i._componentsProvider&&function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}}(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class $V{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Hm(Wr.fromBase64String(e))}catch(t){throw new $e(Ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Hm(Wr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new $e(Ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new $e(Ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new $e(Ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Tt(this._lat,e._lat)||Tt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,r){if(n.length!==r.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==r[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WV=/^__.*__$/;class GV{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Qc(e,this.data,this.fieldMask,t,this.fieldTransforms):new q0(e,this.data,t,this.fieldTransforms)}}class nM{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Qc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function rM(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dt(40011,{Ic:i})}}class oI{constructor(e,t,n,r,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,s===void 0&&this.Ec(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new oI(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.dc({path:n,Rc:!1});return r.Vc(e),r}mc(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.dc({path:n,Rc:!1});return r.Ec(),r}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return J_(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(rM(this.Ic)&&WV.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class KV{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||X1(e)}bc(e,t,n,r=!1){return new oI({Ic:e,methodName:t,wc:n,path:Vr.emptyPath(),Rc:!1,yc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function aI(i){const e=i._freezeSettings(),t=X1(i._databaseId);return new KV(i._databaseId,!!e.ignoreUndefinedProperties,t)}function JV(i,e,t,n,r,s={}){const o=i.bc(s.merge||s.mergeFields?2:0,e,t,r);uI("Data must be an object, but it was:",o,n);const a=iM(n,o);let u,c;if(s.merge)u=new ws(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const m of s.mergeFields){const p=Kx(e,m,t);if(!o.contains(p))throw new $e(Ee.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);oM(d,p)||d.push(p)}u=new ws(d),c=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,c=o.fieldTransforms;return new GV(new Ui(a),u,c)}class sb extends ib{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sb}}class lI extends ib{_toFieldTransform(e){return new Nq(e.path,new Wy)}isEqual(e){return e instanceof lI}}function YV(i,e,t,n){const r=i.bc(1,e,t);uI("Data must be an object, but it was:",r,n);const s=[],o=Ui.empty();Xc(n,(u,c)=>{const d=cI(e,u,t);c=hn(c);const m=r.mc(d);if(c instanceof sb)s.push(d);else{const p=z0(c,m);p!=null&&(s.push(d),o.set(d,p))}});const a=new ws(s);return new nM(o,a,r.fieldTransforms)}function XV(i,e,t,n,r,s){const o=i.bc(1,e,t),a=[Kx(e,n,t)],u=[r];if(s.length%2!=0)throw new $e(Ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(Kx(e,s[p])),u.push(s[p+1]);const c=[],d=Ui.empty();for(let p=a.length-1;p>=0;--p)if(!oM(c,a[p])){const g=a[p];let w=u[p];w=hn(w);const b=o.mc(g);if(w instanceof sb)c.push(g);else{const A=z0(w,b);A!=null&&(c.push(g),d.set(g,A))}}const m=new ws(c);return new nM(d,m,o.fieldTransforms)}function QV(i,e,t,n=!1){return z0(t,i.bc(n?4:3,e))}function z0(i,e){if(sM(i=hn(i)))return uI("Unsupported field value:",e,i),iM(i,e);if(i instanceof ib)return function(n,r){if(!rM(r.Ic))throw r.gc(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.gc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(n,r){const s=[];let o=0;for(const a of n){let u=z0(a,r.fc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(i,e)}return function(n,r){if((n=hn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return kq(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Qn.fromDate(n);return{timestampValue:$_(r.serializer,s)}}if(n instanceof Qn){const s=new Qn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$_(r.serializer,s)}}if(n instanceof iI)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Hm)return{bytesValue:b3(r.serializer,n._byteString)};if(n instanceof _i){const s=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw r.gc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:HT(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof sI)return function(o,a){return{mapValue:{fields:{[JF]:{stringValue:YF},[U_]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.gc("VectorValues must only contain numeric values.");return jT(a.serializer,c)})}}}}}}(n,r);throw r.gc(`Unsupported field value: ${eb(n)}`)}(i,e)}function iM(i,e){const t={};return HF(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xc(i,(n,r)=>{const s=z0(r,e.Ac(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function sM(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof Qn||i instanceof iI||i instanceof Hm||i instanceof _i||i instanceof ib||i instanceof sI)}function uI(i,e,t){if(!sM(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){const n=eb(t);throw n==="an object"?e.gc(i+" a custom object"):e.gc(i+" "+n)}}function Kx(i,e,t){if((e=hn(e))instanceof rb)return e._internalPath;if(typeof e=="string")return cI(i,e);throw J_("Field path arguments must be of type string or ",i,!1,void 0,t)}const ZV=new RegExp("[~\\*/\\[\\]]");function cI(i,e,t){if(e.search(ZV)>=0)throw J_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new rb(...e.split("."))._internalPath}catch{throw J_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function J_(i,e,t,n,r){const s=n&&!n.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${n}`),o&&(u+=` in document ${r}`),u+=")"),new $e(Ee.INVALID_ARGUMENT,a+i+u)}function oM(i,e){return i.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new _i(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new e7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ob("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class e7 extends aM{data(){return super.data()}}function ob(i,e){return typeof e=="string"?cI(i,e):e instanceof rb?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lM(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new $e(Ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hI{}class dI extends hI{}function t7(i,e,...t){let n=[];e instanceof hI&&n.push(e),n=n.concat(t),function(s){const o=s.filter(u=>u instanceof fI).length,a=s.filter(u=>u instanceof ab).length;if(o>1||o>0&&a>0)throw new $e(Ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const r of n)i=r._apply(i);return i}class ab extends dI{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new ab(e,t,n)}_apply(e){const t=this._parse(e);return uM(e._query,t),new eu(e.firestore,e.converter,Mx(e._query,t))}_parse(e){const t=aI(e.firestore);return function(s,o,a,u,c,d,m){let p;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new $e(Ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){XP(m,d);const w=[];for(const b of m)w.push(YP(u,s,b));p={arrayValue:{values:w}}}else p=YP(u,s,m)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||XP(m,d),p=QV(a,o,m,d==="in"||d==="not-in");return Yn.create(c,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function JP(i,e,t){const n=e,r=ob("where",i);return ab._create(r,n,t)}class fI extends hI{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new fI(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:ko.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let o=r;const a=s.getFlattenedFilters();for(const u of a)uM(o,u),o=Mx(o,u)}(e._query,t),new eu(e.firestore,e.converter,Mx(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class pI extends dI{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new pI(e,t)}_apply(e){const t=function(r,s,o){if(r.startAt!==null)throw new $e(Ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new $e(Ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new $y(s,o)}(e._query,this._field,this._direction);return new eu(e.firestore,e.converter,function(r,s){const o=r.explicitOrderBy.concat([s]);return new Jm(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function n7(i,e="asc"){const t=e,n=ob("orderBy",i);return pI._create(n,t)}class mI extends dI{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new mI(e,t,n)}_apply(e){return new eu(e.firestore,e.converter,H_(e._query,this._limit,this._limitType))}}function r7(i){return BV("limit",i),mI._create("limit",i,"F")}function YP(i,e,t){if(typeof(t=hn(t))=="string"){if(t==="")throw new $e(Ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!i3(e)&&t.indexOf("/")!==-1)throw new $e(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(mn.fromString(t));if(!ot.isDocumentKey(n))throw new $e(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return uP(i,new ot(n))}if(t instanceof _i)return uP(i,t._key);throw new $e(Ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${eb(t)}.`)}function XP(i,e){if(!Array.isArray(i)||i.length===0)throw new $e(Ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uM(i,e){const t=function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(i.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new $e(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $e(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class i7{convertValue(e,t="none"){switch(qc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Un(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(jc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw dt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Xc(e,(r,s)=>{n[r]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,r;const s=(r=(n=(t=e.fields)===null||t===void 0?void 0:t[U_].arrayValue)===null||n===void 0?void 0:n.values)===null||r===void 0?void 0:r.map(o=>Un(o.doubleValue));return new sI(s)}convertGeoPoint(e){return new iI(Un(e.latitude),Un(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=$1(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Vy(e));default:return null}}convertTimestamp(e){const t=Bc(e);return new Qn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=mn.fromString(e);Wt(I3(n),9688,{name:e});const r=new Hy(n.get(1),n.get(3)),s=new ot(n.popFirst(5));return r.isEqual(t)||Kl(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s7(i,e,t){let n;return n=i?t&&(t.merge||t.mergeFields)?i.toFirestore(e,t):i.toFirestore(e):e,n}function o7(){return new zV("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cM extends aM{constructor(e,t,n,r,s,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Jw(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(ob("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Jw extends cM{data(e={}){return super.data(e)}}class hM{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new oy(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Jw(this._firestore,this._userDataWriter,n.key,n,new oy(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new $e(Ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const u=new Jw(r._firestore,r._userDataWriter,a.doc.key,a.doc,new oy(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const u=new Jw(r._firestore,r._userDataWriter,a.doc.key,a.doc,new oy(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:a7(a.type),doc:u,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function a7(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dt(61501,{type:i})}}class lb extends i7{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hm(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _i(this.firestore,null,t)}}function l7(i){i=Ks(i,eu);const e=Ks(i.firestore,Hc),t=nb(e),n=new lb(e);return lM(i._query),LV(t,i._query).then(r=>new hM(e,n,i,r))}function u7(i,e,t){i=Ks(i,_i);const n=Ks(i.firestore,Hc),r=s7(i.converter,e,t);return gI(n,[JV(aI(n),"setDoc",i._key,r,i.converter!==null,t).toMutation(i._key,Do.none())])}function c7(i,e,t,...n){i=Ks(i,_i);const r=Ks(i.firestore,Hc),s=aI(r);let o;return o=typeof(e=hn(e))=="string"||e instanceof rb?XV(s,"updateDoc",i._key,e,t,n):YV(s,"updateDoc",i._key,e),gI(r,[o.toMutation(i._key,Do.exists(!0))])}function QP(i){return gI(Ks(i.firestore,Hc),[new qT(i._key,Do.none())])}function h7(i,...e){var t,n,r;i=hn(i);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||KP(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(KP(e[o])){const m=e[o];e[o]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[o+1]=(n=m.error)===null||n===void 0?void 0:n.bind(m),e[o+2]=(r=m.complete)===null||r===void 0?void 0:r.bind(m)}let u,c,d;if(i instanceof _i)c=Ks(i.firestore,Hc),d=BT(i._key.path),u={next:m=>{e[o]&&e[o](d7(c,i,m))},error:e[o+1],complete:e[o+2]};else{const m=Ks(i,eu);c=Ks(m.firestore,Hc),d=m._query;const p=new lb(c);u={next:g=>{e[o]&&e[o](new hM(c,p,m,g))},error:e[o+1],complete:e[o+2]},lM(i._query)}return function(p,g,w,b){const A=new Q3(b),_=new H3(g,A,w);return p.asyncQueue.enqueueAndForget(async()=>U3(await Gx(p),_)),()=>{A.xu(),p.asyncQueue.enqueueAndForget(async()=>V3(await Gx(p),_))}}(nb(c),d,a,u)}function gI(i,e){return function(n,r){const s=new Ul;return n.asyncQueue.enqueueAndForget(async()=>AV(await NV(n),r,s)),s.promise}(nb(i),e)}function d7(i,e,t){const n=t.docs.get(e._key),r=new lb(i);return new cM(i,r,e._key,n,new oy(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f7(i){return p7(i,{count:o7()})}function p7(i,e){const t=Ks(i.firestore,Hc),n=nb(t),r=sq(e,(s,o)=>new Uq(o,s.aggregateType,s._internalFieldPath));return FV(n,i._query,r).then(s=>function(a,u,c){const d=new lb(a);return new $V(u,d,c)}(t,i,s))}function m7(){return new lI("serverTimestamp")}(function(e,t=!0){(function(r){Wm=r})(tf),$d(new Fc("firestore",(n,{instanceIdentifier:r,options:s})=>{const o=n.getProvider("app").getImmediate(),a=new Hc(new H8(n.getProvider("auth-internal")),new W8(o,n.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new $e(Ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hy(c.options.projectId,d)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),ba(XR,QR,e),ba(XR,QR,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM="firebasestorage.googleapis.com",fM="storageBucket",g7=2*60*1e3,y7=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn extends Ra{constructor(e,t,n=0){super(SE(e),`Firebase Storage: ${t} (${SE(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Fn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return SE(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ln;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ln||(Ln={}));function SE(i){return"storage/"+i}function yI(){const i="An unknown error occurred, please check the error payload for server response.";return new Fn(Ln.UNKNOWN,i)}function v7(i){return new Fn(Ln.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")}function w7(i){return new Fn(Ln.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function _7(){const i="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Fn(Ln.UNAUTHENTICATED,i)}function b7(){return new Fn(Ln.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function A7(i){return new Fn(Ln.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")}function E7(){return new Fn(Ln.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function C7(){return new Fn(Ln.CANCELED,"User canceled the upload/download.")}function x7(i){return new Fn(Ln.INVALID_URL,"Invalid URL '"+i+"'.")}function S7(i){return new Fn(Ln.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function T7(){return new Fn(Ln.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+fM+"' property when initializing the app?")}function I7(){return new Fn(Ln.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function D7(){return new Fn(Ln.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function k7(i){return new Fn(Ln.UNSUPPORTED_ENVIRONMENT,`${i} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Jx(i){return new Fn(Ln.INVALID_ARGUMENT,i)}function pM(){return new Fn(Ln.APP_DELETED,"The Firebase app was deleted.")}function R7(i){return new Fn(Ln.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ly(i,e){return new Fn(Ln.INVALID_FORMAT,"String does not match format '"+i+"': "+e)}function Kg(i){throw new Fn(Ln.INTERNAL_ERROR,"Internal error: "+i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=_s.makeFromUrl(e,t)}catch{return new _s(e,"")}if(n.path==="")return n;throw S7(e)}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";function s(S){S.path.charAt(S.path.length-1)==="/"&&(S.path_=S.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function c(S){S.path_=decodeURIComponent(S.path)}const d="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",g=new RegExp(`^https?://${m}/${d}/b/${r}/o${p}`,"i"),w={bucket:1,path:3},b=t===dM?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",_=new RegExp(`^https?://${b}/${r}/${A}`,"i"),I=[{regex:a,indices:u,postModify:s},{regex:g,indices:w,postModify:c},{regex:_,indices:{bucket:1,path:2},postModify:c}];for(let S=0;S<I.length;S++){const R=I[S],L=R.regex.exec(e);if(L){const k=L[R.indices.bucket];let T=L[R.indices.path];T||(T=""),n=new _s(k,T),R.postModify(n);break}}if(n==null)throw x7(e);return n}}class P7{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N7(i,e,t){let n=1,r=null,s=null,o=!1,a=0;function u(){return a===2}let c=!1;function d(...A){c||(c=!0,e.apply(null,A))}function m(A){r=setTimeout(()=>{r=null,i(g,u())},A)}function p(){s&&clearTimeout(s)}function g(A,..._){if(c){p();return}if(A){p(),d.call(null,A,..._);return}if(u()||o){p(),d.call(null,A,..._);return}n<64&&(n*=2);let I;a===1?(a=2,I=0):I=(n+Math.random())*1e3,m(I)}let w=!1;function b(A){w||(w=!0,p(),!c&&(r!==null?(A||(a=2),clearTimeout(r),m(0)):A||(a=1)))}return m(0),s=setTimeout(()=>{o=!0,b(!0)},t),b}function O7(i){i(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L7(i){return i!==void 0}function F7(i){return typeof i=="object"&&!Array.isArray(i)}function vI(i){return typeof i=="string"||i instanceof String}function ZP(i){return wI()&&i instanceof Blob}function wI(){return typeof Blob<"u"}function eN(i,e,t,n){if(n<e)throw Jx(`Invalid value for '${i}'. Expected ${e} or greater.`);if(n>t)throw Jx(`Invalid value for '${i}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ub(i,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${i}`}function mM(i){const e=encodeURIComponent;let t="?";for(const n in i)if(i.hasOwnProperty(n)){const r=e(n)+"="+e(i[n]);t=t+r+"&"}return t=t.slice(0,-1),t}var Hd;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(Hd||(Hd={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M7(i,e){const t=i>=500&&i<600,r=[408,429].indexOf(i)!==-1,s=e.indexOf(i)!==-1;return t||r||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{constructor(e,t,n,r,s,o,a,u,c,d,m,p=!0,g=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=m,this.retry=p,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,b)=>{this.resolve_=w,this.reject_=b,this.start_()})}start_(){const e=(n,r)=>{if(r){n(!1,new Iw(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const u=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Hd.NO_ERROR,u=s.getStatus();if(!a||M7(u,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===Hd.ABORT;n(!1,new Iw(!1,null,d));return}const c=this.successCodes_.indexOf(u)!==-1;n(!0,new Iw(c,s))})},t=(n,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());L7(u)?s(u):s()}catch(u){o(u)}else if(a!==null){const u=yI();u.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,u)):o(u)}else if(r.canceled){const u=this.appDelete_?pM():C7();o(u)}else{const u=E7();o(u)}};this.canceled_?t(!1,new Iw(!1,null,!0)):this.backoffId_=N7(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&O7(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Iw{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function j7(i,e){e!==null&&e.length>0&&(i.Authorization="Firebase "+e)}function q7(i,e){i["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function U7(i,e){e&&(i["X-Firebase-GMPID"]=e)}function V7(i,e){e!==null&&(i["X-Firebase-AppCheck"]=e)}function H7(i,e,t,n,r,s,o=!0,a=!1){const u=mM(i.urlParams),c=i.url+u,d=Object.assign({},i.headers);return U7(d,e),j7(d,t),q7(d,s),V7(d,n),new B7(c,i.method,d,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,r,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z7(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function $7(...i){const e=z7();if(e!==void 0){const t=new e;for(let n=0;n<i.length;n++)t.append(i[n]);return t.getBlob()}else{if(wI())return new Blob(i);throw new Fn(Ln.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function W7(i,e,t){return i.webkitSlice?i.webkitSlice(e,t):i.mozSlice?i.mozSlice(e,t):i.slice?i.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G7(i){if(typeof atob>"u")throw k7("base-64");return atob(i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class TE{constructor(e,t){this.data=e,this.contentType=t||null}}function K7(i,e){switch(i){case wa.RAW:return new TE(gM(e));case wa.BASE64:case wa.BASE64URL:return new TE(yM(i,e));case wa.DATA_URL:return new TE(Y7(e),X7(e))}throw yI()}function gM(i){const e=[];for(let t=0;t<i.length;t++){let n=i.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<i.length-1&&(i.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const s=n,o=i.charCodeAt(++t);n=65536|(s&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function J7(i){let e;try{e=decodeURIComponent(i)}catch{throw Ly(wa.DATA_URL,"Malformed data URL.")}return gM(e)}function yM(i,e){switch(i){case wa.BASE64:{const r=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(r||s)throw Ly(i,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case wa.BASE64URL:{const r=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(r||s)throw Ly(i,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=G7(e)}catch(r){throw r.message.includes("polyfill")?r:Ly(i,"Invalid character found")}const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}class vM{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Ly(wa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=Q7(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function Y7(i){const e=new vM(i);return e.base64?yM(wa.BASE64,e.rest):J7(e.rest)}function X7(i){return new vM(i).contentType}function Q7(i,e){return i.length>=e.length?i.substring(i.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e,t){let n=0,r="";ZP(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(ZP(this.data_)){const n=this.data_,r=W7(n,e,t);return r===null?null:new Pu(r)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Pu(n,!0)}}static getBlob(...e){if(wI()){const t=e.map(n=>n instanceof Pu?n.data_:n);return new Pu($7.apply(null,t))}else{const t=e.map(o=>vI(o)?K7(wa.RAW,o).data:o.data_);let n=0;t.forEach(o=>{n+=o.byteLength});const r=new Uint8Array(n);let s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)r[s++]=o[a]}),new Pu(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wM(i){let e;try{e=JSON.parse(i)}catch{return null}return F7(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z7(i){if(i.length===0)return null;const e=i.lastIndexOf("/");return e===-1?"":i.slice(0,e)}function eH(i,e){const t=e.split("/").filter(n=>n.length>0).join("/");return i.length===0?t:i+"/"+t}function _M(i){const e=i.lastIndexOf("/",i.length-2);return e===-1?i:i.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tH(i,e){return e}class ci{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||tH}}let Dw=null;function nH(i){return!vI(i)||i.length<2?i:_M(i)}function bM(){if(Dw)return Dw;const i=[];i.push(new ci("bucket")),i.push(new ci("generation")),i.push(new ci("metageneration")),i.push(new ci("name","fullPath",!0));function e(s,o){return nH(o)}const t=new ci("name");t.xform=e,i.push(t);function n(s,o){return o!==void 0?Number(o):o}const r=new ci("size");return r.xform=n,i.push(r),i.push(new ci("timeCreated")),i.push(new ci("updated")),i.push(new ci("md5Hash",null,!0)),i.push(new ci("cacheControl",null,!0)),i.push(new ci("contentDisposition",null,!0)),i.push(new ci("contentEncoding",null,!0)),i.push(new ci("contentLanguage",null,!0)),i.push(new ci("contentType",null,!0)),i.push(new ci("metadata","customMetadata",!0)),Dw=i,Dw}function rH(i,e){function t(){const n=i.bucket,r=i.fullPath,s=new _s(n,r);return e._makeStorageReference(s)}Object.defineProperty(i,"ref",{get:t})}function iH(i,e,t){const n={};n.type="file";const r=t.length;for(let s=0;s<r;s++){const o=t[s];n[o.local]=o.xform(n,e[o.server])}return rH(n,i),n}function AM(i,e,t){const n=wM(e);return n===null?null:iH(i,n,t)}function sH(i,e,t,n){const r=wM(e);if(r===null||!vI(r.downloadTokens))return null;const s=r.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(c=>{const d=i.bucket,m=i.fullPath,p="/b/"+o(d)+"/o/"+o(m),g=ub(p,t,n),w=mM({alt:"media",token:c});return g+w})[0]}function oH(i,e){const t={},n=e.length;for(let r=0;r<n;r++){const s=e[r];s.writable&&(t[s.server]=i[s.local])}return JSON.stringify(t)}class _I{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EM(i){if(!i)throw yI()}function aH(i,e){function t(n,r){const s=AM(i,r,e);return EM(s!==null),s}return t}function lH(i,e){function t(n,r){const s=AM(i,r,e);return EM(s!==null),sH(s,r,i.host,i._protocol)}return t}function CM(i){function e(t,n){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=b7():r=_7():t.getStatus()===402?r=w7(i.bucket):t.getStatus()===403?r=A7(i.path):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}return e}function xM(i){const e=CM(i);function t(n,r){let s=e(n,r);return n.getStatus()===404&&(s=v7(i.path)),s.serverResponse=r.serverResponse,s}return t}function uH(i,e,t){const n=e.fullServerUrl(),r=ub(n,i.host,i._protocol),s="GET",o=i.maxOperationRetryTime,a=new _I(r,s,lH(i,t),o);return a.errorHandler=xM(e),a}function cH(i,e){const t=e.fullServerUrl(),n=ub(t,i.host,i._protocol),r="DELETE",s=i.maxOperationRetryTime;function o(u,c){}const a=new _I(n,r,o,s);return a.successCodes=[200,204],a.errorHandler=xM(e),a}function hH(i,e){return i&&i.contentType||e&&e.type()||"application/octet-stream"}function dH(i,e,t){const n=Object.assign({},t);return n.fullPath=i.path,n.size=e.size(),n.contentType||(n.contentType=hH(null,e)),n}function fH(i,e,t,n,r){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let I="";for(let S=0;S<2;S++)I=I+Math.random().toString().slice(2);return I}const u=a();o["Content-Type"]="multipart/related; boundary="+u;const c=dH(e,n,r),d=oH(c,t),m="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+u+`\r
Content-Type: `+c.contentType+`\r
\r
`,p=`\r
--`+u+"--",g=Pu.getBlob(m,n,p);if(g===null)throw I7();const w={name:c.fullPath},b=ub(s,i.host,i._protocol),A="POST",_=i.maxUploadRetryTime,C=new _I(b,A,aH(i,t),_);return C.urlParams=w,C.headers=o,C.body=g.uploadData(),C.errorHandler=CM(e),C}class pH{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Hd.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Hd.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Hd.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r,s){if(this.sent_)throw Kg("cannot .send() more than once");if(Yc(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Kg("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Kg("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Kg("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Kg("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class mH extends pH{initXhr(){this.xhr_.responseType="text"}}function bI(){return new mH}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,t){this._service=e,t instanceof _s?this._location=t:this._location=_s.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Kd(e,t)}get root(){const e=new _s(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return _M(this._location.path)}get storage(){return this._service}get parent(){const e=Z7(this._location.path);if(e===null)return null;const t=new _s(this._location.bucket,e);return new Kd(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw R7(e)}}function gH(i,e,t){i._throwIfRoot("uploadBytes");const n=fH(i.storage,i._location,bM(),new Pu(e,!0),t);return i.storage.makeRequestWithTokens(n,bI).then(r=>({metadata:r,ref:i}))}function yH(i){i._throwIfRoot("getDownloadURL");const e=uH(i.storage,i._location,bM());return i.storage.makeRequestWithTokens(e,bI).then(t=>{if(t===null)throw D7();return t})}function vH(i){i._throwIfRoot("deleteObject");const e=cH(i.storage,i._location);return i.storage.makeRequestWithTokens(e,bI)}function wH(i,e){const t=eH(i._location.path,e),n=new _s(i._location.bucket,t);return new Kd(i.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _H(i){return/^[A-Za-z]+:\/\//.test(i)}function bH(i,e){return new Kd(i,e)}function SM(i,e){if(i instanceof AI){const t=i;if(t._bucket==null)throw T7();const n=new Kd(t,t._bucket);return e!=null?SM(n,e):n}else return e!==void 0?wH(i,e):i}function AH(i,e){if(e&&_H(e)){if(i instanceof AI)return bH(i,e);throw Jx("To use ref(service, url), the first argument must be a Storage instance.")}else return SM(i,e)}function tN(i,e){const t=e==null?void 0:e[fM];return t==null?null:_s.makeFromBucketSpec(t,i)}function EH(i,e,t,n={}){i.host=`${e}:${t}`;const r=Yc(e);r&&(TT(`https://${i.host}/b`),IT("Storage",!0)),i._isUsingEmulator=!0,i._protocol=r?"https":"http";const{mockUserToken:s}=n;s&&(i._overrideAuthToken=typeof s=="string"?s:SF(s,i.app.options.projectId))}class AI{constructor(e,t,n,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=dM,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=g7,this._maxUploadRetryTime=y7,this._requests=new Set,r!=null?this._bucket=_s.makeFromBucketSpec(r,this._host):this._bucket=tN(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=_s.makeFromBucketSpec(this._url,e):this._bucket=tN(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){eN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){eN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ys(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Kd(this,e)}_makeRequest(e,t,n,r,s=!0){if(this._deleted)return new P7(pM());{const o=H7(e,this._appId,n,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const nN="@firebase/storage",rN="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM="storage";function CH(i,e,t){return i=hn(i),gH(i,e,t)}function xH(i){return i=hn(i),yH(i)}function SH(i){return i=hn(i),vH(i)}function IE(i,e){return i=hn(i),AH(i,e)}function TH(i=RT(),e){i=hn(i);const n=V1(i,TM).getImmediate({identifier:e}),r=EF("storage");return r&&IH(n,...r),n}function IH(i,e,t,n={}){EH(i,e,t,n)}function DH(i,{instanceIdentifier:e}){const t=i.getProvider("app").getImmediate(),n=i.getProvider("auth-internal"),r=i.getProvider("app-check-internal");return new AI(t,n,r,e,tf)}function kH(){$d(new Fc(TM,DH,"PUBLIC").setMultipleInstances(!0)),ba(nN,rN,""),ba(nN,rN,"esm2017")}kH();function EI(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(i);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(i,n[r])&&(t[n[r]]=i[n[r]]);return t}function IM(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const RH=IM,DM=new B0("auth","Firebase",IM());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=new DT("@firebase/auth");function PH(i,...e){Y_.logLevel<=Pt.WARN&&Y_.warn(`Auth (${tf}): ${i}`,...e)}function Yw(i,...e){Y_.logLevel<=Pt.ERROR&&Y_.error(`Auth (${tf}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(i,...e){throw CI(i,...e)}function Ca(i,...e){return CI(i,...e)}function kM(i,e,t){const n=Object.assign(Object.assign({},RH()),{[e]:t});return new B0("auth","Firebase",n).create(e,{appName:i.name})}function Vl(i){return kM(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function CI(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return DM.create(i,...e)}function ht(i,e,...t){if(!i)throw CI(e,...t)}function jl(i){const e="INTERNAL ASSERTION FAILED: "+i;throw Yw(e),new Error(e)}function Yl(i,e){i||jl(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.href)||""}function NH(){return iN()==="http:"||iN()==="https:"}function iN(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OH(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(NH()||v6()||"connection"in navigator)?navigator.onLine:!0}function LH(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(e,t){this.shortDelay=e,this.longDelay=t,Yl(t>e,"Short delay should be less than long delay!"),this.isMobile=m6()||w6()}get(){return OH()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(i,e){Yl(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RM{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;jl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;jl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;jl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FH={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MH=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],BH=new $0(3e4,6e4);function tu(i,e){return i.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:i.tenantId}):e}async function Pa(i,e,t,n,r={}){return PM(i,r,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const a=j0(Object.assign({key:i.config.apiKey},o)).slice(1),u=await i._getAdditionalHeaders();u["Content-Type"]="application/json",i.languageCode&&(u["X-Firebase-Locale"]=i.languageCode);const c=Object.assign({method:e,headers:u},s);return y6()||(c.referrerPolicy="no-referrer"),i.emulatorConfig&&Yc(i.emulatorConfig.host)&&(c.credentials="include"),RM.fetch()(await NM(i,i.config.apiHost,t,a),c)})}async function PM(i,e,t){i._canInitEmulator=!1;const n=Object.assign(Object.assign({},FH),e);try{const r=new qH(i),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw kw(i,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[u,c]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw kw(i,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw kw(i,"email-already-in-use",o);if(u==="USER_DISABLED")throw kw(i,"user-disabled",o);const d=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw kM(i,d,c);Ro(i,d)}}catch(r){if(r instanceof Ra)throw r;Ro(i,"network-request-failed",{message:String(r)})}}async function W0(i,e,t,n,r={}){const s=await Pa(i,e,t,n,r);return"mfaPendingCredential"in s&&Ro(i,"multi-factor-auth-required",{_serverResponse:s}),s}async function NM(i,e,t,n){const r=`${e}${t}?${n}`,s=i,o=s.config.emulator?xI(i.config,r):`${i.config.apiScheme}://${r}`;return MH.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function jH(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class qH{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Ca(this.auth,"network-request-failed")),BH.get())})}}function kw(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const r=Ca(i,e,n);return r.customData._tokenResponse=t,r}function sN(i){return i!==void 0&&i.enterprise!==void 0}class UH{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return jH(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function VH(i,e){return Pa(i,"GET","/v2/recaptchaConfig",tu(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HH(i,e){return Pa(i,"POST","/v1/accounts:delete",e)}async function X_(i,e){return Pa(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fy(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zH(i,e=!1){const t=hn(i),n=await t.getIdToken(e),r=SI(n);ht(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:n,authTime:Fy(DE(r.auth_time)),issuedAtTime:Fy(DE(r.iat)),expirationTime:Fy(DE(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function DE(i){return Number(i)*1e3}function SI(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return Yw("JWT malformed, contained fewer than 3 sections"),null;try{const r=bF(t);return r?JSON.parse(r):(Yw("Failed to decode base64 JWT payload"),null)}catch(r){return Yw("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function oN(i){const e=SI(i);return ht(e,"internal-error"),ht(typeof e.exp<"u","internal-error"),ht(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zm(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Ra&&$H(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function $H({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WH{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fy(this.lastLoginAt),this.creationTime=Fy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q_(i){var e;const t=i.auth,n=await i.getIdToken(),r=await zm(i,X_(t,{idToken:n}));ht(r==null?void 0:r.users.length,t,"internal-error");const s=r.users[0];i._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?OM(s.providerUserInfo):[],a=KH(i.providerData,o),u=i.isAnonymous,c=!(i.email&&s.passwordHash)&&!(a!=null&&a.length),d=u?c:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Xx(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(i,m)}async function GH(i){const e=hn(i);await Q_(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function KH(i,e){return[...i.filter(n=>!e.some(r=>r.providerId===n.providerId)),...e]}function OM(i){return i.map(e=>{var{providerId:t}=e,n=EI(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JH(i,e){const t=await PM(i,{},async()=>{const n=j0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=i.config,o=await NM(i,r,"/v1/token",`key=${s}`),a=await i._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:a,body:n};return i.emulatorConfig&&Yc(i.emulatorConfig.host)&&(u.credentials="include"),RM.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function YH(i,e){return Pa(i,"POST","/v2/accounts:revokeToken",tu(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ht(e.idToken,"internal-error"),ht(typeof e.idToken<"u","internal-error"),ht(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ht(e.length!==0,"internal-error");const t=oN(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ht(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await JH(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,o=new gp;return n&&(ht(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),r&&(ht(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(ht(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gp,this.toJSON())}_performRefresh(){return jl("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(i,e){ht(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class To{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,s=EI(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new WH(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Xx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await zm(this,this.stsTokenManager.getToken(this.auth,e));return ht(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return zH(this,e)}reload(){return GH(this)}_assign(e){this!==e&&(ht(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new To(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ht(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Q_(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ys(this.auth.app))return Promise.reject(Vl(this.auth));const e=await this.getIdToken();return await zm(this,HH(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,o,a,u,c,d;const m=(n=t.displayName)!==null&&n!==void 0?n:void 0,p=(r=t.email)!==null&&r!==void 0?r:void 0,g=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,w=(o=t.photoURL)!==null&&o!==void 0?o:void 0,b=(a=t.tenantId)!==null&&a!==void 0?a:void 0,A=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,_=(c=t.createdAt)!==null&&c!==void 0?c:void 0,C=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:I,emailVerified:S,isAnonymous:R,providerData:L,stsTokenManager:k}=t;ht(I&&k,e,"internal-error");const T=gp.fromJSON(this.name,k);ht(typeof I=="string",e,"internal-error"),Iu(m,e.name),Iu(p,e.name),ht(typeof S=="boolean",e,"internal-error"),ht(typeof R=="boolean",e,"internal-error"),Iu(g,e.name),Iu(w,e.name),Iu(b,e.name),Iu(A,e.name),Iu(_,e.name),Iu(C,e.name);const D=new To({uid:I,auth:e,email:p,emailVerified:S,displayName:m,isAnonymous:R,photoURL:w,phoneNumber:g,tenantId:b,stsTokenManager:T,createdAt:_,lastLoginAt:C});return L&&Array.isArray(L)&&(D.providerData=L.map(P=>Object.assign({},P))),A&&(D._redirectEventId=A),D}static async _fromIdTokenResponse(e,t,n=!1){const r=new gp;r.updateFromServerResponse(t);const s=new To({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Q_(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];ht(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?OM(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),a=new gp;a.updateFromIdToken(n);const u=new To({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Xx(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN=new Map;function ql(i){Yl(i instanceof Function,"Expected a class definition");let e=aN.get(i);return e?(Yl(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,aN.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}LM.type="NONE";const lN=LM;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(i,e,t){return`firebase:${i}:${e}:${t}`}class yp{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=Xw(this.userKey,r.apiKey,s),this.fullPersistenceKey=Xw("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await X_(this.auth,{idToken:e}).catch(()=>{});return t?To._fromGetAccountInfoResponse(this.auth,t,e):null}return To._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new yp(ql(lN),e,n);const r=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=r[0]||ql(lN);const o=Xw(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const d=await c._get(o);if(d){let m;if(typeof d=="string"){const p=await X_(e,{idToken:d}).catch(()=>{});if(!p)break;m=await To._fromGetAccountInfoResponse(e,p,d)}else m=To._fromJSON(e,d);c!==s&&(a=m),s=c;break}}catch{}const u=r.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new yp(s,e,n):(s=u[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new yp(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(jM(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(FM(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(UM(e))return"Blackberry";if(VM(e))return"Webos";if(MM(e))return"Safari";if((e.includes("chrome/")||BM(e))&&!e.includes("edge/"))return"Chrome";if(qM(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function FM(i=si()){return/firefox\//i.test(i)}function MM(i=si()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function BM(i=si()){return/crios\//i.test(i)}function jM(i=si()){return/iemobile/i.test(i)}function qM(i=si()){return/android/i.test(i)}function UM(i=si()){return/blackberry/i.test(i)}function VM(i=si()){return/webos/i.test(i)}function TI(i=si()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function XH(i=si()){var e;return TI(i)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function QH(){return _6()&&document.documentMode===10}function HM(i=si()){return TI(i)||qM(i)||VM(i)||UM(i)||/windows phone/i.test(i)||jM(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zM(i,e=[]){let t;switch(i){case"Browser":t=uN(si());break;case"Worker":t=`${uN(si())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${tf}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZH{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,a)=>{try{const u=e(s);o(u)}catch(u){a(u)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ez(i,e={}){return Pa(i,"GET","/v2/passwordPolicy",tu(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tz=6;class nz{constructor(e){var t,n,r,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:tz,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,s,o,a;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(n=u.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.containsLowercaseLetter)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(a=u.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),u}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rz{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cN(this),this.idTokenSubscription=new cN(this),this.beforeStateQueue=new ZH(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=DM,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ql(t)),this._initializationPromise=this.queue(async()=>{var n,r,s;if(!this._deleted&&(this.persistenceManager=await yp.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await X_(this,{idToken:e}),n=await To._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ys(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===a)&&(u!=null&&u.user)&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ht(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Q_(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=LH()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ys(this.app))return Promise.reject(Vl(this));const t=e?hn(e):null;return t&&ht(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ht(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ys(this.app)?Promise.reject(Vl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ys(this.app)?Promise.reject(Vl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ql(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ez(this),t=new nz(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new B0("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await YH(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ql(e)||this._popupRedirectResolver;ht(t,this,"argument-error"),this.redirectPersistenceManager=await yp.create(this,[ql(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ht(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,n,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ht(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zM(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(ys(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&PH(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Zc(i){return hn(i)}class cN{constructor(e){this.auth=e,this.observer=null,this.addObserver=I6(t=>this.observer=t)}get next(){return ht(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cb={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function iz(i){cb=i}function $M(i){return cb.loadJS(i)}function sz(){return cb.recaptchaEnterpriseScript}function oz(){return cb.gapiScript}function az(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class lz{constructor(){this.enterprise=new uz}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class uz{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const cz="recaptcha-enterprise",WM="NO_RECAPTCHA";class hz{constructor(e){this.type=cz,this.auth=Zc(e)}async verify(e="verify",t=!1){async function n(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{VH(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new UH(u);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(u=>{a(u)})})}function r(s,o,a){const u=window.grecaptcha;sN(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(WM)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new lz().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{n(this.auth).then(a=>{if(!t&&sN(window.grecaptcha))r(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=sz();u.length!==0&&(u+=a),$M(u).then(()=>{r(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function hN(i,e,t,n=!1,r=!1){const s=new hz(i);let o;if(r)o=WM;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const u=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const u=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return n?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Z_(i,e,t,n,r){var s;if(!((s=i._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await hN(i,e,t,t==="getOobCode");return n(i,o)}else return n(i,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await hN(i,e,t,t==="getOobCode");return n(i,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dz(i,e){const t=V1(i,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(zd(s,e??{}))return r;Ro(r,"already-initialized")}return t.initialize({options:e})}function fz(i,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(ql);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function pz(i,e,t){const n=Zc(i);ht(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const r=!1,s=GM(e),{host:o,port:a}=mz(e),u=a===null?"":`:${a}`,c={url:`${s}//${o}${u}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!n._canInitEmulator){ht(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ht(zd(c,n.config.emulator)&&zd(d,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,Yc(o)?(TT(`${s}//${o}${u}`),IT("Auth",!0)):gz()}function GM(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function mz(i){const e=GM(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(n);if(r){const s=r[1];return{host:s,port:dN(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:dN(o)}}}function dN(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function gz(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return jl("not implemented")}_getIdTokenResponse(e){return jl("not implemented")}_linkToIdToken(e,t){return jl("not implemented")}_getReauthenticationResolver(e){return jl("not implemented")}}async function yz(i,e){return Pa(i,"POST","/v1/accounts:update",e)}async function vz(i,e){return Pa(i,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wz(i,e){return W0(i,"POST","/v1/accounts:signInWithPassword",tu(i,e))}async function _z(i,e){return Pa(i,"POST","/v1/accounts:sendOobCode",tu(i,e))}async function bz(i,e){return _z(i,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Az(i,e){return W0(i,"POST","/v1/accounts:signInWithEmailLink",tu(i,e))}async function Ez(i,e){return W0(i,"POST","/v1/accounts:signInWithEmailLink",tu(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy extends II{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Jy(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Jy(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Z_(e,t,"signInWithPassword",wz);case"emailLink":return Az(e,{email:this._email,oobCode:this._password});default:Ro(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Z_(e,n,"signUpPassword",vz);case"emailLink":return Ez(e,{idToken:t,email:this._email,oobCode:this._password});default:Ro(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vp(i,e){return W0(i,"POST","/v1/accounts:signInWithIdp",tu(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cz="http://localhost";class Jd extends II{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Jd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ro("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,s=EI(t,["providerId","signInMethod"]);if(!n||!r)return null;const o=new Jd(n,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return vp(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,vp(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,vp(e,t)}buildRequest(){const e={requestUri:Cz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=j0(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xz(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Sz(i){const e=ty(ny(i)).link,t=e?ty(ny(e)).deep_link_id:null,n=ty(ny(i)).deep_link_id;return(n?ty(ny(n)).link:null)||n||t||e||i}class DI{constructor(e){var t,n,r,s,o,a;const u=ty(ny(e)),c=(t=u.apiKey)!==null&&t!==void 0?t:null,d=(n=u.oobCode)!==null&&n!==void 0?n:null,m=xz((r=u.mode)!==null&&r!==void 0?r:null);ht(c&&d&&m,"argument-error"),this.apiKey=c,this.operation=m,this.code=d,this.continueUrl=(s=u.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=u.lang)!==null&&o!==void 0?o:null,this.tenantId=(a=u.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=Sz(e);try{return new DI(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(){this.providerId=Xm.PROVIDER_ID}static credential(e,t){return Jy._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=DI.parseLink(t);return ht(n,"argument-error"),Jy._fromEmailAndCode(e,n.code,n.tenantId)}}Xm.PROVIDER_ID="password";Xm.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Xm.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0 extends KM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu extends G0{constructor(){super("facebook.com")}static credential(e){return Jd._fromParams({providerId:Nu.PROVIDER_ID,signInMethod:Nu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Nu.credentialFromTaggedObject(e)}static credentialFromError(e){return Nu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Nu.credential(e.oauthAccessToken)}catch{return null}}}Nu.FACEBOOK_SIGN_IN_METHOD="facebook.com";Nu.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou extends G0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Jd._fromParams({providerId:Ou.PROVIDER_ID,signInMethod:Ou.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ou.credentialFromTaggedObject(e)}static credentialFromError(e){return Ou.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Ou.credential(t,n)}catch{return null}}}Ou.GOOGLE_SIGN_IN_METHOD="google.com";Ou.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu extends G0{constructor(){super("github.com")}static credential(e){return Jd._fromParams({providerId:Lu.PROVIDER_ID,signInMethod:Lu.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lu.credentialFromTaggedObject(e)}static credentialFromError(e){return Lu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Lu.credential(e.oauthAccessToken)}catch{return null}}}Lu.GITHUB_SIGN_IN_METHOD="github.com";Lu.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu extends G0{constructor(){super("twitter.com")}static credential(e,t){return Jd._fromParams({providerId:Fu.PROVIDER_ID,signInMethod:Fu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Fu.credentialFromTaggedObject(e)}static credentialFromError(e){return Fu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Fu.credential(t,n)}catch{return null}}}Fu.TWITTER_SIGN_IN_METHOD="twitter.com";Fu.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tz(i,e){return W0(i,"POST","/v1/accounts:signUp",tu(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const s=await To._fromIdTokenResponse(e,n,r),o=fN(n);return new Yd({user:s,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=fN(n);return new Yd({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function fN(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1 extends Ra{constructor(e,t,n,r){var s;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,e1.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new e1(e,t,n,r)}}function JM(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?e1._fromErrorAndOperation(i,s,e,n):s})}async function Iz(i,e,t=!1){const n=await zm(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return Yd._forOperation(i,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dz(i,e,t=!1){const{auth:n}=i;if(ys(n.app))return Promise.reject(Vl(n));const r="reauthenticate";try{const s=await zm(i,JM(n,r,e,i),t);ht(s.idToken,n,"internal-error");const o=SI(s.idToken);ht(o,n,"internal-error");const{sub:a}=o;return ht(i.uid===a,n,"user-mismatch"),Yd._forOperation(i,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ro(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YM(i,e,t=!1){if(ys(i.app))return Promise.reject(Vl(i));const n="signIn",r=await JM(i,n,e),s=await Yd._fromIdTokenResponse(i,n,r);return t||await i._updateCurrentUser(s.user),s}async function kz(i,e){return YM(Zc(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XM(i){const e=Zc(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Rz(i,e,t){const n=Zc(i);await Z_(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",bz)}async function Pz(i,e,t){if(ys(i.app))return Promise.reject(Vl(i));const n=Zc(i),o=await Z_(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Tz).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&XM(i),u}),a=await Yd._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(a.user),a}function pN(i,e,t){return ys(i.app)?Promise.reject(Vl(i)):kz(hn(i),Xm.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&XM(i),n})}function Nz(i,e){return Oz(hn(i),null,e)}async function Oz(i,e,t){const{auth:n}=i,s={idToken:await i.getIdToken(),returnSecureToken:!0};t&&(s.password=t);const o=await zm(i,yz(n,s));await i._updateTokensIfNecessary(o,!0)}function Lz(i,e,t,n){return hn(i).onIdTokenChanged(e,t,n)}function Fz(i,e,t){return hn(i).beforeAuthStateChanged(e,t)}function kE(i,e,t,n){return hn(i).onAuthStateChanged(e,t,n)}function mN(i){return hn(i).signOut()}async function Mz(i){return hn(i).delete()}const t1="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(t1,"1"),this.storage.removeItem(t1),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bz=1e3,jz=10;class ZM extends QM{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=HM(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);QH()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,jz):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},Bz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ZM.type="LOCAL";const qz=ZM;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eB extends QM{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}eB.type="SESSION";const tB=eB;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const n=new hb(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(o).map(async c=>c(t.origin,s)),u=await Uz(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}hb.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,u)=>{const c=kI("",20);r.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:r,onMessage(m){const p=m;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xa(){return window}function Hz(i){xa().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nB(){return typeof xa().WorkerGlobalScope<"u"&&typeof xa().importScripts=="function"}async function zz(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $z(){var i;return((i=navigator==null?void 0:navigator.serviceWorker)===null||i===void 0?void 0:i.controller)||null}function Wz(){return nB()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rB="firebaseLocalStorageDb",Gz=1,n1="firebaseLocalStorage",iB="fbase_key";class K0{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function db(i,e){return i.transaction([n1],e?"readwrite":"readonly").objectStore(n1)}function Kz(){const i=indexedDB.deleteDatabase(rB);return new K0(i).toPromise()}function Qx(){const i=indexedDB.open(rB,Gz);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(n1,{keyPath:iB})}catch(r){t(r)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(n1)?e(n):(n.close(),await Kz(),e(await Qx()))})})}async function gN(i,e,t){const n=db(i,!0).put({[iB]:e,value:t});return new K0(n).toPromise()}async function Jz(i,e){const t=db(i,!1).get(e),n=await new K0(t).toPromise();return n===void 0?null:n.value}function yN(i,e){const t=db(i,!0).delete(e);return new K0(t).toPromise()}const Yz=800,Xz=3;class sB{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Qx(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>Xz)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nB()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=hb._getInstance(Wz()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await zz(),!this.activeServiceWorker)return;this.sender=new Vz(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((t=n[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||$z()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Qx();return await gN(e,t1,"1"),await yN(e,t1),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>gN(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>Jz(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>yN(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=db(r,!1).getAll();return new K0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Yz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}sB.type="LOCAL";const Qz=sB;new $0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zz(i,e){return e?ql(e):(ht(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI extends II{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vp(e,this._buildIdpRequest())}_linkToIdToken(e,t){return vp(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return vp(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function e$(i){return YM(i.auth,new RI(i),i.bypassAuthState)}function t$(i){const{auth:e,user:t}=i;return ht(t,e,"internal-error"),Dz(t,new RI(i),i.bypassAuthState)}async function n$(i){const{auth:e,user:t}=i;return ht(t,e,"internal-error"),Iz(t,new RI(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oB{constructor(e,t,n,r,s=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return e$;case"linkViaPopup":case"linkViaRedirect":return n$;case"reauthViaPopup":case"reauthViaRedirect":return t$;default:Ro(this.auth,"internal-error")}}resolve(e){Yl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r$=new $0(2e3,1e4);class hp extends oB{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,hp.currentPopupAction&&hp.currentPopupAction.cancel(),hp.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ht(e,this.auth,"internal-error"),e}async onExecution(){Yl(this.filter.length===1,"Popup operations only handle one event");const e=kI();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ca(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ca(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,hp.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if(!((n=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ca(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,r$.get())};e()}}hp.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i$="pendingRedirect",Qw=new Map;class s$ extends oB{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Qw.get(this.auth._key());if(!e){try{const n=await o$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Qw.set(this.auth._key(),e)}return this.bypassAuthState||Qw.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function o$(i,e){const t=u$(e),n=l$(i);if(!await n._isAvailable())return!1;const r=await n._get(t)==="true";return await n._remove(t),r}function a$(i,e){Qw.set(i._key(),e)}function l$(i){return ql(i._redirectPersistence)}function u$(i){return Xw(i$,i.config.apiKey,i.name)}async function c$(i,e,t=!1){if(ys(i.app))return Promise.reject(Vl(i));const n=Zc(i),r=Zz(n,e),o=await new s$(n,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h$=10*60*1e3;class d${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!f$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!aB(e)){const r=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";t.onError(Ca(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=h$&&this.cachedEventUids.clear(),this.cachedEventUids.has(vN(e))}saveEventToCache(e){this.cachedEventUids.add(vN(e)),this.lastProcessedEventTime=Date.now()}}function vN(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function aB({type:i,error:e}){return i==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function f$(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return aB(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p$(i,e={}){return Pa(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,g$=/^https?/;async function y$(i){if(i.config.emulator)return;const{authorizedDomains:e}=await p$(i);for(const t of e)try{if(v$(t))return}catch{}Ro(i,"unauthorized-domain")}function v$(i){const e=Yx(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const o=new URL(i);return o.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!g$.test(t))return!1;if(m$.test(i))return n===i;const r=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w$=new $0(3e4,6e4);function wN(){const i=xa().___jsl;if(i!=null&&i.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function _$(i){return new Promise((e,t)=>{var n,r,s;function o(){wN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wN(),t(Ca(i,"network-request-failed"))},timeout:w$.get()})}if(!((r=(n=xa().gapi)===null||n===void 0?void 0:n.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=xa().gapi)===null||s===void 0)&&s.load)o();else{const a=az("iframefcb");return xa()[a]=()=>{gapi.load?o():t(Ca(i,"network-request-failed"))},$M(`${oz()}?onload=${a}`).catch(u=>t(u))}}).catch(e=>{throw Zw=null,e})}let Zw=null;function b$(i){return Zw=Zw||_$(i),Zw}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A$=new $0(5e3,15e3),E$="__/auth/iframe",C$="emulator/auth/iframe",x$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},S$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function T$(i){const e=i.config;ht(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?xI(e,C$):`https://${i.config.authDomain}/${E$}`,n={apiKey:e.apiKey,appName:i.name,v:tf},r=S$.get(i.config.apiHost);r&&(n.eid=r);const s=i._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${j0(n).slice(1)}`}async function I$(i){const e=await b$(i),t=xa().gapi;return ht(t,i,"internal-error"),e.open({where:document.body,url:T$(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:x$,dontclear:!0},n=>new Promise(async(r,s)=>{await n.restyle({setHideOnLeave:!1});const o=Ca(i,"network-request-failed"),a=xa().setTimeout(()=>{s(o)},A$.get());function u(){xa().clearTimeout(a),r(n)}n.ping(u).then(u,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},k$=500,R$=600,P$="_blank",N$="http://localhost";class _N{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function O$(i,e,t,n=k$,r=R$){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const u=Object.assign(Object.assign({},D$),{width:n.toString(),height:r.toString(),top:s,left:o}),c=si().toLowerCase();t&&(a=BM(c)?P$:t),FM(c)&&(e=e||N$,u.scrollbars="yes");const d=Object.entries(u).reduce((p,[g,w])=>`${p}${g}=${w},`,"");if(XH(c)&&a!=="_self")return L$(e||"",a),new _N(null);const m=window.open(e||"",a,d);ht(m,i,"popup-blocked");try{m.focus()}catch{}return new _N(m)}function L$(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F$="__/auth/handler",M$="emulator/auth/handler",B$=encodeURIComponent("fac");async function bN(i,e,t,n,r,s){ht(i.config.authDomain,i,"auth-domain-config-required"),ht(i.config.apiKey,i,"invalid-api-key");const o={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:tf,eventId:r};if(e instanceof KM){e.setDefaultLanguage(i.languageCode),o.providerId=e.providerId||"",T6(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries({}))o[d]=m}if(e instanceof G0){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(o.scopes=d.join(","))}i.tenantId&&(o.tid=i.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const u=await i._getAppCheckToken(),c=u?`#${B$}=${encodeURIComponent(u)}`:"";return`${j$(i)}?${j0(a).slice(1)}${c}`}function j$({config:i}){return i.emulator?xI(i,M$):`https://${i.authDomain}/${F$}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE="webStorageSupport";class q${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tB,this._completeRedirectFn=c$,this._overrideRedirectResult=a$}async _openPopup(e,t,n,r){var s;Yl((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await bN(e,t,n,Yx(),r);return O$(e,o,kI())}async _openRedirect(e,t,n,r){await this._originValidation(e);const s=await bN(e,t,n,Yx(),r);return Hz(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Yl(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await I$(e),n=new d$(e);return t.register("authEvent",r=>(ht(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:n.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(RE,{type:RE},r=>{var s;const o=(s=r==null?void 0:r[0])===null||s===void 0?void 0:s[RE];o!==void 0&&t(!!o),Ro(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=y$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return HM()||MM()||TI()}}const U$=q$;var AN="@firebase/auth",EN="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V${constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ht(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H$(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function z$(i){$d(new Fc("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;ht(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:a,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zM(i)},c=new rz(n,r,s,u);return fz(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),$d(new Fc("auth-internal",e=>{const t=Zc(e.getProvider("auth").getImmediate());return(n=>new V$(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ba(AN,EN,H$(i)),ba(AN,EN,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $$=5*60,W$=xF("authIdTokenMaxAge")||$$;let CN=null;const G$=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>W$)return;const r=t==null?void 0:t.token;CN!==r&&(CN=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function e_(i=RT()){const e=V1(i,"auth");if(e.isInitialized())return e.getImmediate();const t=dz(i,{popupRedirectResolver:U$,persistence:[Qz,qz,tB]}),n=xF("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=G$(s.toString());Fz(t,o,()=>o(t.currentUser)),Lz(t,a=>o(a))}}const r=AF("auth");return r&&pz(t,`http://${r}`),t}function K$(){var i,e;return(e=(i=document.getElementsByTagName("head"))===null||i===void 0?void 0:i[0])!==null&&e!==void 0?e:document}iz({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=r=>{const s=Ca("internal-error");s.customData=r,t(s)},n.type="text/javascript",n.charset="UTF-8",K$().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});z$("Browser");const J$={apiKey:"AIzaSyC1ejMnWWe98bFa29RwIiBBB7UndNdJ1cA",authDomain:"salescaptureai.firebaseapp.com",projectId:"salescaptureai",storageBucket:"salescaptureai.firebasestorage.app",messagingSenderId:"392166418592",appId:"1:392166418592:web:7807d9aafec37b8c0581c5",measurementId:"G-BTPP6403LT"},lB=DF(J$),Y$=TH(),X$=VV(lB),Q$=e_(lB);class Z${constructor(){re(this,"doNotInclude",["render","forceUpdate","setState"])}bind(e){var n;let t=Object.getPrototypeOf(e);for(;t&&t!==Object.prototype;){const r=Object.getOwnPropertyNames(t).filter(s=>typeof t[s]=="function"&&s!=="constructor");for(let s of r)this.doNotInclude.includes(s)||(e[s]=(n=e[s])==null?void 0:n.bind(e));t=Object.getPrototypeOf(t)}}setDoNotIncludeList(e){this.doNotInclude=e}leaveOut(e){this.doNotInclude.push(e)}include(e){this.doNotInclude=this.doNotInclude.filter(t=>t!==e)}}let Ai=new Z$;class Hl{constructor(){re(this,"list",[]);Ai.bind(this)}setList(e){e=e.filter(t=>t!==void 0),this.list=e}getList(){return this.list}subscribe(e){e&&this.list.push(e)}unsubscribe(e){this.list=this.list.filter(t=>t!==e)}run(...e){for(let t of this.list)t&&t(...e)}}var Jg={},xN;function eW(){if(xN)return Jg;xN=1,Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.parse=o,Jg.serialize=c;const i=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,r=Object.prototype.toString,s=(()=>{const p=function(){};return p.prototype=Object.create(null),p})();function o(p,g){const w=new s,b=p.length;if(b<2)return w;const A=(g==null?void 0:g.decode)||d;let _=0;do{const C=p.indexOf("=",_);if(C===-1)break;const I=p.indexOf(";",_),S=I===-1?b:I;if(C>S){_=p.lastIndexOf(";",C-1)+1;continue}const R=a(p,_,C),L=u(p,C,R),k=p.slice(R,L);if(w[k]===void 0){let T=a(p,C+1,S),D=u(p,S,T);const P=A(p.slice(T,D));w[k]=P}_=S+1}while(_<b);return w}function a(p,g,w){do{const b=p.charCodeAt(g);if(b!==32&&b!==9)return g}while(++g<w);return w}function u(p,g,w){for(;g>w;){const b=p.charCodeAt(--g);if(b!==32&&b!==9)return g+1}return w}function c(p,g,w){const b=(w==null?void 0:w.encode)||encodeURIComponent;if(!i.test(p))throw new TypeError(`argument name is invalid: ${p}`);const A=b(g);if(!e.test(A))throw new TypeError(`argument val is invalid: ${g}`);let _=p+"="+A;if(!w)return _;if(w.maxAge!==void 0){if(!Number.isInteger(w.maxAge))throw new TypeError(`option maxAge is invalid: ${w.maxAge}`);_+="; Max-Age="+w.maxAge}if(w.domain){if(!t.test(w.domain))throw new TypeError(`option domain is invalid: ${w.domain}`);_+="; Domain="+w.domain}if(w.path){if(!n.test(w.path))throw new TypeError(`option path is invalid: ${w.path}`);_+="; Path="+w.path}if(w.expires){if(!m(w.expires)||!Number.isFinite(w.expires.valueOf()))throw new TypeError(`option expires is invalid: ${w.expires}`);_+="; Expires="+w.expires.toUTCString()}if(w.httpOnly&&(_+="; HttpOnly"),w.secure&&(_+="; Secure"),w.partitioned&&(_+="; Partitioned"),w.priority)switch(typeof w.priority=="string"?w.priority.toLowerCase():void 0){case"low":_+="; Priority=Low";break;case"medium":_+="; Priority=Medium";break;case"high":_+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${w.priority}`)}if(w.sameSite)switch(typeof w.sameSite=="string"?w.sameSite.toLowerCase():w.sameSite){case!0:case"strict":_+="; SameSite=Strict";break;case"lax":_+="; SameSite=Lax";break;case"none":_+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${w.sameSite}`)}return _}function d(p){if(p.indexOf("%")===-1)return p;try{return decodeURIComponent(p)}catch{return p}}function m(p){return r.call(p)==="[object Date]"}return Jg}eW();var SN="popstate";function tW(i={}){function e(n,r){let{pathname:s,search:o,hash:a}=n.location;return Zx("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(n,r){return typeof r=="string"?r:Yy(r)}return rW(e,t,null,i)}function Rn(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Ta(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nW(){return Math.random().toString(36).substring(2,10)}function TN(i,e){return{usr:i.state,key:i.key,idx:e}}function Zx(i,e,t=null,n){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?Qm(e):e,state:t,key:e&&e.key||n||nW()}}function Yy({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function Qm(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let n=i.indexOf("?");n>=0&&(e.search=i.substring(n),i=i.substring(0,n)),i&&(e.pathname=i)}return e}function rW(i,e,t,n={}){let{window:r=document.defaultView,v5Compat:s=!1}=n,o=r.history,a="POP",u=null,c=d();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function d(){return(o.state||{idx:null}).idx}function m(){a="POP";let A=d(),_=A==null?null:A-c;c=A,u&&u({action:a,location:b.location,delta:_})}function p(A,_){a="PUSH";let C=Zx(b.location,A,_);c=d()+1;let I=TN(C,c),S=b.createHref(C);try{o.pushState(I,"",S)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;r.location.assign(S)}s&&u&&u({action:a,location:b.location,delta:1})}function g(A,_){a="REPLACE";let C=Zx(b.location,A,_);c=d();let I=TN(C,c),S=b.createHref(C);o.replaceState(I,"",S),s&&u&&u({action:a,location:b.location,delta:0})}function w(A){return iW(A)}let b={get action(){return a},get location(){return i(r,o)},listen(A){if(u)throw new Error("A history only accepts one active listener");return r.addEventListener(SN,m),u=A,()=>{r.removeEventListener(SN,m),u=null}},createHref(A){return e(r,A)},createURL:w,encodeLocation(A){let _=w(A);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:p,replace:g,go(A){return o.go(A)}};return b}function iW(i,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Rn(t,"No window.location.(origin|href) available to create URL");let n=typeof i=="string"?i:Yy(i);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function uB(i,e,t="/"){return sW(i,e,t,!1)}function sW(i,e,t,n){let r=typeof e=="string"?Qm(e):e,s=Xl(r.pathname||"/",t);if(s==null)return null;let o=cB(i);oW(o);let a=null;for(let u=0;a==null&&u<o.length;++u){let c=yW(s);a=mW(o[u],c,n)}return a}function cB(i,e=[],t=[],n=""){let r=(s,o,a)=>{let u={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};u.relativePath.startsWith("/")&&(Rn(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let c=zl([n,u.relativePath]),d=t.concat(u);s.children&&s.children.length>0&&(Rn(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),cB(s.children,e,d,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:fW(c,s.index),routesMeta:d})};return i.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))r(s,o);else for(let u of hB(s.path))r(s,o,u)}),e}function hB(i){let e=i.split("/");if(e.length===0)return[];let[t,...n]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(n.length===0)return r?[s,""]:[s];let o=hB(n.join("/")),a=[];return a.push(...o.map(u=>u===""?s:[s,u].join("/"))),r&&a.push(...o),a.map(u=>i.startsWith("/")&&u===""?"/":u)}function oW(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:pW(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var aW=/^:[\w-]+$/,lW=3,uW=2,cW=1,hW=10,dW=-2,IN=i=>i==="*";function fW(i,e){let t=i.split("/"),n=t.length;return t.some(IN)&&(n+=dW),e&&(n+=uW),t.filter(r=>!IN(r)).reduce((r,s)=>r+(aW.test(s)?lW:s===""?cW:hW),n)}function pW(i,e){return i.length===e.length&&i.slice(0,-1).every((n,r)=>n===e[r])?i[i.length-1]-e[e.length-1]:0}function mW(i,e,t=!1){let{routesMeta:n}=i,r={},s="/",o=[];for(let a=0;a<n.length;++a){let u=n[a],c=a===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",m=r1({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},d),p=u.route;if(!m&&c&&t&&!n[n.length-1].route.index&&(m=r1({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!m)return null;Object.assign(r,m.params),o.push({params:r,pathname:zl([s,m.pathname]),pathnameBase:bW(zl([s,m.pathnameBase])),route:p}),m.pathnameBase!=="/"&&(s=zl([s,m.pathnameBase]))}return o}function r1(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,n]=gW(i.path,i.caseSensitive,i.end),r=e.match(t);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:n.reduce((c,{paramName:d,isOptional:m},p)=>{if(d==="*"){let w=a[p]||"";o=s.slice(0,s.length-w.length).replace(/(.)\/+$/,"$1")}const g=a[p];return m&&!g?c[d]=void 0:c[d]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:i}}function gW(i,e=!1,t=!0){Ta(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let n=[],r="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,u)=>(n.push({paramName:a,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(n.push({paramName:"*"}),r+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":i!==""&&i!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),n]}function yW(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ta(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function Xl(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=i.charAt(t);return n&&n!=="/"?null:i.slice(t)||"/"}function vW(i,e="/"){let{pathname:t,search:n="",hash:r=""}=typeof i=="string"?Qm(i):i;return{pathname:t?t.startsWith("/")?t:wW(t,e):e,search:AW(n),hash:EW(r)}}function wW(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function PE(i,e,t,n){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function _W(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function dB(i){let e=_W(i);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function fB(i,e,t,n=!1){let r;typeof i=="string"?r=Qm(i):(r={...i},Rn(!r.pathname||!r.pathname.includes("?"),PE("?","pathname","search",r)),Rn(!r.pathname||!r.pathname.includes("#"),PE("#","pathname","hash",r)),Rn(!r.search||!r.search.includes("#"),PE("#","search","hash",r)));let s=i===""||r.pathname==="",o=s?"/":r.pathname,a;if(o==null)a=t;else{let m=e.length-1;if(!n&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),m-=1;r.pathname=p.join("/")}a=m>=0?e[m]:"/"}let u=vW(r,a),c=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(c||d)&&(u.pathname+="/"),u}var zl=i=>i.join("/").replace(/\/\/+/g,"/"),bW=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),AW=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,EW=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function CW(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}var pB=["POST","PUT","PATCH","DELETE"];new Set(pB);var xW=["GET",...pB];new Set(xW);var Zm=Ae.createContext(null);Zm.displayName="DataRouter";var fb=Ae.createContext(null);fb.displayName="DataRouterState";var mB=Ae.createContext({isTransitioning:!1});mB.displayName="ViewTransition";var SW=Ae.createContext(new Map);SW.displayName="Fetchers";var TW=Ae.createContext(null);TW.displayName="Await";var Na=Ae.createContext(null);Na.displayName="Navigation";var J0=Ae.createContext(null);J0.displayName="Location";var nu=Ae.createContext({outlet:null,matches:[],isDataRoute:!1});nu.displayName="Route";var PI=Ae.createContext(null);PI.displayName="RouteError";function IW(i,{relative:e}={}){Rn(Y0(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=Ae.useContext(Na),{hash:r,pathname:s,search:o}=X0(i,{relative:e}),a=s;return t!=="/"&&(a=s==="/"?t:zl([t,s])),n.createHref({pathname:a,search:o,hash:r})}function Y0(){return Ae.useContext(J0)!=null}function sf(){return Rn(Y0(),"useLocation() may be used only in the context of a <Router> component."),Ae.useContext(J0).location}var gB="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function yB(i){Ae.useContext(Na).static||Ae.useLayoutEffect(i)}function DW(){let{isDataRoute:i}=Ae.useContext(nu);return i?VW():kW()}function kW(){Rn(Y0(),"useNavigate() may be used only in the context of a <Router> component.");let i=Ae.useContext(Zm),{basename:e,navigator:t}=Ae.useContext(Na),{matches:n}=Ae.useContext(nu),{pathname:r}=sf(),s=JSON.stringify(dB(n)),o=Ae.useRef(!1);return yB(()=>{o.current=!0}),Ae.useCallback((u,c={})=>{if(Ta(o.current,gB),!o.current)return;if(typeof u=="number"){t.go(u);return}let d=fB(u,JSON.parse(s),r,c.relative==="path");i==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:zl([e,d.pathname])),(c.replace?t.replace:t.push)(d,c.state,c)},[e,t,s,r,i])}Ae.createContext(null);function X0(i,{relative:e}={}){let{matches:t}=Ae.useContext(nu),{pathname:n}=sf(),r=JSON.stringify(dB(t));return Ae.useMemo(()=>fB(i,JSON.parse(r),n,e==="path"),[i,r,n,e])}function RW(i,e){return vB(i,e)}function vB(i,e,t,n){var _;Rn(Y0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=Ae.useContext(Na),{matches:s}=Ae.useContext(nu),o=s[s.length-1],a=o?o.params:{},u=o?o.pathname:"/",c=o?o.pathnameBase:"/",d=o&&o.route;{let C=d&&d.path||"";wB(u,!d||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=sf(),p;if(e){let C=typeof e=="string"?Qm(e):e;Rn(c==="/"||((_=C.pathname)==null?void 0:_.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${C.pathname}" was given in the \`location\` prop.`),p=C}else p=m;let g=p.pathname||"/",w=g;if(c!=="/"){let C=c.replace(/^\//,"").split("/");w="/"+g.replace(/^\//,"").split("/").slice(C.length).join("/")}let b=uB(i,{pathname:w});Ta(d||b!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Ta(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=FW(b&&b.map(C=>Object.assign({},C,{params:Object.assign({},a,C.params),pathname:zl([c,r.encodeLocation?r.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?c:zl([c,r.encodeLocation?r.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),s,t,n);return e&&A?Ae.createElement(J0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},A):A}function PW(){let i=UW(),e=CW(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",i),o=Ae.createElement(Ae.Fragment,null,Ae.createElement("p",null,"💿 Hey developer 👋"),Ae.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Ae.createElement("code",{style:s},"ErrorBoundary")," or"," ",Ae.createElement("code",{style:s},"errorElement")," prop on your route.")),Ae.createElement(Ae.Fragment,null,Ae.createElement("h2",null,"Unexpected Application Error!"),Ae.createElement("h3",{style:{fontStyle:"italic"}},e),t?Ae.createElement("pre",{style:r},t):null,o)}var NW=Ae.createElement(PW,null),OW=class extends Ae.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){console.error("React Router caught the following error during render",i,e)}render(){return this.state.error!==void 0?Ae.createElement(nu.Provider,{value:this.props.routeContext},Ae.createElement(PI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function LW({routeContext:i,match:e,children:t}){let n=Ae.useContext(Zm);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),Ae.createElement(nu.Provider,{value:i},t)}function FW(i,e=[],t=null,n=null){if(i==null){if(!t)return null;if(t.errors)i=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let r=i,s=t==null?void 0:t.errors;if(s!=null){let u=r.findIndex(c=>c.route.id&&(s==null?void 0:s[c.route.id])!==void 0);Rn(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),r=r.slice(0,Math.min(r.length,u+1))}let o=!1,a=-1;if(t)for(let u=0;u<r.length;u++){let c=r[u];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=u),c.route.id){let{loaderData:d,errors:m}=t,p=c.route.loader&&!d.hasOwnProperty(c.route.id)&&(!m||m[c.route.id]===void 0);if(c.route.lazy||p){o=!0,a>=0?r=r.slice(0,a+1):r=[r[0]];break}}}return r.reduceRight((u,c,d)=>{let m,p=!1,g=null,w=null;t&&(m=s&&c.route.id?s[c.route.id]:void 0,g=c.route.errorElement||NW,o&&(a<0&&d===0?(wB("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,w=null):a===d&&(p=!0,w=c.route.hydrateFallbackElement||null)));let b=e.concat(r.slice(0,d+1)),A=()=>{let _;return m?_=g:p?_=w:c.route.Component?_=Ae.createElement(c.route.Component,null):c.route.element?_=c.route.element:_=u,Ae.createElement(LW,{match:c,routeContext:{outlet:u,matches:b,isDataRoute:t!=null},children:_})};return t&&(c.route.ErrorBoundary||c.route.errorElement||d===0)?Ae.createElement(OW,{location:t.location,revalidation:t.revalidation,component:g,error:m,children:A(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):A()},null)}function NI(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function MW(i){let e=Ae.useContext(Zm);return Rn(e,NI(i)),e}function BW(i){let e=Ae.useContext(fb);return Rn(e,NI(i)),e}function jW(i){let e=Ae.useContext(nu);return Rn(e,NI(i)),e}function OI(i){let e=jW(i),t=e.matches[e.matches.length-1];return Rn(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function qW(){return OI("useRouteId")}function UW(){var n;let i=Ae.useContext(PI),e=BW("useRouteError"),t=OI("useRouteError");return i!==void 0?i:(n=e.errors)==null?void 0:n[t]}function VW(){let{router:i}=MW("useNavigate"),e=OI("useNavigate"),t=Ae.useRef(!1);return yB(()=>{t.current=!0}),Ae.useCallback(async(r,s={})=>{Ta(t.current,gB),t.current&&(typeof r=="number"?i.navigate(r):await i.navigate(r,{fromRouteId:e,...s}))},[i,e])}var DN={};function wB(i,e,t){!e&&!DN[i]&&(DN[i]=!0,Ta(!1,t))}Ae.memo(HW);function HW({routes:i,future:e,state:t}){return vB(i,void 0,t,e)}function Du(i){Rn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function zW({basename:i="/",children:e=null,location:t,navigationType:n="POP",navigator:r,static:s=!1}){Rn(!Y0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=i.replace(/^\/*/,"/"),a=Ae.useMemo(()=>({basename:o,navigator:r,static:s,future:{}}),[o,r,s]);typeof t=="string"&&(t=Qm(t));let{pathname:u="/",search:c="",hash:d="",state:m=null,key:p="default"}=t,g=Ae.useMemo(()=>{let w=Xl(u,o);return w==null?null:{location:{pathname:w,search:c,hash:d,state:m,key:p},navigationType:n}},[o,u,c,d,m,p,n]);return Ta(g!=null,`<Router basename="${o}"> is not able to match the URL "${u}${c}${d}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:Ae.createElement(Na.Provider,{value:a},Ae.createElement(J0.Provider,{children:e,value:g}))}function kN({children:i,location:e}){return RW(eS(i),e)}function eS(i,e=[]){let t=[];return Ae.Children.forEach(i,(n,r)=>{if(!Ae.isValidElement(n))return;let s=[...e,r];if(n.type===Ae.Fragment){t.push.apply(t,eS(n.props.children,s));return}Rn(n.type===Du,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Rn(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=eS(n.props.children,s)),t.push(o)}),t}var t_="get",n_="application/x-www-form-urlencoded";function pb(i){return i!=null&&typeof i.tagName=="string"}function $W(i){return pb(i)&&i.tagName.toLowerCase()==="button"}function WW(i){return pb(i)&&i.tagName.toLowerCase()==="form"}function GW(i){return pb(i)&&i.tagName.toLowerCase()==="input"}function KW(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function JW(i,e){return i.button===0&&(!e||e==="_self")&&!KW(i)}var Rw=null;function YW(){if(Rw===null)try{new FormData(document.createElement("form"),0),Rw=!1}catch{Rw=!0}return Rw}var XW=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function NE(i){return i!=null&&!XW.has(i)?(Ta(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${n_}"`),null):i}function QW(i,e){let t,n,r,s,o;if(WW(i)){let a=i.getAttribute("action");n=a?Xl(a,e):null,t=i.getAttribute("method")||t_,r=NE(i.getAttribute("enctype"))||n_,s=new FormData(i)}else if($W(i)||GW(i)&&(i.type==="submit"||i.type==="image")){let a=i.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=i.getAttribute("formaction")||a.getAttribute("action");if(n=u?Xl(u,e):null,t=i.getAttribute("formmethod")||a.getAttribute("method")||t_,r=NE(i.getAttribute("formenctype"))||NE(a.getAttribute("enctype"))||n_,s=new FormData(a,i),!YW()){let{name:c,type:d,value:m}=i;if(d==="image"){let p=c?`${c}.`:"";s.append(`${p}x`,"0"),s.append(`${p}y`,"0")}else c&&s.append(c,m)}}else{if(pb(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=t_,n=null,r=n_,o=i}return s&&r==="text/plain"&&(o=s,s=void 0),{action:n,method:t.toLowerCase(),encType:r,formData:s,body:o}}function LI(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}async function ZW(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function eG(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function tG(i,e,t){let n=await Promise.all(i.map(async r=>{let s=e.routes[r.route.id];if(s){let o=await ZW(s,t);return o.links?o.links():[]}return[]}));return sG(n.flat(1).filter(eG).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function RN(i,e,t,n,r,s){let o=(u,c)=>t[c]?u.route.id!==t[c].route.id:!0,a=(u,c)=>{var d;return t[c].pathname!==u.pathname||((d=t[c].route.path)==null?void 0:d.endsWith("*"))&&t[c].params["*"]!==u.params["*"]};return s==="assets"?e.filter((u,c)=>o(u,c)||a(u,c)):s==="data"?e.filter((u,c)=>{var m;let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(o(u,c)||a(u,c))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((m=t[0])==null?void 0:m.params)||{},nextUrl:new URL(i,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function nG(i,e,{includeHydrateFallback:t}={}){return rG(i.map(n=>{let r=e.routes[n.route.id];if(!r)return[];let s=[r.module];return r.clientActionModule&&(s=s.concat(r.clientActionModule)),r.clientLoaderModule&&(s=s.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(s=s.concat(r.hydrateFallbackModule)),r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function rG(i){return[...new Set(i)]}function iG(i){let e={},t=Object.keys(i).sort();for(let n of t)e[n]=i[n];return e}function sG(i,e){let t=new Set;return new Set(e),i.reduce((n,r)=>{let s=JSON.stringify(iG(r));return t.has(s)||(t.add(s),n.push({key:s,link:r})),n},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var oG=new Set([100,101,204,205]);function aG(i,e){let t=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return t.pathname==="/"?t.pathname="_root.data":e&&Xl(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function _B(){let i=Ae.useContext(Zm);return LI(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function lG(){let i=Ae.useContext(fb);return LI(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var FI=Ae.createContext(void 0);FI.displayName="FrameworkContext";function bB(){let i=Ae.useContext(FI);return LI(i,"You must render this element inside a <HydratedRouter> element"),i}function uG(i,e){let t=Ae.useContext(FI),[n,r]=Ae.useState(!1),[s,o]=Ae.useState(!1),{onFocus:a,onBlur:u,onMouseEnter:c,onMouseLeave:d,onTouchStart:m}=e,p=Ae.useRef(null);Ae.useEffect(()=>{if(i==="render"&&o(!0),i==="viewport"){let b=_=>{_.forEach(C=>{o(C.isIntersecting)})},A=new IntersectionObserver(b,{threshold:.5});return p.current&&A.observe(p.current),()=>{A.disconnect()}}},[i]),Ae.useEffect(()=>{if(n){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[n]);let g=()=>{r(!0)},w=()=>{r(!1),o(!1)};return t?i!=="intent"?[s,p,{}]:[s,p,{onFocus:Yg(a,g),onBlur:Yg(u,w),onMouseEnter:Yg(c,g),onMouseLeave:Yg(d,w),onTouchStart:Yg(m,g)}]:[!1,p,{}]}function Yg(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function cG({page:i,...e}){let{router:t}=_B(),n=Ae.useMemo(()=>uB(t.routes,i,t.basename),[t.routes,i,t.basename]);return n?Ae.createElement(dG,{page:i,matches:n,...e}):null}function hG(i){let{manifest:e,routeModules:t}=bB(),[n,r]=Ae.useState([]);return Ae.useEffect(()=>{let s=!1;return tG(i,e,t).then(o=>{s||r(o)}),()=>{s=!0}},[i,e,t]),n}function dG({page:i,matches:e,...t}){let n=sf(),{manifest:r,routeModules:s}=bB(),{basename:o}=_B(),{loaderData:a,matches:u}=lG(),c=Ae.useMemo(()=>RN(i,e,u,r,n,"data"),[i,e,u,r,n]),d=Ae.useMemo(()=>RN(i,e,u,r,n,"assets"),[i,e,u,r,n]),m=Ae.useMemo(()=>{if(i===n.pathname+n.search+n.hash)return[];let w=new Set,b=!1;if(e.forEach(_=>{var I;let C=r.routes[_.route.id];!C||!C.hasLoader||(!c.some(S=>S.route.id===_.route.id)&&_.route.id in a&&((I=s[_.route.id])!=null&&I.shouldRevalidate)||C.hasClientLoader?b=!0:w.add(_.route.id))}),w.size===0)return[];let A=aG(i,o);return b&&w.size>0&&A.searchParams.set("_routes",e.filter(_=>w.has(_.route.id)).map(_=>_.route.id).join(",")),[A.pathname+A.search]},[o,a,n,r,c,e,i,s]),p=Ae.useMemo(()=>nG(d,r),[d,r]),g=hG(d);return Ae.createElement(Ae.Fragment,null,m.map(w=>Ae.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),p.map(w=>Ae.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),g.map(({key:w,link:b})=>Ae.createElement("link",{key:w,...b})))}function fG(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var AB=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{AB&&(window.__reactRouterVersion="7.6.2")}catch{}function pG({basename:i,children:e,window:t}){let n=Ae.useRef();n.current==null&&(n.current=tW({window:t,v5Compat:!0}));let r=n.current,[s,o]=Ae.useState({action:r.action,location:r.location}),a=Ae.useCallback(u=>{Ae.startTransition(()=>o(u))},[o]);return Ae.useLayoutEffect(()=>r.listen(a),[r,a]),Ae.createElement(zW,{basename:i,children:e,location:s.location,navigationType:s.action,navigator:r})}var EB=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yn=Ae.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:s,replace:o,state:a,target:u,to:c,preventScrollReset:d,viewTransition:m,...p},g){let{basename:w}=Ae.useContext(Na),b=typeof c=="string"&&EB.test(c),A,_=!1;if(typeof c=="string"&&b&&(A=c,AB))try{let D=new URL(window.location.href),P=c.startsWith("//")?new URL(D.protocol+c):new URL(c),N=Xl(P.pathname,w);P.origin===D.origin&&N!=null?c=N+P.search+P.hash:_=!0}catch{Ta(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=IW(c,{relative:r}),[I,S,R]=uG(n,p),L=vG(c,{replace:o,state:a,target:u,preventScrollReset:d,relative:r,viewTransition:m});function k(D){e&&e(D),D.defaultPrevented||L(D)}let T=Ae.createElement("a",{...p,...R,href:A||C,onClick:_||s?e:k,ref:fG(g,S),target:u,"data-discover":!b&&t==="render"?"true":void 0});return I&&!b?Ae.createElement(Ae.Fragment,null,T,Ae.createElement(cG,{page:C})):T});yn.displayName="Link";var mG=Ae.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:s,to:o,viewTransition:a,children:u,...c},d){let m=X0(o,{relative:c.relative}),p=sf(),g=Ae.useContext(fb),{navigator:w,basename:b}=Ae.useContext(Na),A=g!=null&&EG(m)&&a===!0,_=w.encodeLocation?w.encodeLocation(m).pathname:m.pathname,C=p.pathname,I=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;t||(C=C.toLowerCase(),I=I?I.toLowerCase():null,_=_.toLowerCase()),I&&b&&(I=Xl(I,b)||I);const S=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let R=C===_||!r&&C.startsWith(_)&&C.charAt(S)==="/",L=I!=null&&(I===_||!r&&I.startsWith(_)&&I.charAt(_.length)==="/"),k={isActive:R,isPending:L,isTransitioning:A},T=R?e:void 0,D;typeof n=="function"?D=n(k):D=[n,R?"active":null,L?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let P=typeof s=="function"?s(k):s;return Ae.createElement(yn,{...c,"aria-current":T,className:D,ref:d,style:P,to:o,viewTransition:a},typeof u=="function"?u(k):u)});mG.displayName="NavLink";var gG=Ae.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:r,state:s,method:o=t_,action:a,onSubmit:u,relative:c,preventScrollReset:d,viewTransition:m,...p},g)=>{let w=bG(),b=AG(a,{relative:c}),A=o.toLowerCase()==="get"?"get":"post",_=typeof a=="string"&&EB.test(a),C=I=>{if(u&&u(I),I.defaultPrevented)return;I.preventDefault();let S=I.nativeEvent.submitter,R=(S==null?void 0:S.getAttribute("formmethod"))||o;w(S||I.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:r,state:s,relative:c,preventScrollReset:d,viewTransition:m})};return Ae.createElement("form",{ref:g,method:A,action:b,onSubmit:n?u:C,...p,"data-discover":!_&&i==="render"?"true":void 0})});gG.displayName="Form";function yG(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CB(i){let e=Ae.useContext(Zm);return Rn(e,yG(i)),e}function vG(i,{target:e,replace:t,state:n,preventScrollReset:r,relative:s,viewTransition:o}={}){let a=DW(),u=sf(),c=X0(i,{relative:s});return Ae.useCallback(d=>{if(JW(d,e)){d.preventDefault();let m=t!==void 0?t:Yy(u)===Yy(c);a(i,{replace:m,state:n,preventScrollReset:r,relative:s,viewTransition:o})}},[u,a,c,t,n,e,i,r,s,o])}var wG=0,_G=()=>`__${String(++wG)}__`;function bG(){let{router:i}=CB("useSubmit"),{basename:e}=Ae.useContext(Na),t=qW();return Ae.useCallback(async(n,r={})=>{let{action:s,method:o,encType:a,formData:u,body:c}=QW(n,e);if(r.navigate===!1){let d=r.fetcherKey||_G();await i.fetch(d,t,r.action||s,{preventScrollReset:r.preventScrollReset,formData:u,body:c,formMethod:r.method||o,formEncType:r.encType||a,flushSync:r.flushSync})}else await i.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:u,body:c,formMethod:r.method||o,formEncType:r.encType||a,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[i,e,t])}function AG(i,{relative:e}={}){let{basename:t}=Ae.useContext(Na),n=Ae.useContext(nu);Rn(n,"useFormAction must be used inside a RouteContext");let[r]=n.matches.slice(-1),s={...X0(i||".",{relative:e})},o=sf();if(i==null){s.search=o.search;let a=new URLSearchParams(s.search),u=a.getAll("index");if(u.some(d=>d==="")){a.delete("index"),u.filter(m=>m).forEach(m=>a.append("index",m));let d=a.toString();s.search=d?`?${d}`:""}}return(!i||i===".")&&r.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:zl([t,s.pathname])),Yy(s)}function EG(i,e={}){let t=Ae.useContext(mB);Rn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=CB("useViewTransitionState"),r=X0(i,{relative:e.relative});if(!t.isTransitioning)return!1;let s=Xl(t.currentLocation.pathname,n)||t.currentLocation.pathname,o=Xl(t.nextLocation.pathname,n)||t.nextLocation.pathname;return r1(r.pathname,o)!=null||r1(r.pathname,s)!=null}[...oG];var CG=ST();const xG=M0(CG);class SG{constructor(e){Ai.bind(this),this.props={...e},this.content=e.content||"",this.type="div"}setHtmlType(e){this.type=e}getHtmlType(){return this.type}setProp(e,t){this.props[e]=t}setProps(e){this.props={...e},e.content&&(this.content=e.content)}updateProps(e){this.props={...this.props,...e},e.content&&(this.content=e.content)}addProps(e){this.props={...this.props,...e},e.content&&(this.content=e.content)}getProps(){return this.props}getProp(e){return this.props[e]}setStyle(e){this.props.style=e}updateStyle(e){this.props.style={...this.props.style,...e}}getStyle(){return this.props.style}setClass(e){this.props.className=e}getClass(){return this.props.className}setOnChange(e){this.props.onChange=e}setOnClick(e){this.props.onClick=e}getOnClick(){return this.props.onClick}setContent(e){this.content=e}getContent(){return this.content}getHtml(e){let{content:t,props:n}=e,r=e==null?void 0:e.type;t&&(this.content=t),n={...this.props,...n};const s={a:v.jsx("a",{...n,children:this.content}),button:v.jsx("button",{...n,children:this.content}),div:v.jsx("div",{...n,children:this.content}),h1:v.jsx("h1",{...n,children:this.content}),h2:v.jsx("h2",{...n,children:this.content}),h3:v.jsx("h3",{...n,children:this.content}),h4:v.jsx("h4",{...n,children:this.content}),h5:v.jsx("h5",{...n,children:this.content}),h6:v.jsx("h6",{...n,children:this.content}),img:v.jsx("img",{...n}),input:v.jsx("input",{...n}),p:v.jsx("p",{...n,children:this.content}),span:v.jsx("span",{...n,children:this.content}),table:v.jsx("table",{...n,children:this.content}),tr:v.jsx("tr",{...n,children:this.content}),td:v.jsx("td",{...n,children:this.content}),th:v.jsx("th",{...n,children:this.content}),ul:v.jsx("ul",{...n,children:this.content}),li:v.jsx("li",{...n,children:this.content}),ol:v.jsx("ol",{...n,children:this.content}),form:v.jsx("form",{...n,children:this.content}),textarea:v.jsx("textarea",{...n,children:this.content}),select:v.jsx("select",{...n,children:this.content}),option:v.jsx("option",{...n,children:this.content}),label:v.jsx("label",{...n,children:this.content}),nav:v.jsx("nav",{...n,children:this.content}),footer:v.jsx("footer",{...n,children:this.content}),header:v.jsx("header",{...n,children:this.content}),article:v.jsx("article",{...n,children:this.content}),section:v.jsx("section",{...n,children:this.content}),aside:v.jsx("aside",{...n,children:this.content}),main:v.jsx("main",{...n,children:this.content}),video:v.jsx("video",{...n,children:this.content}),audio:v.jsx("audio",{...n,children:this.content}),iframe:v.jsx("iframe",{...n,children:this.content}),canvas:v.jsx("canvas",{...n,children:this.content}),content:v.jsx(v.Fragment,{}),fragment:v.jsx(v.Fragment,{children:this.content}),link:v.jsx(yn,{...n,children:this.content})};if(r==="content"||this.type==="conent"){let a=this.content;s.content=v.jsx(a,{...n})}return r?s[r]:s[this.type]}}class TG extends Hl{constructor(){super(...arguments);re(this,"component");re(this,"setAttribute")}setObserverFunction(t){this.setAttribute=t}setComponent(t){this.component=t}getComponent(){return this.component}run(){for(let t of this.list)this.setAttribute(t.name,new SG(t))}}class eg{constructor(){re(this,"factory");re(this,"componentList");re(this,"themeFactory");re(this,"appComponent");re(this,"mainFunc");re(this,"appObserver",new Hl);Ai.bind(this),this.getFactory(),this.getThemeFactory()}subscribeToAppObserver(e){this.appObserver.subscribe(e)}getMainFunc(){return this.mainFunc}getFactory(){}getThemeFactory(){}getAppComponent(){return this.appComponent}setAppComponent(e){this.appComponent=e,this.appObserver.run(e)}getComponentList(){var e,t;return this.componentList||(this.componentList=(t=(e=this.appComponent)==null?void 0:e.state)==null?void 0:t.componentList),this.componentList}}class IG extends eg{constructor(){super(...arguments);re(this,"type","appInterface")}}const xB=new IG;class ct extends Ae.Component{constructor(t){super(t);re(this,"resize");Ai.bind(this),this.initialBuilderSetupFunctions=[],this.setInterface(),this.setInitialApp(),this.initialPropsSetupFunctions=[this.setInterface,this.setAppOnInterace,this.setInitialApp,this.setObj,this.setThemeFactory,this.setTheme,this.createReactRefsForComponents],this.setupObserver=new Hl,this.builderObserver=new TG,this.ObserverForSetupFunction=new Hl,this.builderObserver.setComponent(this),this.builderObserver.setObserverFunction(this.setHtmlBuilderSingleton),this.initialSetupFunctions=[this.builderObserver.run,this.additionalSetup],this.components=[]}setInitialApp(){var n,r,s,o,a,u;this.interface||(this.app=(n=this.props)==null?void 0:n.app);let t=this.interface.getAppComponent();t&&(this.app=t),this.app&&(this.propsState=(r=this.app)==null?void 0:r.state,this.dispatch=(s=this.app)==null?void 0:s.dispatch,this.componentList=(o=this.propsState)==null?void 0:o.componentList,this.APIService=(a=this.componentList)==null?void 0:a.getAPIService(),this.operationsFactory=(u=this.componentList)==null?void 0:u.getOperationsFactory())}setInterface(t){var n;this.interface=t||((n=this.props)==null?void 0:n.interface)||this.interface||xB,this.interface.type==="appInterface"&&this.subscribeToAppObserverBool===void 0&&(this.subscribeToAppObserverBool=!0,this.interface.subscribeToAppObserver(this.setInitialApp))}setAppOnInterace(){this.interface&&(this.props.app&&this.interface.setAppComponent(this.props.app),this.app=this.interface.getAppComponent())}setComponents(t){this.components=t}getComponents(){return this.components}createReactRefsForComponents(){for(let t of this.components)this[t+"Ref"]||(this[t+"Ref"]=ze.createRef())}createPropObj(t,n){n=n||this.state.propType;let r,s=this[n||"props"][t+"Class"];return s||(s=this.theme&&typeof this.theme!="string"?this.theme[this.state[t+"Class"]]:this["default"+t+"Class"]||""),r={name:t,ref:this[t+"Ref"],style:this[t+"Click"]?{...this[n||"props"][t+"Style"],cursor:"pointer"}:this[n||"props"][t+"Style"],className:s,content:this[n||"props"][t],onClick:this[n||"props"][t+"Click"]||this[t+"Click"],obj:this.obj},r.onClick&&(r.onClick=r.onClick.bind(this,this.obj)),r}builderPropsSubscribe(t){this[t+"Props"]=this.createPropObj(t),this.builderObserver.subscribe(this[t+"Props"])}setInitialBuilderPropFunctions(){for(let t of this.components)this["set"+t+"props"]||(this["set"+t+"props"]=this.builderPropsSubscribe(t)),this.initialBuilderSetupFunctions.push(this["set"+t+"props"]);return this.initialBuilderSetupFunctions}loadObserver(){this.setupObserver.setList(this.initialSetupFunctions)}setInitialSetupFunctions(){const t=[...this.initialPropsSetupFunctions,...this.initialBuilderSetupFunctions,...this.initialSetupFunctions,this.additionalPostSetup],n=[...new Set(t)];return this.initialSetupFunctions=n,this.initialSetupFunctions}runInitialPropsSetup(){for(let t of this.initialPropsSetupFunctions)t&&t()}isArray(t){return Array.isArray(t)?t:[t]}setObj(){this.obj=this.props.obj}setThemeFactory(){this.interface!==void 0&&(this.themeFactory=this.interface.getThemeFactory())}setTheme(){var t,n;this.themeFactory&&(this.theme=this.themeFactory.getComponent(((t=this.props)==null?void 0:t.theme)||((n=this.state)==null?void 0:n.defaultTheme)||"default"))}clearLists(){this.setupObserver.setList([]),this.builderObserver.setList([])}setupItem(...t){this.clearLists(),this.preSetup(),this.runInitialPropsSetup(),this.setInitialBuilderPropFunctions(),this.setInitialSetupFunctions(),this.loadObserver(),this.setupObserver.run(...t)}preSetup(){}setAttribute(t,n){this[t]=n}setHtmlBuilderSingleton(t,n){this[t]||(this[t]=n)}getInnerContent(){return this.innerContent}getAdditionalInnerContent(){return this.innerContent}mapList(t){return v.jsx(v.Fragment,{children:t.filter(n=>n!==void 0&&n!==!1).map(n=>n)})}additionalSetup(){}additionalPostSetup(){}mapInnerContent(){return this.getInnerContent(),this.getAdditionalInnerContent(),this.innerContent=this.mapList(this.innerContent),this.innerContent}getHtml(){return this.html}getFactoryTypeString(t){let n=this.propsState.componentListInterface.getFactory().getRegistry(),r=n.find(s=>t.toLowerCase()===s);return r=r||n.find(s=>t.toLowerCase().includes(s)),r}getCapitalFirstLetter(t){var n;return((n=t==null?void 0:t.charAt(0))==null?void 0:n.toUpperCase())+(t==null?void 0:t.slice(1))}classNameToString(t){let n=t.name;return n.charAt(0).toLowerCase()+n.slice(1)}render(){return this.setupItem(),this.html=this.getHtml(),this.html}}class DG extends eg{}const SB=new DG;class pr extends ct{constructor(t){super(t);re(this,"type");re(this,"theme");re(this,"interface");this.wrapperRef=ze.createRef(),this.setWrapperRef=this.setWrapperRef,this.initialPropsSetupFunctions=[...this.initialPropsSetupFunctions,this.setApp,this.setType,this.setClassStr],this.state={defaultType:this.props.type?this.props.type:"fit",defaultTheme:this.props.theme?this.props.theme:"Default",typeKey:"type",themeKey:"theme"},this.interface=SB}componentDidMount(){this.props.popup&&document.addEventListener("mousedown",this.handleClickOutside)}componentWillUnmount(){this.props.popup&&document.removeEventListener("mousedown",this.handleClickOutside)}handleClickOutside(t){this.wrapperRef&&!this.wrapperRef.current.contains(t.target)&&this.props.handleClose&&this.props.handleClose()}isPopup(t){if(this.props.popup){let n=this.closePopup.getHtml({content:this.props.closeUI||v.jsx(v.Fragment,{children:"X"}),props:{onClick:()=>{this.props.handleClose&&this.props.handleClose()}}}),r=this.popupContent.getHtml({content:v.jsxs(v.Fragment,{children:[n,t]}),props:{ref:this.wrapperRef}});t=this.backDrop.getHtml({content:r})}return t}setTheme(){this.theme=this.props[this.state.themeKey]?this.props[this.state.themeKey]:this.state.defaultTheme}setType(){this.type=this.props[this.state.typeKey]?this.props[this.state.typeKey]:this.state.defaultType}setClassStr(){this.defaultcardClass=this.type+this.theme+" scroller",this.defaultcardClass=this.props.popup?this.defaultcardClass+" cardPopup":this.defaultcardClass,this.props.popup&&(this.defaultbackDropClass="backDropPopup",this.defaultpopupContentClass="popupContent",this.defaultclosePopupClass="closePopup")}getHtml(){let t=this.getContent();return this.html=this.card.getHtml({content:t}),this.html=this.isPopup(this.html),this.html}getContent(){return this.content=this.props.content,this.content}preSetup(){let t=["card"];this.props.popup&&(t=[...t,"backDrop","popupContent","closePopup"]),this.setComponents(t)}}let kG=class{constructor(e){re(this,"operationsFactory");re(this,"dispatch");re(this,"json",{_id:"",backendKeys:[],backendAttributes:[],backendFilterKeys:[],orderMatters:!1,orderFilterKey:"",filterKey:"",removeOwnerQuery:[]});re(this,"componentList");re(this,"APIService");Ai.bind(this),this.operationsFactory=e,this.json._id=this.createId()}getAssociatedItemsHelper(e){let t=this.json._id,n=this.json.type+"Id";return this.json.backendAttributes.length>0&&(t=this.json[this.json.backendAttributes[e]]),this.json.backendFilterKeys.length>0&&(n=this.json.backendFilterKeys[e]),{attribute:t,filterKey:n}}async getAssociatedItems(e){e=e||this.json.backendKeys;const t=e==null?void 0:e.map((n,r)=>{let{attribute:s,filterKey:o}=this.getAssociatedItemsHelper(r);return this.componentList.getList(n,s,o)});return await Promise.all(t)}async getAssociatedItemsFromBackend(e,t){e=e||this.json.backendKeys;let n=!0;const r=e==null?void 0:e.map((s,o)=>{this.json.removeOwnerQuery.includes(s)&&(n=!1);let{attribute:a,filterKey:u}=this.getAssociatedItemsHelper(o);return this.componentList.getComponentsFromBackend({type:s,ids:a,filterKeys:u,owner:n,...t})});return await Promise.all(r)}setComponentList(e){this.componentList=e,this.componentList.getAPIService&&this.setAPIService(this.componentList.getAPIService()),this.componentList.getDispatch&&this.setDispatch(this.componentList.getDispatch())}setDispatch(e){this.dispatch=e}getDispatch(){return this.dispatch}getComponentList(){return this.componentList}setAPIService(e){this.APIService=e}getAPIService(){return this.APIService}update(...e){this.APIService&&this.APIService.update([this],...e)}del(...e){this.componentList.del(this,{...e})}updateOrder(e,t){e=e||-1,e===!0&&(e=1);let n=this.componentList.getList(this.json.type,this.json[this.json.orderFilterKey],this.json.orderFilterKey);t=t||(this.json.orderKey?this.json[this.json.orderKey]:"order");let r=n.indexOf(this),s;e<0&&r===0?this.json[t]=n.length:e>0&&r===n.length-1?(this.json[t]=0,this.componentList.shiftOrderedList(this,t)):(s=n[r+e],s.setCompState({[t]:r},{run:!0,clean:!0}),this.json[t]=r+e),this.componentList.sortSelectedList(this.json.type,this.json.orderKey||"order"),this.componentList.resetOrder(this,t),this.update()}prepare(){this.operationsFactory.prepare({prepare:this})}setAttribute(e,t){this[e]=t}setAttributes(e){for(let t in e)this[t]=e[t]}getAttribute(e){return this[e]}getJsonAttribute(e){return this.json[e]}setCompState(e,t,n,r){this.subscribeToOperations(t),this.json={...this.json,...e},n&&this.dispatch({updated:this}),r&&r(e),t!=null&&t.run&&this.operationsFactory.runOperations()}getOperationsFactory(){return this.operationsFactory}setJson(e,t,n,r){this.subscribeToOperations(t),this.json=e,n&&this.dispatch({updated:this}),r&&r(this),t!=null&&t.run&&this.operationsFactory.runOperations()}getJson(){return this.json}subscribeToOperations(e){e&&this.operationsFactory.subscribeToOperations(e.operation||this.update,e.clean)}copyJson(e){return{...this.json,_id:"",...e}}copy(e){let t=this.copyJson(e);this.componentList.addComponents(t)}updateObjInsideJson(e,t){this.json[e]={...this.json[e],...t}}removeObjInsideJson(e,t){let n={};for(const r in this.json[e])t.includes(r)||(n[r]=this.json[e][r]);this.json[e]=n}randomFiveDigitNumber(){let e=Math.floor(Math.random()*9e4)+1e4;e=e.toString();let t=String.fromCharCode(97+Math.floor(Math.random()*26)),n=Math.floor(Math.random()*5);if(e=e.substring(0,n)+t+e.substring(n+1),Math.floor(Math.random()*2)===1){let s=String.fromCharCode(97+Math.floor(Math.random()*26)),o;do o=Math.floor(Math.random()*5);while(o===n);e=e.substring(0,o)+s+e.substring(o+1)}return e}createId(){const e=new Date,t=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0"),r=e.getFullYear().toString().slice(-2);return this.randomFiveDigitNumber().toString()+t+n+r}createUUID(e){let t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz123456789",r=n.length;for(let s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*r));return t}};class RG{constructor(){re(this,"operationsFactory");re(this,"factory",{})}registerComponents(e){this.factory[e.name]=e.component}setOperationsFactory(e){this.operationsFactory=e}getRegistry(){return Object.keys(this.factory)}async getComponent(e){if(Object.keys(this.factory).includes(e.type)){let t=e.type,n=new this.factory[t](this.operationsFactory);return[void 0,"",!1].includes(e._id)&&(e._id=n.getJson()._id),n.setCompState({...e}),n}}}class PG extends Hl{clear(){this.list=[]}cleanSubscibe(e){this.clear(),this.subscribe(e)}run(...e){for(let t of this.list)t&&t(...e);this.clear()}}class PN{constructor(e){re(this,"register");re(this,"factory");re(this,"operationsObserver");Ai.bind(this),this.add=[],this.lastChange=[],this.factory=e.getFactory(),this.operationsObserver=new PG}removeFromList(e){this.add=this.add.filter(t=>t!==e)}getOperationsObserver(){return this.operationsObserver}setOperationsObserver(e){this.operationsObserver=e}subscribeToOperations(e,t){t&&this.operationsObserver.clear(),this.operationsObserver.subscribe(e)}runOperations(...e){this.operationsObserver.run(...e)}setAddList(e){this.add=[...e],this.lastChange=[...this.add]}getAddList(){return this.add}getLastPrepare(){return this.lastChange}async prepare(e,t){let{prepare:n,amount:r,clean:s}=e;r=r||1;let o=Array.isArray(n)?n:[n];o=o.flatMap(u=>Array(r).fill(u));let a=[];for(let u of o){let c=await this.factory.getComponent({...u});a.push(c)}return o=[...a],this.setAddList(s?[...o]:[...this.add,...o]),t&&t(this.add),e.run&&await this.addToComponentList(),this.add}clear(){this.setAddList([])}removeFromRegister(e){this.setAddList(this.add.filter(t=>t!==e))}run(e){this.addToComponentList(e)}addToComponentList(e){let t=[...this.add];return this.clear(),this.register(t,{skipBackendUpdate:e}),t}setRegister(e){this.register=e}}class NG{constructor(e){re(this,"components",[]);re(this,"dispatch");re(this,"backArray",{});re(this,"operationsFactory");re(this,"componentListInterface");re(this,"componentsList",{});re(this,"completionObserver",new Hl);re(this,"factory");re(this,"APIService");Ai.bind(this),this.operationsFactory=e.getOperationsFactory(),this.operationsFactory.setRegister(this.add),this.componentListInterface=e,this.factory=e.getFactory(),this.dispatch=e.dispatch,this.APIService=e.getAPIService(),this.APIService.setComponentList(this),this.completionObserver.subscribe(this.setComponentsList),this.completionObserver.subscribe(this.setOrderAfterAddorDel)}getFactory(){return this.factory}getDispatch(){return this.dispatch}setDispatch(e){this.dispatch=e}getCompletionObserver(){return this.completionObserver}setCompoletionObserver(e){this.completionObserver=e}subscribeToOperationCompletion(e){this.completionObserver.subscribe(e)}getAPIService(){return this.APIService}setAPIService(e){this.APIService=e}getComponents(){return this.components}filterOutErrors(e){let t=this.components.map(r=>r.getJson()._id);e=e.filter(r=>r!==void 0),e=e.map(r=>{if(r!==void 0&&t.includes(r.getJson()._id)){let s=this.components.find(o=>o.getJson()._id===r.getJson()._id);r.setJson({...s.getJson(),...r.getJson()})}return r}),e=e.filter(r=>!t.includes(r.getJson()._id));let n=this.factory.getRegistry();return e=e.filter(r=>n.includes(r.getJson().type)),e}add(e,t){return e=Array.isArray(e)?e:[e],e=this.filterOutErrors(e),e.forEach(n=>{n.setComponentList(this)}),this.components=[...this.components,...e],this.operationComplete(e,"add",t)}setComponentsList(){let e={};this.componentListInterface.getFactory().getRegistry().forEach(n=>{e[n]=[]});for(let n of this.components){let r=n.getJson().type;e[r].push(n)}this.componentsList=e}async addComponents(e,t){e.prepare||(e={prepare:Array.isArray(e)?e:[e]}),await this.operationsFactory.prepare({...e}),this.operationsFactory.addToComponentList(t);let n=e==null?void 0:e.prepare.map(s=>s._id);return await this.components.filter(s=>n.includes(s.getJson()._id))}del(e,t){return e=Array.isArray(e)?e:[e],this.components=this.components.filter(n=>!e.includes(n)),this.operationComplete(e,"del",t)}setOrderAfterAddorDel(e){for(let t of e){let n=t.getJson();if(n.orderMatters){let r=this.getList(n.type,n[n.orderFilterKey],n.orderFilterKey),s=n.orderKey?n[n.orderKey]:"order",o=t.getJson()[s],u=r.filter(d=>{let m=parseInt(d.getJson()[s]);return o=parseInt(o),m===o}).find(d=>!e.includes(d)),c=r.indexOf(t);u&&u!==t&&t.setCompState({[s]:c}),this.sortSelectedList(n.type,n.orderKey||"order"),this.resetOrder(t,s)}}}shiftOrderedList(e,t){let n=e.getJson();this.sortSelectedList(n.type,n.orderKey||"order");let r=this.getList(n.type,n[n.orderFilterKey],n.orderFilterKey);t=t||(n.orderKey?n[n.orderKey]:"order"),r=r.filter(s=>s!==e);for(let s=1;s<r.length;s++)r[s-1].setCompState({[t]:s},{run:!0,clean:!0})}resetOrder(e,t){let n=e.getJson();t=t||(n.orderKey?n[n.orderKey]:n.order);let r=this.getList(n.type,n[n.orderFilterKey],n.orderFilterKey);for(let s=0;s<r.length;s++)r[s][t]!==s&&(r[s].setCompState({[t]:s}),r[s]!==e&&r[s].update())}operationComplete(e,t,n){return this.completionObserver.run(e,t,n),this.backArray={[t]:e},n.skipBackendUpdate||this.updateBackend(e,t,n),e}updateBackend(e,t,n){this.dispatch({backend:!0,backendUpdate:{...this.backArray}});let r=[n.path,n.dispatchKey];t==="add"&&r.push(n.timeKey),this.APIService[t](e,...r),this.backArray={}}getOperationsFactory(){return this.operationsFactory}createQueryJson(e,t,n,r,s="type"){r=r||{},n===void 0&&t&&(n="_id"),t=Array.isArray(t)?t:[t],n=Array.isArray(n)?n:[n];let o={where:[{attribute:s,val:e}],...r};return t.length>0&&t[0]!==void 0&&(o.where=[...o.where,...t.map((a,u)=>({attribute:n[u]||n[0],val:a}))]),o}async getComponentsFromBackend(e,t){typeof e=="string"&&(e={type:e,owner:t===!1?t:!0});let n=await this.createQueryJson(e.type,e.ids,e.filterKeys,e.obj,e.typeAttribute);return await this.APIService[e.snapshot?"firebaseGetterSnapshot":"firebaseGetter"](n,e.path,e.owner)}async getComponentFromBackend(e){return(await this.getComponentsFromBackend(e))[0]}getList(e,t,n){n=n||"owner",e=Array.isArray(e)?e:[e];let r=[];for(let s of e){let o=this.componentsList[s]||[];r=[...r,...o]}return Array.isArray(t)||(t=t?[t]:[]),Array.isArray(n)||(n=[n]),t.length>0&&(r=r.filter(s=>n.some((o,a)=>{var d;const u=(d=s.getJson())==null?void 0:d[o],c=t[a]||t[0];return typeof u=="object"?Object.keys(u).includes(c):u===c}))),r}getComponent(e,t,n){return this.getList(e,t,n||"_id")[0]}clearList(){this.components=[],this.componentsList={}}clearSelectedList(e,t){let n=[...this.components],r=[];for(const s in n)n[s].getJson()[t]!==e&&r.push(n[s]);this.components=[...r],this.setComponentsList()}setComponentList(e){this.componentsList=e}setSelectedList(e,t){this.componentsList[e]=t}sortSelectedList(e,t,n){if(t&&this.componentsList[e]){let r=[...this.componentsList[e]];r=r.sort(function(s,o){const a=s.getJson()[t],u=o.getJson()[t],c=isNaN(Number(a))?a:Number(a),d=isNaN(Number(u))?u:Number(u);return typeof c=="number"&&typeof d=="number"?n?d-c:c-d:n?(""+d).localeCompare(""+c):(""+c).localeCompare(""+d)}),this.setSelectedList(e,r)}}sortSelectedListbyFirebaseDate(e,t){if(this.componentsList[e]){let n=[...this.componentsList[e]];n=n.sort(function(r,s){var u,c;let o=r.getJson().date||r.getJson().date!==""?(u=r.getJson().date)==null?void 0:u.seconds:new Date(0),a=s.getJson().date||s.getJson().date!==""?(c=s.getJson().date)==null?void 0:c.seconds:new Date(0);return t?a-o:o-a}),this.setSelectedList(e,n)}}}class OG{constructor(e,t){re(this,"DB");re(this,"url");re(this,"path",[]);re(this,"orderStr","date");Ai.bind(this),this.setDB(e),this.setUrl(t),this.path=[this.DB,this.url+"users",this.url+"APP","components"]}setDB(e){this.DB=e}setUrl(e){this.url=e}setPath(e){this.path=e}setOrderStr(e){this.orderStr=e}async generateQueary(e,t,n){let r=e.where.map(u=>{if(u.attribute!==void 0)return JP(u.attribute,u.type||"==",u.val)}).filter(u=>u!==void 0);n&&r.push(JP("owner","==",n)),t=t||this.path;let s=[...r],o=e.order||this.orderStr;return o!=="noOrder"&&o!==void 0&&s.push(n7(o)),e.limit&&s.push(r7(e.limit)),t7(qV(...t),...s)}}class LG{constructor(e,t,n,r,s){re(this,"urlEndpoint","");re(this,"dispatch");re(this,"componentList");re(this,"userStr","flinnappsUser");re(this,"QuearyGenerator");re(this,"DB");re(this,"storage");re(this,"auth");re(this,"userEmail");re(this,"path",[]);re(this,"postObserver",new Hl);re(this,"dispatchObserver",new Hl);re(this,"readObserver",new Hl);Ai.bind(this),this.urlEndpoint=e,this.DB=t,this.storage=n,this.auth=r,this.dispatch=s,this.path=[this.DB,`${this.urlEndpoint}users`,`${this.urlEndpoint}APP`,"components"],this.QuearyGenerator=new OG(this.DB,this.urlEndpoint)}setAuth(e){this.auth=e}setStorage(e){this.storage=e}setPath(e){this.path=e}setDB(e){this.DB=e,this.QuearyGenerator.setDB(e)}setDispatch(e){this.dispatch=e}setComponentList(e){this.componentList=e}setUserStr(e){this.userStr=e,this.QuearyGenerator.setUrl(e)}getPostObserver(){return this.postObserver}setPostObserver(e){this.postObserver=e}subscribeToPostObserver(e){this.postObserver.subscribe(e)}getReadObserver(){return this.readObserver}setReadObserver(e){this.readObserver=e}subscribeToReadObserver(e){this.readObserver.subscribe(e)}getPath(){return this.path}getDispatchObserver(){return this.dispatchObserver}setDispatchObserver(e){this.dispatchObserver=e}subscribeToDispatchObserver(e){this.dispatchObserver.subscribe(e)}getQueryGenerator(){return this.QuearyGenerator}setQueryGenerator(e){this.QuearyGenerator=e}async login(e,t){let n,r;if(await pN(this.auth,e,t).then(s=>{n=s.user}).catch(s=>{const o=s.message;r={error:o.slice(9,o.length-1)},console.log(r)}),n){let s=n;this.dispatch({login:!0}),await localStorage.setItem(this.userStr,JSON.stringify(s)),this.componentList!==void 0&&this.dispatch!==void 0&&(n=await this.getuser(e))}else n=r;return n}async register(e,t,n){let r;return await Pz(this.auth,e,t).then(s=>{r=s.user}).catch(s=>{s.code;let o=s.message,a=o.length-1;r={error:o.slice(9,a)}}),r.error||(this.userEmail=r.email,localStorage.setItem(this.userStr,JSON.stringify(r))),r}async logout(){await localStorage.clear(),localStorage.setItem(this.userStr,void 0);let e;await kE(this.auth,t=>{t&&(e=t.uid)}),e&&await mN(this.auth),await localStorage.setItem(this.userStr,null),window.location.href="/"}sendForgotPasswordChange(e){const t=e_();Rz(t,e).then(()=>{}).catch(n=>{n.code,n.message})}async checkIfLoggedIn(){return new Promise((e,t)=>{kE(this.auth,async n=>{if(n)e(n);else{await localStorage.setItem(this.userStr,null),await localStorage.clear(),localStorage.setItem(this.userStr,void 0);let r;await kE(this.auth,s=>{s&&(r=s.uid)}),r&&await mN(this.auth),await window.location.reload()}})})}async getCurrentUser(){let e=await localStorage.getItem(this.userStr);return e=await JSON.parse(e),e}async setCurrentUser(e){await localStorage.setItem(this.userStr,JSON.stringify(e))}async loginToDel(e,t){await pN(this.auth,e,t).then(n=>{}).catch(n=>{n.code,n.message})}async delAccount(){const t=e_().currentUser;await Mz(t).then(()=>{}).catch(n=>{})}async notify(e,t){fetch(t,{method:"POST",mode:"no-cors",body:JSON.stringify(e),headers:{"Conent-Type":"application/json"}})}async changePassword(e){const n=e_().currentUser;return await Nz(n,e).then(()=>{}).catch(s=>{}),!0}async firebaseGetterSnapshot(e,t,n){n=n===!0?this.userEmail:void 0;let r=await this.QuearyGenerator.generateQueary(e,t,n),s=[];return await h7(r,async o=>{s=await this.getRawData(o)}),s}async firebaseGetter(e,t,n){n=n===!0?this.userEmail:void 0;let r=await this.QuearyGenerator.generateQueary(e,t,n),s=await l7(r);return await this.getRawData(s)}async getRawData(e){let t=[];for(const r in e.docs){let s=e.docs[r].data();t.push(s)}let n=await this.componentList.addComponents(t,!0);return this.dispatch&&await this.dispatch({snapShot:{dataRetrieved:n}}),this.readObserver.run(n,t),n}async getCount(e,t,n){n=n===!0?this.userEmail:void 0;let r=await this.QuearyGenerator.generateQueary(e,t,n);return(await f7(r)).data().count}async getuser(e){this.userEmail=e;let t=await this.componentList.getComponentFromBackend({type:"user",ids:e});return t&&this.dispatch({currentUser:t,email:e,gotUser:!0}),t}async GetAllData(e,t){t=t||[this.db,this.urlEndpoint+"users"],this.firebaseGetter(e,t)}async uploadPics(e,t){const n=IE(this.storage,t);await CH(n,e).then(r=>{console.log("Uploaded a file!")})}async downloadPics(e){let t;return await xH(IE(this.storage,e)).then(n=>{t=n}),t}deletePics(e){const t=IE(this.storage,e);SH(t).then(()=>{}).catch(n=>{})}prep(e){return e=Array.isArray(e)?e:[e],e=e.map(t=>{let n=t;return t.getJson&&(n=t.getJson()),n}),e=e.filter(t=>t!==void 0),e}async add(e,t,n,r){return e=await e.map(s=>((s.getJson().owner===""||s.getJson().owner===void 0)&&s.setCompState({owner:this.userEmail}),s)),await this.operate(e,u7,t,n||"added",r||"date")}async update(e,t,n,r){return await this.operate(e,c7,t,r||"updated",n||"lastUpdated")}async del(e,t,n){return await this.operate(e,QP,t,n||"deleted")}async operate(e,t,n,r,s){try{e=await this.prep(e),n=n||this.path;for(let o of e){s&&(o[s]=await m7()),await this.postObserver.run([o]);let a=[UV(...n,o._id)];t!==QP&&a.push(o),await t(...a)}return this.dispatch&&this.dispatch({[r]:e,dispatchComplete:!0}),this.dispatchObserver.run([{[r]:e}]),e}catch(o){console.log(o),console.error(e,"something went wrong with this operation")}}}class FG{constructor(e,t,n,r,s){re(this,"factory");re(this,"updater");re(this,"operationsFactory");re(this,"dispatch");re(this,"APIService");Ai.bind(this),this.dispatch=e,this.getFactory(),this.getAPIService(t,n,r,s,e)}getFactory(){return this.factory===void 0&&(this.factory=new RG(this)),this.factory}getAPIService(e,t,n,r,s){return this.APIService===void 0&&(this.APIService=new LG(e,t,n,r,s)),this.APIService}createComponentList(){return new NG(this)}getOperationsFactory(){return this.operationsFactory===void 0&&(this.operationsFactory=new PN(this),this.factory.setOperationsFactory(this.operationsFactory)),this.operationsFactory}getNewOperationsFactory(){return new PN(this)}}class wp extends ct{constructor(e){super(e),this.domList=["a","button","div","h1","h2","h3","h4","h5","h6","img","input","p","span","table","tr","td","th","ul","li","ol","form","textarea","select","option","label","nav","footer","header","article","section","aside","main","video","audio","iframe","canvas"],this.state={...this.state,wrapperClass:"FCWrapper",formClass:"FCInputForm",labelClass:"defaultLabel",errorClass:"defaultErrorMessage",interface:"form"}}setObj(){var e,t;if(!this.props.prepareOnClick){let n=this.props.obj||(this.props.inPopup?(e=this.propsState)==null?void 0:e.currentPopupComponent:(t=this.propsState)==null?void 0:t.currentComponent);this.obj=this.isArray(n)}}preSetup(){this.setComponents(["wrapper","form","label","error"])}getInnerContent(){return this.innerContent=[this.props.label&&this.label.getHtml(),this.getFormHtml(),this.props.errorText&&this.error.getHtml()],this.innerContent}getHtml(){this.mapInnerContent();let e=this.wrapper.getHtml({type:"div",content:this.innerContent});return this.html=v.jsx(v.Fragment,{children:e}),this.html}getFormHtml(){const e=this.props.type||"input";return e==="select"&&(this.content=this.generateSelectOptions()),this.getInputProps(e),this.additionalPropsSetup(),this.form.getHtml({type:e,content:this.content,props:this.inputProps})}additionalPropsSetup(){}handleChange(e){let{name:t,value:n}=e.target;for(let r of this.obj){if(this.props.isPropArray){let s=r.getJson()[this.props.name]||[];Array.isArray(s)||(s=[s]),Array.isArray(s[0])||(s[0]=[s[0]]),s[0]=n,n=s}r.setCompState({[this.props.name]:n})}this.afterChange(e)}afterChange(e){if(this.props.update)for(let t of this.obj){let n=this.props.update===!0?void 0:{...this.props.update};t==null||t.update(n)}this.props.sendUpdate&&this.props.app&&this.app.dispatch({formUpdate:this.props.type}),this.props.callbackFunc&&this.props.callbackFunc(this.obj),this.additionalChanges(e),this.setState({})}additionalChanges(e){}async prepareOnClick(){var e;if(this.props.prepareOnClick&&this.props.app){let t=this.props.obj;t&&(t=this.isArray(t)),t=await((e=this.props.app)==null?void 0:e.state.componentList.getOperationsFactory().prepare({...t})),t&&(t=this.isArray(t)),this.obj=t}}objDispatch(e){for(let t of this.obj)t.setCompState({[this.props.name]:e});this.afterChange()}handleChangeWithoutEvent(e){for(let t in this.obj)t.setCompState({[e.name]:e.value});this.afterChange()}generateSelectOptions(){const{selectOptions:e,textOptions:t,useIndexForValue:n}=this.props;return Array.isArray(e)?t&&(!Array.isArray(t)||e.length!==t.length)?(console.error("'selectOptions' and 'textOptions' must be arrays of the same length."),null):e.map((r,s)=>{var u;const o=t?t[s]:r;let a=t?n?s:(u=r==null?void 0:r.getJson)==null?void 0:u.call(r)._id:r;return a===void 0?(console.warn(`Could not determine a value for the option at index ${s}.`),null):v.jsx("option",{value:a,children:o},a)}):null}getInputProps(e){var t;return this.inputProps={onChange:this.props.handleChange?n=>{this.props.handleChange(n,this.obj)}:this.handleChange,value:this.obj[0]?(t=this.obj[0])==null?void 0:t.getJson()[this.props.name]:this.props.value,type:this.props.inputType||this.props.type,onFocus:this.props.onFocus||this.onFocus,placeholder:this.props.placeholder,name:this.props.name,min:this.props.min,max:this.props.max,cols:this.props.cols||"",rows:this.props.rows||5,resize:this.props.resize||"true",autoComplete:this.props.autoComplete?this.props.autoComplete:"off",id:this.props.id,checked:this.props.checked,spellCheck:this.props.type==="password"||this.props.spellCheck===void 0?!1:this.props.spellCheck,minLength:this.props.minLength,maxLength:this.props.maxLength},this.domList.includes(e)||(this.inputProps.handleChangeWithoutEvent=this.props.update?()=>{console.log("")}:this.props.handleChangeWithoutEvent?this.props.handleChangeWithoutEvent:this.handleChangeWithoutEvent,this.inputProps.selectOptions=this.props.selectOptions,this.inputProps.textOptions=this.props.textOptions,this.inputProps.unit=this.props.unit?this.props.unit:"$",this.inputProps.tickClass=this.props.tickClass,this.inputProps.handleHTMLChange=this.props.handleHTMLChange||this.objDispatch,this.inputProps.doesMath=this.props.doesMath,this.inputProps.objDispatch=this.objDispatch,this.inputProps.emitClickedOutside=this.props.emitClickedOutside,this.inputProps.updateOnClickOutside=this.props.updateOnClickOutside),this.props.required&&(this.inputProps.required=!0),this.props.disabled&&(this.inputProps.disabled=!0),this.inputProps}}class eh extends wp{constructor(e){super(e),this.state.formClass="FCDefaultButton"}buttonClick(){this.props.buttonClick?this.props.buttonClick(this.obj):this.buttonClickFunc(),this.props.callbackFunc&&this.props.callbackFunc(this.obj)}buttonClickFunc(){}additionalSetup(){this.form.setOnClick(this.buttonClick)}getFormHtml(){return this.form.setStyle({cursor:"pointer"}),this.content=this.props.content||this.content||v.jsx(v.Fragment,{children:"button"}),this.form.getHtml({type:"div",content:this.content})}}let TB=class{constructor(){re(this,"FCInputForm","defaultInputForm");re(this,"FCWrapper","defaultWrapper");re(this,"FCError","defaultErrorMessage");re(this,"FCLabel","defaultLabel");re(this,"FCDefaultButton","defaultButton");re(this,"FCDefaultDelButton","delButton");re(this,"FCImgButton","imgButton")}};const MG=Object.freeze(Object.defineProperty({__proto__:null,DefaultRegistry:TB},Symbol.toStringTag,{value:"Module"}));class MI{constructor(e){re(this,"factory",{});Ai.bind(this),e&&(this.registry=e,this.registerListWithFactory())}registerListWithFactory(){for(const e in this.registry)if(Object.prototype.hasOwnProperty.call(this.registry,e)){const t=e.charAt(0).toLowerCase()+e.slice(1);this.factory[t]=this.registry[e]}}getComponent(e){let t;return this.factory[e]&&(t=new this.factory[e]),t}registerComponent(e,t){this.factory[e]=t}}let BG=class extends MI{constructor(){super(MG),this.factory.default=TB}};class IB{constructor(){re(this,"factory",{})}getComponent(e,t){let n;return this.factory[e]&&(n=this.factory[e]),v.jsx(n,{...t})}registerComponent(e,t){this.factory[e]=t}}class jG extends eh{buttonClickFunc(){let e=this.props.add;this.componentList.addComponents(e)}}class qG{constructor(){Ai.bind(this)}doMath(e){e=e.replace(/\s+/g,"");const t=/(\d+)([+\-*/])(\d+)/,n=e.match(t);if(!n)throw new Error("Invalid input");const r=parseFloat(n[1]),s=n[2],o=parseFloat(n[3]);return{"+":r+o,"-":r-o,"*":r*o,"/":r/o}[s]}}let UG=new qG;class VG extends wp{constructor(e){super(e)}componentDidMount(){document.addEventListener("keyup",this.doMath)}componentWillUnmount(){document.removeEventListener("keyup",this.doMath)}additionalChanges(e){let{name:t,value:n}=e.target;this.setState({val:n})}async doMath(e){if(e.key==="Enter"&&this.state.val!==void 0){let t=this.obj[0],n=await UG.doMath(this.state.val).toString();await t.setCompState({[this.props.name]:n}),t.update(),await this.setState({val:void 0})}}}let HG=class extends eh{async buttonClickFunc(){let e=this.obj,t=e.type;this.props.popupSwitch.includes("add")&&(e=e[0]?e[0]:{type:this.getFactoryTypeString(this.props.popupSwitch.slice(3))},e={prepare:{...e},amount:this.props.amount,clean:this.props.clean},e=await this.operationsFactory.prepare(e),e.length===1&&(e=e[0],t=e.getJson().type)),Array.isArray(e)&&e.length===1&&(e=e[0]);let n=this.props.setCurrnetItem&&{["current"+this.getCapitalFirstLetter(t)]:e},r={popupSwitch:this.props.popupSwitch,currentPopupComponent:e,...n};await this.dispatch({...r})}},zG=class extends eh{buttonClickFunc(){for(let e of this.obj)e.update(this.props.updateParams);this.props.isPopup&&this.dispatch({popupSwitch:"",currentPopupComponent:void 0})}},$G=class extends eh{buttonClickFunc(){let e=this.operationsFactory.addToComponentList(this.props.skipBackendUpdate),t=this.props.setCurrnetItem&&{["current"+this.getCapitalFirstLetter(e[0].getJson().type)]:e[0]},n={};this.props.isPopup&&(n={popupSwitch:"",currentPopupComponent:void 0}),this.dispatch({...n,...t})}};var OE,NN;function WG(){if(NN)return OE;NN=1;function i(){this.__data__=[],this.size=0}return OE=i,OE}var LE,ON;function DB(){if(ON)return LE;ON=1;function i(e,t){return e===t||e!==e&&t!==t}return LE=i,LE}var FE,LN;function mb(){if(LN)return FE;LN=1;var i=DB();function e(t,n){for(var r=t.length;r--;)if(i(t[r][0],n))return r;return-1}return FE=e,FE}var ME,FN;function GG(){if(FN)return ME;FN=1;var i=mb(),e=Array.prototype,t=e.splice;function n(r){var s=this.__data__,o=i(s,r);if(o<0)return!1;var a=s.length-1;return o==a?s.pop():t.call(s,o,1),--this.size,!0}return ME=n,ME}var BE,MN;function KG(){if(MN)return BE;MN=1;var i=mb();function e(t){var n=this.__data__,r=i(n,t);return r<0?void 0:n[r][1]}return BE=e,BE}var jE,BN;function JG(){if(BN)return jE;BN=1;var i=mb();function e(t){return i(this.__data__,t)>-1}return jE=e,jE}var qE,jN;function YG(){if(jN)return qE;jN=1;var i=mb();function e(t,n){var r=this.__data__,s=i(r,t);return s<0?(++this.size,r.push([t,n])):r[s][1]=n,this}return qE=e,qE}var UE,qN;function gb(){if(qN)return UE;qN=1;var i=WG(),e=GG(),t=KG(),n=JG(),r=YG();function s(o){var a=-1,u=o==null?0:o.length;for(this.clear();++a<u;){var c=o[a];this.set(c[0],c[1])}}return s.prototype.clear=i,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=r,UE=s,UE}var VE,UN;function XG(){if(UN)return VE;UN=1;var i=gb();function e(){this.__data__=new i,this.size=0}return VE=e,VE}var HE,VN;function QG(){if(VN)return HE;VN=1;function i(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}return HE=i,HE}var zE,HN;function ZG(){if(HN)return zE;HN=1;function i(e){return this.__data__.get(e)}return zE=i,zE}var $E,zN;function eK(){if(zN)return $E;zN=1;function i(e){return this.__data__.has(e)}return $E=i,$E}var WE,$N;function kB(){if($N)return WE;$N=1;var i=typeof cp=="object"&&cp&&cp.Object===Object&&cp;return WE=i,WE}var GE,WN;function ru(){if(WN)return GE;WN=1;var i=kB(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=i||e||Function("return this")();return GE=t,GE}var KE,GN;function BI(){if(GN)return KE;GN=1;var i=ru(),e=i.Symbol;return KE=e,KE}var JE,KN;function tK(){if(KN)return JE;KN=1;var i=BI(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,r=i?i.toStringTag:void 0;function s(o){var a=t.call(o,r),u=o[r];try{o[r]=void 0;var c=!0}catch{}var d=n.call(o);return c&&(a?o[r]=u:delete o[r]),d}return JE=s,JE}var YE,JN;function nK(){if(JN)return YE;JN=1;var i=Object.prototype,e=i.toString;function t(n){return e.call(n)}return YE=t,YE}var XE,YN;function yb(){if(YN)return XE;YN=1;var i=BI(),e=tK(),t=nK(),n="[object Null]",r="[object Undefined]",s=i?i.toStringTag:void 0;function o(a){return a==null?a===void 0?r:n:s&&s in Object(a)?e(a):t(a)}return XE=o,XE}var QE,XN;function RB(){if(XN)return QE;XN=1;function i(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return QE=i,QE}var ZE,QN;function PB(){if(QN)return ZE;QN=1;var i=yb(),e=RB(),t="[object AsyncFunction]",n="[object Function]",r="[object GeneratorFunction]",s="[object Proxy]";function o(a){if(!e(a))return!1;var u=i(a);return u==n||u==r||u==t||u==s}return ZE=o,ZE}var eC,ZN;function rK(){if(ZN)return eC;ZN=1;var i=ru(),e=i["__core-js_shared__"];return eC=e,eC}var tC,eO;function iK(){if(eO)return tC;eO=1;var i=rK(),e=function(){var n=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function t(n){return!!e&&e in n}return tC=t,tC}var nC,tO;function NB(){if(tO)return nC;tO=1;var i=Function.prototype,e=i.toString;function t(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return nC=t,nC}var rC,nO;function sK(){if(nO)return rC;nO=1;var i=PB(),e=iK(),t=RB(),n=NB(),r=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,a=Object.prototype,u=o.toString,c=a.hasOwnProperty,d=RegExp("^"+u.call(c).replace(r,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function m(p){if(!t(p)||e(p))return!1;var g=i(p)?d:s;return g.test(n(p))}return rC=m,rC}var iC,rO;function oK(){if(rO)return iC;rO=1;function i(e,t){return e==null?void 0:e[t]}return iC=i,iC}var sC,iO;function tg(){if(iO)return sC;iO=1;var i=sK(),e=oK();function t(n,r){var s=e(n,r);return i(s)?s:void 0}return sC=t,sC}var oC,sO;function jI(){if(sO)return oC;sO=1;var i=tg(),e=ru(),t=i(e,"Map");return oC=t,oC}var aC,oO;function vb(){if(oO)return aC;oO=1;var i=tg(),e=i(Object,"create");return aC=e,aC}var lC,aO;function aK(){if(aO)return lC;aO=1;var i=vb();function e(){this.__data__=i?i(null):{},this.size=0}return lC=e,lC}var uC,lO;function lK(){if(lO)return uC;lO=1;function i(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return uC=i,uC}var cC,uO;function uK(){if(uO)return cC;uO=1;var i=vb(),e="__lodash_hash_undefined__",t=Object.prototype,n=t.hasOwnProperty;function r(s){var o=this.__data__;if(i){var a=o[s];return a===e?void 0:a}return n.call(o,s)?o[s]:void 0}return cC=r,cC}var hC,cO;function cK(){if(cO)return hC;cO=1;var i=vb(),e=Object.prototype,t=e.hasOwnProperty;function n(r){var s=this.__data__;return i?s[r]!==void 0:t.call(s,r)}return hC=n,hC}var dC,hO;function hK(){if(hO)return dC;hO=1;var i=vb(),e="__lodash_hash_undefined__";function t(n,r){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=i&&r===void 0?e:r,this}return dC=t,dC}var fC,dO;function dK(){if(dO)return fC;dO=1;var i=aK(),e=lK(),t=uK(),n=cK(),r=hK();function s(o){var a=-1,u=o==null?0:o.length;for(this.clear();++a<u;){var c=o[a];this.set(c[0],c[1])}}return s.prototype.clear=i,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=r,fC=s,fC}var pC,fO;function fK(){if(fO)return pC;fO=1;var i=dK(),e=gb(),t=jI();function n(){this.size=0,this.__data__={hash:new i,map:new(t||e),string:new i}}return pC=n,pC}var mC,pO;function pK(){if(pO)return mC;pO=1;function i(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return mC=i,mC}var gC,mO;function wb(){if(mO)return gC;mO=1;var i=pK();function e(t,n){var r=t.__data__;return i(n)?r[typeof n=="string"?"string":"hash"]:r.map}return gC=e,gC}var yC,gO;function mK(){if(gO)return yC;gO=1;var i=wb();function e(t){var n=i(this,t).delete(t);return this.size-=n?1:0,n}return yC=e,yC}var vC,yO;function gK(){if(yO)return vC;yO=1;var i=wb();function e(t){return i(this,t).get(t)}return vC=e,vC}var wC,vO;function yK(){if(vO)return wC;vO=1;var i=wb();function e(t){return i(this,t).has(t)}return wC=e,wC}var _C,wO;function vK(){if(wO)return _C;wO=1;var i=wb();function e(t,n){var r=i(this,t),s=r.size;return r.set(t,n),this.size+=r.size==s?0:1,this}return _C=e,_C}var bC,_O;function OB(){if(_O)return bC;_O=1;var i=fK(),e=mK(),t=gK(),n=yK(),r=vK();function s(o){var a=-1,u=o==null?0:o.length;for(this.clear();++a<u;){var c=o[a];this.set(c[0],c[1])}}return s.prototype.clear=i,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=r,bC=s,bC}var AC,bO;function wK(){if(bO)return AC;bO=1;var i=gb(),e=jI(),t=OB(),n=200;function r(s,o){var a=this.__data__;if(a instanceof i){var u=a.__data__;if(!e||u.length<n-1)return u.push([s,o]),this.size=++a.size,this;a=this.__data__=new t(u)}return a.set(s,o),this.size=a.size,this}return AC=r,AC}var EC,AO;function _K(){if(AO)return EC;AO=1;var i=gb(),e=XG(),t=QG(),n=ZG(),r=eK(),s=wK();function o(a){var u=this.__data__=new i(a);this.size=u.size}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=s,EC=o,EC}var CC,EO;function bK(){if(EO)return CC;EO=1;var i="__lodash_hash_undefined__";function e(t){return this.__data__.set(t,i),this}return CC=e,CC}var xC,CO;function AK(){if(CO)return xC;CO=1;function i(e){return this.__data__.has(e)}return xC=i,xC}var SC,xO;function EK(){if(xO)return SC;xO=1;var i=OB(),e=bK(),t=AK();function n(r){var s=-1,o=r==null?0:r.length;for(this.__data__=new i;++s<o;)this.add(r[s])}return n.prototype.add=n.prototype.push=e,n.prototype.has=t,SC=n,SC}var TC,SO;function CK(){if(SO)return TC;SO=1;function i(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}return TC=i,TC}var IC,TO;function xK(){if(TO)return IC;TO=1;function i(e,t){return e.has(t)}return IC=i,IC}var DC,IO;function LB(){if(IO)return DC;IO=1;var i=EK(),e=CK(),t=xK(),n=1,r=2;function s(o,a,u,c,d,m){var p=u&n,g=o.length,w=a.length;if(g!=w&&!(p&&w>g))return!1;var b=m.get(o),A=m.get(a);if(b&&A)return b==a&&A==o;var _=-1,C=!0,I=u&r?new i:void 0;for(m.set(o,a),m.set(a,o);++_<g;){var S=o[_],R=a[_];if(c)var L=p?c(R,S,_,a,o,m):c(S,R,_,o,a,m);if(L!==void 0){if(L)continue;C=!1;break}if(I){if(!e(a,function(k,T){if(!t(I,T)&&(S===k||d(S,k,u,c,m)))return I.push(T)})){C=!1;break}}else if(!(S===R||d(S,R,u,c,m))){C=!1;break}}return m.delete(o),m.delete(a),C}return DC=s,DC}var kC,DO;function SK(){if(DO)return kC;DO=1;var i=ru(),e=i.Uint8Array;return kC=e,kC}var RC,kO;function TK(){if(kO)return RC;kO=1;function i(e){var t=-1,n=Array(e.size);return e.forEach(function(r,s){n[++t]=[s,r]}),n}return RC=i,RC}var PC,RO;function IK(){if(RO)return PC;RO=1;function i(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}return PC=i,PC}var NC,PO;function DK(){if(PO)return NC;PO=1;var i=BI(),e=SK(),t=DB(),n=LB(),r=TK(),s=IK(),o=1,a=2,u="[object Boolean]",c="[object Date]",d="[object Error]",m="[object Map]",p="[object Number]",g="[object RegExp]",w="[object Set]",b="[object String]",A="[object Symbol]",_="[object ArrayBuffer]",C="[object DataView]",I=i?i.prototype:void 0,S=I?I.valueOf:void 0;function R(L,k,T,D,P,N,F){switch(T){case C:if(L.byteLength!=k.byteLength||L.byteOffset!=k.byteOffset)return!1;L=L.buffer,k=k.buffer;case _:return!(L.byteLength!=k.byteLength||!N(new e(L),new e(k)));case u:case c:case p:return t(+L,+k);case d:return L.name==k.name&&L.message==k.message;case g:case b:return L==k+"";case m:var M=r;case w:var $=D&o;if(M||(M=s),L.size!=k.size&&!$)return!1;var Q=F.get(L);if(Q)return Q==k;D|=a,F.set(L,k);var ie=n(M(L),M(k),D,P,N,F);return F.delete(L),ie;case A:if(S)return S.call(L)==S.call(k)}return!1}return NC=R,NC}var OC,NO;function kK(){if(NO)return OC;NO=1;function i(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e}return OC=i,OC}var LC,OO;function qI(){if(OO)return LC;OO=1;var i=Array.isArray;return LC=i,LC}var FC,LO;function RK(){if(LO)return FC;LO=1;var i=kK(),e=qI();function t(n,r,s){var o=r(n);return e(n)?o:i(o,s(n))}return FC=t,FC}var MC,FO;function PK(){if(FO)return MC;FO=1;function i(e,t){for(var n=-1,r=e==null?0:e.length,s=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[s++]=a)}return o}return MC=i,MC}var BC,MO;function NK(){if(MO)return BC;MO=1;function i(){return[]}return BC=i,BC}var jC,BO;function OK(){if(BO)return jC;BO=1;var i=PK(),e=NK(),t=Object.prototype,n=t.propertyIsEnumerable,r=Object.getOwnPropertySymbols,s=r?function(o){return o==null?[]:(o=Object(o),i(r(o),function(a){return n.call(o,a)}))}:e;return jC=s,jC}var qC,jO;function LK(){if(jO)return qC;jO=1;function i(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}return qC=i,qC}var UC,qO;function _b(){if(qO)return UC;qO=1;function i(e){return e!=null&&typeof e=="object"}return UC=i,UC}var VC,UO;function FK(){if(UO)return VC;UO=1;var i=yb(),e=_b(),t="[object Arguments]";function n(r){return e(r)&&i(r)==t}return VC=n,VC}var HC,VO;function MK(){if(VO)return HC;VO=1;var i=FK(),e=_b(),t=Object.prototype,n=t.hasOwnProperty,r=t.propertyIsEnumerable,s=i(function(){return arguments}())?i:function(o){return e(o)&&n.call(o,"callee")&&!r.call(o,"callee")};return HC=s,HC}var ay={exports:{}},zC,HO;function BK(){if(HO)return zC;HO=1;function i(){return!1}return zC=i,zC}ay.exports;var zO;function FB(){return zO||(zO=1,function(i,e){var t=ru(),n=BK(),r=e&&!e.nodeType&&e,s=r&&!0&&i&&!i.nodeType&&i,o=s&&s.exports===r,a=o?t.Buffer:void 0,u=a?a.isBuffer:void 0,c=u||n;i.exports=c}(ay,ay.exports)),ay.exports}var $C,$O;function jK(){if($O)return $C;$O=1;var i=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(n,r){var s=typeof n;return r=r??i,!!r&&(s=="number"||s!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<r}return $C=t,$C}var WC,WO;function MB(){if(WO)return WC;WO=1;var i=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=i}return WC=e,WC}var GC,GO;function qK(){if(GO)return GC;GO=1;var i=yb(),e=MB(),t=_b(),n="[object Arguments]",r="[object Array]",s="[object Boolean]",o="[object Date]",a="[object Error]",u="[object Function]",c="[object Map]",d="[object Number]",m="[object Object]",p="[object RegExp]",g="[object Set]",w="[object String]",b="[object WeakMap]",A="[object ArrayBuffer]",_="[object DataView]",C="[object Float32Array]",I="[object Float64Array]",S="[object Int8Array]",R="[object Int16Array]",L="[object Int32Array]",k="[object Uint8Array]",T="[object Uint8ClampedArray]",D="[object Uint16Array]",P="[object Uint32Array]",N={};N[C]=N[I]=N[S]=N[R]=N[L]=N[k]=N[T]=N[D]=N[P]=!0,N[n]=N[r]=N[A]=N[s]=N[_]=N[o]=N[a]=N[u]=N[c]=N[d]=N[m]=N[p]=N[g]=N[w]=N[b]=!1;function F(M){return t(M)&&e(M.length)&&!!N[i(M)]}return GC=F,GC}var KC,KO;function UK(){if(KO)return KC;KO=1;function i(e){return function(t){return e(t)}}return KC=i,KC}var ly={exports:{}};ly.exports;var JO;function VK(){return JO||(JO=1,function(i,e){var t=kB(),n=e&&!e.nodeType&&e,r=n&&!0&&i&&!i.nodeType&&i,s=r&&r.exports===n,o=s&&t.process,a=function(){try{var u=r&&r.require&&r.require("util").types;return u||o&&o.binding&&o.binding("util")}catch{}}();i.exports=a}(ly,ly.exports)),ly.exports}var JC,YO;function BB(){if(YO)return JC;YO=1;var i=qK(),e=UK(),t=VK(),n=t&&t.isTypedArray,r=n?e(n):i;return JC=r,JC}var YC,XO;function HK(){if(XO)return YC;XO=1;var i=LK(),e=MK(),t=qI(),n=FB(),r=jK(),s=BB(),o=Object.prototype,a=o.hasOwnProperty;function u(c,d){var m=t(c),p=!m&&e(c),g=!m&&!p&&n(c),w=!m&&!p&&!g&&s(c),b=m||p||g||w,A=b?i(c.length,String):[],_=A.length;for(var C in c)(d||a.call(c,C))&&!(b&&(C=="length"||g&&(C=="offset"||C=="parent")||w&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||r(C,_)))&&A.push(C);return A}return YC=u,YC}var XC,QO;function zK(){if(QO)return XC;QO=1;var i=Object.prototype;function e(t){var n=t&&t.constructor,r=typeof n=="function"&&n.prototype||i;return t===r}return XC=e,XC}var QC,ZO;function $K(){if(ZO)return QC;ZO=1;function i(e,t){return function(n){return e(t(n))}}return QC=i,QC}var ZC,eL;function WK(){if(eL)return ZC;eL=1;var i=$K(),e=i(Object.keys,Object);return ZC=e,ZC}var ex,tL;function GK(){if(tL)return ex;tL=1;var i=zK(),e=WK(),t=Object.prototype,n=t.hasOwnProperty;function r(s){if(!i(s))return e(s);var o=[];for(var a in Object(s))n.call(s,a)&&a!="constructor"&&o.push(a);return o}return ex=r,ex}var tx,nL;function KK(){if(nL)return tx;nL=1;var i=PB(),e=MB();function t(n){return n!=null&&e(n.length)&&!i(n)}return tx=t,tx}var nx,rL;function JK(){if(rL)return nx;rL=1;var i=HK(),e=GK(),t=KK();function n(r){return t(r)?i(r):e(r)}return nx=n,nx}var rx,iL;function YK(){if(iL)return rx;iL=1;var i=RK(),e=OK(),t=JK();function n(r){return i(r,t,e)}return rx=n,rx}var ix,sL;function XK(){if(sL)return ix;sL=1;var i=YK(),e=1,t=Object.prototype,n=t.hasOwnProperty;function r(s,o,a,u,c,d){var m=a&e,p=i(s),g=p.length,w=i(o),b=w.length;if(g!=b&&!m)return!1;for(var A=g;A--;){var _=p[A];if(!(m?_ in o:n.call(o,_)))return!1}var C=d.get(s),I=d.get(o);if(C&&I)return C==o&&I==s;var S=!0;d.set(s,o),d.set(o,s);for(var R=m;++A<g;){_=p[A];var L=s[_],k=o[_];if(u)var T=m?u(k,L,_,o,s,d):u(L,k,_,s,o,d);if(!(T===void 0?L===k||c(L,k,a,u,d):T)){S=!1;break}R||(R=_=="constructor")}if(S&&!R){var D=s.constructor,P=o.constructor;D!=P&&"constructor"in s&&"constructor"in o&&!(typeof D=="function"&&D instanceof D&&typeof P=="function"&&P instanceof P)&&(S=!1)}return d.delete(s),d.delete(o),S}return ix=r,ix}var sx,oL;function QK(){if(oL)return sx;oL=1;var i=tg(),e=ru(),t=i(e,"DataView");return sx=t,sx}var ox,aL;function ZK(){if(aL)return ox;aL=1;var i=tg(),e=ru(),t=i(e,"Promise");return ox=t,ox}var ax,lL;function eJ(){if(lL)return ax;lL=1;var i=tg(),e=ru(),t=i(e,"Set");return ax=t,ax}var lx,uL;function tJ(){if(uL)return lx;uL=1;var i=tg(),e=ru(),t=i(e,"WeakMap");return lx=t,lx}var ux,cL;function nJ(){if(cL)return ux;cL=1;var i=QK(),e=jI(),t=ZK(),n=eJ(),r=tJ(),s=yb(),o=NB(),a="[object Map]",u="[object Object]",c="[object Promise]",d="[object Set]",m="[object WeakMap]",p="[object DataView]",g=o(i),w=o(e),b=o(t),A=o(n),_=o(r),C=s;return(i&&C(new i(new ArrayBuffer(1)))!=p||e&&C(new e)!=a||t&&C(t.resolve())!=c||n&&C(new n)!=d||r&&C(new r)!=m)&&(C=function(I){var S=s(I),R=S==u?I.constructor:void 0,L=R?o(R):"";if(L)switch(L){case g:return p;case w:return a;case b:return c;case A:return d;case _:return m}return S}),ux=C,ux}var cx,hL;function rJ(){if(hL)return cx;hL=1;var i=_K(),e=LB(),t=DK(),n=XK(),r=nJ(),s=qI(),o=FB(),a=BB(),u=1,c="[object Arguments]",d="[object Array]",m="[object Object]",p=Object.prototype,g=p.hasOwnProperty;function w(b,A,_,C,I,S){var R=s(b),L=s(A),k=R?d:r(b),T=L?d:r(A);k=k==c?m:k,T=T==c?m:T;var D=k==m,P=T==m,N=k==T;if(N&&o(b)){if(!o(A))return!1;R=!0,D=!1}if(N&&!D)return S||(S=new i),R||a(b)?e(b,A,_,C,I,S):t(b,A,k,_,C,I,S);if(!(_&u)){var F=D&&g.call(b,"__wrapped__"),M=P&&g.call(A,"__wrapped__");if(F||M){var $=F?b.value():b,Q=M?A.value():A;return S||(S=new i),I($,Q,_,C,S)}}return N?(S||(S=new i),n(b,A,_,C,I,S)):!1}return cx=w,cx}var hx,dL;function iJ(){if(dL)return hx;dL=1;var i=rJ(),e=_b();function t(n,r,s,o,a){return n===r?!0:n==null||r==null||!e(n)&&!e(r)?n!==n&&r!==r:i(n,r,s,o,t,a)}return hx=t,hx}var dx,fL;function sJ(){if(fL)return dx;fL=1;var i=iJ();function e(t,n){return i(t,n)}return dx=e,dx}var r_={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */var oJ=r_.exports,pL;function aJ(){return pL||(pL=1,function(i,e){(function(n,r){i.exports=r()})(typeof self<"u"?self:oJ,function(){return function(t){var n={};function r(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=n,r.d=function(s,o,a){r.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:a})},r.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(o,"a",o),o},r.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},r.p="",r(r.s=109)}([function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(17),o=r(18),a=r(19),u=r(45),c=r(46),d=r(47),m=r(48),p=r(49),g=r(12),w=r(32),b=r(33),A=r(31),_=r(1),C={Scope:_.Scope,create:_.create,find:_.find,query:_.query,register:_.register,Container:s.default,Format:o.default,Leaf:a.default,Embed:m.default,Scroll:u.default,Block:d.default,Inline:c.default,Text:p.default,Attributor:{Attribute:g.default,Class:w.default,Style:b.default,Store:A.default}};n.default=C},function(t,n,r){var s=this&&this.__extends||function(){var A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,C){_.__proto__=C}||function(_,C){for(var I in C)C.hasOwnProperty(I)&&(_[I]=C[I])};return function(_,C){A(_,C);function I(){this.constructor=_}_.prototype=C===null?Object.create(C):(I.prototype=C.prototype,new I)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(A){s(_,A);function _(C){var I=this;return C="[Parchment] "+C,I=A.call(this,C)||this,I.message=C,I.name=I.constructor.name,I}return _}(Error);n.ParchmentError=o;var a={},u={},c={},d={};n.DATA_KEY="__blot";var m;(function(A){A[A.TYPE=3]="TYPE",A[A.LEVEL=12]="LEVEL",A[A.ATTRIBUTE=13]="ATTRIBUTE",A[A.BLOT=14]="BLOT",A[A.INLINE=7]="INLINE",A[A.BLOCK=11]="BLOCK",A[A.BLOCK_BLOT=10]="BLOCK_BLOT",A[A.INLINE_BLOT=6]="INLINE_BLOT",A[A.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",A[A.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",A[A.ANY=15]="ANY"})(m=n.Scope||(n.Scope={}));function p(A,_){var C=w(A);if(C==null)throw new o("Unable to create "+A+" blot");var I=C,S=A instanceof Node||A.nodeType===Node.TEXT_NODE?A:I.create(_);return new I(S,_)}n.create=p;function g(A,_){return _===void 0&&(_=!1),A==null?null:A[n.DATA_KEY]!=null?A[n.DATA_KEY].blot:_?g(A.parentNode,_):null}n.find=g;function w(A,_){_===void 0&&(_=m.ANY);var C;if(typeof A=="string")C=d[A]||a[A];else if(A instanceof Text||A.nodeType===Node.TEXT_NODE)C=d.text;else if(typeof A=="number")A&m.LEVEL&m.BLOCK?C=d.block:A&m.LEVEL&m.INLINE&&(C=d.inline);else if(A instanceof HTMLElement){var I=(A.getAttribute("class")||"").split(/\s+/);for(var S in I)if(C=u[I[S]],C)break;C=C||c[A.tagName]}return C==null?null:_&m.LEVEL&C.scope&&_&m.TYPE&C.scope?C:null}n.query=w;function b(){for(var A=[],_=0;_<arguments.length;_++)A[_]=arguments[_];if(A.length>1)return A.map(function(S){return b(S)});var C=A[0];if(typeof C.blotName!="string"&&typeof C.attrName!="string")throw new o("Invalid definition");if(C.blotName==="abstract")throw new o("Cannot register abstract class");if(d[C.blotName||C.attrName]=C,typeof C.keyName=="string")a[C.keyName]=C;else if(C.className!=null&&(u[C.className]=C),C.tagName!=null){Array.isArray(C.tagName)?C.tagName=C.tagName.map(function(S){return S.toUpperCase()}):C.tagName=C.tagName.toUpperCase();var I=Array.isArray(C.tagName)?C.tagName:[C.tagName];I.forEach(function(S){(c[S]==null||C.className==null)&&(c[S]=C)})}return C}n.register=b},function(t,n,r){var s=r(51),o=r(11),a=r(3),u=r(20),c="\0",d=function(m){Array.isArray(m)?this.ops=m:m!=null&&Array.isArray(m.ops)?this.ops=m.ops:this.ops=[]};d.prototype.insert=function(m,p){var g={};return m.length===0?this:(g.insert=m,p!=null&&typeof p=="object"&&Object.keys(p).length>0&&(g.attributes=p),this.push(g))},d.prototype.delete=function(m){return m<=0?this:this.push({delete:m})},d.prototype.retain=function(m,p){if(m<=0)return this;var g={retain:m};return p!=null&&typeof p=="object"&&Object.keys(p).length>0&&(g.attributes=p),this.push(g)},d.prototype.push=function(m){var p=this.ops.length,g=this.ops[p-1];if(m=a(!0,{},m),typeof g=="object"){if(typeof m.delete=="number"&&typeof g.delete=="number")return this.ops[p-1]={delete:g.delete+m.delete},this;if(typeof g.delete=="number"&&m.insert!=null&&(p-=1,g=this.ops[p-1],typeof g!="object"))return this.ops.unshift(m),this;if(o(m.attributes,g.attributes)){if(typeof m.insert=="string"&&typeof g.insert=="string")return this.ops[p-1]={insert:g.insert+m.insert},typeof m.attributes=="object"&&(this.ops[p-1].attributes=m.attributes),this;if(typeof m.retain=="number"&&typeof g.retain=="number")return this.ops[p-1]={retain:g.retain+m.retain},typeof m.attributes=="object"&&(this.ops[p-1].attributes=m.attributes),this}}return p===this.ops.length?this.ops.push(m):this.ops.splice(p,0,m),this},d.prototype.chop=function(){var m=this.ops[this.ops.length-1];return m&&m.retain&&!m.attributes&&this.ops.pop(),this},d.prototype.filter=function(m){return this.ops.filter(m)},d.prototype.forEach=function(m){this.ops.forEach(m)},d.prototype.map=function(m){return this.ops.map(m)},d.prototype.partition=function(m){var p=[],g=[];return this.forEach(function(w){var b=m(w)?p:g;b.push(w)}),[p,g]},d.prototype.reduce=function(m,p){return this.ops.reduce(m,p)},d.prototype.changeLength=function(){return this.reduce(function(m,p){return p.insert?m+u.length(p):p.delete?m-p.delete:m},0)},d.prototype.length=function(){return this.reduce(function(m,p){return m+u.length(p)},0)},d.prototype.slice=function(m,p){m=m||0,typeof p!="number"&&(p=1/0);for(var g=[],w=u.iterator(this.ops),b=0;b<p&&w.hasNext();){var A;b<m?A=w.next(m-b):(A=w.next(p-b),g.push(A)),b+=u.length(A)}return new d(g)},d.prototype.compose=function(m){var p=u.iterator(this.ops),g=u.iterator(m.ops),w=[],b=g.peek();if(b!=null&&typeof b.retain=="number"&&b.attributes==null){for(var A=b.retain;p.peekType()==="insert"&&p.peekLength()<=A;)A-=p.peekLength(),w.push(p.next());b.retain-A>0&&g.next(b.retain-A)}for(var _=new d(w);p.hasNext()||g.hasNext();)if(g.peekType()==="insert")_.push(g.next());else if(p.peekType()==="delete")_.push(p.next());else{var C=Math.min(p.peekLength(),g.peekLength()),I=p.next(C),S=g.next(C);if(typeof S.retain=="number"){var R={};typeof I.retain=="number"?R.retain=C:R.insert=I.insert;var L=u.attributes.compose(I.attributes,S.attributes,typeof I.retain=="number");if(L&&(R.attributes=L),_.push(R),!g.hasNext()&&o(_.ops[_.ops.length-1],R)){var k=new d(p.rest());return _.concat(k).chop()}}else typeof S.delete=="number"&&typeof I.retain=="number"&&_.push(S)}return _.chop()},d.prototype.concat=function(m){var p=new d(this.ops.slice());return m.ops.length>0&&(p.push(m.ops[0]),p.ops=p.ops.concat(m.ops.slice(1))),p},d.prototype.diff=function(m,p){if(this.ops===m.ops)return new d;var g=[this,m].map(function(C){return C.map(function(I){if(I.insert!=null)return typeof I.insert=="string"?I.insert:c;var S=C===m?"on":"with";throw new Error("diff() called "+S+" non-document")}).join("")}),w=new d,b=s(g[0],g[1],p),A=u.iterator(this.ops),_=u.iterator(m.ops);return b.forEach(function(C){for(var I=C[1].length;I>0;){var S=0;switch(C[0]){case s.INSERT:S=Math.min(_.peekLength(),I),w.push(_.next(S));break;case s.DELETE:S=Math.min(I,A.peekLength()),A.next(S),w.delete(S);break;case s.EQUAL:S=Math.min(A.peekLength(),_.peekLength(),I);var R=A.next(S),L=_.next(S);o(R.insert,L.insert)?w.retain(S,u.attributes.diff(R.attributes,L.attributes)):w.push(L).delete(S);break}I-=S}}),w.chop()},d.prototype.eachLine=function(m,p){p=p||`
`;for(var g=u.iterator(this.ops),w=new d,b=0;g.hasNext();){if(g.peekType()!=="insert")return;var A=g.peek(),_=u.length(A)-g.peekLength(),C=typeof A.insert=="string"?A.insert.indexOf(p,_)-_:-1;if(C<0)w.push(g.next());else if(C>0)w.push(g.next(C));else{if(m(w,g.next(1).attributes||{},b)===!1)return;b+=1,w=new d}}w.length()>0&&m(w,{},b)},d.prototype.transform=function(m,p){if(p=!!p,typeof m=="number")return this.transformPosition(m,p);for(var g=u.iterator(this.ops),w=u.iterator(m.ops),b=new d;g.hasNext()||w.hasNext();)if(g.peekType()==="insert"&&(p||w.peekType()!=="insert"))b.retain(u.length(g.next()));else if(w.peekType()==="insert")b.push(w.next());else{var A=Math.min(g.peekLength(),w.peekLength()),_=g.next(A),C=w.next(A);if(_.delete)continue;C.delete?b.push(C):b.retain(A,u.attributes.transform(_.attributes,C.attributes,p))}return b.chop()},d.prototype.transformPosition=function(m,p){p=!!p;for(var g=u.iterator(this.ops),w=0;g.hasNext()&&w<=m;){var b=g.peekLength(),A=g.peekType();if(g.next(),A==="delete"){m-=Math.min(b,m-w);continue}else A==="insert"&&(w<m||!p)&&(m+=b);w+=b}return m},t.exports=d},function(t,n){var r=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,u=function(g){return typeof Array.isArray=="function"?Array.isArray(g):s.call(g)==="[object Array]"},c=function(g){if(!g||s.call(g)!=="[object Object]")return!1;var w=r.call(g,"constructor"),b=g.constructor&&g.constructor.prototype&&r.call(g.constructor.prototype,"isPrototypeOf");if(g.constructor&&!w&&!b)return!1;var A;for(A in g);return typeof A>"u"||r.call(g,A)},d=function(g,w){o&&w.name==="__proto__"?o(g,w.name,{enumerable:!0,configurable:!0,value:w.newValue,writable:!0}):g[w.name]=w.newValue},m=function(g,w){if(w==="__proto__")if(r.call(g,w)){if(a)return a(g,w).value}else return;return g[w]};t.exports=function p(){var g,w,b,A,_,C,I=arguments[0],S=1,R=arguments.length,L=!1;for(typeof I=="boolean"&&(L=I,I=arguments[1]||{},S=2),(I==null||typeof I!="object"&&typeof I!="function")&&(I={});S<R;++S)if(g=arguments[S],g!=null)for(w in g)b=m(I,w),A=m(g,w),I!==A&&(L&&A&&(c(A)||(_=u(A)))?(_?(_=!1,C=b&&u(b)?b:[]):C=b&&c(b)?b:{},d(I,{name:w,newValue:p(L,C,A)})):typeof A<"u"&&d(I,{name:w,newValue:A}));return I}},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var s=function(){function N(F,M){for(var $=0;$<M.length;$++){var Q=M[$];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(F,Q.key,Q)}}return function(F,M,$){return M&&N(F.prototype,M),$&&N(F,$),F}}(),o=function N(F,M,$){F===null&&(F=Function.prototype);var Q=Object.getOwnPropertyDescriptor(F,M);if(Q===void 0){var ie=Object.getPrototypeOf(F);return ie===null?void 0:N(ie,M,$)}else{if("value"in Q)return Q.value;var ee=Q.get;return ee===void 0?void 0:ee.call($)}},a=r(3),u=I(a),c=r(2),d=I(c),m=r(0),p=I(m),g=r(16),w=I(g),b=r(6),A=I(b),_=r(7),C=I(_);function I(N){return N&&N.__esModule?N:{default:N}}function S(N,F){if(!(N instanceof F))throw new TypeError("Cannot call a class as a function")}function R(N,F){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:N}function L(N,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);N.prototype=Object.create(F&&F.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(N,F):N.__proto__=F)}var k=1,T=function(N){L(F,N);function F(){return S(this,F),R(this,(F.__proto__||Object.getPrototypeOf(F)).apply(this,arguments))}return s(F,[{key:"attach",value:function(){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"attach",this).call(this),this.attributes=new p.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new d.default().insert(this.value(),(0,u.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function($,Q){var ie=p.default.query($,p.default.Scope.BLOCK_ATTRIBUTE);ie!=null&&this.attributes.attribute(ie,Q)}},{key:"formatAt",value:function($,Q,ie,ee){this.format(ie,ee)}},{key:"insertAt",value:function($,Q,ie){if(typeof Q=="string"&&Q.endsWith(`
`)){var ee=p.default.create(D.blotName);this.parent.insertBefore(ee,$===0?this:this.next),ee.insertAt(0,Q.slice(0,-1))}else o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertAt",this).call(this,$,Q,ie)}}]),F}(p.default.Embed);T.scope=p.default.Scope.BLOCK_BLOT;var D=function(N){L(F,N);function F(M){S(this,F);var $=R(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,M));return $.cache={},$}return s(F,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(p.default.Leaf).reduce(function($,Q){return Q.length()===0?$:$.insert(Q.value(),P(Q))},new d.default).insert(`
`,P(this))),this.cache.delta}},{key:"deleteAt",value:function($,Q){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"deleteAt",this).call(this,$,Q),this.cache={}}},{key:"formatAt",value:function($,Q,ie,ee){Q<=0||(p.default.query(ie,p.default.Scope.BLOCK)?$+Q===this.length()&&this.format(ie,ee):o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"formatAt",this).call(this,$,Math.min(Q,this.length()-$-1),ie,ee),this.cache={})}},{key:"insertAt",value:function($,Q,ie){if(ie!=null)return o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertAt",this).call(this,$,Q,ie);if(Q.length!==0){var ee=Q.split(`
`),ue=ee.shift();ue.length>0&&($<this.length()-1||this.children.tail==null?o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertAt",this).call(this,Math.min($,this.length()-1),ue):this.children.tail.insertAt(this.children.tail.length(),ue),this.cache={});var Y=this;ee.reduce(function(J,q){return Y=Y.split(J,!0),Y.insertAt(0,q),q.length},$+ue.length)}}},{key:"insertBefore",value:function($,Q){var ie=this.children.head;o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertBefore",this).call(this,$,Q),ie instanceof w.default&&ie.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"length",this).call(this)+k),this.cache.length}},{key:"moveChildren",value:function($,Q){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"moveChildren",this).call(this,$,Q),this.cache={}}},{key:"optimize",value:function($){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"optimize",this).call(this,$),this.cache={}}},{key:"path",value:function($){return o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"path",this).call(this,$,!0)}},{key:"removeChild",value:function($){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"removeChild",this).call(this,$),this.cache={}}},{key:"split",value:function($){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Q&&($===0||$>=this.length()-k)){var ie=this.clone();return $===0?(this.parent.insertBefore(ie,this),this):(this.parent.insertBefore(ie,this.next),ie)}else{var ee=o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"split",this).call(this,$,Q);return this.cache={},ee}}}]),F}(p.default.Block);D.blotName="block",D.tagName="P",D.defaultChild="break",D.allowedChildren=[A.default,p.default.Embed,C.default];function P(N){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return N==null||(typeof N.formats=="function"&&(F=(0,u.default)(F,N.formats())),N.parent==null||N.parent.blotName=="scroll"||N.parent.statics.scope!==N.statics.scope)?F:P(N.parent,F)}n.bubbleFormats=P,n.BlockEmbed=T,n.default=D},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},o=function(){function Y(J,q){var H=[],G=!0,le=!1,se=void 0;try{for(var X=J[Symbol.iterator](),ne;!(G=(ne=X.next()).done)&&(H.push(ne.value),!(q&&H.length===q));G=!0);}catch(te){le=!0,se=te}finally{try{!G&&X.return&&X.return()}finally{if(le)throw se}}return H}return function(J,q){if(Array.isArray(J))return J;if(Symbol.iterator in Object(J))return Y(J,q);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function Y(J,q){for(var H=0;H<q.length;H++){var G=q[H];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(J,G.key,G)}}return function(J,q,H){return q&&Y(J.prototype,q),H&&Y(J,H),J}}();r(50);var u=r(2),c=P(u),d=r(14),m=P(d),p=r(8),g=P(p),w=r(9),b=P(w),A=r(0),_=P(A),C=r(15),I=P(C),S=r(3),R=P(S),L=r(10),k=P(L),T=r(34),D=P(T);function P(Y){return Y&&Y.__esModule?Y:{default:Y}}function N(Y,J,q){return J in Y?Object.defineProperty(Y,J,{value:q,enumerable:!0,configurable:!0,writable:!0}):Y[J]=q,Y}function F(Y,J){if(!(Y instanceof J))throw new TypeError("Cannot call a class as a function")}var M=(0,k.default)("quill"),$=function(){a(Y,null,[{key:"debug",value:function(q){q===!0&&(q="log"),k.default.level(q)}},{key:"find",value:function(q){return q.__quill||_.default.find(q)}},{key:"import",value:function(q){return this.imports[q]==null&&M.error("Cannot import "+q+". Are you sure it was registered?"),this.imports[q]}},{key:"register",value:function(q,H){var G=this,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof q!="string"){var se=q.attrName||q.blotName;typeof se=="string"?this.register("formats/"+se,q,H):Object.keys(q).forEach(function(X){G.register(X,q[X],H)})}else this.imports[q]!=null&&!le&&M.warn("Overwriting "+q+" with",H),this.imports[q]=H,(q.startsWith("blots/")||q.startsWith("formats/"))&&H.blotName!=="abstract"?_.default.register(H):q.startsWith("modules")&&typeof H.register=="function"&&H.register()}}]);function Y(J){var q=this,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(F(this,Y),this.options=Q(J,H),this.container=this.options.container,this.container==null)return M.error("Invalid Quill container",J);this.options.debug&&Y.debug(this.options.debug);var G=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new g.default,this.scroll=_.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new m.default(this.scroll),this.selection=new I.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(g.default.events.EDITOR_CHANGE,function(se){se===g.default.events.TEXT_CHANGE&&q.root.classList.toggle("ql-blank",q.editor.isBlank())}),this.emitter.on(g.default.events.SCROLL_UPDATE,function(se,X){var ne=q.selection.lastRange,te=ne&&ne.length===0?ne.index:void 0;ie.call(q,function(){return q.editor.update(null,X,te)},se)});var le=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+G+"<p><br></p></div>");this.setContents(le),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return a(Y,[{key:"addContainer",value:function(q){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof q=="string"){var G=q;q=document.createElement("div"),q.classList.add(G)}return this.container.insertBefore(q,H),q}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(q,H,G){var le=this,se=ee(q,H,G),X=o(se,4);return q=X[0],H=X[1],G=X[3],ie.call(this,function(){return le.editor.deleteText(q,H)},G,q,-1*H)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(q),this.container.classList.toggle("ql-disabled",!q)}},{key:"focus",value:function(){var q=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=q,this.scrollIntoView()}},{key:"format",value:function(q,H){var G=this,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.default.sources.API;return ie.call(this,function(){var se=G.getSelection(!0),X=new c.default;if(se==null)return X;if(_.default.query(q,_.default.Scope.BLOCK))X=G.editor.formatLine(se.index,se.length,N({},q,H));else{if(se.length===0)return G.selection.format(q,H),X;X=G.editor.formatText(se.index,se.length,N({},q,H))}return G.setSelection(se,g.default.sources.SILENT),X},le)}},{key:"formatLine",value:function(q,H,G,le,se){var X=this,ne=void 0,te=ee(q,H,G,le,se),ae=o(te,4);return q=ae[0],H=ae[1],ne=ae[2],se=ae[3],ie.call(this,function(){return X.editor.formatLine(q,H,ne)},se,q,0)}},{key:"formatText",value:function(q,H,G,le,se){var X=this,ne=void 0,te=ee(q,H,G,le,se),ae=o(te,4);return q=ae[0],H=ae[1],ne=ae[2],se=ae[3],ie.call(this,function(){return X.editor.formatText(q,H,ne)},se,q,0)}},{key:"getBounds",value:function(q){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,G=void 0;typeof q=="number"?G=this.selection.getBounds(q,H):G=this.selection.getBounds(q.index,q.length);var le=this.container.getBoundingClientRect();return{bottom:G.bottom-le.top,height:G.height,left:G.left-le.left,right:G.right-le.left,top:G.top-le.top,width:G.width}}},{key:"getContents",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-q,G=ee(q,H),le=o(G,2);return q=le[0],H=le[1],this.editor.getContents(q,H)}},{key:"getFormat",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof q=="number"?this.editor.getFormat(q,H):this.editor.getFormat(q.index,q.length)}},{key:"getIndex",value:function(q){return q.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(q){return this.scroll.leaf(q)}},{key:"getLine",value:function(q){return this.scroll.line(q)}},{key:"getLines",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof q!="number"?this.scroll.lines(q.index,q.length):this.scroll.lines(q,H)}},{key:"getModule",value:function(q){return this.theme.modules[q]}},{key:"getSelection",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return q&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-q,G=ee(q,H),le=o(G,2);return q=le[0],H=le[1],this.editor.getText(q,H)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(q,H,G){var le=this,se=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Y.sources.API;return ie.call(this,function(){return le.editor.insertEmbed(q,H,G)},se,q)}},{key:"insertText",value:function(q,H,G,le,se){var X=this,ne=void 0,te=ee(q,0,G,le,se),ae=o(te,4);return q=ae[0],ne=ae[2],se=ae[3],ie.call(this,function(){return X.editor.insertText(q,H,ne)},se,q,H.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(q,H,G){this.clipboard.dangerouslyPasteHTML(q,H,G)}},{key:"removeFormat",value:function(q,H,G){var le=this,se=ee(q,H,G),X=o(se,4);return q=X[0],H=X[1],G=X[3],ie.call(this,function(){return le.editor.removeFormat(q,H)},G,q)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(q){var H=this,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g.default.sources.API;return ie.call(this,function(){q=new c.default(q);var le=H.getLength(),se=H.editor.deleteText(0,le),X=H.editor.applyDelta(q),ne=X.ops[X.ops.length-1];ne!=null&&typeof ne.insert=="string"&&ne.insert[ne.insert.length-1]===`
`&&(H.editor.deleteText(H.getLength()-1,1),X.delete(1));var te=se.compose(X);return te},G)}},{key:"setSelection",value:function(q,H,G){if(q==null)this.selection.setRange(null,H||Y.sources.API);else{var le=ee(q,H,G),se=o(le,4);q=se[0],H=se[1],G=se[3],this.selection.setRange(new C.Range(q,H),G),G!==g.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(q){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g.default.sources.API,G=new c.default().insert(q);return this.setContents(G,H)}},{key:"update",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g.default.sources.USER,H=this.scroll.update(q);return this.selection.update(q),H}},{key:"updateContents",value:function(q){var H=this,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g.default.sources.API;return ie.call(this,function(){return q=new c.default(q),H.editor.applyDelta(q,G)},G,!0)}}]),Y}();$.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},$.events=g.default.events,$.sources=g.default.sources,$.version="1.3.7",$.imports={delta:c.default,parchment:_.default,"core/module":b.default,"core/theme":D.default};function Q(Y,J){if(J=(0,R.default)(!0,{container:Y,modules:{clipboard:!0,keyboard:!0,history:!0}},J),!J.theme||J.theme===$.DEFAULTS.theme)J.theme=D.default;else if(J.theme=$.import("themes/"+J.theme),J.theme==null)throw new Error("Invalid theme "+J.theme+". Did you register it?");var q=(0,R.default)(!0,{},J.theme.DEFAULTS);[q,J].forEach(function(le){le.modules=le.modules||{},Object.keys(le.modules).forEach(function(se){le.modules[se]===!0&&(le.modules[se]={})})});var H=Object.keys(q.modules).concat(Object.keys(J.modules)),G=H.reduce(function(le,se){var X=$.import("modules/"+se);return X==null?M.error("Cannot load "+se+" module. Are you sure you registered it?"):le[se]=X.DEFAULTS||{},le},{});return J.modules!=null&&J.modules.toolbar&&J.modules.toolbar.constructor!==Object&&(J.modules.toolbar={container:J.modules.toolbar}),J=(0,R.default)(!0,{},$.DEFAULTS,{modules:G},q,J),["bounds","container","scrollingContainer"].forEach(function(le){typeof J[le]=="string"&&(J[le]=document.querySelector(J[le]))}),J.modules=Object.keys(J.modules).reduce(function(le,se){return J.modules[se]&&(le[se]=J.modules[se]),le},{}),J}function ie(Y,J,q,H){if(this.options.strict&&!this.isEnabled()&&J===g.default.sources.USER)return new c.default;var G=q==null?null:this.getSelection(),le=this.editor.delta,se=Y();if(G!=null&&(q===!0&&(q=G.index),H==null?G=ue(G,se,J):H!==0&&(G=ue(G,q,H,J)),this.setSelection(G,g.default.sources.SILENT)),se.length()>0){var X,ne=[g.default.events.TEXT_CHANGE,se,le,J];if((X=this.emitter).emit.apply(X,[g.default.events.EDITOR_CHANGE].concat(ne)),J!==g.default.sources.SILENT){var te;(te=this.emitter).emit.apply(te,ne)}}return se}function ee(Y,J,q,H,G){var le={};return typeof Y.index=="number"&&typeof Y.length=="number"?typeof J!="number"?(G=H,H=q,q=J,J=Y.length,Y=Y.index):(J=Y.length,Y=Y.index):typeof J!="number"&&(G=H,H=q,q=J,J=0),(typeof q>"u"?"undefined":s(q))==="object"?(le=q,G=H):typeof q=="string"&&(H!=null?le[q]=H:G=q),G=G||g.default.sources.API,[Y,J,le,G]}function ue(Y,J,q,H){if(Y==null)return null;var G=void 0,le=void 0;if(J instanceof c.default){var se=[Y.index,Y.index+Y.length].map(function(ae){return J.transformPosition(ae,H!==g.default.sources.USER)}),X=o(se,2);G=X[0],le=X[1]}else{var ne=[Y.index,Y.index+Y.length].map(function(ae){return ae<J||ae===J&&H===g.default.sources.USER?ae:q>=0?ae+q:Math.max(J,ae+q)}),te=o(ne,2);G=te[0],le=te[1]}return new C.Range(G,le-G)}n.expandConfig=Q,n.overload=ee,n.default=$},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function A(_,C){for(var I=0;I<C.length;I++){var S=C[I];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(_,S.key,S)}}return function(_,C,I){return C&&A(_.prototype,C),I&&A(_,I),_}}(),o=function A(_,C,I){_===null&&(_=Function.prototype);var S=Object.getOwnPropertyDescriptor(_,C);if(S===void 0){var R=Object.getPrototypeOf(_);return R===null?void 0:A(R,C,I)}else{if("value"in S)return S.value;var L=S.get;return L===void 0?void 0:L.call(I)}},a=r(7),u=m(a),c=r(0),d=m(c);function m(A){return A&&A.__esModule?A:{default:A}}function p(A,_){if(!(A instanceof _))throw new TypeError("Cannot call a class as a function")}function g(A,_){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:A}function w(A,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);A.prototype=Object.create(_&&_.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(A,_):A.__proto__=_)}var b=function(A){w(_,A);function _(){return p(this,_),g(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return s(_,[{key:"formatAt",value:function(I,S,R,L){if(_.compare(this.statics.blotName,R)<0&&d.default.query(R,d.default.Scope.BLOT)){var k=this.isolate(I,S);L&&k.wrap(R,L)}else o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"formatAt",this).call(this,I,S,R,L)}},{key:"optimize",value:function(I){if(o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"optimize",this).call(this,I),this.parent instanceof _&&_.compare(this.statics.blotName,this.parent.statics.blotName)>0){var S=this.parent.isolate(this.offset(),this.length());this.moveChildren(S),S.wrap(this)}}}],[{key:"compare",value:function(I,S){var R=_.order.indexOf(I),L=_.order.indexOf(S);return R>=0||L>=0?R-L:I===S?0:I<S?-1:1}}]),_}(d.default.Inline);b.allowedChildren=[b,d.default.Embed,u.default],b.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=b},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(0),o=a(s);function a(p){return p&&p.__esModule?p:{default:p}}function u(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function c(p,g){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:p}function d(p,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);p.prototype=Object.create(g&&g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(p,g):p.__proto__=g)}var m=function(p){d(g,p);function g(){return u(this,g),c(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g}(o.default.Text);n.default=m},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function C(I,S){for(var R=0;R<S.length;R++){var L=S[R];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(I,L.key,L)}}return function(I,S,R){return S&&C(I.prototype,S),R&&C(I,R),I}}(),o=function C(I,S,R){I===null&&(I=Function.prototype);var L=Object.getOwnPropertyDescriptor(I,S);if(L===void 0){var k=Object.getPrototypeOf(I);return k===null?void 0:C(k,S,R)}else{if("value"in L)return L.value;var T=L.get;return T===void 0?void 0:T.call(R)}},a=r(54),u=m(a),c=r(10),d=m(c);function m(C){return C&&C.__esModule?C:{default:C}}function p(C,I){if(!(C instanceof I))throw new TypeError("Cannot call a class as a function")}function g(C,I){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:C}function w(C,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);C.prototype=Object.create(I&&I.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(C,I):C.__proto__=I)}var b=(0,d.default)("quill:events"),A=["selectionchange","mousedown","mouseup","click"];A.forEach(function(C){document.addEventListener(C,function(){for(var I=arguments.length,S=Array(I),R=0;R<I;R++)S[R]=arguments[R];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(L){if(L.__quill&&L.__quill.emitter){var k;(k=L.__quill.emitter).handleDOM.apply(k,S)}})})});var _=function(C){w(I,C);function I(){p(this,I);var S=g(this,(I.__proto__||Object.getPrototypeOf(I)).call(this));return S.listeners={},S.on("error",b.error),S}return s(I,[{key:"emit",value:function(){b.log.apply(b,arguments),o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(R){for(var L=arguments.length,k=Array(L>1?L-1:0),T=1;T<L;T++)k[T-1]=arguments[T];(this.listeners[R.type]||[]).forEach(function(D){var P=D.node,N=D.handler;(R.target===P||P.contains(R.target))&&N.apply(void 0,[R].concat(k))})}},{key:"listenDOM",value:function(R,L,k){this.listeners[R]||(this.listeners[R]=[]),this.listeners[R].push({node:L,handler:k})}}]),I}(u.default);_.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},_.sources={API:"api",SILENT:"silent",USER:"user"},n.default=_},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});function s(a,u){if(!(a instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function a(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,a),this.quill=u,this.options=c};o.DEFAULTS={},n.default=o},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function a(c){if(s.indexOf(c)<=s.indexOf(o)){for(var d,m=arguments.length,p=Array(m>1?m-1:0),g=1;g<m;g++)p[g-1]=arguments[g];(d=console)[c].apply(d,p)}}function u(c){return s.reduce(function(d,m){return d[m]=a.bind(console,m,c),d},{})}a.level=u.level=function(c){o=c},n.default=u},function(t,n,r){var s=Array.prototype.slice,o=r(52),a=r(53),u=t.exports=function(p,g,w){return w||(w={}),p===g?!0:p instanceof Date&&g instanceof Date?p.getTime()===g.getTime():!p||!g||typeof p!="object"&&typeof g!="object"?w.strict?p===g:p==g:m(p,g,w)};function c(p){return p==null}function d(p){return!(!p||typeof p!="object"||typeof p.length!="number"||typeof p.copy!="function"||typeof p.slice!="function"||p.length>0&&typeof p[0]!="number")}function m(p,g,w){var b,A;if(c(p)||c(g)||p.prototype!==g.prototype)return!1;if(a(p))return a(g)?(p=s.call(p),g=s.call(g),u(p,g,w)):!1;if(d(p)){if(!d(g)||p.length!==g.length)return!1;for(b=0;b<p.length;b++)if(p[b]!==g[b])return!1;return!0}try{var _=o(p),C=o(g)}catch{return!1}if(_.length!=C.length)return!1;for(_.sort(),C.sort(),b=_.length-1;b>=0;b--)if(_[b]!=C[b])return!1;for(b=_.length-1;b>=0;b--)if(A=_[b],!u(p[A],g[A],w))return!1;return typeof p==typeof g}},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(1),o=function(){function a(u,c,d){d===void 0&&(d={}),this.attrName=u,this.keyName=c;var m=s.Scope.TYPE&s.Scope.ATTRIBUTE;d.scope!=null?this.scope=d.scope&s.Scope.LEVEL|m:this.scope=s.Scope.ATTRIBUTE,d.whitelist!=null&&(this.whitelist=d.whitelist)}return a.keys=function(u){return[].map.call(u.attributes,function(c){return c.name})},a.prototype.add=function(u,c){return this.canAdd(u,c)?(u.setAttribute(this.keyName,c),!0):!1},a.prototype.canAdd=function(u,c){var d=s.query(u,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return d==null?!1:this.whitelist==null?!0:typeof c=="string"?this.whitelist.indexOf(c.replace(/["']/g,""))>-1:this.whitelist.indexOf(c)>-1},a.prototype.remove=function(u){u.removeAttribute(this.keyName)},a.prototype.value=function(u){var c=u.getAttribute(this.keyName);return this.canAdd(u,c)&&c?c:""},a}();n.default=o},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var s=function(){function T(D,P){var N=[],F=!0,M=!1,$=void 0;try{for(var Q=D[Symbol.iterator](),ie;!(F=(ie=Q.next()).done)&&(N.push(ie.value),!(P&&N.length===P));F=!0);}catch(ee){M=!0,$=ee}finally{try{!F&&Q.return&&Q.return()}finally{if(M)throw $}}return N}return function(D,P){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return T(D,P);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function T(D,P){for(var N=0;N<P.length;N++){var F=P[N];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(D,F.key,F)}}return function(D,P,N){return P&&T(D.prototype,P),N&&T(D,N),D}}(),a=function T(D,P,N){D===null&&(D=Function.prototype);var F=Object.getOwnPropertyDescriptor(D,P);if(F===void 0){var M=Object.getPrototypeOf(D);return M===null?void 0:T(M,P,N)}else{if("value"in F)return F.value;var $=F.get;return $===void 0?void 0:$.call(N)}},u=r(2),c=C(u),d=r(0),m=C(d),p=r(4),g=C(p),w=r(6),b=C(w),A=r(7),_=C(A);function C(T){return T&&T.__esModule?T:{default:T}}function I(T,D){if(!(T instanceof D))throw new TypeError("Cannot call a class as a function")}function S(T,D){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:T}function R(T,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);T.prototype=Object.create(D&&D.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(T,D):T.__proto__=D)}var L=function(T){R(D,T);function D(){return I(this,D),S(this,(D.__proto__||Object.getPrototypeOf(D)).apply(this,arguments))}return D}(b.default);L.blotName="code",L.tagName="CODE";var k=function(T){R(D,T);function D(){return I(this,D),S(this,(D.__proto__||Object.getPrototypeOf(D)).apply(this,arguments))}return o(D,[{key:"delta",value:function(){var N=this,F=this.domNode.textContent;return F.endsWith(`
`)&&(F=F.slice(0,-1)),F.split(`
`).reduce(function(M,$){return M.insert($).insert(`
`,N.formats())},new c.default)}},{key:"format",value:function(N,F){if(!(N===this.statics.blotName&&F)){var M=this.descendant(_.default,this.length()-1),$=s(M,1),Q=$[0];Q!=null&&Q.deleteAt(Q.length()-1,1),a(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"format",this).call(this,N,F)}}},{key:"formatAt",value:function(N,F,M,$){if(F!==0&&!(m.default.query(M,m.default.Scope.BLOCK)==null||M===this.statics.blotName&&$===this.statics.formats(this.domNode))){var Q=this.newlineIndex(N);if(!(Q<0||Q>=N+F)){var ie=this.newlineIndex(N,!0)+1,ee=Q-ie+1,ue=this.isolate(ie,ee),Y=ue.next;ue.format(M,$),Y instanceof D&&Y.formatAt(0,N-ie+F-ee,M,$)}}}},{key:"insertAt",value:function(N,F,M){if(M==null){var $=this.descendant(_.default,N),Q=s($,2),ie=Q[0],ee=Q[1];ie.insertAt(ee,F)}}},{key:"length",value:function(){var N=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?N:N+1}},{key:"newlineIndex",value:function(N){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(F)return this.domNode.textContent.slice(0,N).lastIndexOf(`
`);var M=this.domNode.textContent.slice(N).indexOf(`
`);return M>-1?N+M:-1}},{key:"optimize",value:function(N){this.domNode.textContent.endsWith(`
`)||this.appendChild(m.default.create("text",`
`)),a(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"optimize",this).call(this,N);var F=this.next;F!=null&&F.prev===this&&F.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===F.statics.formats(F.domNode)&&(F.optimize(N),F.moveChildren(this),F.remove())}},{key:"replace",value:function(N){a(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"replace",this).call(this,N),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(F){var M=m.default.find(F);M==null?F.parentNode.removeChild(F):M instanceof m.default.Embed?M.remove():M.unwrap()})}}],[{key:"create",value:function(N){var F=a(D.__proto__||Object.getPrototypeOf(D),"create",this).call(this,N);return F.setAttribute("spellcheck",!1),F}},{key:"formats",value:function(){return!0}}]),D}(g.default);k.blotName="code-block",k.tagName="PRE",k.TAB="  ",n.Code=L,n.default=k},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},o=function(){function Y(J,q){var H=[],G=!0,le=!1,se=void 0;try{for(var X=J[Symbol.iterator](),ne;!(G=(ne=X.next()).done)&&(H.push(ne.value),!(q&&H.length===q));G=!0);}catch(te){le=!0,se=te}finally{try{!G&&X.return&&X.return()}finally{if(le)throw se}}return H}return function(J,q){if(Array.isArray(J))return J;if(Symbol.iterator in Object(J))return Y(J,q);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function Y(J,q){for(var H=0;H<q.length;H++){var G=q[H];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(J,G.key,G)}}return function(J,q,H){return q&&Y(J.prototype,q),H&&Y(J,H),J}}(),u=r(2),c=F(u),d=r(20),m=F(d),p=r(0),g=F(p),w=r(13),b=F(w),A=r(24),_=F(A),C=r(4),I=F(C),S=r(16),R=F(S),L=r(21),k=F(L),T=r(11),D=F(T),P=r(3),N=F(P);function F(Y){return Y&&Y.__esModule?Y:{default:Y}}function M(Y,J,q){return J in Y?Object.defineProperty(Y,J,{value:q,enumerable:!0,configurable:!0,writable:!0}):Y[J]=q,Y}function $(Y,J){if(!(Y instanceof J))throw new TypeError("Cannot call a class as a function")}var Q=/^[ -~]*$/,ie=function(){function Y(J){$(this,Y),this.scroll=J,this.delta=this.getDelta()}return a(Y,[{key:"applyDelta",value:function(q){var H=this,G=!1;this.scroll.update();var le=this.scroll.length();return this.scroll.batchStart(),q=ue(q),q.reduce(function(se,X){var ne=X.retain||X.delete||X.insert.length||1,te=X.attributes||{};if(X.insert!=null){if(typeof X.insert=="string"){var ae=X.insert;ae.endsWith(`
`)&&G&&(G=!1,ae=ae.slice(0,-1)),se>=le&&!ae.endsWith(`
`)&&(G=!0),H.scroll.insertAt(se,ae);var de=H.scroll.line(se),ye=o(de,2),xe=ye[0],Oe=ye[1],Fe=(0,N.default)({},(0,C.bubbleFormats)(xe));if(xe instanceof I.default){var Be=xe.descendant(g.default.Leaf,Oe),We=o(Be,1),mt=We[0];Fe=(0,N.default)(Fe,(0,C.bubbleFormats)(mt))}te=m.default.attributes.diff(Fe,te)||{}}else if(s(X.insert)==="object"){var fe=Object.keys(X.insert)[0];if(fe==null)return se;H.scroll.insertAt(se,fe,X.insert[fe])}le+=ne}return Object.keys(te).forEach(function(ve){H.scroll.formatAt(se,ne,ve,te[ve])}),se+ne},0),q.reduce(function(se,X){return typeof X.delete=="number"?(H.scroll.deleteAt(se,X.delete),se):se+(X.retain||X.insert.length||1)},0),this.scroll.batchEnd(),this.update(q)}},{key:"deleteText",value:function(q,H){return this.scroll.deleteAt(q,H),this.update(new c.default().retain(q).delete(H))}},{key:"formatLine",value:function(q,H){var G=this,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(le).forEach(function(se){if(!(G.scroll.whitelist!=null&&!G.scroll.whitelist[se])){var X=G.scroll.lines(q,Math.max(H,1)),ne=H;X.forEach(function(te){var ae=te.length();if(!(te instanceof b.default))te.format(se,le[se]);else{var de=q-te.offset(G.scroll),ye=te.newlineIndex(de+ne)-de+1;te.formatAt(de,ye,se,le[se])}ne-=ae})}}),this.scroll.optimize(),this.update(new c.default().retain(q).retain(H,(0,k.default)(le)))}},{key:"formatText",value:function(q,H){var G=this,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(le).forEach(function(se){G.scroll.formatAt(q,H,se,le[se])}),this.update(new c.default().retain(q).retain(H,(0,k.default)(le)))}},{key:"getContents",value:function(q,H){return this.delta.slice(q,q+H)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(q,H){return q.concat(H.delta())},new c.default)}},{key:"getFormat",value:function(q){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,G=[],le=[];H===0?this.scroll.path(q).forEach(function(X){var ne=o(X,1),te=ne[0];te instanceof I.default?G.push(te):te instanceof g.default.Leaf&&le.push(te)}):(G=this.scroll.lines(q,H),le=this.scroll.descendants(g.default.Leaf,q,H));var se=[G,le].map(function(X){if(X.length===0)return{};for(var ne=(0,C.bubbleFormats)(X.shift());Object.keys(ne).length>0;){var te=X.shift();if(te==null)return ne;ne=ee((0,C.bubbleFormats)(te),ne)}return ne});return N.default.apply(N.default,se)}},{key:"getText",value:function(q,H){return this.getContents(q,H).filter(function(G){return typeof G.insert=="string"}).map(function(G){return G.insert}).join("")}},{key:"insertEmbed",value:function(q,H,G){return this.scroll.insertAt(q,H,G),this.update(new c.default().retain(q).insert(M({},H,G)))}},{key:"insertText",value:function(q,H){var G=this,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return H=H.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(q,H),Object.keys(le).forEach(function(se){G.scroll.formatAt(q,H.length,se,le[se])}),this.update(new c.default().retain(q).insert(H,(0,k.default)(le)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var q=this.scroll.children.head;return q.statics.blotName!==I.default.blotName||q.children.length>1?!1:q.children.head instanceof R.default}},{key:"removeFormat",value:function(q,H){var G=this.getText(q,H),le=this.scroll.line(q+H),se=o(le,2),X=se[0],ne=se[1],te=0,ae=new c.default;X!=null&&(X instanceof b.default?te=X.newlineIndex(ne)-ne+1:te=X.length()-ne,ae=X.delta().slice(ne,ne+te-1).insert(`
`));var de=this.getContents(q,H+te),ye=de.diff(new c.default().insert(G).concat(ae)),xe=new c.default().retain(q).concat(ye);return this.applyDelta(xe)}},{key:"update",value:function(q){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,le=this.delta;if(H.length===1&&H[0].type==="characterData"&&H[0].target.data.match(Q)&&g.default.find(H[0].target)){var se=g.default.find(H[0].target),X=(0,C.bubbleFormats)(se),ne=se.offset(this.scroll),te=H[0].oldValue.replace(_.default.CONTENTS,""),ae=new c.default().insert(te),de=new c.default().insert(se.value()),ye=new c.default().retain(ne).concat(ae.diff(de,G));q=ye.reduce(function(xe,Oe){return Oe.insert?xe.insert(Oe.insert,X):xe.push(Oe)},new c.default),this.delta=le.compose(q)}else this.delta=this.getDelta(),(!q||!(0,D.default)(le.compose(q),this.delta))&&(q=le.diff(this.delta,G));return q}}]),Y}();function ee(Y,J){return Object.keys(J).reduce(function(q,H){return Y[H]==null||(J[H]===Y[H]?q[H]=J[H]:Array.isArray(J[H])?J[H].indexOf(Y[H])<0&&(q[H]=J[H].concat([Y[H]])):q[H]=[J[H],Y[H]]),q},{})}function ue(Y){return Y.reduce(function(J,q){if(q.insert===1){var H=(0,k.default)(q.attributes);return delete H.image,J.insert({image:q.attributes.image},H)}if(q.attributes!=null&&(q.attributes.list===!0||q.attributes.bullet===!0)&&(q=(0,k.default)(q),q.attributes.list?q.attributes.list="ordered":(q.attributes.list="bullet",delete q.attributes.bullet)),typeof q.insert=="string"){var G=q.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return J.insert(G,q.attributes)}return J.push(q)},new c.default)}n.default=ie},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var s=function(){function T(D,P){var N=[],F=!0,M=!1,$=void 0;try{for(var Q=D[Symbol.iterator](),ie;!(F=(ie=Q.next()).done)&&(N.push(ie.value),!(P&&N.length===P));F=!0);}catch(ee){M=!0,$=ee}finally{try{!F&&Q.return&&Q.return()}finally{if(M)throw $}}return N}return function(D,P){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return T(D,P);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function T(D,P){for(var N=0;N<P.length;N++){var F=P[N];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(D,F.key,F)}}return function(D,P,N){return P&&T(D.prototype,P),N&&T(D,N),D}}(),a=r(0),u=_(a),c=r(21),d=_(c),m=r(11),p=_(m),g=r(8),w=_(g),b=r(10),A=_(b);function _(T){return T&&T.__esModule?T:{default:T}}function C(T){if(Array.isArray(T)){for(var D=0,P=Array(T.length);D<T.length;D++)P[D]=T[D];return P}else return Array.from(T)}function I(T,D){if(!(T instanceof D))throw new TypeError("Cannot call a class as a function")}var S=(0,A.default)("quill:selection"),R=function T(D){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;I(this,T),this.index=D,this.length=P},L=function(){function T(D,P){var N=this;I(this,T),this.emitter=P,this.scroll=D,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=u.default.create("cursor",this),this.lastRange=this.savedRange=new R(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){N.mouseDown||setTimeout(N.update.bind(N,w.default.sources.USER),1)}),this.emitter.on(w.default.events.EDITOR_CHANGE,function(F,M){F===w.default.events.TEXT_CHANGE&&M.length()>0&&N.update(w.default.sources.SILENT)}),this.emitter.on(w.default.events.SCROLL_BEFORE_UPDATE,function(){if(N.hasFocus()){var F=N.getNativeRange();F!=null&&F.start.node!==N.cursor.textNode&&N.emitter.once(w.default.events.SCROLL_UPDATE,function(){try{N.setNativeRange(F.start.node,F.start.offset,F.end.node,F.end.offset)}catch{}})}}),this.emitter.on(w.default.events.SCROLL_OPTIMIZE,function(F,M){if(M.range){var $=M.range,Q=$.startNode,ie=$.startOffset,ee=$.endNode,ue=$.endOffset;N.setNativeRange(Q,ie,ee,ue)}}),this.update(w.default.sources.SILENT)}return o(T,[{key:"handleComposition",value:function(){var P=this;this.root.addEventListener("compositionstart",function(){P.composing=!0}),this.root.addEventListener("compositionend",function(){if(P.composing=!1,P.cursor.parent){var N=P.cursor.restore();if(!N)return;setTimeout(function(){P.setNativeRange(N.startNode,N.startOffset,N.endNode,N.endOffset)},1)}})}},{key:"handleDragging",value:function(){var P=this;this.emitter.listenDOM("mousedown",document.body,function(){P.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){P.mouseDown=!1,P.update(w.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(P,N){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[P])){this.scroll.update();var F=this.getNativeRange();if(!(F==null||!F.native.collapsed||u.default.query(P,u.default.Scope.BLOCK))){if(F.start.node!==this.cursor.textNode){var M=u.default.find(F.start.node,!1);if(M==null)return;if(M instanceof u.default.Leaf){var $=M.split(F.start.offset);M.parent.insertBefore(this.cursor,$)}else M.insertBefore(this.cursor,F.start.node);this.cursor.attach()}this.cursor.format(P,N),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(P){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,F=this.scroll.length();P=Math.min(P,F-1),N=Math.min(P+N,F-1)-P;var M=void 0,$=this.scroll.leaf(P),Q=s($,2),ie=Q[0],ee=Q[1];if(ie==null)return null;var ue=ie.position(ee,!0),Y=s(ue,2);M=Y[0],ee=Y[1];var J=document.createRange();if(N>0){J.setStart(M,ee);var q=this.scroll.leaf(P+N),H=s(q,2);if(ie=H[0],ee=H[1],ie==null)return null;var G=ie.position(ee,!0),le=s(G,2);return M=le[0],ee=le[1],J.setEnd(M,ee),J.getBoundingClientRect()}else{var se="left",X=void 0;return M instanceof Text?(ee<M.data.length?(J.setStart(M,ee),J.setEnd(M,ee+1)):(J.setStart(M,ee-1),J.setEnd(M,ee),se="right"),X=J.getBoundingClientRect()):(X=ie.domNode.getBoundingClientRect(),ee>0&&(se="right")),{bottom:X.top+X.height,height:X.height,left:X[se],right:X[se],top:X.top,width:0}}}},{key:"getNativeRange",value:function(){var P=document.getSelection();if(P==null||P.rangeCount<=0)return null;var N=P.getRangeAt(0);if(N==null)return null;var F=this.normalizeNative(N);return S.info("getNativeRange",F),F}},{key:"getRange",value:function(){var P=this.getNativeRange();if(P==null)return[null,null];var N=this.normalizedToRange(P);return[N,P]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(P){var N=this,F=[[P.start.node,P.start.offset]];P.native.collapsed||F.push([P.end.node,P.end.offset]);var M=F.map(function(ie){var ee=s(ie,2),ue=ee[0],Y=ee[1],J=u.default.find(ue,!0),q=J.offset(N.scroll);return Y===0?q:J instanceof u.default.Container?q+J.length():q+J.index(ue,Y)}),$=Math.min(Math.max.apply(Math,C(M)),this.scroll.length()-1),Q=Math.min.apply(Math,[$].concat(C(M)));return new R(Q,$-Q)}},{key:"normalizeNative",value:function(P){if(!k(this.root,P.startContainer)||!P.collapsed&&!k(this.root,P.endContainer))return null;var N={start:{node:P.startContainer,offset:P.startOffset},end:{node:P.endContainer,offset:P.endOffset},native:P};return[N.start,N.end].forEach(function(F){for(var M=F.node,$=F.offset;!(M instanceof Text)&&M.childNodes.length>0;)if(M.childNodes.length>$)M=M.childNodes[$],$=0;else if(M.childNodes.length===$)M=M.lastChild,$=M instanceof Text?M.data.length:M.childNodes.length+1;else break;F.node=M,F.offset=$}),N}},{key:"rangeToNative",value:function(P){var N=this,F=P.collapsed?[P.index]:[P.index,P.index+P.length],M=[],$=this.scroll.length();return F.forEach(function(Q,ie){Q=Math.min($-1,Q);var ee=void 0,ue=N.scroll.leaf(Q),Y=s(ue,2),J=Y[0],q=Y[1],H=J.position(q,ie!==0),G=s(H,2);ee=G[0],q=G[1],M.push(ee,q)}),M.length<2&&(M=M.concat(M)),M}},{key:"scrollIntoView",value:function(P){var N=this.lastRange;if(N!=null){var F=this.getBounds(N.index,N.length);if(F!=null){var M=this.scroll.length()-1,$=this.scroll.line(Math.min(N.index,M)),Q=s($,1),ie=Q[0],ee=ie;if(N.length>0){var ue=this.scroll.line(Math.min(N.index+N.length,M)),Y=s(ue,1);ee=Y[0]}if(!(ie==null||ee==null)){var J=P.getBoundingClientRect();F.top<J.top?P.scrollTop-=J.top-F.top:F.bottom>J.bottom&&(P.scrollTop+=F.bottom-J.bottom)}}}}},{key:"setNativeRange",value:function(P,N){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:P,M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:N,$=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(S.info("setNativeRange",P,N,F,M),!(P!=null&&(this.root.parentNode==null||P.parentNode==null||F.parentNode==null))){var Q=document.getSelection();if(Q!=null)if(P!=null){this.hasFocus()||this.root.focus();var ie=(this.getNativeRange()||{}).native;if(ie==null||$||P!==ie.startContainer||N!==ie.startOffset||F!==ie.endContainer||M!==ie.endOffset){P.tagName=="BR"&&(N=[].indexOf.call(P.parentNode.childNodes,P),P=P.parentNode),F.tagName=="BR"&&(M=[].indexOf.call(F.parentNode.childNodes,F),F=F.parentNode);var ee=document.createRange();ee.setStart(P,N),ee.setEnd(F,M),Q.removeAllRanges(),Q.addRange(ee)}}else Q.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(P){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:w.default.sources.API;if(typeof N=="string"&&(F=N,N=!1),S.info("setRange",P),P!=null){var M=this.rangeToNative(P);this.setNativeRange.apply(this,C(M).concat([N]))}else this.setNativeRange(null);this.update(F)}},{key:"update",value:function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:w.default.sources.USER,N=this.lastRange,F=this.getRange(),M=s(F,2),$=M[0],Q=M[1];if(this.lastRange=$,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,p.default)(N,this.lastRange)){var ie;!this.composing&&Q!=null&&Q.native.collapsed&&Q.start.node!==this.cursor.textNode&&this.cursor.restore();var ee=[w.default.events.SELECTION_CHANGE,(0,d.default)(this.lastRange),(0,d.default)(N),P];if((ie=this.emitter).emit.apply(ie,[w.default.events.EDITOR_CHANGE].concat(ee)),P!==w.default.sources.SILENT){var ue;(ue=this.emitter).emit.apply(ue,ee)}}}}]),T}();function k(T,D){try{D.parentNode}catch{return!1}return D instanceof Text&&(D=D.parentNode),T.contains(D)}n.Range=R,n.default=L},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function w(b,A){for(var _=0;_<A.length;_++){var C=A[_];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(b,C.key,C)}}return function(b,A,_){return A&&w(b.prototype,A),_&&w(b,_),b}}(),o=function w(b,A,_){b===null&&(b=Function.prototype);var C=Object.getOwnPropertyDescriptor(b,A);if(C===void 0){var I=Object.getPrototypeOf(b);return I===null?void 0:w(I,A,_)}else{if("value"in C)return C.value;var S=C.get;return S===void 0?void 0:S.call(_)}},a=r(0),u=c(a);function c(w){return w&&w.__esModule?w:{default:w}}function d(w,b){if(!(w instanceof b))throw new TypeError("Cannot call a class as a function")}function m(w,b){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:w}function p(w,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);w.prototype=Object.create(b&&b.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(w,b):w.__proto__=b)}var g=function(w){p(b,w);function b(){return d(this,b),m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"insertInto",value:function(_,C){_.children.length===0?o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"insertInto",this).call(this,_,C):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),b}(u.default.Embed);g.blotName="break",g.tagName="BR",n.default=g},function(t,n,r){var s=this&&this.__extends||function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var w in g)g.hasOwnProperty(w)&&(p[w]=g[w])};return function(p,g){m(p,g);function w(){this.constructor=p}p.prototype=g===null?Object.create(g):(w.prototype=g.prototype,new w)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=r(44),a=r(30),u=r(1),c=function(m){s(p,m);function p(g){var w=m.call(this,g)||this;return w.build(),w}return p.prototype.appendChild=function(g){this.insertBefore(g)},p.prototype.attach=function(){m.prototype.attach.call(this),this.children.forEach(function(g){g.attach()})},p.prototype.build=function(){var g=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(w){try{var b=d(w);g.insertBefore(b,g.children.head||void 0)}catch(A){if(A instanceof u.ParchmentError)return;throw A}})},p.prototype.deleteAt=function(g,w){if(g===0&&w===this.length())return this.remove();this.children.forEachAt(g,w,function(b,A,_){b.deleteAt(A,_)})},p.prototype.descendant=function(g,w){var b=this.children.find(w),A=b[0],_=b[1];return g.blotName==null&&g(A)||g.blotName!=null&&A instanceof g?[A,_]:A instanceof p?A.descendant(g,_):[null,-1]},p.prototype.descendants=function(g,w,b){w===void 0&&(w=0),b===void 0&&(b=Number.MAX_VALUE);var A=[],_=b;return this.children.forEachAt(w,b,function(C,I,S){(g.blotName==null&&g(C)||g.blotName!=null&&C instanceof g)&&A.push(C),C instanceof p&&(A=A.concat(C.descendants(g,I,_))),_-=S}),A},p.prototype.detach=function(){this.children.forEach(function(g){g.detach()}),m.prototype.detach.call(this)},p.prototype.formatAt=function(g,w,b,A){this.children.forEachAt(g,w,function(_,C,I){_.formatAt(C,I,b,A)})},p.prototype.insertAt=function(g,w,b){var A=this.children.find(g),_=A[0],C=A[1];if(_)_.insertAt(C,w,b);else{var I=b==null?u.create("text",w):u.create(w,b);this.appendChild(I)}},p.prototype.insertBefore=function(g,w){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(b){return g instanceof b}))throw new u.ParchmentError("Cannot insert "+g.statics.blotName+" into "+this.statics.blotName);g.insertInto(this,w)},p.prototype.length=function(){return this.children.reduce(function(g,w){return g+w.length()},0)},p.prototype.moveChildren=function(g,w){this.children.forEach(function(b){g.insertBefore(b,w)})},p.prototype.optimize=function(g){if(m.prototype.optimize.call(this,g),this.children.length===0)if(this.statics.defaultChild!=null){var w=u.create(this.statics.defaultChild);this.appendChild(w),w.optimize(g)}else this.remove()},p.prototype.path=function(g,w){w===void 0&&(w=!1);var b=this.children.find(g,w),A=b[0],_=b[1],C=[[this,g]];return A instanceof p?C.concat(A.path(_,w)):(A!=null&&C.push([A,_]),C)},p.prototype.removeChild=function(g){this.children.remove(g)},p.prototype.replace=function(g){g instanceof p&&g.moveChildren(this),m.prototype.replace.call(this,g)},p.prototype.split=function(g,w){if(w===void 0&&(w=!1),!w){if(g===0)return this;if(g===this.length())return this.next}var b=this.clone();return this.parent.insertBefore(b,this.next),this.children.forEachAt(g,this.length(),function(A,_,C){A=A.split(_,w),b.appendChild(A)}),b},p.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},p.prototype.update=function(g,w){var b=this,A=[],_=[];g.forEach(function(C){C.target===b.domNode&&C.type==="childList"&&(A.push.apply(A,C.addedNodes),_.push.apply(_,C.removedNodes))}),_.forEach(function(C){if(!(C.parentNode!=null&&C.tagName!=="IFRAME"&&document.body.compareDocumentPosition(C)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var I=u.find(C);I!=null&&(I.domNode.parentNode==null||I.domNode.parentNode===b.domNode)&&I.detach()}}),A.filter(function(C){return C.parentNode==b.domNode}).sort(function(C,I){return C===I?0:C.compareDocumentPosition(I)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(C){var I=null;C.nextSibling!=null&&(I=u.find(C.nextSibling));var S=d(C);(S.next!=I||S.next==null)&&(S.parent!=null&&S.parent.removeChild(b),b.insertBefore(S,I||void 0))})},p}(a.default);function d(m){var p=u.find(m);if(p==null)try{p=u.create(m)}catch{p=u.create(u.Scope.INLINE),[].slice.call(m.childNodes).forEach(function(w){p.domNode.appendChild(w)}),m.parentNode&&m.parentNode.replaceChild(p.domNode,m),p.attach()}return p}n.default=c},function(t,n,r){var s=this&&this.__extends||function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var w in g)g.hasOwnProperty(w)&&(p[w]=g[w])};return function(p,g){m(p,g);function w(){this.constructor=p}p.prototype=g===null?Object.create(g):(w.prototype=g.prototype,new w)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=r(12),a=r(31),u=r(17),c=r(1),d=function(m){s(p,m);function p(g){var w=m.call(this,g)||this;return w.attributes=new a.default(w.domNode),w}return p.formats=function(g){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return g.tagName.toLowerCase()},p.prototype.format=function(g,w){var b=c.query(g);b instanceof o.default?this.attributes.attribute(b,w):w&&b!=null&&(g!==this.statics.blotName||this.formats()[g]!==w)&&this.replaceWith(g,w)},p.prototype.formats=function(){var g=this.attributes.values(),w=this.statics.formats(this.domNode);return w!=null&&(g[this.statics.blotName]=w),g},p.prototype.replaceWith=function(g,w){var b=m.prototype.replaceWith.call(this,g,w);return this.attributes.copy(b),b},p.prototype.update=function(g,w){var b=this;m.prototype.update.call(this,g,w),g.some(function(A){return A.target===b.domNode&&A.type==="attributes"})&&this.attributes.build()},p.prototype.wrap=function(g,w){var b=m.prototype.wrap.call(this,g,w);return b instanceof p&&b.statics.scope===this.statics.scope&&this.attributes.move(b),b},p}(u.default);n.default=d},function(t,n,r){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,m){d.__proto__=m}||function(d,m){for(var p in m)m.hasOwnProperty(p)&&(d[p]=m[p])};return function(d,m){c(d,m);function p(){this.constructor=d}d.prototype=m===null?Object.create(m):(p.prototype=m.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=r(30),a=r(1),u=function(c){s(d,c);function d(){return c!==null&&c.apply(this,arguments)||this}return d.value=function(m){return!0},d.prototype.index=function(m,p){return this.domNode===m||this.domNode.compareDocumentPosition(m)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(p,1):-1},d.prototype.position=function(m,p){var g=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return m>0&&(g+=1),[this.parent.domNode,g]},d.prototype.value=function(){var m;return m={},m[this.statics.blotName]=this.statics.value(this.domNode)||!0,m},d.scope=a.Scope.INLINE_BLOT,d}(o.default);n.default=u},function(t,n,r){var s=r(11),o=r(3),a={attributes:{compose:function(c,d,m){typeof c!="object"&&(c={}),typeof d!="object"&&(d={});var p=o(!0,{},d);m||(p=Object.keys(p).reduce(function(w,b){return p[b]!=null&&(w[b]=p[b]),w},{}));for(var g in c)c[g]!==void 0&&d[g]===void 0&&(p[g]=c[g]);return Object.keys(p).length>0?p:void 0},diff:function(c,d){typeof c!="object"&&(c={}),typeof d!="object"&&(d={});var m=Object.keys(c).concat(Object.keys(d)).reduce(function(p,g){return s(c[g],d[g])||(p[g]=d[g]===void 0?null:d[g]),p},{});return Object.keys(m).length>0?m:void 0},transform:function(c,d,m){if(typeof c!="object")return d;if(typeof d=="object"){if(!m)return d;var p=Object.keys(d).reduce(function(g,w){return c[w]===void 0&&(g[w]=d[w]),g},{});return Object.keys(p).length>0?p:void 0}}},iterator:function(c){return new u(c)},length:function(c){return typeof c.delete=="number"?c.delete:typeof c.retain=="number"?c.retain:typeof c.insert=="string"?c.insert.length:1}};function u(c){this.ops=c,this.index=0,this.offset=0}u.prototype.hasNext=function(){return this.peekLength()<1/0},u.prototype.next=function(c){c||(c=1/0);var d=this.ops[this.index];if(d){var m=this.offset,p=a.length(d);if(c>=p-m?(c=p-m,this.index+=1,this.offset=0):this.offset+=c,typeof d.delete=="number")return{delete:c};var g={};return d.attributes&&(g.attributes=d.attributes),typeof d.retain=="number"?g.retain=c:typeof d.insert=="string"?g.insert=d.insert.substr(m,c):g.insert=d.insert,g}else return{retain:1/0}},u.prototype.peek=function(){return this.ops[this.index]},u.prototype.peekLength=function(){return this.ops[this.index]?a.length(this.ops[this.index])-this.offset:1/0},u.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},u.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var c=this.offset,d=this.index,m=this.next(),p=this.ops.slice(this.index);return this.offset=c,this.index=d,[m].concat(p)}else return[]},t.exports=a},function(t,n){var r=function(){function s(b,A){return A!=null&&b instanceof A}var o;try{o=Map}catch{o=function(){}}var a;try{a=Set}catch{a=function(){}}var u;try{u=Promise}catch{u=function(){}}function c(b,A,_,C,I){typeof A=="object"&&(_=A.depth,C=A.prototype,I=A.includeNonEnumerable,A=A.circular);var S=[],R=[],L=typeof Buffer<"u";typeof A>"u"&&(A=!0),typeof _>"u"&&(_=1/0);function k(T,D){if(T===null)return null;if(D===0)return T;var P,N;if(typeof T!="object")return T;if(s(T,o))P=new o;else if(s(T,a))P=new a;else if(s(T,u))P=new u(function(J,q){T.then(function(H){J(k(H,D-1))},function(H){q(k(H,D-1))})});else if(c.__isArray(T))P=[];else if(c.__isRegExp(T))P=new RegExp(T.source,w(T)),T.lastIndex&&(P.lastIndex=T.lastIndex);else if(c.__isDate(T))P=new Date(T.getTime());else{if(L&&Buffer.isBuffer(T))return Buffer.allocUnsafe?P=Buffer.allocUnsafe(T.length):P=new Buffer(T.length),T.copy(P),P;s(T,Error)?P=Object.create(T):typeof C>"u"?(N=Object.getPrototypeOf(T),P=Object.create(N)):(P=Object.create(C),N=C)}if(A){var F=S.indexOf(T);if(F!=-1)return R[F];S.push(T),R.push(P)}s(T,o)&&T.forEach(function(J,q){var H=k(q,D-1),G=k(J,D-1);P.set(H,G)}),s(T,a)&&T.forEach(function(J){var q=k(J,D-1);P.add(q)});for(var M in T){var $;N&&($=Object.getOwnPropertyDescriptor(N,M)),!($&&$.set==null)&&(P[M]=k(T[M],D-1))}if(Object.getOwnPropertySymbols)for(var Q=Object.getOwnPropertySymbols(T),M=0;M<Q.length;M++){var ie=Q[M],ee=Object.getOwnPropertyDescriptor(T,ie);ee&&!ee.enumerable&&!I||(P[ie]=k(T[ie],D-1),ee.enumerable||Object.defineProperty(P,ie,{enumerable:!1}))}if(I)for(var ue=Object.getOwnPropertyNames(T),M=0;M<ue.length;M++){var Y=ue[M],ee=Object.getOwnPropertyDescriptor(T,Y);ee&&ee.enumerable||(P[Y]=k(T[Y],D-1),Object.defineProperty(P,Y,{enumerable:!1}))}return P}return k(b,_)}c.clonePrototype=function(A){if(A===null)return null;var _=function(){};return _.prototype=A,new _};function d(b){return Object.prototype.toString.call(b)}c.__objToStr=d;function m(b){return typeof b=="object"&&d(b)==="[object Date]"}c.__isDate=m;function p(b){return typeof b=="object"&&d(b)==="[object Array]"}c.__isArray=p;function g(b){return typeof b=="object"&&d(b)==="[object RegExp]"}c.__isRegExp=g;function w(b){var A="";return b.global&&(A+="g"),b.ignoreCase&&(A+="i"),b.multiline&&(A+="m"),A}return c.__getRegExpFlags=w,c}();typeof t=="object"&&t.exports&&(t.exports=r)},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function P(N,F){var M=[],$=!0,Q=!1,ie=void 0;try{for(var ee=N[Symbol.iterator](),ue;!($=(ue=ee.next()).done)&&(M.push(ue.value),!(F&&M.length===F));$=!0);}catch(Y){Q=!0,ie=Y}finally{try{!$&&ee.return&&ee.return()}finally{if(Q)throw ie}}return M}return function(N,F){if(Array.isArray(N))return N;if(Symbol.iterator in Object(N))return P(N,F);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function P(N,F){for(var M=0;M<F.length;M++){var $=F[M];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(N,$.key,$)}}return function(N,F,M){return F&&P(N.prototype,F),M&&P(N,M),N}}(),a=function P(N,F,M){N===null&&(N=Function.prototype);var $=Object.getOwnPropertyDescriptor(N,F);if($===void 0){var Q=Object.getPrototypeOf(N);return Q===null?void 0:P(Q,F,M)}else{if("value"in $)return $.value;var ie=$.get;return ie===void 0?void 0:ie.call(M)}},u=r(0),c=S(u),d=r(8),m=S(d),p=r(4),g=S(p),w=r(16),b=S(w),A=r(13),_=S(A),C=r(25),I=S(C);function S(P){return P&&P.__esModule?P:{default:P}}function R(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")}function L(P,N){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:P}function k(P,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);P.prototype=Object.create(N&&N.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(P,N):P.__proto__=N)}function T(P){return P instanceof g.default||P instanceof p.BlockEmbed}var D=function(P){k(N,P);function N(F,M){R(this,N);var $=L(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,F));return $.emitter=M.emitter,Array.isArray(M.whitelist)&&($.whitelist=M.whitelist.reduce(function(Q,ie){return Q[ie]=!0,Q},{})),$.domNode.addEventListener("DOMNodeInserted",function(){}),$.optimize(),$.enable(),$}return o(N,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(M,$){var Q=this.line(M),ie=s(Q,2),ee=ie[0],ue=ie[1],Y=this.line(M+$),J=s(Y,1),q=J[0];if(a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"deleteAt",this).call(this,M,$),q!=null&&ee!==q&&ue>0){if(ee instanceof p.BlockEmbed||q instanceof p.BlockEmbed){this.optimize();return}if(ee instanceof _.default){var H=ee.newlineIndex(ee.length(),!0);if(H>-1&&(ee=ee.split(H+1),ee===q)){this.optimize();return}}else if(q instanceof _.default){var G=q.newlineIndex(0);G>-1&&q.split(G+1)}var le=q.children.head instanceof b.default?null:q.children.head;ee.moveChildren(q,le),ee.remove()}this.optimize()}},{key:"enable",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",M)}},{key:"formatAt",value:function(M,$,Q,ie){this.whitelist!=null&&!this.whitelist[Q]||(a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"formatAt",this).call(this,M,$,Q,ie),this.optimize())}},{key:"insertAt",value:function(M,$,Q){if(!(Q!=null&&this.whitelist!=null&&!this.whitelist[$])){if(M>=this.length())if(Q==null||c.default.query($,c.default.Scope.BLOCK)==null){var ie=c.default.create(this.statics.defaultChild);this.appendChild(ie),Q==null&&$.endsWith(`
`)&&($=$.slice(0,-1)),ie.insertAt(0,$,Q)}else{var ee=c.default.create($,Q);this.appendChild(ee)}else a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"insertAt",this).call(this,M,$,Q);this.optimize()}}},{key:"insertBefore",value:function(M,$){if(M.statics.scope===c.default.Scope.INLINE_BLOT){var Q=c.default.create(this.statics.defaultChild);Q.appendChild(M),M=Q}a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"insertBefore",this).call(this,M,$)}},{key:"leaf",value:function(M){return this.path(M).pop()||[null,-1]}},{key:"line",value:function(M){return M===this.length()?this.line(M-1):this.descendant(T,M)}},{key:"lines",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,Q=function ie(ee,ue,Y){var J=[],q=Y;return ee.children.forEachAt(ue,Y,function(H,G,le){T(H)?J.push(H):H instanceof c.default.Container&&(J=J.concat(ie(H,G,q))),q-=le}),J};return Q(this,M,$)}},{key:"optimize",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"optimize",this).call(this,M,$),M.length>0&&this.emitter.emit(m.default.events.SCROLL_OPTIMIZE,M,$))}},{key:"path",value:function(M){return a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"path",this).call(this,M).slice(1)}},{key:"update",value:function(M){if(this.batch!==!0){var $=m.default.sources.USER;typeof M=="string"&&($=M),Array.isArray(M)||(M=this.observer.takeRecords()),M.length>0&&this.emitter.emit(m.default.events.SCROLL_BEFORE_UPDATE,$,M),a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"update",this).call(this,M.concat([])),M.length>0&&this.emitter.emit(m.default.events.SCROLL_UPDATE,$,M)}}}]),N}(c.default.Scroll);D.blotName="scroll",D.className="ql-editor",D.tagName="DIV",D.defaultChild="block",D.allowedChildren=[g.default,p.BlockEmbed,I.default],n.default=D},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},o=function(){function X(ne,te){var ae=[],de=!0,ye=!1,xe=void 0;try{for(var Oe=ne[Symbol.iterator](),Fe;!(de=(Fe=Oe.next()).done)&&(ae.push(Fe.value),!(te&&ae.length===te));de=!0);}catch(Be){ye=!0,xe=Be}finally{try{!de&&Oe.return&&Oe.return()}finally{if(ye)throw xe}}return ae}return function(ne,te){if(Array.isArray(ne))return ne;if(Symbol.iterator in Object(ne))return X(ne,te);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function X(ne,te){for(var ae=0;ae<te.length;ae++){var de=te[ae];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),Object.defineProperty(ne,de.key,de)}}return function(ne,te,ae){return te&&X(ne.prototype,te),ae&&X(ne,ae),ne}}(),u=r(21),c=P(u),d=r(11),m=P(d),p=r(3),g=P(p),w=r(2),b=P(w),A=r(20),_=P(A),C=r(0),I=P(C),S=r(5),R=P(S),L=r(10),k=P(L),T=r(9),D=P(T);function P(X){return X&&X.__esModule?X:{default:X}}function N(X,ne,te){return ne in X?Object.defineProperty(X,ne,{value:te,enumerable:!0,configurable:!0,writable:!0}):X[ne]=te,X}function F(X,ne){if(!(X instanceof ne))throw new TypeError("Cannot call a class as a function")}function M(X,ne){if(!X)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne&&(typeof ne=="object"||typeof ne=="function")?ne:X}function $(X,ne){if(typeof ne!="function"&&ne!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ne);X.prototype=Object.create(ne&&ne.prototype,{constructor:{value:X,enumerable:!1,writable:!0,configurable:!0}}),ne&&(Object.setPrototypeOf?Object.setPrototypeOf(X,ne):X.__proto__=ne)}var Q=(0,k.default)("quill:keyboard"),ie=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",ee=function(X){$(ne,X),a(ne,null,[{key:"match",value:function(ae,de){return de=se(de),["altKey","ctrlKey","metaKey","shiftKey"].some(function(ye){return!!de[ye]!==ae[ye]&&de[ye]!==null})?!1:de.key===(ae.which||ae.keyCode)}}]);function ne(te,ae){F(this,ne);var de=M(this,(ne.__proto__||Object.getPrototypeOf(ne)).call(this,te,ae));return de.bindings={},Object.keys(de.options.bindings).forEach(function(ye){ye==="list autofill"&&te.scroll.whitelist!=null&&!te.scroll.whitelist.list||de.options.bindings[ye]&&de.addBinding(de.options.bindings[ye])}),de.addBinding({key:ne.keys.ENTER,shiftKey:null},H),de.addBinding({key:ne.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(de.addBinding({key:ne.keys.BACKSPACE},{collapsed:!0},Y),de.addBinding({key:ne.keys.DELETE},{collapsed:!0},J)):(de.addBinding({key:ne.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},Y),de.addBinding({key:ne.keys.DELETE},{collapsed:!0,suffix:/^.?$/},J)),de.addBinding({key:ne.keys.BACKSPACE},{collapsed:!1},q),de.addBinding({key:ne.keys.DELETE},{collapsed:!1},q),de.addBinding({key:ne.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},Y),de.listen(),de}return a(ne,[{key:"addBinding",value:function(ae){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ye=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},xe=se(ae);if(xe==null||xe.key==null)return Q.warn("Attempted to add invalid keyboard binding",xe);typeof de=="function"&&(de={handler:de}),typeof ye=="function"&&(ye={handler:ye}),xe=(0,g.default)(xe,de,ye),this.bindings[xe.key]=this.bindings[xe.key]||[],this.bindings[xe.key].push(xe)}},{key:"listen",value:function(){var ae=this;this.quill.root.addEventListener("keydown",function(de){if(!de.defaultPrevented){var ye=de.which||de.keyCode,xe=(ae.bindings[ye]||[]).filter(function(Mt){return ne.match(de,Mt)});if(xe.length!==0){var Oe=ae.quill.getSelection();if(!(Oe==null||!ae.quill.hasFocus())){var Fe=ae.quill.getLine(Oe.index),Be=o(Fe,2),We=Be[0],mt=Be[1],fe=ae.quill.getLeaf(Oe.index),ve=o(fe,2),Ie=ve[0],Re=ve[1],be=Oe.length===0?[Ie,Re]:ae.quill.getLeaf(Oe.index+Oe.length),rt=o(be,2),qe=rt[0],Ze=rt[1],st=Ie instanceof I.default.Text?Ie.value().slice(0,Re):"",ft=qe instanceof I.default.Text?qe.value().slice(Ze):"",gt={collapsed:Oe.length===0,empty:Oe.length===0&&We.length()<=1,format:ae.quill.getFormat(Oe),offset:mt,prefix:st,suffix:ft},xi=xe.some(function(Mt){if(Mt.collapsed!=null&&Mt.collapsed!==gt.collapsed||Mt.empty!=null&&Mt.empty!==gt.empty||Mt.offset!=null&&Mt.offset!==gt.offset)return!1;if(Array.isArray(Mt.format)){if(Mt.format.every(function(an){return gt.format[an]==null}))return!1}else if(s(Mt.format)==="object"&&!Object.keys(Mt.format).every(function(an){return Mt.format[an]===!0?gt.format[an]!=null:Mt.format[an]===!1?gt.format[an]==null:(0,m.default)(Mt.format[an],gt.format[an])}))return!1;return Mt.prefix!=null&&!Mt.prefix.test(gt.prefix)||Mt.suffix!=null&&!Mt.suffix.test(gt.suffix)?!1:Mt.handler.call(ae,Oe,gt)!==!0});xi&&de.preventDefault()}}}})}}]),ne}(D.default);ee.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},ee.DEFAULTS={bindings:{bold:le("bold"),italic:le("italic"),underline:le("underline"),indent:{key:ee.keys.TAB,format:["blockquote","indent","list"],handler:function(ne,te){if(te.collapsed&&te.offset!==0)return!0;this.quill.format("indent","+1",R.default.sources.USER)}},outdent:{key:ee.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(ne,te){if(te.collapsed&&te.offset!==0)return!0;this.quill.format("indent","-1",R.default.sources.USER)}},"outdent backspace":{key:ee.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(ne,te){te.format.indent!=null?this.quill.format("indent","-1",R.default.sources.USER):te.format.list!=null&&this.quill.format("list",!1,R.default.sources.USER)}},"indent code-block":G(!0),"outdent code-block":G(!1),"remove tab":{key:ee.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(ne){this.quill.deleteText(ne.index-1,1,R.default.sources.USER)}},tab:{key:ee.keys.TAB,handler:function(ne){this.quill.history.cutoff();var te=new b.default().retain(ne.index).delete(ne.length).insert("	");this.quill.updateContents(te,R.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(ne.index+1,R.default.sources.SILENT)}},"list empty enter":{key:ee.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(ne,te){this.quill.format("list",!1,R.default.sources.USER),te.format.indent&&this.quill.format("indent",!1,R.default.sources.USER)}},"checklist enter":{key:ee.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(ne){var te=this.quill.getLine(ne.index),ae=o(te,2),de=ae[0],ye=ae[1],xe=(0,g.default)({},de.formats(),{list:"checked"}),Oe=new b.default().retain(ne.index).insert(`
`,xe).retain(de.length()-ye-1).retain(1,{list:"unchecked"});this.quill.updateContents(Oe,R.default.sources.USER),this.quill.setSelection(ne.index+1,R.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:ee.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(ne,te){var ae=this.quill.getLine(ne.index),de=o(ae,2),ye=de[0],xe=de[1],Oe=new b.default().retain(ne.index).insert(`
`,te.format).retain(ye.length()-xe-1).retain(1,{header:null});this.quill.updateContents(Oe,R.default.sources.USER),this.quill.setSelection(ne.index+1,R.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(ne,te){var ae=te.prefix.length,de=this.quill.getLine(ne.index),ye=o(de,2),xe=ye[0],Oe=ye[1];if(Oe>ae)return!0;var Fe=void 0;switch(te.prefix.trim()){case"[]":case"[ ]":Fe="unchecked";break;case"[x]":Fe="checked";break;case"-":case"*":Fe="bullet";break;default:Fe="ordered"}this.quill.insertText(ne.index," ",R.default.sources.USER),this.quill.history.cutoff();var Be=new b.default().retain(ne.index-Oe).delete(ae+1).retain(xe.length()-2-Oe).retain(1,{list:Fe});this.quill.updateContents(Be,R.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(ne.index-ae,R.default.sources.SILENT)}},"code exit":{key:ee.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(ne){var te=this.quill.getLine(ne.index),ae=o(te,2),de=ae[0],ye=ae[1],xe=new b.default().retain(ne.index+de.length()-ye-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(xe,R.default.sources.USER)}},"embed left":ue(ee.keys.LEFT,!1),"embed left shift":ue(ee.keys.LEFT,!0),"embed right":ue(ee.keys.RIGHT,!1),"embed right shift":ue(ee.keys.RIGHT,!0)}};function ue(X,ne){var te,ae=X===ee.keys.LEFT?"prefix":"suffix";return te={key:X,shiftKey:ne,altKey:null},N(te,ae,/^$/),N(te,"handler",function(ye){var xe=ye.index;X===ee.keys.RIGHT&&(xe+=ye.length+1);var Oe=this.quill.getLeaf(xe),Fe=o(Oe,1),Be=Fe[0];return Be instanceof I.default.Embed?(X===ee.keys.LEFT?ne?this.quill.setSelection(ye.index-1,ye.length+1,R.default.sources.USER):this.quill.setSelection(ye.index-1,R.default.sources.USER):ne?this.quill.setSelection(ye.index,ye.length+1,R.default.sources.USER):this.quill.setSelection(ye.index+ye.length+1,R.default.sources.USER),!1):!0}),te}function Y(X,ne){if(!(X.index===0||this.quill.getLength()<=1)){var te=this.quill.getLine(X.index),ae=o(te,1),de=ae[0],ye={};if(ne.offset===0){var xe=this.quill.getLine(X.index-1),Oe=o(xe,1),Fe=Oe[0];if(Fe!=null&&Fe.length()>1){var Be=de.formats(),We=this.quill.getFormat(X.index-1,1);ye=_.default.attributes.diff(Be,We)||{}}}var mt=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(ne.prefix)?2:1;this.quill.deleteText(X.index-mt,mt,R.default.sources.USER),Object.keys(ye).length>0&&this.quill.formatLine(X.index-mt,mt,ye,R.default.sources.USER),this.quill.focus()}}function J(X,ne){var te=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(ne.suffix)?2:1;if(!(X.index>=this.quill.getLength()-te)){var ae={},de=0,ye=this.quill.getLine(X.index),xe=o(ye,1),Oe=xe[0];if(ne.offset>=Oe.length()-1){var Fe=this.quill.getLine(X.index+1),Be=o(Fe,1),We=Be[0];if(We){var mt=Oe.formats(),fe=this.quill.getFormat(X.index,1);ae=_.default.attributes.diff(mt,fe)||{},de=We.length()}}this.quill.deleteText(X.index,te,R.default.sources.USER),Object.keys(ae).length>0&&this.quill.formatLine(X.index+de-1,te,ae,R.default.sources.USER)}}function q(X){var ne=this.quill.getLines(X),te={};if(ne.length>1){var ae=ne[0].formats(),de=ne[ne.length-1].formats();te=_.default.attributes.diff(de,ae)||{}}this.quill.deleteText(X,R.default.sources.USER),Object.keys(te).length>0&&this.quill.formatLine(X.index,1,te,R.default.sources.USER),this.quill.setSelection(X.index,R.default.sources.SILENT),this.quill.focus()}function H(X,ne){var te=this;X.length>0&&this.quill.scroll.deleteAt(X.index,X.length);var ae=Object.keys(ne.format).reduce(function(de,ye){return I.default.query(ye,I.default.Scope.BLOCK)&&!Array.isArray(ne.format[ye])&&(de[ye]=ne.format[ye]),de},{});this.quill.insertText(X.index,`
`,ae,R.default.sources.USER),this.quill.setSelection(X.index+1,R.default.sources.SILENT),this.quill.focus(),Object.keys(ne.format).forEach(function(de){ae[de]==null&&(Array.isArray(ne.format[de])||de!=="link"&&te.quill.format(de,ne.format[de],R.default.sources.USER))})}function G(X){return{key:ee.keys.TAB,shiftKey:!X,format:{"code-block":!0},handler:function(te){var ae=I.default.query("code-block"),de=te.index,ye=te.length,xe=this.quill.scroll.descendant(ae,de),Oe=o(xe,2),Fe=Oe[0],Be=Oe[1];if(Fe!=null){var We=this.quill.getIndex(Fe),mt=Fe.newlineIndex(Be,!0)+1,fe=Fe.newlineIndex(We+Be+ye),ve=Fe.domNode.textContent.slice(mt,fe).split(`
`);Be=0,ve.forEach(function(Ie,Re){X?(Fe.insertAt(mt+Be,ae.TAB),Be+=ae.TAB.length,Re===0?de+=ae.TAB.length:ye+=ae.TAB.length):Ie.startsWith(ae.TAB)&&(Fe.deleteAt(mt+Be,ae.TAB.length),Be-=ae.TAB.length,Re===0?de-=ae.TAB.length:ye-=ae.TAB.length),Be+=Ie.length+1}),this.quill.update(R.default.sources.USER),this.quill.setSelection(de,ye,R.default.sources.SILENT)}}}}function le(X){return{key:X[0].toUpperCase(),shortKey:!0,handler:function(te,ae){this.quill.format(X,!ae.format[X],R.default.sources.USER)}}}function se(X){if(typeof X=="string"||typeof X=="number")return se({key:X});if((typeof X>"u"?"undefined":s(X))==="object"&&(X=(0,c.default)(X,!1)),typeof X.key=="string")if(ee.keys[X.key.toUpperCase()]!=null)X.key=ee.keys[X.key.toUpperCase()];else if(X.key.length===1)X.key=X.key.toUpperCase().charCodeAt(0);else return null;return X.shortKey&&(X[ie]=X.shortKey,delete X.shortKey),X}n.default=ee,n.SHORTKEY=ie},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(C,I){var S=[],R=!0,L=!1,k=void 0;try{for(var T=C[Symbol.iterator](),D;!(R=(D=T.next()).done)&&(S.push(D.value),!(I&&S.length===I));R=!0);}catch(P){L=!0,k=P}finally{try{!R&&T.return&&T.return()}finally{if(L)throw k}}return S}return function(C,I){if(Array.isArray(C))return C;if(Symbol.iterator in Object(C))return _(C,I);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function _(C,I,S){C===null&&(C=Function.prototype);var R=Object.getOwnPropertyDescriptor(C,I);if(R===void 0){var L=Object.getPrototypeOf(C);return L===null?void 0:_(L,I,S)}else{if("value"in R)return R.value;var k=R.get;return k===void 0?void 0:k.call(S)}},a=function(){function _(C,I){for(var S=0;S<I.length;S++){var R=I[S];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(C,R.key,R)}}return function(C,I,S){return I&&_(C.prototype,I),S&&_(C,S),C}}(),u=r(0),c=p(u),d=r(7),m=p(d);function p(_){return _&&_.__esModule?_:{default:_}}function g(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}function w(_,C){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:_}function b(_,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);_.prototype=Object.create(C&&C.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(_,C):_.__proto__=C)}var A=function(_){b(C,_),a(C,null,[{key:"value",value:function(){}}]);function C(I,S){g(this,C);var R=w(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,I));return R.selection=S,R.textNode=document.createTextNode(C.CONTENTS),R.domNode.appendChild(R.textNode),R._length=0,R}return a(C,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(S,R){if(this._length!==0)return o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"format",this).call(this,S,R);for(var L=this,k=0;L!=null&&L.statics.scope!==c.default.Scope.BLOCK_BLOT;)k+=L.offset(L.parent),L=L.parent;L!=null&&(this._length=C.CONTENTS.length,L.optimize(),L.formatAt(k,C.CONTENTS.length,S,R),this._length=0)}},{key:"index",value:function(S,R){return S===this.textNode?0:o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"index",this).call(this,S,R)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var S=this.textNode,R=this.selection.getNativeRange(),L=void 0,k=void 0,T=void 0;if(R!=null&&R.start.node===S&&R.end.node===S){var D=[S,R.start.offset,R.end.offset];L=D[0],k=D[1],T=D[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==C.CONTENTS){var P=this.textNode.data.split(C.CONTENTS).join("");this.next instanceof m.default?(L=this.next.domNode,this.next.insertAt(0,P),this.textNode.data=C.CONTENTS):(this.textNode.data=P,this.parent.insertBefore(c.default.create(this.textNode),this),this.textNode=document.createTextNode(C.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),k!=null){var N=[k,T].map(function(M){return Math.max(0,Math.min(L.data.length,M-1))}),F=s(N,2);return k=F[0],T=F[1],{startNode:L,startOffset:k,endNode:L,endOffset:T}}}}},{key:"update",value:function(S,R){var L=this;if(S.some(function(T){return T.type==="characterData"&&T.target===L.textNode})){var k=this.restore();k&&(R.range=k)}}},{key:"value",value:function(){return""}}]),C}(c.default.Embed);A.blotName="cursor",A.className="ql-cursor",A.tagName="span",A.CONTENTS="\uFEFF",n.default=A},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(0),o=c(s),a=r(4),u=c(a);function c(w){return w&&w.__esModule?w:{default:w}}function d(w,b){if(!(w instanceof b))throw new TypeError("Cannot call a class as a function")}function m(w,b){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:w}function p(w,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);w.prototype=Object.create(b&&b.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(w,b):w.__proto__=b)}var g=function(w){p(b,w);function b(){return d(this,b),m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return b}(o.default.Container);g.allowedChildren=[u.default,a.BlockEmbed,g],n.default=g},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var s=function(){function A(_,C){for(var I=0;I<C.length;I++){var S=C[I];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(_,S.key,S)}}return function(_,C,I){return C&&A(_.prototype,C),I&&A(_,I),_}}(),o=function A(_,C,I){_===null&&(_=Function.prototype);var S=Object.getOwnPropertyDescriptor(_,C);if(S===void 0){var R=Object.getPrototypeOf(_);return R===null?void 0:A(R,C,I)}else{if("value"in S)return S.value;var L=S.get;return L===void 0?void 0:L.call(I)}},a=r(0),u=c(a);function c(A){return A&&A.__esModule?A:{default:A}}function d(A,_){if(!(A instanceof _))throw new TypeError("Cannot call a class as a function")}function m(A,_){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:A}function p(A,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);A.prototype=Object.create(_&&_.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(A,_):A.__proto__=_)}var g=function(A){p(_,A);function _(){return d(this,_),m(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return s(_,[{key:"value",value:function(I){var S=o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"value",this).call(this,I);return S.startsWith("rgb(")?(S=S.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+S.split(",").map(function(R){return("00"+parseInt(R).toString(16)).slice(-2)}).join("")):S}}]),_}(u.default.Attributor.Style),w=new u.default.Attributor.Class("color","ql-color",{scope:u.default.Scope.INLINE}),b=new g("color","color",{scope:u.default.Scope.INLINE});n.ColorAttributor=g,n.ColorClass=w,n.ColorStyle=b},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var s=function(){function b(A,_){for(var C=0;C<_.length;C++){var I=_[C];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(A,I.key,I)}}return function(A,_,C){return _&&b(A.prototype,_),C&&b(A,C),A}}(),o=function b(A,_,C){A===null&&(A=Function.prototype);var I=Object.getOwnPropertyDescriptor(A,_);if(I===void 0){var S=Object.getPrototypeOf(A);return S===null?void 0:b(S,_,C)}else{if("value"in I)return I.value;var R=I.get;return R===void 0?void 0:R.call(C)}},a=r(6),u=c(a);function c(b){return b&&b.__esModule?b:{default:b}}function d(b,A){if(!(b instanceof A))throw new TypeError("Cannot call a class as a function")}function m(b,A){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:b}function p(b,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);b.prototype=Object.create(A&&A.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(b,A):b.__proto__=A)}var g=function(b){p(A,b);function A(){return d(this,A),m(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return s(A,[{key:"format",value:function(C,I){if(C!==this.statics.blotName||!I)return o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"format",this).call(this,C,I);I=this.constructor.sanitize(I),this.domNode.setAttribute("href",I)}}],[{key:"create",value:function(C){var I=o(A.__proto__||Object.getPrototypeOf(A),"create",this).call(this,C);return C=this.sanitize(C),I.setAttribute("href",C),I.setAttribute("rel","noopener noreferrer"),I.setAttribute("target","_blank"),I}},{key:"formats",value:function(C){return C.getAttribute("href")}},{key:"sanitize",value:function(C){return w(C,this.PROTOCOL_WHITELIST)?C:this.SANITIZED_URL}}]),A}(u.default);g.blotName="link",g.tagName="A",g.SANITIZED_URL="about:blank",g.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function w(b,A){var _=document.createElement("a");_.href=b;var C=_.href.slice(0,_.href.indexOf(":"));return A.indexOf(C)>-1}n.default=g,n.sanitize=w},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},o=function(){function A(_,C){for(var I=0;I<C.length;I++){var S=C[I];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(_,S.key,S)}}return function(_,C,I){return C&&A(_.prototype,C),I&&A(_,I),_}}(),a=r(23),u=m(a),c=r(107),d=m(c);function m(A){return A&&A.__esModule?A:{default:A}}function p(A,_){if(!(A instanceof _))throw new TypeError("Cannot call a class as a function")}var g=0;function w(A,_){A.setAttribute(_,A.getAttribute(_)!=="true")}var b=function(){function A(_){var C=this;p(this,A),this.select=_,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){C.togglePicker()}),this.label.addEventListener("keydown",function(I){switch(I.keyCode){case u.default.keys.ENTER:C.togglePicker();break;case u.default.keys.ESCAPE:C.escape(),I.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(A,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),w(this.label,"aria-expanded"),w(this.options,"aria-hidden")}},{key:"buildItem",value:function(C){var I=this,S=document.createElement("span");return S.tabIndex="0",S.setAttribute("role","button"),S.classList.add("ql-picker-item"),C.hasAttribute("value")&&S.setAttribute("data-value",C.getAttribute("value")),C.textContent&&S.setAttribute("data-label",C.textContent),S.addEventListener("click",function(){I.selectItem(S,!0)}),S.addEventListener("keydown",function(R){switch(R.keyCode){case u.default.keys.ENTER:I.selectItem(S,!0),R.preventDefault();break;case u.default.keys.ESCAPE:I.escape(),R.preventDefault();break}}),S}},{key:"buildLabel",value:function(){var C=document.createElement("span");return C.classList.add("ql-picker-label"),C.innerHTML=d.default,C.tabIndex="0",C.setAttribute("role","button"),C.setAttribute("aria-expanded","false"),this.container.appendChild(C),C}},{key:"buildOptions",value:function(){var C=this,I=document.createElement("span");I.classList.add("ql-picker-options"),I.setAttribute("aria-hidden","true"),I.tabIndex="-1",I.id="ql-picker-options-"+g,g+=1,this.label.setAttribute("aria-controls",I.id),this.options=I,[].slice.call(this.select.options).forEach(function(S){var R=C.buildItem(S);I.appendChild(R),S.selected===!0&&C.selectItem(R)}),this.container.appendChild(I)}},{key:"buildPicker",value:function(){var C=this;[].slice.call(this.select.attributes).forEach(function(I){C.container.setAttribute(I.name,I.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var C=this;this.close(),setTimeout(function(){return C.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(C){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=this.container.querySelector(".ql-selected");if(C!==S&&(S!=null&&S.classList.remove("ql-selected"),C!=null&&(C.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(C.parentNode.children,C),C.hasAttribute("data-value")?this.label.setAttribute("data-value",C.getAttribute("data-value")):this.label.removeAttribute("data-value"),C.hasAttribute("data-label")?this.label.setAttribute("data-label",C.getAttribute("data-label")):this.label.removeAttribute("data-label"),I))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":s(Event))==="object"){var R=document.createEvent("Event");R.initEvent("change",!0,!0),this.select.dispatchEvent(R)}this.close()}}},{key:"update",value:function(){var C=void 0;if(this.select.selectedIndex>-1){var I=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];C=this.select.options[this.select.selectedIndex],this.selectItem(I)}else this.selectItem(null);var S=C!=null&&C!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",S)}}]),A}();n.default=b},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(0),o=Q(s),a=r(5),u=Q(a),c=r(4),d=Q(c),m=r(16),p=Q(m),g=r(25),w=Q(g),b=r(24),A=Q(b),_=r(35),C=Q(_),I=r(6),S=Q(I),R=r(22),L=Q(R),k=r(7),T=Q(k),D=r(55),P=Q(D),N=r(42),F=Q(N),M=r(23),$=Q(M);function Q(ie){return ie&&ie.__esModule?ie:{default:ie}}u.default.register({"blots/block":d.default,"blots/block/embed":c.BlockEmbed,"blots/break":p.default,"blots/container":w.default,"blots/cursor":A.default,"blots/embed":C.default,"blots/inline":S.default,"blots/scroll":L.default,"blots/text":T.default,"modules/clipboard":P.default,"modules/history":F.default,"modules/keyboard":$.default}),o.default.register(d.default,p.default,A.default,S.default,L.default,T.default),n.default=u.default},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(1),o=function(){function a(u){this.domNode=u,this.domNode[s.DATA_KEY]={blot:this}}return Object.defineProperty(a.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),a.create=function(u){if(this.tagName==null)throw new s.ParchmentError("Blot definition missing tagName");var c;return Array.isArray(this.tagName)?(typeof u=="string"&&(u=u.toUpperCase(),parseInt(u).toString()===u&&(u=parseInt(u))),typeof u=="number"?c=document.createElement(this.tagName[u-1]):this.tagName.indexOf(u)>-1?c=document.createElement(u):c=document.createElement(this.tagName[0])):c=document.createElement(this.tagName),this.className&&c.classList.add(this.className),c},a.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},a.prototype.clone=function(){var u=this.domNode.cloneNode(!1);return s.create(u)},a.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[s.DATA_KEY]},a.prototype.deleteAt=function(u,c){var d=this.isolate(u,c);d.remove()},a.prototype.formatAt=function(u,c,d,m){var p=this.isolate(u,c);if(s.query(d,s.Scope.BLOT)!=null&&m)p.wrap(d,m);else if(s.query(d,s.Scope.ATTRIBUTE)!=null){var g=s.create(this.statics.scope);p.wrap(g),g.format(d,m)}},a.prototype.insertAt=function(u,c,d){var m=d==null?s.create("text",c):s.create(c,d),p=this.split(u);this.parent.insertBefore(m,p)},a.prototype.insertInto=function(u,c){c===void 0&&(c=null),this.parent!=null&&this.parent.children.remove(this);var d=null;u.children.insertBefore(this,c),c!=null&&(d=c.domNode),(this.domNode.parentNode!=u.domNode||this.domNode.nextSibling!=d)&&u.domNode.insertBefore(this.domNode,d),this.parent=u,this.attach()},a.prototype.isolate=function(u,c){var d=this.split(u);return d.split(c),d},a.prototype.length=function(){return 1},a.prototype.offset=function(u){return u===void 0&&(u=this.parent),this.parent==null||this==u?0:this.parent.children.offset(this)+this.parent.offset(u)},a.prototype.optimize=function(u){this.domNode[s.DATA_KEY]!=null&&delete this.domNode[s.DATA_KEY].mutations},a.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},a.prototype.replace=function(u){u.parent!=null&&(u.parent.insertBefore(this,u.next),u.remove())},a.prototype.replaceWith=function(u,c){var d=typeof u=="string"?s.create(u,c):u;return d.replace(this),d},a.prototype.split=function(u,c){return u===0?this:this.next},a.prototype.update=function(u,c){},a.prototype.wrap=function(u,c){var d=typeof u=="string"?s.create(u,c):u;return this.parent!=null&&this.parent.insertBefore(d,this.next),d.appendChild(this),d},a.blotName="abstract",a}();n.default=o},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(12),o=r(32),a=r(33),u=r(1),c=function(){function d(m){this.attributes={},this.domNode=m,this.build()}return d.prototype.attribute=function(m,p){p?m.add(this.domNode,p)&&(m.value(this.domNode)!=null?this.attributes[m.attrName]=m:delete this.attributes[m.attrName]):(m.remove(this.domNode),delete this.attributes[m.attrName])},d.prototype.build=function(){var m=this;this.attributes={};var p=s.default.keys(this.domNode),g=o.default.keys(this.domNode),w=a.default.keys(this.domNode);p.concat(g).concat(w).forEach(function(b){var A=u.query(b,u.Scope.ATTRIBUTE);A instanceof s.default&&(m.attributes[A.attrName]=A)})},d.prototype.copy=function(m){var p=this;Object.keys(this.attributes).forEach(function(g){var w=p.attributes[g].value(p.domNode);m.format(g,w)})},d.prototype.move=function(m){var p=this;this.copy(m),Object.keys(this.attributes).forEach(function(g){p.attributes[g].remove(p.domNode)}),this.attributes={}},d.prototype.values=function(){var m=this;return Object.keys(this.attributes).reduce(function(p,g){return p[g]=m.attributes[g].value(m.domNode),p},{})},d}();n.default=c},function(t,n,r){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,m){d.__proto__=m}||function(d,m){for(var p in m)m.hasOwnProperty(p)&&(d[p]=m[p])};return function(d,m){c(d,m);function p(){this.constructor=d}d.prototype=m===null?Object.create(m):(p.prototype=m.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=r(12);function a(c,d){var m=c.getAttribute("class")||"";return m.split(/\s+/).filter(function(p){return p.indexOf(d+"-")===0})}var u=function(c){s(d,c);function d(){return c!==null&&c.apply(this,arguments)||this}return d.keys=function(m){return(m.getAttribute("class")||"").split(/\s+/).map(function(p){return p.split("-").slice(0,-1).join("-")})},d.prototype.add=function(m,p){return this.canAdd(m,p)?(this.remove(m),m.classList.add(this.keyName+"-"+p),!0):!1},d.prototype.remove=function(m){var p=a(m,this.keyName);p.forEach(function(g){m.classList.remove(g)}),m.classList.length===0&&m.removeAttribute("class")},d.prototype.value=function(m){var p=a(m,this.keyName)[0]||"",g=p.slice(this.keyName.length+1);return this.canAdd(m,g)?g:""},d}(o.default);n.default=u},function(t,n,r){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,m){d.__proto__=m}||function(d,m){for(var p in m)m.hasOwnProperty(p)&&(d[p]=m[p])};return function(d,m){c(d,m);function p(){this.constructor=d}d.prototype=m===null?Object.create(m):(p.prototype=m.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=r(12);function a(c){var d=c.split("-"),m=d.slice(1).map(function(p){return p[0].toUpperCase()+p.slice(1)}).join("");return d[0]+m}var u=function(c){s(d,c);function d(){return c!==null&&c.apply(this,arguments)||this}return d.keys=function(m){return(m.getAttribute("style")||"").split(";").map(function(p){var g=p.split(":");return g[0].trim()})},d.prototype.add=function(m,p){return this.canAdd(m,p)?(m.style[a(this.keyName)]=p,!0):!1},d.prototype.remove=function(m){m.style[a(this.keyName)]="",m.getAttribute("style")||m.removeAttribute("style")},d.prototype.value=function(m){var p=m.style[a(this.keyName)];return this.canAdd(m,p)?p:""},d}(o.default);n.default=u},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function u(c,d){for(var m=0;m<d.length;m++){var p=d[m];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}return function(c,d,m){return d&&u(c.prototype,d),m&&u(c,m),c}}();function o(u,c){if(!(u instanceof c))throw new TypeError("Cannot call a class as a function")}var a=function(){function u(c,d){o(this,u),this.quill=c,this.options=d,this.modules={}}return s(u,[{key:"init",value:function(){var d=this;Object.keys(this.options.modules).forEach(function(m){d.modules[m]==null&&d.addModule(m)})}},{key:"addModule",value:function(d){var m=this.quill.constructor.import("modules/"+d);return this.modules[d]=new m(this.quill,this.options.modules[d]||{}),this.modules[d]}}]),u}();a.DEFAULTS={modules:{}},a.themes={default:a},n.default=a},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(C,I){for(var S=0;S<I.length;S++){var R=I[S];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(C,R.key,R)}}return function(C,I,S){return I&&_(C.prototype,I),S&&_(C,S),C}}(),o=function _(C,I,S){C===null&&(C=Function.prototype);var R=Object.getOwnPropertyDescriptor(C,I);if(R===void 0){var L=Object.getPrototypeOf(C);return L===null?void 0:_(L,I,S)}else{if("value"in R)return R.value;var k=R.get;return k===void 0?void 0:k.call(S)}},a=r(0),u=m(a),c=r(7),d=m(c);function m(_){return _&&_.__esModule?_:{default:_}}function p(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}function g(_,C){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:_}function w(_,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);_.prototype=Object.create(C&&C.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(_,C):_.__proto__=C)}var b="\uFEFF",A=function(_){w(C,_);function C(I){p(this,C);var S=g(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,I));return S.contentNode=document.createElement("span"),S.contentNode.setAttribute("contenteditable",!1),[].slice.call(S.domNode.childNodes).forEach(function(R){S.contentNode.appendChild(R)}),S.leftGuard=document.createTextNode(b),S.rightGuard=document.createTextNode(b),S.domNode.appendChild(S.leftGuard),S.domNode.appendChild(S.contentNode),S.domNode.appendChild(S.rightGuard),S}return s(C,[{key:"index",value:function(S,R){return S===this.leftGuard?0:S===this.rightGuard?1:o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"index",this).call(this,S,R)}},{key:"restore",value:function(S){var R=void 0,L=void 0,k=S.data.split(b).join("");if(S===this.leftGuard)if(this.prev instanceof d.default){var T=this.prev.length();this.prev.insertAt(T,k),R={startNode:this.prev.domNode,startOffset:T+k.length}}else L=document.createTextNode(k),this.parent.insertBefore(u.default.create(L),this),R={startNode:L,startOffset:k.length};else S===this.rightGuard&&(this.next instanceof d.default?(this.next.insertAt(0,k),R={startNode:this.next.domNode,startOffset:k.length}):(L=document.createTextNode(k),this.parent.insertBefore(u.default.create(L),this.next),R={startNode:L,startOffset:k.length}));return S.data=b,R}},{key:"update",value:function(S,R){var L=this;S.forEach(function(k){if(k.type==="characterData"&&(k.target===L.leftGuard||k.target===L.rightGuard)){var T=L.restore(k.target);T&&(R.range=T)}})}}]),C}(u.default.Embed);n.default=A},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var s=r(0),o=a(s);function a(p){return p&&p.__esModule?p:{default:p}}var u={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},c=new o.default.Attributor.Attribute("align","align",u),d=new o.default.Attributor.Class("align","ql-align",u),m=new o.default.Attributor.Style("align","text-align",u);n.AlignAttribute=c,n.AlignClass=d,n.AlignStyle=m},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var s=r(0),o=u(s),a=r(26);function u(m){return m&&m.__esModule?m:{default:m}}var c=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),d=new a.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=c,n.BackgroundStyle=d},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var s=r(0),o=a(s);function a(p){return p&&p.__esModule?p:{default:p}}var u={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},c=new o.default.Attributor.Attribute("direction","dir",u),d=new o.default.Attributor.Class("direction","ql-direction",u),m=new o.default.Attributor.Style("direction","direction",u);n.DirectionAttribute=c,n.DirectionClass=d,n.DirectionStyle=m},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var s=function(){function _(C,I){for(var S=0;S<I.length;S++){var R=I[S];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(C,R.key,R)}}return function(C,I,S){return I&&_(C.prototype,I),S&&_(C,S),C}}(),o=function _(C,I,S){C===null&&(C=Function.prototype);var R=Object.getOwnPropertyDescriptor(C,I);if(R===void 0){var L=Object.getPrototypeOf(C);return L===null?void 0:_(L,I,S)}else{if("value"in R)return R.value;var k=R.get;return k===void 0?void 0:k.call(S)}},a=r(0),u=c(a);function c(_){return _&&_.__esModule?_:{default:_}}function d(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}function m(_,C){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:_}function p(_,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);_.prototype=Object.create(C&&C.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(_,C):_.__proto__=C)}var g={scope:u.default.Scope.INLINE,whitelist:["serif","monospace"]},w=new u.default.Attributor.Class("font","ql-font",g),b=function(_){p(C,_);function C(){return d(this,C),m(this,(C.__proto__||Object.getPrototypeOf(C)).apply(this,arguments))}return s(C,[{key:"value",value:function(S){return o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"value",this).call(this,S).replace(/["']/g,"")}}]),C}(u.default.Attributor.Style),A=new b("font","font-family",g);n.FontStyle=A,n.FontClass=w},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var s=r(0),o=a(s);function a(d){return d&&d.__esModule?d:{default:d}}var u=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),c=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=u,n.SizeStyle=c},function(t,n,r){t.exports={align:{"":r(76),center:r(77),right:r(78),justify:r(79)},background:r(80),blockquote:r(81),bold:r(82),clean:r(83),code:r(58),"code-block":r(58),color:r(84),direction:{"":r(85),rtl:r(86)},float:{center:r(87),full:r(88),left:r(89),right:r(90)},formula:r(91),header:{1:r(92),2:r(93)},italic:r(94),image:r(95),indent:{"+1":r(96),"-1":r(97)},link:r(98),list:{ordered:r(99),bullet:r(100),check:r(101)},script:{sub:r(102),super:r(103)},strike:r(104),underline:r(105),video:r(106)}},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var s=function(){function I(S,R){for(var L=0;L<R.length;L++){var k=R[L];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(S,k.key,k)}}return function(S,R,L){return R&&I(S.prototype,R),L&&I(S,L),S}}(),o=r(0),a=p(o),u=r(5),c=p(u),d=r(9),m=p(d);function p(I){return I&&I.__esModule?I:{default:I}}function g(I,S){if(!(I instanceof S))throw new TypeError("Cannot call a class as a function")}function w(I,S){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:I}function b(I,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);I.prototype=Object.create(S&&S.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(I,S):I.__proto__=S)}var A=function(I){b(S,I);function S(R,L){g(this,S);var k=w(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,R,L));return k.lastRecorded=0,k.ignoreChange=!1,k.clear(),k.quill.on(c.default.events.EDITOR_CHANGE,function(T,D,P,N){T!==c.default.events.TEXT_CHANGE||k.ignoreChange||(!k.options.userOnly||N===c.default.sources.USER?k.record(D,P):k.transform(D))}),k.quill.keyboard.addBinding({key:"Z",shortKey:!0},k.undo.bind(k)),k.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},k.redo.bind(k)),/Win/i.test(navigator.platform)&&k.quill.keyboard.addBinding({key:"Y",shortKey:!0},k.redo.bind(k)),k}return s(S,[{key:"change",value:function(L,k){if(this.stack[L].length!==0){var T=this.stack[L].pop();this.stack[k].push(T),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(T[L],c.default.sources.USER),this.ignoreChange=!1;var D=C(T[L]);this.quill.setSelection(D)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(L,k){if(L.ops.length!==0){this.stack.redo=[];var T=this.quill.getContents().diff(k),D=Date.now();if(this.lastRecorded+this.options.delay>D&&this.stack.undo.length>0){var P=this.stack.undo.pop();T=T.compose(P.undo),L=P.redo.compose(L)}else this.lastRecorded=D;this.stack.undo.push({redo:L,undo:T}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(L){this.stack.undo.forEach(function(k){k.undo=L.transform(k.undo,!0),k.redo=L.transform(k.redo,!0)}),this.stack.redo.forEach(function(k){k.undo=L.transform(k.undo,!0),k.redo=L.transform(k.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),S}(m.default);A.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function _(I){var S=I.ops[I.ops.length-1];return S==null?!1:S.insert!=null?typeof S.insert=="string"&&S.insert.endsWith(`
`):S.attributes!=null?Object.keys(S.attributes).some(function(R){return a.default.query(R,a.default.Scope.BLOCK)!=null}):!1}function C(I){var S=I.reduce(function(L,k){return L+=k.delete||0,L},0),R=I.length()-S;return _(I)&&(R-=1),R}n.default=A,n.getLastChangeIndex=C},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var s=function(){function H(G,le){for(var se=0;se<le.length;se++){var X=le[se];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(G,X.key,X)}}return function(G,le,se){return le&&H(G.prototype,le),se&&H(G,se),G}}(),o=function H(G,le,se){G===null&&(G=Function.prototype);var X=Object.getOwnPropertyDescriptor(G,le);if(X===void 0){var ne=Object.getPrototypeOf(G);return ne===null?void 0:H(ne,le,se)}else{if("value"in X)return X.value;var te=X.get;return te===void 0?void 0:te.call(se)}},a=r(3),u=D(a),c=r(2),d=D(c),m=r(8),p=D(m),g=r(23),w=D(g),b=r(34),A=D(b),_=r(59),C=D(_),I=r(60),S=D(I),R=r(28),L=D(R),k=r(61),T=D(k);function D(H){return H&&H.__esModule?H:{default:H}}function P(H,G){if(!(H instanceof G))throw new TypeError("Cannot call a class as a function")}function N(H,G){if(!H)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return G&&(typeof G=="object"||typeof G=="function")?G:H}function F(H,G){if(typeof G!="function"&&G!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof G);H.prototype=Object.create(G&&G.prototype,{constructor:{value:H,enumerable:!1,writable:!0,configurable:!0}}),G&&(Object.setPrototypeOf?Object.setPrototypeOf(H,G):H.__proto__=G)}var M=[!1,"center","right","justify"],$=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],Q=[!1,"serif","monospace"],ie=["1","2","3",!1],ee=["small",!1,"large","huge"],ue=function(H){F(G,H);function G(le,se){P(this,G);var X=N(this,(G.__proto__||Object.getPrototypeOf(G)).call(this,le,se)),ne=function te(ae){if(!document.body.contains(le.root))return document.body.removeEventListener("click",te);X.tooltip!=null&&!X.tooltip.root.contains(ae.target)&&document.activeElement!==X.tooltip.textbox&&!X.quill.hasFocus()&&X.tooltip.hide(),X.pickers!=null&&X.pickers.forEach(function(de){de.container.contains(ae.target)||de.close()})};return le.emitter.listenDOM("click",document.body,ne),X}return s(G,[{key:"addModule",value:function(se){var X=o(G.prototype.__proto__||Object.getPrototypeOf(G.prototype),"addModule",this).call(this,se);return se==="toolbar"&&this.extendToolbar(X),X}},{key:"buildButtons",value:function(se,X){se.forEach(function(ne){var te=ne.getAttribute("class")||"";te.split(/\s+/).forEach(function(ae){if(ae.startsWith("ql-")&&(ae=ae.slice(3),X[ae]!=null))if(ae==="direction")ne.innerHTML=X[ae][""]+X[ae].rtl;else if(typeof X[ae]=="string")ne.innerHTML=X[ae];else{var de=ne.value||"";de!=null&&X[ae][de]&&(ne.innerHTML=X[ae][de])}})})}},{key:"buildPickers",value:function(se,X){var ne=this;this.pickers=se.map(function(ae){if(ae.classList.contains("ql-align"))return ae.querySelector("option")==null&&q(ae,M),new S.default(ae,X.align);if(ae.classList.contains("ql-background")||ae.classList.contains("ql-color")){var de=ae.classList.contains("ql-background")?"background":"color";return ae.querySelector("option")==null&&q(ae,$,de==="background"?"#ffffff":"#000000"),new C.default(ae,X[de])}else return ae.querySelector("option")==null&&(ae.classList.contains("ql-font")?q(ae,Q):ae.classList.contains("ql-header")?q(ae,ie):ae.classList.contains("ql-size")&&q(ae,ee)),new L.default(ae)});var te=function(){ne.pickers.forEach(function(de){de.update()})};this.quill.on(p.default.events.EDITOR_CHANGE,te)}}]),G}(A.default);ue.DEFAULTS=(0,u.default)(!0,{},A.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var G=this,le=this.container.querySelector("input.ql-image[type=file]");le==null&&(le=document.createElement("input"),le.setAttribute("type","file"),le.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),le.classList.add("ql-image"),le.addEventListener("change",function(){if(le.files!=null&&le.files[0]!=null){var se=new FileReader;se.onload=function(X){var ne=G.quill.getSelection(!0);G.quill.updateContents(new d.default().retain(ne.index).delete(ne.length).insert({image:X.target.result}),p.default.sources.USER),G.quill.setSelection(ne.index+1,p.default.sources.SILENT),le.value=""},se.readAsDataURL(le.files[0])}}),this.container.appendChild(le)),le.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var Y=function(H){F(G,H);function G(le,se){P(this,G);var X=N(this,(G.__proto__||Object.getPrototypeOf(G)).call(this,le,se));return X.textbox=X.root.querySelector('input[type="text"]'),X.listen(),X}return s(G,[{key:"listen",value:function(){var se=this;this.textbox.addEventListener("keydown",function(X){w.default.match(X,"enter")?(se.save(),X.preventDefault()):w.default.match(X,"escape")&&(se.cancel(),X.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),X!=null?this.textbox.value=X:se!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+se)||""),this.root.setAttribute("data-mode",se)}},{key:"restoreFocus",value:function(){var se=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=se}},{key:"save",value:function(){var se=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var X=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",se,p.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",se,p.default.sources.USER)),this.quill.root.scrollTop=X;break}case"video":se=J(se);case"formula":{if(!se)break;var ne=this.quill.getSelection(!0);if(ne!=null){var te=ne.index+ne.length;this.quill.insertEmbed(te,this.root.getAttribute("data-mode"),se,p.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(te+1," ",p.default.sources.USER),this.quill.setSelection(te+2,p.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),G}(T.default);function J(H){var G=H.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||H.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return G?(G[1]||"https")+"://www.youtube.com/embed/"+G[2]+"?showinfo=0":(G=H.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(G[1]||"https")+"://player.vimeo.com/video/"+G[2]+"/":H}function q(H,G){var le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;G.forEach(function(se){var X=document.createElement("option");se===le?X.setAttribute("selected","selected"):X.setAttribute("value",se),H.appendChild(X)})}n.BaseTooltip=Y,n.default=ue},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];this.insertBefore(a[0],null),a.length>1&&this.append.apply(this,a.slice(1))},o.prototype.contains=function(a){for(var u,c=this.iterator();u=c();)if(u===a)return!0;return!1},o.prototype.insertBefore=function(a,u){a&&(a.next=u,u!=null?(a.prev=u.prev,u.prev!=null&&(u.prev.next=a),u.prev=a,u===this.head&&(this.head=a)):this.tail!=null?(this.tail.next=a,a.prev=this.tail,this.tail=a):(a.prev=null,this.head=this.tail=a),this.length+=1)},o.prototype.offset=function(a){for(var u=0,c=this.head;c!=null;){if(c===a)return u;u+=c.length(),c=c.next}return-1},o.prototype.remove=function(a){this.contains(a)&&(a.prev!=null&&(a.prev.next=a.next),a.next!=null&&(a.next.prev=a.prev),a===this.head&&(this.head=a.next),a===this.tail&&(this.tail=a.prev),this.length-=1)},o.prototype.iterator=function(a){return a===void 0&&(a=this.head),function(){var u=a;return a!=null&&(a=a.next),u}},o.prototype.find=function(a,u){u===void 0&&(u=!1);for(var c,d=this.iterator();c=d();){var m=c.length();if(a<m||u&&a===m&&(c.next==null||c.next.length()!==0))return[c,a];a-=m}return[null,0]},o.prototype.forEach=function(a){for(var u,c=this.iterator();u=c();)a(u)},o.prototype.forEachAt=function(a,u,c){if(!(u<=0))for(var d=this.find(a),m=d[0],p=d[1],g,w=a-p,b=this.iterator(m);(g=b())&&w<a+u;){var A=g.length();a>w?c(g,a-w,Math.min(u,w+A-a)):c(g,0,Math.min(A,a+u-w)),w+=A}},o.prototype.map=function(a){return this.reduce(function(u,c){return u.push(a(c)),u},[])},o.prototype.reduce=function(a,u){for(var c,d=this.iterator();c=d();)u=a(u,c);return u},o}();n.default=s},function(t,n,r){var s=this&&this.__extends||function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var w in g)g.hasOwnProperty(w)&&(p[w]=g[w])};return function(p,g){m(p,g);function w(){this.constructor=p}p.prototype=g===null?Object.create(g):(w.prototype=g.prototype,new w)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=r(17),a=r(1),u={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},c=100,d=function(m){s(p,m);function p(g){var w=m.call(this,g)||this;return w.scroll=w,w.observer=new MutationObserver(function(b){w.update(b)}),w.observer.observe(w.domNode,u),w.attach(),w}return p.prototype.detach=function(){m.prototype.detach.call(this),this.observer.disconnect()},p.prototype.deleteAt=function(g,w){this.update(),g===0&&w===this.length()?this.children.forEach(function(b){b.remove()}):m.prototype.deleteAt.call(this,g,w)},p.prototype.formatAt=function(g,w,b,A){this.update(),m.prototype.formatAt.call(this,g,w,b,A)},p.prototype.insertAt=function(g,w,b){this.update(),m.prototype.insertAt.call(this,g,w,b)},p.prototype.optimize=function(g,w){var b=this;g===void 0&&(g=[]),w===void 0&&(w={}),m.prototype.optimize.call(this,w);for(var A=[].slice.call(this.observer.takeRecords());A.length>0;)g.push(A.pop());for(var _=function(R,L){L===void 0&&(L=!0),!(R==null||R===b)&&R.domNode.parentNode!=null&&(R.domNode[a.DATA_KEY].mutations==null&&(R.domNode[a.DATA_KEY].mutations=[]),L&&_(R.parent))},C=function(R){R.domNode[a.DATA_KEY]==null||R.domNode[a.DATA_KEY].mutations==null||(R instanceof o.default&&R.children.forEach(C),R.optimize(w))},I=g,S=0;I.length>0;S+=1){if(S>=c)throw new Error("[Parchment] Maximum optimize iterations reached");for(I.forEach(function(R){var L=a.find(R.target,!0);L!=null&&(L.domNode===R.target&&(R.type==="childList"?(_(a.find(R.previousSibling,!1)),[].forEach.call(R.addedNodes,function(k){var T=a.find(k,!1);_(T,!1),T instanceof o.default&&T.children.forEach(function(D){_(D,!1)})})):R.type==="attributes"&&_(L.prev)),_(L))}),this.children.forEach(C),I=[].slice.call(this.observer.takeRecords()),A=I.slice();A.length>0;)g.push(A.pop())}},p.prototype.update=function(g,w){var b=this;w===void 0&&(w={}),g=g||this.observer.takeRecords(),g.map(function(A){var _=a.find(A.target,!0);return _==null?null:_.domNode[a.DATA_KEY].mutations==null?(_.domNode[a.DATA_KEY].mutations=[A],_):(_.domNode[a.DATA_KEY].mutations.push(A),null)}).forEach(function(A){A==null||A===b||A.domNode[a.DATA_KEY]==null||A.update(A.domNode[a.DATA_KEY].mutations||[],w)}),this.domNode[a.DATA_KEY].mutations!=null&&m.prototype.update.call(this,this.domNode[a.DATA_KEY].mutations,w),this.optimize(g,w)},p.blotName="scroll",p.defaultChild="block",p.scope=a.Scope.BLOCK_BLOT,p.tagName="DIV",p}(o.default);n.default=d},function(t,n,r){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,p){m.__proto__=p}||function(m,p){for(var g in p)p.hasOwnProperty(g)&&(m[g]=p[g])};return function(m,p){d(m,p);function g(){this.constructor=m}m.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=r(18),a=r(1);function u(d,m){if(Object.keys(d).length!==Object.keys(m).length)return!1;for(var p in d)if(d[p]!==m[p])return!1;return!0}var c=function(d){s(m,d);function m(){return d!==null&&d.apply(this,arguments)||this}return m.formats=function(p){if(p.tagName!==m.tagName)return d.formats.call(this,p)},m.prototype.format=function(p,g){var w=this;p===this.statics.blotName&&!g?(this.children.forEach(function(b){b instanceof o.default||(b=b.wrap(m.blotName,!0)),w.attributes.copy(b)}),this.unwrap()):d.prototype.format.call(this,p,g)},m.prototype.formatAt=function(p,g,w,b){if(this.formats()[w]!=null||a.query(w,a.Scope.ATTRIBUTE)){var A=this.isolate(p,g);A.format(w,b)}else d.prototype.formatAt.call(this,p,g,w,b)},m.prototype.optimize=function(p){d.prototype.optimize.call(this,p);var g=this.formats();if(Object.keys(g).length===0)return this.unwrap();var w=this.next;w instanceof m&&w.prev===this&&u(g,w.formats())&&(w.moveChildren(this),w.remove())},m.blotName="inline",m.scope=a.Scope.INLINE_BLOT,m.tagName="SPAN",m}(o.default);n.default=c},function(t,n,r){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,m){d.__proto__=m}||function(d,m){for(var p in m)m.hasOwnProperty(p)&&(d[p]=m[p])};return function(d,m){c(d,m);function p(){this.constructor=d}d.prototype=m===null?Object.create(m):(p.prototype=m.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=r(18),a=r(1),u=function(c){s(d,c);function d(){return c!==null&&c.apply(this,arguments)||this}return d.formats=function(m){var p=a.query(d.blotName).tagName;if(m.tagName!==p)return c.formats.call(this,m)},d.prototype.format=function(m,p){a.query(m,a.Scope.BLOCK)!=null&&(m===this.statics.blotName&&!p?this.replaceWith(d.blotName):c.prototype.format.call(this,m,p))},d.prototype.formatAt=function(m,p,g,w){a.query(g,a.Scope.BLOCK)!=null?this.format(g,w):c.prototype.formatAt.call(this,m,p,g,w)},d.prototype.insertAt=function(m,p,g){if(g==null||a.query(p,a.Scope.INLINE)!=null)c.prototype.insertAt.call(this,m,p,g);else{var w=this.split(m),b=a.create(p,g);w.parent.insertBefore(b,w)}},d.prototype.update=function(m,p){navigator.userAgent.match(/Trident/)?this.build():c.prototype.update.call(this,m,p)},d.blotName="block",d.scope=a.Scope.BLOCK_BLOT,d.tagName="P",d}(o.default);n.default=u},function(t,n,r){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var m in d)d.hasOwnProperty(m)&&(c[m]=d[m])};return function(c,d){u(c,d);function m(){this.constructor=c}c.prototype=d===null?Object.create(d):(m.prototype=d.prototype,new m)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=r(19),a=function(u){s(c,u);function c(){return u!==null&&u.apply(this,arguments)||this}return c.formats=function(d){},c.prototype.format=function(d,m){u.prototype.formatAt.call(this,0,this.length(),d,m)},c.prototype.formatAt=function(d,m,p,g){d===0&&m===this.length()?this.format(p,g):u.prototype.formatAt.call(this,d,m,p,g)},c.prototype.formats=function(){return this.statics.formats(this.domNode)},c}(o.default);n.default=a},function(t,n,r){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,m){d.__proto__=m}||function(d,m){for(var p in m)m.hasOwnProperty(p)&&(d[p]=m[p])};return function(d,m){c(d,m);function p(){this.constructor=d}d.prototype=m===null?Object.create(m):(p.prototype=m.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=r(19),a=r(1),u=function(c){s(d,c);function d(m){var p=c.call(this,m)||this;return p.text=p.statics.value(p.domNode),p}return d.create=function(m){return document.createTextNode(m)},d.value=function(m){var p=m.data;return p.normalize&&(p=p.normalize()),p},d.prototype.deleteAt=function(m,p){this.domNode.data=this.text=this.text.slice(0,m)+this.text.slice(m+p)},d.prototype.index=function(m,p){return this.domNode===m?p:-1},d.prototype.insertAt=function(m,p,g){g==null?(this.text=this.text.slice(0,m)+p+this.text.slice(m),this.domNode.data=this.text):c.prototype.insertAt.call(this,m,p,g)},d.prototype.length=function(){return this.text.length},d.prototype.optimize=function(m){c.prototype.optimize.call(this,m),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof d&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},d.prototype.position=function(m,p){return[this.domNode,m]},d.prototype.split=function(m,p){if(p===void 0&&(p=!1),!p){if(m===0)return this;if(m===this.length())return this.next}var g=a.create(this.domNode.splitText(m));return this.parent.insertBefore(g,this.next),this.text=this.statics.value(this.domNode),g},d.prototype.update=function(m,p){var g=this;m.some(function(w){return w.type==="characterData"&&w.target===g.domNode})&&(this.text=this.statics.value(this.domNode))},d.prototype.value=function(){return this.text},d.blotName="text",d.scope=a.Scope.INLINE_BLOT,d}(o.default);n.default=u},function(t,n,r){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(a,u){return arguments.length>1&&!this.contains(a)==!u?u:o.call(this,a)}}String.prototype.startsWith||(String.prototype.startsWith=function(a,u){return u=u||0,this.substr(u,a.length)===a}),String.prototype.endsWith||(String.prototype.endsWith=function(a,u){var c=this.toString();(typeof u!="number"||!isFinite(u)||Math.floor(u)!==u||u>c.length)&&(u=c.length),u-=a.length;var d=c.indexOf(a,u);return d!==-1&&d===u}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(u){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof u!="function")throw new TypeError("predicate must be a function");for(var c=Object(this),d=c.length>>>0,m=arguments[1],p,g=0;g<d;g++)if(p=c[g],u.call(m,p,g,c))return p}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(t,n){var r=-1,s=1,o=0;function a(S,R,L){if(S==R)return S?[[o,S]]:[];(L<0||S.length<L)&&(L=null);var k=m(S,R),T=S.substring(0,k);S=S.substring(k),R=R.substring(k),k=p(S,R);var D=S.substring(S.length-k);S=S.substring(0,S.length-k),R=R.substring(0,R.length-k);var P=u(S,R);return T&&P.unshift([o,T]),D&&P.push([o,D]),w(P),L!=null&&(P=_(P,L)),P=C(P),P}function u(S,R){var L;if(!S)return[[s,R]];if(!R)return[[r,S]];var k=S.length>R.length?S:R,T=S.length>R.length?R:S,D=k.indexOf(T);if(D!=-1)return L=[[s,k.substring(0,D)],[o,T],[s,k.substring(D+T.length)]],S.length>R.length&&(L[0][0]=L[2][0]=r),L;if(T.length==1)return[[r,S],[s,R]];var P=g(S,R);if(P){var N=P[0],F=P[1],M=P[2],$=P[3],Q=P[4],ie=a(N,M),ee=a(F,$);return ie.concat([[o,Q]],ee)}return c(S,R)}function c(S,R){for(var L=S.length,k=R.length,T=Math.ceil((L+k)/2),D=T,P=2*T,N=new Array(P),F=new Array(P),M=0;M<P;M++)N[M]=-1,F[M]=-1;N[D+1]=0,F[D+1]=0;for(var $=L-k,Q=$%2!=0,ie=0,ee=0,ue=0,Y=0,J=0;J<T;J++){for(var q=-J+ie;q<=J-ee;q+=2){var H=D+q,G;q==-J||q!=J&&N[H-1]<N[H+1]?G=N[H+1]:G=N[H-1]+1;for(var le=G-q;G<L&&le<k&&S.charAt(G)==R.charAt(le);)G++,le++;if(N[H]=G,G>L)ee+=2;else if(le>k)ie+=2;else if(Q){var se=D+$-q;if(se>=0&&se<P&&F[se]!=-1){var X=L-F[se];if(G>=X)return d(S,R,G,le)}}}for(var ne=-J+ue;ne<=J-Y;ne+=2){var se=D+ne,X;ne==-J||ne!=J&&F[se-1]<F[se+1]?X=F[se+1]:X=F[se-1]+1;for(var te=X-ne;X<L&&te<k&&S.charAt(L-X-1)==R.charAt(k-te-1);)X++,te++;if(F[se]=X,X>L)Y+=2;else if(te>k)ue+=2;else if(!Q){var H=D+$-ne;if(H>=0&&H<P&&N[H]!=-1){var G=N[H],le=D+G-H;if(X=L-X,G>=X)return d(S,R,G,le)}}}}return[[r,S],[s,R]]}function d(S,R,L,k){var T=S.substring(0,L),D=R.substring(0,k),P=S.substring(L),N=R.substring(k),F=a(T,D),M=a(P,N);return F.concat(M)}function m(S,R){if(!S||!R||S.charAt(0)!=R.charAt(0))return 0;for(var L=0,k=Math.min(S.length,R.length),T=k,D=0;L<T;)S.substring(D,T)==R.substring(D,T)?(L=T,D=L):k=T,T=Math.floor((k-L)/2+L);return T}function p(S,R){if(!S||!R||S.charAt(S.length-1)!=R.charAt(R.length-1))return 0;for(var L=0,k=Math.min(S.length,R.length),T=k,D=0;L<T;)S.substring(S.length-T,S.length-D)==R.substring(R.length-T,R.length-D)?(L=T,D=L):k=T,T=Math.floor((k-L)/2+L);return T}function g(S,R){var L=S.length>R.length?S:R,k=S.length>R.length?R:S;if(L.length<4||k.length*2<L.length)return null;function T(ee,ue,Y){for(var J=ee.substring(Y,Y+Math.floor(ee.length/4)),q=-1,H="",G,le,se,X;(q=ue.indexOf(J,q+1))!=-1;){var ne=m(ee.substring(Y),ue.substring(q)),te=p(ee.substring(0,Y),ue.substring(0,q));H.length<te+ne&&(H=ue.substring(q-te,q)+ue.substring(q,q+ne),G=ee.substring(0,Y-te),le=ee.substring(Y+ne),se=ue.substring(0,q-te),X=ue.substring(q+ne))}return H.length*2>=ee.length?[G,le,se,X,H]:null}var D=T(L,k,Math.ceil(L.length/4)),P=T(L,k,Math.ceil(L.length/2)),N;if(!D&&!P)return null;P?D?N=D[4].length>P[4].length?D:P:N=P:N=D;var F,M,$,Q;S.length>R.length?(F=N[0],M=N[1],$=N[2],Q=N[3]):($=N[0],Q=N[1],F=N[2],M=N[3]);var ie=N[4];return[F,M,$,Q,ie]}function w(S){S.push([o,""]);for(var R=0,L=0,k=0,T="",D="",P;R<S.length;)switch(S[R][0]){case s:k++,D+=S[R][1],R++;break;case r:L++,T+=S[R][1],R++;break;case o:L+k>1?(L!==0&&k!==0&&(P=m(D,T),P!==0&&(R-L-k>0&&S[R-L-k-1][0]==o?S[R-L-k-1][1]+=D.substring(0,P):(S.splice(0,0,[o,D.substring(0,P)]),R++),D=D.substring(P),T=T.substring(P)),P=p(D,T),P!==0&&(S[R][1]=D.substring(D.length-P)+S[R][1],D=D.substring(0,D.length-P),T=T.substring(0,T.length-P))),L===0?S.splice(R-k,L+k,[s,D]):k===0?S.splice(R-L,L+k,[r,T]):S.splice(R-L-k,L+k,[r,T],[s,D]),R=R-L-k+(L?1:0)+(k?1:0)+1):R!==0&&S[R-1][0]==o?(S[R-1][1]+=S[R][1],S.splice(R,1)):R++,k=0,L=0,T="",D="";break}S[S.length-1][1]===""&&S.pop();var N=!1;for(R=1;R<S.length-1;)S[R-1][0]==o&&S[R+1][0]==o&&(S[R][1].substring(S[R][1].length-S[R-1][1].length)==S[R-1][1]?(S[R][1]=S[R-1][1]+S[R][1].substring(0,S[R][1].length-S[R-1][1].length),S[R+1][1]=S[R-1][1]+S[R+1][1],S.splice(R-1,1),N=!0):S[R][1].substring(0,S[R+1][1].length)==S[R+1][1]&&(S[R-1][1]+=S[R+1][1],S[R][1]=S[R][1].substring(S[R+1][1].length)+S[R+1][1],S.splice(R+1,1),N=!0)),R++;N&&w(S)}var b=a;b.INSERT=s,b.DELETE=r,b.EQUAL=o,t.exports=b;function A(S,R){if(R===0)return[o,S];for(var L=0,k=0;k<S.length;k++){var T=S[k];if(T[0]===r||T[0]===o){var D=L+T[1].length;if(R===D)return[k+1,S];if(R<D){S=S.slice();var P=R-L,N=[T[0],T[1].slice(0,P)],F=[T[0],T[1].slice(P)];return S.splice(k,1,N,F),[k+1,S]}else L=D}}throw new Error("cursor_pos is out of bounds!")}function _(S,R){var L=A(S,R),k=L[1],T=L[0],D=k[T],P=k[T+1];if(D==null)return S;if(D[0]!==o)return S;if(P!=null&&D[1]+P[1]===P[1]+D[1])return k.splice(T,2,P,D),I(k,T,2);if(P!=null&&P[1].indexOf(D[1])===0){k.splice(T,2,[P[0],D[1]],[0,D[1]]);var N=P[1].slice(D[1].length);return N.length>0&&k.splice(T+2,0,[P[0],N]),I(k,T,3)}else return S}function C(S){for(var R=!1,L=function(P){return P.charCodeAt(0)>=56320&&P.charCodeAt(0)<=57343},k=function(P){return P.charCodeAt(P.length-1)>=55296&&P.charCodeAt(P.length-1)<=56319},T=2;T<S.length;T+=1)S[T-2][0]===o&&k(S[T-2][1])&&S[T-1][0]===r&&L(S[T-1][1])&&S[T][0]===s&&L(S[T][1])&&(R=!0,S[T-1][1]=S[T-2][1].slice(-1)+S[T-1][1],S[T][1]=S[T-2][1].slice(-1)+S[T][1],S[T-2][1]=S[T-2][1].slice(0,-1));if(!R)return S;for(var D=[],T=0;T<S.length;T+=1)S[T][1].length>0&&D.push(S[T]);return D}function I(S,R,L){for(var k=R+L-1;k>=0&&k>=R-1;k--)if(k+1<S.length){var T=S[k],D=S[k+1];T[0]===D[1]&&S.splice(k,2,[T[0],T[1]+D[1]])}return S}},function(t,n){n=t.exports=typeof Object.keys=="function"?Object.keys:r,n.shim=r;function r(s){var o=[];for(var a in s)o.push(a);return o}},function(t,n){var r=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=t.exports=r?s:o,n.supported=s;function s(a){return Object.prototype.toString.call(a)=="[object Arguments]"}n.unsupported=o;function o(a){return a&&typeof a=="object"&&typeof a.length=="number"&&Object.prototype.hasOwnProperty.call(a,"callee")&&!Object.prototype.propertyIsEnumerable.call(a,"callee")||!1}},function(t,n){var r=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function a(c,d,m){this.fn=c,this.context=d,this.once=m||!1}function u(){this._events=new o,this._eventsCount=0}u.prototype.eventNames=function(){var d=[],m,p;if(this._eventsCount===0)return d;for(p in m=this._events)r.call(m,p)&&d.push(s?p.slice(1):p);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(m)):d},u.prototype.listeners=function(d,m){var p=s?s+d:d,g=this._events[p];if(m)return!!g;if(!g)return[];if(g.fn)return[g.fn];for(var w=0,b=g.length,A=new Array(b);w<b;w++)A[w]=g[w].fn;return A},u.prototype.emit=function(d,m,p,g,w,b){var A=s?s+d:d;if(!this._events[A])return!1;var _=this._events[A],C=arguments.length,I,S;if(_.fn){switch(_.once&&this.removeListener(d,_.fn,void 0,!0),C){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,m),!0;case 3:return _.fn.call(_.context,m,p),!0;case 4:return _.fn.call(_.context,m,p,g),!0;case 5:return _.fn.call(_.context,m,p,g,w),!0;case 6:return _.fn.call(_.context,m,p,g,w,b),!0}for(S=1,I=new Array(C-1);S<C;S++)I[S-1]=arguments[S];_.fn.apply(_.context,I)}else{var R=_.length,L;for(S=0;S<R;S++)switch(_[S].once&&this.removeListener(d,_[S].fn,void 0,!0),C){case 1:_[S].fn.call(_[S].context);break;case 2:_[S].fn.call(_[S].context,m);break;case 3:_[S].fn.call(_[S].context,m,p);break;case 4:_[S].fn.call(_[S].context,m,p,g);break;default:if(!I)for(L=1,I=new Array(C-1);L<C;L++)I[L-1]=arguments[L];_[S].fn.apply(_[S].context,I)}}return!0},u.prototype.on=function(d,m,p){var g=new a(m,p||this),w=s?s+d:d;return this._events[w]?this._events[w].fn?this._events[w]=[this._events[w],g]:this._events[w].push(g):(this._events[w]=g,this._eventsCount++),this},u.prototype.once=function(d,m,p){var g=new a(m,p||this,!0),w=s?s+d:d;return this._events[w]?this._events[w].fn?this._events[w]=[this._events[w],g]:this._events[w].push(g):(this._events[w]=g,this._eventsCount++),this},u.prototype.removeListener=function(d,m,p,g){var w=s?s+d:d;if(!this._events[w])return this;if(!m)return--this._eventsCount===0?this._events=new o:delete this._events[w],this;var b=this._events[w];if(b.fn)b.fn===m&&(!g||b.once)&&(!p||b.context===p)&&(--this._eventsCount===0?this._events=new o:delete this._events[w]);else{for(var A=0,_=[],C=b.length;A<C;A++)(b[A].fn!==m||g&&!b[A].once||p&&b[A].context!==p)&&_.push(b[A]);_.length?this._events[w]=_.length===1?_[0]:_:--this._eventsCount===0?this._events=new o:delete this._events[w]}return this},u.prototype.removeAllListeners=function(d){var m;return d?(m=s?s+d:d,this._events[m]&&(--this._eventsCount===0?this._events=new o:delete this._events[m])):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prototype.setMaxListeners=function(){return this},u.prefixed=s,u.EventEmitter=u,typeof t<"u"&&(t.exports=u)},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(fe){return typeof fe}:function(fe){return fe&&typeof Symbol=="function"&&fe.constructor===Symbol&&fe!==Symbol.prototype?"symbol":typeof fe},o=function(){function fe(ve,Ie){var Re=[],be=!0,rt=!1,qe=void 0;try{for(var Ze=ve[Symbol.iterator](),st;!(be=(st=Ze.next()).done)&&(Re.push(st.value),!(Ie&&Re.length===Ie));be=!0);}catch(ft){rt=!0,qe=ft}finally{try{!be&&Ze.return&&Ze.return()}finally{if(rt)throw qe}}return Re}return function(ve,Ie){if(Array.isArray(ve))return ve;if(Symbol.iterator in Object(ve))return fe(ve,Ie);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function fe(ve,Ie){for(var Re=0;Re<Ie.length;Re++){var be=Ie[Re];be.enumerable=be.enumerable||!1,be.configurable=!0,"value"in be&&(be.writable=!0),Object.defineProperty(ve,be.key,be)}}return function(ve,Ie,Re){return Ie&&fe(ve.prototype,Ie),Re&&fe(ve,Re),ve}}(),u=r(3),c=F(u),d=r(2),m=F(d),p=r(0),g=F(p),w=r(5),b=F(w),A=r(10),_=F(A),C=r(9),I=F(C),S=r(36),R=r(37),L=r(13),k=F(L),T=r(26),D=r(38),P=r(39),N=r(40);function F(fe){return fe&&fe.__esModule?fe:{default:fe}}function M(fe,ve,Ie){return ve in fe?Object.defineProperty(fe,ve,{value:Ie,enumerable:!0,configurable:!0,writable:!0}):fe[ve]=Ie,fe}function $(fe,ve){if(!(fe instanceof ve))throw new TypeError("Cannot call a class as a function")}function Q(fe,ve){if(!fe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ve&&(typeof ve=="object"||typeof ve=="function")?ve:fe}function ie(fe,ve){if(typeof ve!="function"&&ve!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ve);fe.prototype=Object.create(ve&&ve.prototype,{constructor:{value:fe,enumerable:!1,writable:!0,configurable:!0}}),ve&&(Object.setPrototypeOf?Object.setPrototypeOf(fe,ve):fe.__proto__=ve)}var ee=(0,_.default)("quill:clipboard"),ue="__ql-matcher",Y=[[Node.TEXT_NODE,mt],[Node.TEXT_NODE,Fe],["br",ye],[Node.ELEMENT_NODE,Fe],[Node.ELEMENT_NODE,de],[Node.ELEMENT_NODE,Be],[Node.ELEMENT_NODE,ae],[Node.ELEMENT_NODE,We],["li",Oe],["b",te.bind(te,"bold")],["i",te.bind(te,"italic")],["style",xe]],J=[S.AlignAttribute,D.DirectionAttribute].reduce(function(fe,ve){return fe[ve.keyName]=ve,fe},{}),q=[S.AlignStyle,R.BackgroundStyle,T.ColorStyle,D.DirectionStyle,P.FontStyle,N.SizeStyle].reduce(function(fe,ve){return fe[ve.keyName]=ve,fe},{}),H=function(fe){ie(ve,fe);function ve(Ie,Re){$(this,ve);var be=Q(this,(ve.__proto__||Object.getPrototypeOf(ve)).call(this,Ie,Re));return be.quill.root.addEventListener("paste",be.onPaste.bind(be)),be.container=be.quill.addContainer("ql-clipboard"),be.container.setAttribute("contenteditable",!0),be.container.setAttribute("tabindex",-1),be.matchers=[],Y.concat(be.options.matchers).forEach(function(rt){var qe=o(rt,2),Ze=qe[0],st=qe[1];!Re.matchVisual&&st===Be||be.addMatcher(Ze,st)}),be}return a(ve,[{key:"addMatcher",value:function(Re,be){this.matchers.push([Re,be])}},{key:"convert",value:function(Re){if(typeof Re=="string")return this.container.innerHTML=Re.replace(/\>\r?\n +\</g,"><"),this.convert();var be=this.quill.getFormat(this.quill.selection.savedRange.index);if(be[k.default.blotName]){var rt=this.container.innerText;return this.container.innerHTML="",new m.default().insert(rt,M({},k.default.blotName,be[k.default.blotName]))}var qe=this.prepareMatching(),Ze=o(qe,2),st=Ze[0],ft=Ze[1],gt=ne(this.container,st,ft);return se(gt,`
`)&&gt.ops[gt.ops.length-1].attributes==null&&(gt=gt.compose(new m.default().retain(gt.length()-1).delete(1))),ee.log("convert",this.container.innerHTML,gt),this.container.innerHTML="",gt}},{key:"dangerouslyPasteHTML",value:function(Re,be){var rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b.default.sources.API;if(typeof Re=="string")this.quill.setContents(this.convert(Re),be),this.quill.setSelection(0,b.default.sources.SILENT);else{var qe=this.convert(be);this.quill.updateContents(new m.default().retain(Re).concat(qe),rt),this.quill.setSelection(Re+qe.length(),b.default.sources.SILENT)}}},{key:"onPaste",value:function(Re){var be=this;if(!(Re.defaultPrevented||!this.quill.isEnabled())){var rt=this.quill.getSelection(),qe=new m.default().retain(rt.index),Ze=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(b.default.sources.SILENT),setTimeout(function(){qe=qe.concat(be.convert()).delete(rt.length),be.quill.updateContents(qe,b.default.sources.USER),be.quill.setSelection(qe.length()-rt.length,b.default.sources.SILENT),be.quill.scrollingContainer.scrollTop=Ze,be.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var Re=this,be=[],rt=[];return this.matchers.forEach(function(qe){var Ze=o(qe,2),st=Ze[0],ft=Ze[1];switch(st){case Node.TEXT_NODE:rt.push(ft);break;case Node.ELEMENT_NODE:be.push(ft);break;default:[].forEach.call(Re.container.querySelectorAll(st),function(gt){gt[ue]=gt[ue]||[],gt[ue].push(ft)});break}}),[be,rt]}}]),ve}(I.default);H.DEFAULTS={matchers:[],matchVisual:!0};function G(fe,ve,Ie){return(typeof ve>"u"?"undefined":s(ve))==="object"?Object.keys(ve).reduce(function(Re,be){return G(Re,be,ve[be])},fe):fe.reduce(function(Re,be){return be.attributes&&be.attributes[ve]?Re.push(be):Re.insert(be.insert,(0,c.default)({},M({},ve,Ie),be.attributes))},new m.default)}function le(fe){if(fe.nodeType!==Node.ELEMENT_NODE)return{};var ve="__ql-computed-style";return fe[ve]||(fe[ve]=window.getComputedStyle(fe))}function se(fe,ve){for(var Ie="",Re=fe.ops.length-1;Re>=0&&Ie.length<ve.length;--Re){var be=fe.ops[Re];if(typeof be.insert!="string")break;Ie=be.insert+Ie}return Ie.slice(-1*ve.length)===ve}function X(fe){if(fe.childNodes.length===0)return!1;var ve=le(fe);return["block","list-item"].indexOf(ve.display)>-1}function ne(fe,ve,Ie){return fe.nodeType===fe.TEXT_NODE?Ie.reduce(function(Re,be){return be(fe,Re)},new m.default):fe.nodeType===fe.ELEMENT_NODE?[].reduce.call(fe.childNodes||[],function(Re,be){var rt=ne(be,ve,Ie);return be.nodeType===fe.ELEMENT_NODE&&(rt=ve.reduce(function(qe,Ze){return Ze(be,qe)},rt),rt=(be[ue]||[]).reduce(function(qe,Ze){return Ze(be,qe)},rt)),Re.concat(rt)},new m.default):new m.default}function te(fe,ve,Ie){return G(Ie,fe,!0)}function ae(fe,ve){var Ie=g.default.Attributor.Attribute.keys(fe),Re=g.default.Attributor.Class.keys(fe),be=g.default.Attributor.Style.keys(fe),rt={};return Ie.concat(Re).concat(be).forEach(function(qe){var Ze=g.default.query(qe,g.default.Scope.ATTRIBUTE);Ze!=null&&(rt[Ze.attrName]=Ze.value(fe),rt[Ze.attrName])||(Ze=J[qe],Ze!=null&&(Ze.attrName===qe||Ze.keyName===qe)&&(rt[Ze.attrName]=Ze.value(fe)||void 0),Ze=q[qe],Ze!=null&&(Ze.attrName===qe||Ze.keyName===qe)&&(Ze=q[qe],rt[Ze.attrName]=Ze.value(fe)||void 0))}),Object.keys(rt).length>0&&(ve=G(ve,rt)),ve}function de(fe,ve){var Ie=g.default.query(fe);if(Ie==null)return ve;if(Ie.prototype instanceof g.default.Embed){var Re={},be=Ie.value(fe);be!=null&&(Re[Ie.blotName]=be,ve=new m.default().insert(Re,Ie.formats(fe)))}else typeof Ie.formats=="function"&&(ve=G(ve,Ie.blotName,Ie.formats(fe)));return ve}function ye(fe,ve){return se(ve,`
`)||ve.insert(`
`),ve}function xe(){return new m.default}function Oe(fe,ve){var Ie=g.default.query(fe);if(Ie==null||Ie.blotName!=="list-item"||!se(ve,`
`))return ve;for(var Re=-1,be=fe.parentNode;!be.classList.contains("ql-clipboard");)(g.default.query(be)||{}).blotName==="list"&&(Re+=1),be=be.parentNode;return Re<=0?ve:ve.compose(new m.default().retain(ve.length()-1).retain(1,{indent:Re}))}function Fe(fe,ve){return se(ve,`
`)||(X(fe)||ve.length()>0&&fe.nextSibling&&X(fe.nextSibling))&&ve.insert(`
`),ve}function Be(fe,ve){if(X(fe)&&fe.nextElementSibling!=null&&!se(ve,`

`)){var Ie=fe.offsetHeight+parseFloat(le(fe).marginTop)+parseFloat(le(fe).marginBottom);fe.nextElementSibling.offsetTop>fe.offsetTop+Ie*1.5&&ve.insert(`
`)}return ve}function We(fe,ve){var Ie={},Re=fe.style||{};return Re.fontStyle&&le(fe).fontStyle==="italic"&&(Ie.italic=!0),Re.fontWeight&&(le(fe).fontWeight.startsWith("bold")||parseInt(le(fe).fontWeight)>=700)&&(Ie.bold=!0),Object.keys(Ie).length>0&&(ve=G(ve,Ie)),parseFloat(Re.textIndent||0)>0&&(ve=new m.default().insert("	").concat(ve)),ve}function mt(fe,ve){var Ie=fe.data;if(fe.parentNode.tagName==="O:P")return ve.insert(Ie.trim());if(Ie.trim().length===0&&fe.parentNode.classList.contains("ql-clipboard"))return ve;if(!le(fe.parentNode).whiteSpace.startsWith("pre")){var Re=function(rt,qe){return qe=qe.replace(/[^\u00a0]/g,""),qe.length<1&&rt?" ":qe};Ie=Ie.replace(/\r\n/g," ").replace(/\n/g," "),Ie=Ie.replace(/\s\s+/g,Re.bind(Re,!0)),(fe.previousSibling==null&&X(fe.parentNode)||fe.previousSibling!=null&&X(fe.previousSibling))&&(Ie=Ie.replace(/^\s+/,Re.bind(Re,!1))),(fe.nextSibling==null&&X(fe.parentNode)||fe.nextSibling!=null&&X(fe.nextSibling))&&(Ie=Ie.replace(/\s+$/,Re.bind(Re,!1)))}return ve.insert(Ie)}n.default=H,n.matchAttributor=ae,n.matchBlot=de,n.matchNewline=Fe,n.matchSpacing=Be,n.matchText=mt},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function w(b,A){for(var _=0;_<A.length;_++){var C=A[_];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(b,C.key,C)}}return function(b,A,_){return A&&w(b.prototype,A),_&&w(b,_),b}}(),o=function w(b,A,_){b===null&&(b=Function.prototype);var C=Object.getOwnPropertyDescriptor(b,A);if(C===void 0){var I=Object.getPrototypeOf(b);return I===null?void 0:w(I,A,_)}else{if("value"in C)return C.value;var S=C.get;return S===void 0?void 0:S.call(_)}},a=r(6),u=c(a);function c(w){return w&&w.__esModule?w:{default:w}}function d(w,b){if(!(w instanceof b))throw new TypeError("Cannot call a class as a function")}function m(w,b){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:w}function p(w,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);w.prototype=Object.create(b&&b.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(w,b):w.__proto__=b)}var g=function(w){p(b,w);function b(){return d(this,b),m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"optimize",value:function(_){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"optimize",this).call(this,_),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),b}(u.default);g.blotName="bold",g.tagName=["STRONG","B"],n.default=g},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=function(){function N(F,M){var $=[],Q=!0,ie=!1,ee=void 0;try{for(var ue=F[Symbol.iterator](),Y;!(Q=(Y=ue.next()).done)&&($.push(Y.value),!(M&&$.length===M));Q=!0);}catch(J){ie=!0,ee=J}finally{try{!Q&&ue.return&&ue.return()}finally{if(ie)throw ee}}return $}return function(F,M){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return N(F,M);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function N(F,M){for(var $=0;$<M.length;$++){var Q=M[$];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(F,Q.key,Q)}}return function(F,M,$){return M&&N(F.prototype,M),$&&N(F,$),F}}(),a=r(2),u=_(a),c=r(0),d=_(c),m=r(5),p=_(m),g=r(10),w=_(g),b=r(9),A=_(b);function _(N){return N&&N.__esModule?N:{default:N}}function C(N,F,M){return F in N?Object.defineProperty(N,F,{value:M,enumerable:!0,configurable:!0,writable:!0}):N[F]=M,N}function I(N,F){if(!(N instanceof F))throw new TypeError("Cannot call a class as a function")}function S(N,F){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:N}function R(N,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);N.prototype=Object.create(F&&F.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(N,F):N.__proto__=F)}var L=(0,w.default)("quill:toolbar"),k=function(N){R(F,N);function F(M,$){I(this,F);var Q=S(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,M,$));if(Array.isArray(Q.options.container)){var ie=document.createElement("div");D(ie,Q.options.container),M.container.parentNode.insertBefore(ie,M.container),Q.container=ie}else typeof Q.options.container=="string"?Q.container=document.querySelector(Q.options.container):Q.container=Q.options.container;if(!(Q.container instanceof HTMLElement)){var ee;return ee=L.error("Container required for toolbar",Q.options),S(Q,ee)}return Q.container.classList.add("ql-toolbar"),Q.controls=[],Q.handlers={},Object.keys(Q.options.handlers).forEach(function(ue){Q.addHandler(ue,Q.options.handlers[ue])}),[].forEach.call(Q.container.querySelectorAll("button, select"),function(ue){Q.attach(ue)}),Q.quill.on(p.default.events.EDITOR_CHANGE,function(ue,Y){ue===p.default.events.SELECTION_CHANGE&&Q.update(Y)}),Q.quill.on(p.default.events.SCROLL_OPTIMIZE,function(){var ue=Q.quill.selection.getRange(),Y=s(ue,1),J=Y[0];Q.update(J)}),Q}return o(F,[{key:"addHandler",value:function($,Q){this.handlers[$]=Q}},{key:"attach",value:function($){var Q=this,ie=[].find.call($.classList,function(ue){return ue.indexOf("ql-")===0});if(ie){if(ie=ie.slice(3),$.tagName==="BUTTON"&&$.setAttribute("type","button"),this.handlers[ie]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[ie]==null){L.warn("ignoring attaching to disabled format",ie,$);return}if(d.default.query(ie)==null){L.warn("ignoring attaching to nonexistent format",ie,$);return}}var ee=$.tagName==="SELECT"?"change":"click";$.addEventListener(ee,function(ue){var Y=void 0;if($.tagName==="SELECT"){if($.selectedIndex<0)return;var J=$.options[$.selectedIndex];J.hasAttribute("selected")?Y=!1:Y=J.value||!1}else $.classList.contains("ql-active")?Y=!1:Y=$.value||!$.hasAttribute("value"),ue.preventDefault();Q.quill.focus();var q=Q.quill.selection.getRange(),H=s(q,1),G=H[0];if(Q.handlers[ie]!=null)Q.handlers[ie].call(Q,Y);else if(d.default.query(ie).prototype instanceof d.default.Embed){if(Y=prompt("Enter "+ie),!Y)return;Q.quill.updateContents(new u.default().retain(G.index).delete(G.length).insert(C({},ie,Y)),p.default.sources.USER)}else Q.quill.format(ie,Y,p.default.sources.USER);Q.update(G)}),this.controls.push([ie,$])}}},{key:"update",value:function($){var Q=$==null?{}:this.quill.getFormat($);this.controls.forEach(function(ie){var ee=s(ie,2),ue=ee[0],Y=ee[1];if(Y.tagName==="SELECT"){var J=void 0;if($==null)J=null;else if(Q[ue]==null)J=Y.querySelector("option[selected]");else if(!Array.isArray(Q[ue])){var q=Q[ue];typeof q=="string"&&(q=q.replace(/\"/g,'\\"')),J=Y.querySelector('option[value="'+q+'"]')}J==null?(Y.value="",Y.selectedIndex=-1):J.selected=!0}else if($==null)Y.classList.remove("ql-active");else if(Y.hasAttribute("value")){var H=Q[ue]===Y.getAttribute("value")||Q[ue]!=null&&Q[ue].toString()===Y.getAttribute("value")||Q[ue]==null&&!Y.getAttribute("value");Y.classList.toggle("ql-active",H)}else Y.classList.toggle("ql-active",Q[ue]!=null)})}}]),F}(A.default);k.DEFAULTS={};function T(N,F,M){var $=document.createElement("button");$.setAttribute("type","button"),$.classList.add("ql-"+F),M!=null&&($.value=M),N.appendChild($)}function D(N,F){Array.isArray(F[0])||(F=[F]),F.forEach(function(M){var $=document.createElement("span");$.classList.add("ql-formats"),M.forEach(function(Q){if(typeof Q=="string")T($,Q);else{var ie=Object.keys(Q)[0],ee=Q[ie];Array.isArray(ee)?P($,ie,ee):T($,ie,ee)}}),N.appendChild($)})}function P(N,F,M){var $=document.createElement("select");$.classList.add("ql-"+F),M.forEach(function(Q){var ie=document.createElement("option");Q!==!1?ie.setAttribute("value",Q):ie.setAttribute("selected","selected"),$.appendChild(ie)}),N.appendChild($)}k.DEFAULTS={container:null,handlers:{clean:function(){var F=this,M=this.quill.getSelection();if(M!=null)if(M.length==0){var $=this.quill.getFormat();Object.keys($).forEach(function(Q){d.default.query(Q,d.default.Scope.INLINE)!=null&&F.quill.format(Q,!1)})}else this.quill.removeFormat(M,p.default.sources.USER)},direction:function(F){var M=this.quill.getFormat().align;F==="rtl"&&M==null?this.quill.format("align","right",p.default.sources.USER):!F&&M==="right"&&this.quill.format("align",!1,p.default.sources.USER),this.quill.format("direction",F,p.default.sources.USER)},indent:function(F){var M=this.quill.getSelection(),$=this.quill.getFormat(M),Q=parseInt($.indent||0);if(F==="+1"||F==="-1"){var ie=F==="+1"?1:-1;$.direction==="rtl"&&(ie*=-1),this.quill.format("indent",Q+ie,p.default.sources.USER)}},link:function(F){F===!0&&(F=prompt("Enter link URL:")),this.quill.format("link",F,p.default.sources.USER)},list:function(F){var M=this.quill.getSelection(),$=this.quill.getFormat(M);F==="check"?$.list==="checked"||$.list==="unchecked"?this.quill.format("list",!1,p.default.sources.USER):this.quill.format("list","unchecked",p.default.sources.USER):this.quill.format("list",F,p.default.sources.USER)}}},n.default=k,n.addControls=D},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function w(b,A){for(var _=0;_<A.length;_++){var C=A[_];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(b,C.key,C)}}return function(b,A,_){return A&&w(b.prototype,A),_&&w(b,_),b}}(),o=function w(b,A,_){b===null&&(b=Function.prototype);var C=Object.getOwnPropertyDescriptor(b,A);if(C===void 0){var I=Object.getPrototypeOf(b);return I===null?void 0:w(I,A,_)}else{if("value"in C)return C.value;var S=C.get;return S===void 0?void 0:S.call(_)}},a=r(28),u=c(a);function c(w){return w&&w.__esModule?w:{default:w}}function d(w,b){if(!(w instanceof b))throw new TypeError("Cannot call a class as a function")}function m(w,b){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:w}function p(w,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);w.prototype=Object.create(b&&b.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(w,b):w.__proto__=b)}var g=function(w){p(b,w);function b(A,_){d(this,b);var C=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,A));return C.label.innerHTML=_,C.container.classList.add("ql-color-picker"),[].slice.call(C.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(I){I.classList.add("ql-primary")}),C}return s(b,[{key:"buildItem",value:function(_){var C=o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"buildItem",this).call(this,_);return C.style.backgroundColor=_.getAttribute("value")||"",C}},{key:"selectItem",value:function(_,C){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"selectItem",this).call(this,_,C);var I=this.label.querySelector(".ql-color-label"),S=_&&_.getAttribute("data-value")||"";I&&(I.tagName==="line"?I.style.stroke=S:I.style.fill=S)}}]),b}(u.default);n.default=g},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function w(b,A){for(var _=0;_<A.length;_++){var C=A[_];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(b,C.key,C)}}return function(b,A,_){return A&&w(b.prototype,A),_&&w(b,_),b}}(),o=function w(b,A,_){b===null&&(b=Function.prototype);var C=Object.getOwnPropertyDescriptor(b,A);if(C===void 0){var I=Object.getPrototypeOf(b);return I===null?void 0:w(I,A,_)}else{if("value"in C)return C.value;var S=C.get;return S===void 0?void 0:S.call(_)}},a=r(28),u=c(a);function c(w){return w&&w.__esModule?w:{default:w}}function d(w,b){if(!(w instanceof b))throw new TypeError("Cannot call a class as a function")}function m(w,b){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:w}function p(w,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);w.prototype=Object.create(b&&b.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(w,b):w.__proto__=b)}var g=function(w){p(b,w);function b(A,_){d(this,b);var C=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,A));return C.container.classList.add("ql-icon-picker"),[].forEach.call(C.container.querySelectorAll(".ql-picker-item"),function(I){I.innerHTML=_[I.getAttribute("data-value")||""]}),C.defaultItem=C.container.querySelector(".ql-selected"),C.selectItem(C.defaultItem),C}return s(b,[{key:"selectItem",value:function(_,C){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"selectItem",this).call(this,_,C),_=_||this.defaultItem,this.label.innerHTML=_.innerHTML}}]),b}(u.default);n.default=g},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function u(c,d){for(var m=0;m<d.length;m++){var p=d[m];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}return function(c,d,m){return d&&u(c.prototype,d),m&&u(c,m),c}}();function o(u,c){if(!(u instanceof c))throw new TypeError("Cannot call a class as a function")}var a=function(){function u(c,d){var m=this;o(this,u),this.quill=c,this.boundsContainer=d||document.body,this.root=c.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){m.root.style.marginTop=-1*m.quill.root.scrollTop+"px"}),this.hide()}return s(u,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(d){var m=d.left+d.width/2-this.root.offsetWidth/2,p=d.bottom+this.quill.root.scrollTop;this.root.style.left=m+"px",this.root.style.top=p+"px",this.root.classList.remove("ql-flip");var g=this.boundsContainer.getBoundingClientRect(),w=this.root.getBoundingClientRect(),b=0;if(w.right>g.right&&(b=g.right-w.right,this.root.style.left=m+b+"px"),w.left<g.left&&(b=g.left-w.left,this.root.style.left=m+b+"px"),w.bottom>g.bottom){var A=w.bottom-w.top,_=d.bottom-d.top+A;this.root.style.top=p-_+"px",this.root.classList.add("ql-flip")}return b}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),u}();n.default=a},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function P(N,F){var M=[],$=!0,Q=!1,ie=void 0;try{for(var ee=N[Symbol.iterator](),ue;!($=(ue=ee.next()).done)&&(M.push(ue.value),!(F&&M.length===F));$=!0);}catch(Y){Q=!0,ie=Y}finally{try{!$&&ee.return&&ee.return()}finally{if(Q)throw ie}}return M}return function(N,F){if(Array.isArray(N))return N;if(Symbol.iterator in Object(N))return P(N,F);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function P(N,F,M){N===null&&(N=Function.prototype);var $=Object.getOwnPropertyDescriptor(N,F);if($===void 0){var Q=Object.getPrototypeOf(N);return Q===null?void 0:P(Q,F,M)}else{if("value"in $)return $.value;var ie=$.get;return ie===void 0?void 0:ie.call(M)}},a=function(){function P(N,F){for(var M=0;M<F.length;M++){var $=F[M];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(N,$.key,$)}}return function(N,F,M){return F&&P(N.prototype,F),M&&P(N,M),N}}(),u=r(3),c=I(u),d=r(8),m=I(d),p=r(43),g=I(p),w=r(27),b=I(w),A=r(15),_=r(41),C=I(_);function I(P){return P&&P.__esModule?P:{default:P}}function S(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")}function R(P,N){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:P}function L(P,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);P.prototype=Object.create(N&&N.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(P,N):P.__proto__=N)}var k=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],T=function(P){L(N,P);function N(F,M){S(this,N),M.modules.toolbar!=null&&M.modules.toolbar.container==null&&(M.modules.toolbar.container=k);var $=R(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,F,M));return $.quill.container.classList.add("ql-snow"),$}return a(N,[{key:"extendToolbar",value:function(M){M.container.classList.add("ql-snow"),this.buildButtons([].slice.call(M.container.querySelectorAll("button")),C.default),this.buildPickers([].slice.call(M.container.querySelectorAll("select")),C.default),this.tooltip=new D(this.quill,this.options.bounds),M.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function($,Q){M.handlers.link.call(M,!Q.format.link)})}}]),N}(g.default);T.DEFAULTS=(0,c.default)(!0,{},g.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(N){if(N){var F=this.quill.getSelection();if(F==null||F.length==0)return;var M=this.quill.getText(F);/^\S+@\S+\.\S+$/.test(M)&&M.indexOf("mailto:")!==0&&(M="mailto:"+M);var $=this.quill.theme.tooltip;$.edit("link",M)}else this.quill.format("link",!1)}}}}});var D=function(P){L(N,P);function N(F,M){S(this,N);var $=R(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,F,M));return $.preview=$.root.querySelector("a.ql-preview"),$}return a(N,[{key:"listen",value:function(){var M=this;o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function($){M.root.classList.contains("ql-editing")?M.save():M.edit("link",M.preview.textContent),$.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function($){if(M.linkRange!=null){var Q=M.linkRange;M.restoreFocus(),M.quill.formatText(Q,"link",!1,m.default.sources.USER),delete M.linkRange}$.preventDefault(),M.hide()}),this.quill.on(m.default.events.SELECTION_CHANGE,function($,Q,ie){if($!=null){if($.length===0&&ie===m.default.sources.USER){var ee=M.quill.scroll.descendant(b.default,$.index),ue=s(ee,2),Y=ue[0],J=ue[1];if(Y!=null){M.linkRange=new A.Range($.index-J,Y.length());var q=b.default.formats(Y.domNode);M.preview.textContent=q,M.preview.setAttribute("href",q),M.show(),M.position(M.quill.getBounds(M.linkRange));return}}else delete M.linkRange;M.hide()}})}},{key:"show",value:function(){o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),N}(p.BaseTooltip);D.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=T},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(29),o=be(s),a=r(36),u=r(38),c=r(64),d=r(65),m=be(d),p=r(66),g=be(p),w=r(67),b=be(w),A=r(37),_=r(26),C=r(39),I=r(40),S=r(56),R=be(S),L=r(68),k=be(L),T=r(27),D=be(T),P=r(69),N=be(P),F=r(70),M=be(F),$=r(71),Q=be($),ie=r(72),ee=be(ie),ue=r(73),Y=be(ue),J=r(13),q=be(J),H=r(74),G=be(H),le=r(75),se=be(le),X=r(57),ne=be(X),te=r(41),ae=be(te),de=r(28),ye=be(de),xe=r(59),Oe=be(xe),Fe=r(60),Be=be(Fe),We=r(61),mt=be(We),fe=r(108),ve=be(fe),Ie=r(62),Re=be(Ie);function be(rt){return rt&&rt.__esModule?rt:{default:rt}}o.default.register({"attributors/attribute/direction":u.DirectionAttribute,"attributors/class/align":a.AlignClass,"attributors/class/background":A.BackgroundClass,"attributors/class/color":_.ColorClass,"attributors/class/direction":u.DirectionClass,"attributors/class/font":C.FontClass,"attributors/class/size":I.SizeClass,"attributors/style/align":a.AlignStyle,"attributors/style/background":A.BackgroundStyle,"attributors/style/color":_.ColorStyle,"attributors/style/direction":u.DirectionStyle,"attributors/style/font":C.FontStyle,"attributors/style/size":I.SizeStyle},!0),o.default.register({"formats/align":a.AlignClass,"formats/direction":u.DirectionClass,"formats/indent":c.IndentClass,"formats/background":A.BackgroundStyle,"formats/color":_.ColorStyle,"formats/font":C.FontClass,"formats/size":I.SizeClass,"formats/blockquote":m.default,"formats/code-block":q.default,"formats/header":g.default,"formats/list":b.default,"formats/bold":R.default,"formats/code":J.Code,"formats/italic":k.default,"formats/link":D.default,"formats/script":N.default,"formats/strike":M.default,"formats/underline":Q.default,"formats/image":ee.default,"formats/video":Y.default,"formats/list/item":w.ListItem,"modules/formula":G.default,"modules/syntax":se.default,"modules/toolbar":ne.default,"themes/bubble":ve.default,"themes/snow":Re.default,"ui/icons":ae.default,"ui/picker":ye.default,"ui/icon-picker":Be.default,"ui/color-picker":Oe.default,"ui/tooltip":mt.default},!0),n.default=o.default},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=function(){function b(A,_){for(var C=0;C<_.length;C++){var I=_[C];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(A,I.key,I)}}return function(A,_,C){return _&&b(A.prototype,_),C&&b(A,C),A}}(),o=function b(A,_,C){A===null&&(A=Function.prototype);var I=Object.getOwnPropertyDescriptor(A,_);if(I===void 0){var S=Object.getPrototypeOf(A);return S===null?void 0:b(S,_,C)}else{if("value"in I)return I.value;var R=I.get;return R===void 0?void 0:R.call(C)}},a=r(0),u=c(a);function c(b){return b&&b.__esModule?b:{default:b}}function d(b,A){if(!(b instanceof A))throw new TypeError("Cannot call a class as a function")}function m(b,A){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:b}function p(b,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);b.prototype=Object.create(A&&A.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(b,A):b.__proto__=A)}var g=function(b){p(A,b);function A(){return d(this,A),m(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return s(A,[{key:"add",value:function(C,I){if(I==="+1"||I==="-1"){var S=this.value(C)||0;I=I==="+1"?S+1:S-1}return I===0?(this.remove(C),!0):o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"add",this).call(this,C,I)}},{key:"canAdd",value:function(C,I){return o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"canAdd",this).call(this,C,I)||o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"canAdd",this).call(this,C,parseInt(I))}},{key:"value",value:function(C){return parseInt(o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"value",this).call(this,C))||void 0}}]),A}(u.default.Attributor.Class),w=new g("indent","ql-indent",{scope:u.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=w},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(4),o=a(s);function a(p){return p&&p.__esModule?p:{default:p}}function u(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function c(p,g){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:p}function d(p,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);p.prototype=Object.create(g&&g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(p,g):p.__proto__=g)}var m=function(p){d(g,p);function g(){return u(this,g),c(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g}(o.default);m.blotName="blockquote",m.tagName="blockquote",n.default=m},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function g(w,b){for(var A=0;A<b.length;A++){var _=b[A];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(w,_.key,_)}}return function(w,b,A){return b&&g(w.prototype,b),A&&g(w,A),w}}(),o=r(4),a=u(o);function u(g){return g&&g.__esModule?g:{default:g}}function c(g,w){if(!(g instanceof w))throw new TypeError("Cannot call a class as a function")}function d(g,w){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:g}function m(g,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);g.prototype=Object.create(w&&w.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(g,w):g.__proto__=w)}var p=function(g){m(w,g);function w(){return c(this,w),d(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return s(w,null,[{key:"formats",value:function(A){return this.tagName.indexOf(A.tagName)+1}}]),w}(a.default);p.blotName="header",p.tagName=["H1","H2","H3","H4","H5","H6"],n.default=p},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=function(){function S(R,L){for(var k=0;k<L.length;k++){var T=L[k];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(R,T.key,T)}}return function(R,L,k){return L&&S(R.prototype,L),k&&S(R,k),R}}(),o=function S(R,L,k){R===null&&(R=Function.prototype);var T=Object.getOwnPropertyDescriptor(R,L);if(T===void 0){var D=Object.getPrototypeOf(R);return D===null?void 0:S(D,L,k)}else{if("value"in T)return T.value;var P=T.get;return P===void 0?void 0:P.call(k)}},a=r(0),u=g(a),c=r(4),d=g(c),m=r(25),p=g(m);function g(S){return S&&S.__esModule?S:{default:S}}function w(S,R,L){return R in S?Object.defineProperty(S,R,{value:L,enumerable:!0,configurable:!0,writable:!0}):S[R]=L,S}function b(S,R){if(!(S instanceof R))throw new TypeError("Cannot call a class as a function")}function A(S,R){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:S}function _(S,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);S.prototype=Object.create(R&&R.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(S,R):S.__proto__=R)}var C=function(S){_(R,S);function R(){return b(this,R),A(this,(R.__proto__||Object.getPrototypeOf(R)).apply(this,arguments))}return s(R,[{key:"format",value:function(k,T){k===I.blotName&&!T?this.replaceWith(u.default.create(this.statics.scope)):o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"format",this).call(this,k,T)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(k,T){return this.parent.isolate(this.offset(this.parent),this.length()),k===this.parent.statics.blotName?(this.parent.replaceWith(k,T),this):(this.parent.unwrap(),o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"replaceWith",this).call(this,k,T))}}],[{key:"formats",value:function(k){return k.tagName===this.tagName?void 0:o(R.__proto__||Object.getPrototypeOf(R),"formats",this).call(this,k)}}]),R}(d.default);C.blotName="list-item",C.tagName="LI";var I=function(S){_(R,S),s(R,null,[{key:"create",value:function(k){var T=k==="ordered"?"OL":"UL",D=o(R.__proto__||Object.getPrototypeOf(R),"create",this).call(this,T);return(k==="checked"||k==="unchecked")&&D.setAttribute("data-checked",k==="checked"),D}},{key:"formats",value:function(k){if(k.tagName==="OL")return"ordered";if(k.tagName==="UL")return k.hasAttribute("data-checked")?k.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function R(L){b(this,R);var k=A(this,(R.__proto__||Object.getPrototypeOf(R)).call(this,L)),T=function(P){if(P.target.parentNode===L){var N=k.statics.formats(L),F=u.default.find(P.target);N==="checked"?F.format("list","unchecked"):N==="unchecked"&&F.format("list","checked")}};return L.addEventListener("touchstart",T),L.addEventListener("mousedown",T),k}return s(R,[{key:"format",value:function(k,T){this.children.length>0&&this.children.tail.format(k,T)}},{key:"formats",value:function(){return w({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(k,T){if(k instanceof C)o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"insertBefore",this).call(this,k,T);else{var D=T==null?this.length():T.offset(this),P=this.split(D);P.parent.insertBefore(k,P)}}},{key:"optimize",value:function(k){o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"optimize",this).call(this,k);var T=this.next;T!=null&&T.prev===this&&T.statics.blotName===this.statics.blotName&&T.domNode.tagName===this.domNode.tagName&&T.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(T.moveChildren(this),T.remove())}},{key:"replace",value:function(k){if(k.statics.blotName!==this.statics.blotName){var T=u.default.create(this.statics.defaultChild);k.moveChildren(T),this.appendChild(T)}o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"replace",this).call(this,k)}}]),R}(p.default);I.blotName="list",I.scope=u.default.Scope.BLOCK_BLOT,I.tagName=["OL","UL"],I.defaultChild="list-item",I.allowedChildren=[C],n.ListItem=C,n.default=I},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(56),o=a(s);function a(p){return p&&p.__esModule?p:{default:p}}function u(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function c(p,g){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:p}function d(p,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);p.prototype=Object.create(g&&g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(p,g):p.__proto__=g)}var m=function(p){d(g,p);function g(){return u(this,g),c(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g}(o.default);m.blotName="italic",m.tagName=["EM","I"],n.default=m},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function w(b,A){for(var _=0;_<A.length;_++){var C=A[_];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(b,C.key,C)}}return function(b,A,_){return A&&w(b.prototype,A),_&&w(b,_),b}}(),o=function w(b,A,_){b===null&&(b=Function.prototype);var C=Object.getOwnPropertyDescriptor(b,A);if(C===void 0){var I=Object.getPrototypeOf(b);return I===null?void 0:w(I,A,_)}else{if("value"in C)return C.value;var S=C.get;return S===void 0?void 0:S.call(_)}},a=r(6),u=c(a);function c(w){return w&&w.__esModule?w:{default:w}}function d(w,b){if(!(w instanceof b))throw new TypeError("Cannot call a class as a function")}function m(w,b){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:w}function p(w,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);w.prototype=Object.create(b&&b.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(w,b):w.__proto__=b)}var g=function(w){p(b,w);function b(){return d(this,b),m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,null,[{key:"create",value:function(_){return _==="super"?document.createElement("sup"):_==="sub"?document.createElement("sub"):o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,_)}},{key:"formats",value:function(_){if(_.tagName==="SUB")return"sub";if(_.tagName==="SUP")return"super"}}]),b}(u.default);g.blotName="script",g.tagName=["SUB","SUP"],n.default=g},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(6),o=a(s);function a(p){return p&&p.__esModule?p:{default:p}}function u(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function c(p,g){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:p}function d(p,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);p.prototype=Object.create(g&&g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(p,g):p.__proto__=g)}var m=function(p){d(g,p);function g(){return u(this,g),c(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g}(o.default);m.blotName="strike",m.tagName="S",n.default=m},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=r(6),o=a(s);function a(p){return p&&p.__esModule?p:{default:p}}function u(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function c(p,g){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:p}function d(p,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);p.prototype=Object.create(g&&g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(p,g):p.__proto__=g)}var m=function(p){d(g,p);function g(){return u(this,g),c(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g}(o.default);m.blotName="underline",m.tagName="U",n.default=m},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function A(_,C){for(var I=0;I<C.length;I++){var S=C[I];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(_,S.key,S)}}return function(_,C,I){return C&&A(_.prototype,C),I&&A(_,I),_}}(),o=function A(_,C,I){_===null&&(_=Function.prototype);var S=Object.getOwnPropertyDescriptor(_,C);if(S===void 0){var R=Object.getPrototypeOf(_);return R===null?void 0:A(R,C,I)}else{if("value"in S)return S.value;var L=S.get;return L===void 0?void 0:L.call(I)}},a=r(0),u=d(a),c=r(27);function d(A){return A&&A.__esModule?A:{default:A}}function m(A,_){if(!(A instanceof _))throw new TypeError("Cannot call a class as a function")}function p(A,_){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:A}function g(A,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);A.prototype=Object.create(_&&_.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(A,_):A.__proto__=_)}var w=["alt","height","width"],b=function(A){g(_,A);function _(){return m(this,_),p(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return s(_,[{key:"format",value:function(I,S){w.indexOf(I)>-1?S?this.domNode.setAttribute(I,S):this.domNode.removeAttribute(I):o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"format",this).call(this,I,S)}}],[{key:"create",value:function(I){var S=o(_.__proto__||Object.getPrototypeOf(_),"create",this).call(this,I);return typeof I=="string"&&S.setAttribute("src",this.sanitize(I)),S}},{key:"formats",value:function(I){return w.reduce(function(S,R){return I.hasAttribute(R)&&(S[R]=I.getAttribute(R)),S},{})}},{key:"match",value:function(I){return/\.(jpe?g|gif|png)$/.test(I)||/^data:image\/.+;base64/.test(I)}},{key:"sanitize",value:function(I){return(0,c.sanitize)(I,["http","https","data"])?I:"//:0"}},{key:"value",value:function(I){return I.getAttribute("src")}}]),_}(u.default.Embed);b.blotName="image",b.tagName="IMG",n.default=b},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function A(_,C){for(var I=0;I<C.length;I++){var S=C[I];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(_,S.key,S)}}return function(_,C,I){return C&&A(_.prototype,C),I&&A(_,I),_}}(),o=function A(_,C,I){_===null&&(_=Function.prototype);var S=Object.getOwnPropertyDescriptor(_,C);if(S===void 0){var R=Object.getPrototypeOf(_);return R===null?void 0:A(R,C,I)}else{if("value"in S)return S.value;var L=S.get;return L===void 0?void 0:L.call(I)}},a=r(4),u=r(27),c=d(u);function d(A){return A&&A.__esModule?A:{default:A}}function m(A,_){if(!(A instanceof _))throw new TypeError("Cannot call a class as a function")}function p(A,_){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:A}function g(A,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);A.prototype=Object.create(_&&_.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(A,_):A.__proto__=_)}var w=["height","width"],b=function(A){g(_,A);function _(){return m(this,_),p(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return s(_,[{key:"format",value:function(I,S){w.indexOf(I)>-1?S?this.domNode.setAttribute(I,S):this.domNode.removeAttribute(I):o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"format",this).call(this,I,S)}}],[{key:"create",value:function(I){var S=o(_.__proto__||Object.getPrototypeOf(_),"create",this).call(this,I);return S.setAttribute("frameborder","0"),S.setAttribute("allowfullscreen",!0),S.setAttribute("src",this.sanitize(I)),S}},{key:"formats",value:function(I){return w.reduce(function(S,R){return I.hasAttribute(R)&&(S[R]=I.getAttribute(R)),S},{})}},{key:"sanitize",value:function(I){return c.default.sanitize(I)}},{key:"value",value:function(I){return I.getAttribute("src")}}]),_}(a.BlockEmbed);b.blotName="video",b.className="ql-video",b.tagName="IFRAME",n.default=b},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=function(){function I(S,R){for(var L=0;L<R.length;L++){var k=R[L];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(S,k.key,k)}}return function(S,R,L){return R&&I(S.prototype,R),L&&I(S,L),S}}(),o=function I(S,R,L){S===null&&(S=Function.prototype);var k=Object.getOwnPropertyDescriptor(S,R);if(k===void 0){var T=Object.getPrototypeOf(S);return T===null?void 0:I(T,R,L)}else{if("value"in k)return k.value;var D=k.get;return D===void 0?void 0:D.call(L)}},a=r(35),u=g(a),c=r(5),d=g(c),m=r(9),p=g(m);function g(I){return I&&I.__esModule?I:{default:I}}function w(I,S){if(!(I instanceof S))throw new TypeError("Cannot call a class as a function")}function b(I,S){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:I}function A(I,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);I.prototype=Object.create(S&&S.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(I,S):I.__proto__=S)}var _=function(I){A(S,I);function S(){return w(this,S),b(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,null,[{key:"create",value:function(L){var k=o(S.__proto__||Object.getPrototypeOf(S),"create",this).call(this,L);return typeof L=="string"&&(window.katex.render(L,k,{throwOnError:!1,errorColor:"#f00"}),k.setAttribute("data-value",L)),k}},{key:"value",value:function(L){return L.getAttribute("data-value")}}]),S}(u.default);_.blotName="formula",_.className="ql-formula",_.tagName="SPAN";var C=function(I){A(S,I),s(S,null,[{key:"register",value:function(){d.default.register(_,!0)}}]);function S(){w(this,S);var R=b(this,(S.__proto__||Object.getPrototypeOf(S)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return R}return S}(p.default);n.FormulaBlot=_,n.default=C},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=function(){function L(k,T){for(var D=0;D<T.length;D++){var P=T[D];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(k,P.key,P)}}return function(k,T,D){return T&&L(k.prototype,T),D&&L(k,D),k}}(),o=function L(k,T,D){k===null&&(k=Function.prototype);var P=Object.getOwnPropertyDescriptor(k,T);if(P===void 0){var N=Object.getPrototypeOf(k);return N===null?void 0:L(N,T,D)}else{if("value"in P)return P.value;var F=P.get;return F===void 0?void 0:F.call(D)}},a=r(0),u=b(a),c=r(5),d=b(c),m=r(9),p=b(m),g=r(13),w=b(g);function b(L){return L&&L.__esModule?L:{default:L}}function A(L,k){if(!(L instanceof k))throw new TypeError("Cannot call a class as a function")}function _(L,k){if(!L)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:L}function C(L,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);L.prototype=Object.create(k&&k.prototype,{constructor:{value:L,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(L,k):L.__proto__=k)}var I=function(L){C(k,L);function k(){return A(this,k),_(this,(k.__proto__||Object.getPrototypeOf(k)).apply(this,arguments))}return s(k,[{key:"replaceWith",value:function(D){this.domNode.textContent=this.domNode.textContent,this.attach(),o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"replaceWith",this).call(this,D)}},{key:"highlight",value:function(D){var P=this.domNode.textContent;this.cachedText!==P&&((P.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=D(P),this.domNode.normalize(),this.attach()),this.cachedText=P)}}]),k}(w.default);I.className="ql-syntax";var S=new u.default.Attributor.Class("token","hljs",{scope:u.default.Scope.INLINE}),R=function(L){C(k,L),s(k,null,[{key:"register",value:function(){d.default.register(S,!0),d.default.register(I,!0)}}]);function k(T,D){A(this,k);var P=_(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,T,D));if(typeof P.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var N=null;return P.quill.on(d.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(N),N=setTimeout(function(){P.highlight(),N=null},P.options.interval)}),P.highlight(),P}return s(k,[{key:"highlight",value:function(){var D=this;if(!this.quill.selection.composing){this.quill.update(d.default.sources.USER);var P=this.quill.getSelection();this.quill.scroll.descendants(I).forEach(function(N){N.highlight(D.options.highlight)}),this.quill.update(d.default.sources.SILENT),P!=null&&this.quill.setSelection(P,d.default.sources.SILENT)}}}]),k}(p.default);R.DEFAULTS={highlight:function(){return window.hljs==null?null:function(L){var k=window.hljs.highlightAuto(L);return k.value}}(),interval:1e3},n.CodeBlock=I,n.CodeToken=S,n.default=R},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function k(T,D,P){T===null&&(T=Function.prototype);var N=Object.getOwnPropertyDescriptor(T,D);if(N===void 0){var F=Object.getPrototypeOf(T);return F===null?void 0:k(F,D,P)}else{if("value"in N)return N.value;var M=N.get;return M===void 0?void 0:M.call(P)}},o=function(){function k(T,D){for(var P=0;P<D.length;P++){var N=D[P];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(T,N.key,N)}}return function(T,D,P){return D&&k(T.prototype,D),P&&k(T,P),T}}(),a=r(3),u=A(a),c=r(8),d=A(c),m=r(43),p=A(m),g=r(15),w=r(41),b=A(w);function A(k){return k&&k.__esModule?k:{default:k}}function _(k,T){if(!(k instanceof T))throw new TypeError("Cannot call a class as a function")}function C(k,T){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:k}function I(k,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);k.prototype=Object.create(T&&T.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(k,T):k.__proto__=T)}var S=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],R=function(k){I(T,k);function T(D,P){_(this,T),P.modules.toolbar!=null&&P.modules.toolbar.container==null&&(P.modules.toolbar.container=S);var N=C(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,D,P));return N.quill.container.classList.add("ql-bubble"),N}return o(T,[{key:"extendToolbar",value:function(P){this.tooltip=new L(this.quill,this.options.bounds),this.tooltip.root.appendChild(P.container),this.buildButtons([].slice.call(P.container.querySelectorAll("button")),b.default),this.buildPickers([].slice.call(P.container.querySelectorAll("select")),b.default)}}]),T}(p.default);R.DEFAULTS=(0,u.default)(!0,{},p.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(T){T?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var L=function(k){I(T,k);function T(D,P){_(this,T);var N=C(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,D,P));return N.quill.on(d.default.events.EDITOR_CHANGE,function(F,M,$,Q){if(F===d.default.events.SELECTION_CHANGE)if(M!=null&&M.length>0&&Q===d.default.sources.USER){N.show(),N.root.style.left="0px",N.root.style.width="",N.root.style.width=N.root.offsetWidth+"px";var ie=N.quill.getLines(M.index,M.length);if(ie.length===1)N.position(N.quill.getBounds(M));else{var ee=ie[ie.length-1],ue=N.quill.getIndex(ee),Y=Math.min(ee.length()-1,M.index+M.length-ue),J=N.quill.getBounds(new g.Range(ue,Y));N.position(J)}}else document.activeElement!==N.textbox&&N.quill.hasFocus()&&N.hide()}),N}return o(T,[{key:"listen",value:function(){var P=this;s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){P.root.classList.remove("ql-editing")}),this.quill.on(d.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!P.root.classList.contains("ql-hidden")){var N=P.quill.getSelection();N!=null&&P.position(P.quill.getBounds(N))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(P){var N=s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"position",this).call(this,P),F=this.root.querySelector(".ql-tooltip-arrow");if(F.style.marginLeft="",N===0)return N;F.style.marginLeft=-1*N-F.offsetWidth/2+"px"}}]),T}(m.BaseTooltip);L.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=L,n.default=R},function(t,n,r){t.exports=r(63)}]).default})}(r_)),r_.exports}var mo,mL;function lJ(){if(mL)return mo;mL=1;var i=mo&&mo.__extends||function(){var d=function(m,p){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,w){g.__proto__=w}||function(g,w){for(var b in w)w.hasOwnProperty(b)&&(g[b]=w[b])},d(m,p)};return function(m,p){d(m,p);function g(){this.constructor=m}m.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}}(),e=mo&&mo.__assign||function(){return e=Object.assign||function(d){for(var m,p=1,g=arguments.length;p<g;p++){m=arguments[p];for(var w in m)Object.prototype.hasOwnProperty.call(m,w)&&(d[w]=m[w])}return d},e.apply(this,arguments)},t=mo&&mo.__spreadArrays||function(){for(var d=0,m=0,p=arguments.length;m<p;m++)d+=arguments[m].length;for(var g=Array(d),w=0,m=0;m<p;m++)for(var b=arguments[m],A=0,_=b.length;A<_;A++,w++)g[w]=b[A];return g},n=mo&&mo.__importDefault||function(d){return d&&d.__esModule?d:{default:d}},r=n(q1()),s=n(ST()),o=n(sJ()),a=n(aJ()),u=function(d){i(m,d);function m(p){var g=d.call(this,p)||this;g.dirtyProps=["modules","formats","bounds","theme","children"],g.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],g.state={generation:0},g.selection=null,g.onEditorChange=function(b,A,_,C){var I,S,R,L;b==="text-change"?(S=(I=g).onEditorChangeText)===null||S===void 0||S.call(I,g.editor.root.innerHTML,A,C,g.unprivilegedEditor):b==="selection-change"&&((L=(R=g).onEditorChangeSelection)===null||L===void 0||L.call(R,A,C,g.unprivilegedEditor))};var w=g.isControlled()?p.value:p.defaultValue;return g.value=w??"",g}return m.prototype.validateProps=function(p){var g;if(r.default.Children.count(p.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(r.default.Children.count(p.children)){var w=r.default.Children.only(p.children);if(((g=w)===null||g===void 0?void 0:g.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&p.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},m.prototype.shouldComponentUpdate=function(p,g){var w=this,b;if(this.validateProps(p),!this.editor||this.state.generation!==g.generation)return!0;if("value"in p){var A=this.getEditorContents(),_=(b=p.value,b??"");this.isEqualValue(_,A)||this.setEditorContents(this.editor,_)}return p.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,p.readOnly),t(this.cleanProps,this.dirtyProps).some(function(C){return!o.default(p[C],w.props[C])})},m.prototype.shouldComponentRegenerate=function(p){var g=this;return this.dirtyProps.some(function(w){return!o.default(p[w],g.props[w])})},m.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},m.prototype.componentWillUnmount=function(){this.destroyEditor()},m.prototype.componentDidUpdate=function(p,g){var w=this;if(this.editor&&this.shouldComponentRegenerate(p)){var b=this.editor.getContents(),A=this.editor.getSelection();this.regenerationSnapshot={delta:b,selection:A},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==g.generation){var _=this.regenerationSnapshot,b=_.delta,C=_.selection;delete this.regenerationSnapshot,this.instantiateEditor();var I=this.editor;I.setContents(b),c(function(){return w.setEditorSelection(I,C)})}},m.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},m.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},m.prototype.isControlled=function(){return"value"in this.props},m.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},m.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},m.prototype.createEditor=function(p,g){var w=new a.default(p,g);return g.tabIndex!=null&&this.setEditorTabIndex(w,g.tabIndex),this.hookEditor(w),w},m.prototype.hookEditor=function(p){this.unprivilegedEditor=this.makeUnprivilegedEditor(p),p.on("editor-change",this.onEditorChange)},m.prototype.unhookEditor=function(p){p.off("editor-change",this.onEditorChange)},m.prototype.getEditorContents=function(){return this.value},m.prototype.getEditorSelection=function(){return this.selection},m.prototype.isDelta=function(p){return p&&p.ops},m.prototype.isEqualValue=function(p,g){return this.isDelta(p)&&this.isDelta(g)?o.default(p.ops,g.ops):o.default(p,g)},m.prototype.setEditorContents=function(p,g){var w=this;this.value=g;var b=this.getEditorSelection();typeof g=="string"?p.setContents(p.clipboard.convert(g)):p.setContents(g),c(function(){return w.setEditorSelection(p,b)})},m.prototype.setEditorSelection=function(p,g){if(this.selection=g,g){var w=p.getLength();g.index=Math.max(0,Math.min(g.index,w-1)),g.length=Math.max(0,Math.min(g.length,w-1-g.index)),p.setSelection(g)}},m.prototype.setEditorTabIndex=function(p,g){var w,b;!((b=(w=p)===null||w===void 0?void 0:w.scroll)===null||b===void 0)&&b.domNode&&(p.scroll.domNode.tabIndex=g)},m.prototype.setEditorReadOnly=function(p,g){g?p.disable():p.enable()},m.prototype.makeUnprivilegedEditor=function(p){var g=p;return{getHTML:function(){return g.root.innerHTML},getLength:g.getLength.bind(g),getText:g.getText.bind(g),getContents:g.getContents.bind(g),getSelection:g.getSelection.bind(g),getBounds:g.getBounds.bind(g)}},m.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var p=s.default.findDOMNode(this.editingArea);if(!p)throw new Error("Cannot find element for editing area");if(p.nodeType===3)throw new Error("Editing area cannot be a text node");return p},m.prototype.renderEditingArea=function(){var p=this,g=this.props,w=g.children,b=g.preserveWhitespace,A=this.state.generation,_={key:A,ref:function(C){p.editingArea=C}};return r.default.Children.count(w)?r.default.cloneElement(r.default.Children.only(w),_):b?r.default.createElement("pre",e({},_)):r.default.createElement("div",e({},_))},m.prototype.render=function(){var p;return r.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(p=this.props.className,p??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},m.prototype.onEditorChangeText=function(p,g,w,b){var A,_;if(this.editor){var C=this.isDelta(this.value)?b.getContents():b.getHTML();C!==this.getEditorContents()&&(this.lastDeltaChangeSet=g,this.value=C,(_=(A=this.props).onChange)===null||_===void 0||_.call(A,p,g,w,b))}},m.prototype.onEditorChangeSelection=function(p,g,w){var b,A,_,C,I,S;if(this.editor){var R=this.getEditorSelection(),L=!R&&p,k=R&&!p;o.default(p,R)||(this.selection=p,(A=(b=this.props).onChangeSelection)===null||A===void 0||A.call(b,p,g,w),L?(C=(_=this.props).onFocus)===null||C===void 0||C.call(_,p,g,w):k&&((S=(I=this.props).onBlur)===null||S===void 0||S.call(I,R,g,w)))}},m.prototype.focus=function(){this.editor&&this.editor.focus()},m.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},m.displayName="React Quill",m.Quill=a.default,m.defaultProps={theme:"snow",modules:{},readOnly:!1},m}(r.default.Component);function c(d){Promise.resolve().then(d)}return mo=u,mo}var uJ=lJ();const cJ=M0(uJ);class hJ extends wp{constructor(e){super(e),this.quillRef=ze.createRef()}getFormHtml(){return v.jsx("div",{children:v.jsx(cJ,{ref:this.quillRef,modules:{toolbar:[["bold","italic","underline","blockquote"],[{color:["#F4F5F8","#E6FFFD","#99AFD1","#ecd23a","#fd5259","#D7ABF7","#9EFFA0","#F4F5F888","#E6FFFD77","#99AFD188","#ecd23a88","#fd525988","#D7ABF788","#9EFFA088","#000000","#E6FFFD44","#99AFD155","#ecd23a55","#fd525955","#D7ABF755","#9EFFA055"]},{background:[!1,"black","#00274D","#C1A71B","#5F0C0C","#4B0082","#002E07"]}],[,"code-block"],[{list:"ordered"},{list:"bullet"},{align:[]}],[{indent:"-1"},{indent:"+1"}],[{size:["small",!1,"large","huge"]}],[],["clean"]]},style:this.props.wrapperStyle?{...this.props.wrapperStyle}:{minHeight:"100%",padding:"8px",minWidth:"99%",width:"100%"},theme:"snow",value:this.obj[0].getJson()[this.props.name],onChange:this.objDispatch})})}}class jB extends eh{constructor(e){super(e)}createFileInfo(e){const t=new Date,n=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0");let o="images/"+`${Math.floor(Math.random()*9999)}-${n+r}`+e.target.files[0].name;return this.fileInfo={selectedFile:e.target.files[0],path:o,pic:URL.createObjectURL(e.target.files[0])},this.setState({...this.fileInfo}),this.fileInfo}async prepareOnChange(){let e=await this.operationsFactory.prepare({prepare:{...this.props.prepareOnChange},clean:!0});e=e[0],this.obj=e}async changeHandler(e){var n;await this.createFileInfo(e),this.props.prepareOnChange&&await this.prepareOnChange(),this.props.callBackFunc&&await this.props.callBackFunc(this.obj,this.fileInfo);let t;if(await this.APIService.uploadPics(this.fileInfo.selectedFile,this.fileInfo.path),!this.obj.getPicSrc){if(t=await this.APIService.downloadPics(this.fileInfo.path),!this.props.skipUpdate&&!this.state.skipUpdate)if((n=this.obj)!=null&&n.length)for(let r of this.obj)await r.setCompState({[this.props.uploadAttribute||"picURL"]:t});else await this.obj.setCompState({[this.props.uploadAttribute||"picURL"]:t});this.props.downloadPicsCallBackFunc&&this.props.downloadPicsCallBackFunc(this.obj,this.fileInfo)}return this.props.runOnChange&&this.onSubmit(),t}async onSubmit(){this.props.prepareOnChange&&await this.operationsFactory.addToComponentList(),await this.obj.update(),this.props.finishCallBackFunc&&this.props.finishCallBackFunc(this.obj),this.dispatch({imgUploaded:this.obj})}additionalSetup(){this.wrapper.setStyle({maxWidth:"300px",maxHeight:"30px",width:"fit-content"}),this.label.setStyle({display:"inline-block",height:"35px",maxWidth:"fit-content",cursor:"pointer",position:"relative"}),this.form.updateProps({accept:"image/png, image/gif, image/jpeg, image/jpg, image/webp, image/svg+xml, application/pdf",style:{position:"absolute",top:0,left:0,cursor:"pointer",width:"100%",height:"100%",opacity:0},size:"6",type:"file",name:"file",onChange:this.changeHandler})}getInnerContent(){let e=this.getFormHtml();return this.innerContent=[this.label.getHtml({content:e,type:"label"}),this.props.errorText&&this.error.getHtml()],this.innerContent}getFormHtml(){return this.content=this.props.content||v.jsx(v.Fragment,{children:"Upload"}),v.jsxs("div",{className:this.props.containerStyle||"defaultButton",children:[this.content,this.form.getHtml({type:"input"})]})}}class dJ extends jB{constructor(e){super(e)}getFormHtml(){var t,n;this.content=this.props.content||v.jsx(v.Fragment,{children:"Upload"});let e=(n=(t=this.obj)==null?void 0:t[0])==null?void 0:n.getJson()[this.props.uploadImgAttribute||"picURL"];return v.jsxs(v.Fragment,{children:[v.jsxs("div",{style:this.props.containerStyle,className:this.props.containerClass||"defaultButton",children:[this.content,this.form.getHtml({type:"input"})]}),(this.state.pic||e)&&v.jsx("img",{style:this.props.uploadedImgStyle,className:this.props.uploadedImgClass||"uploadedImg",src:this.state.pic||e})]})}}let fJ=class extends eh{constructor(e){super(e),this.state.formClass="FCDefaultDelButton",this.content="Delete"}buttonClickFunc(){this.props.obj.del()}};class pJ extends IB{constructor(){super(...arguments);re(this,"factory",{input:wp,textarea:wp,select:wp,math:VG,addButton:jG,baseButton:eh,popupButton:HG,updateButton:zG,runButton:$G,quill:hJ,upload:jB,showUpload:dJ,del:fJ})}}class UI extends ct{constructor(){super();re(this,"addToProps",{});re(this,"addToInitialSetup",[]);re(this,"getterFunc");this.state={}}getProps(){return{interface:this.interface,app:this.app,theme:this.props.theme,type:this.props.type,...this.props,...this.addToProps}}setComponentList(){var t;this.componentList=(t=this.interface)==null?void 0:t.getComponentList()}setProps(){}getHtml(){this.setProps();let t=this.getProps();return this.setGetterFunc(this.props.getterFunc),this.getterFunc&&(this.html=this.getterFunc({...t},t.type||this.state.type)),v.jsx(v.Fragment,{children:this.html})}setGetterFunc(t){this.getterFunc=t||this.interface.getMainFunc()||this.getterFunc}addToFactory(){if(this.props.addToFactory){let t=this.interface.getFactory();for(let n of this.props.addToFactory)t.registerComponent(n.type,n.comp)}}preSetup(){this.componentPreSetup(),this.initialSetupFunctions=[...this.initialSetupFunctions,this.setComponentList,this.addToFactory,...this.addToInitialSetup]}componentPreSetup(){}}class qB extends eg{constructor(){super(...arguments);re(this,"mainFunc",this.getFormComponent)}getFactory(){return this.factory===void 0&&(this.factory=new pJ),this.factory}getThemeFactory(){return this.themeFactory===void 0&&(this.themeFactory=new BG),this.themeFactory}getFormComponent(t,n){return n=n||"input",this.factory.getComponent(n,t)}}const UB=new qB;class Qe extends UI{constructor(e){super(e),this.state={type:"input"},this.interface=UB}}class bb extends Qe{constructor(e){super(e),this.state={type:"popupButton"}}}class Q0 extends Qe{constructor(e){super(e),this.state={type:"updateButton"}}}class Es extends Qe{constructor(e){super(e),this.state={type:"runButton"}}}class mJ extends Qe{constructor(e){super(e),this.state={type:e.uploadType||"upload"}}}class ng extends Qe{constructor(e){super(e),this.state={type:e.uploadType||"del"}}}class Ei extends ct{constructor(e){super(e),this.initialPropsSetupFunctions=[...this.initialPropsSetupFunctions,this.setCell,this.getUseId],this.state={...this.state,defaultTheme:"defaultColumn",interface:"map",wrapperClass:"MCCell",linkClass:"MCLink"},this.setItemPropsRan=!1}setCell(){this.cell=this.props.cell}preSetup(){this.setComponents(["link","wrapper","item","option"])}setitemprops(){let e={...this.createPropObj("item","cell"),className:this.cell.class||this.theme[this.state.classKey],style:this.cell.style};this.cell.itemClick&&(e.checkItemClick=!0),this.setItemPropsRan?this.item.setProps(e):(this.builderObserver.subscribe(e),this.setItemPropsRan=!0)}setwrapperprops(){let e={...this.createPropObj("wrapper","cell")};this.setWrapperPropsRan?this.wrapper.setProps(e):(this.builderObserver.subscribe(e),this.setWrapperPropsRan=!0)}getOption(){return v.jsx(v.Fragment,{})}getUseId(){return this.cell&&this.obj.getJson&&(this.useId=this.cell.useId===!1?"":this.cell.useId===void 0?this.obj.getJson()._id:this.obj.getJson()[this.cell.useId]),this.useId}getInnerContent(){return this.innerContent=[this.item.getHtml({type:this.state.itemType||"span",content:this.getOption()})],this.innerContent}getLinkUrl(){var t,n,r;return(t=this.cell)!=null&&t.to?this.cell.to:`/${(r=(n=this.obj)==null?void 0:n.getJson())==null?void 0:r.type}/${this.useId}`}getLinkFunc(){if(this.cell.forceUpdate){let e=()=>{this.dispatch({forceUpdate:this.cell.forceUpdate})};this.link.setOnClick(e)}if(this.cell.linkClick){let e=()=>{this.cell.linkClick(this.obj),this.cell.forceUpdate&&this.dispatch({forceUpdate:this.cell.forceUpdate})};this.link.setOnClick(e)}}getHtml(){var t;this.mapInnerContent(),this.getLinkFunc(),this.cell.type;let e=(t=this.cell)!=null&&t.hasLink?this.link.getHtml({type:this.state.linkType||"link",content:this.innerContent,props:{to:this.getLinkUrl()}}):this.wrapper.getHtml({type:this.state.wrapperType||"span",content:this.innerContent});return this.html=v.jsx(v.Fragment,{children:e}),this.html}}class VI extends Ei{constructor(e){super(e),this.state.classKey="MCDelItem",this.initialPropsSetupFunctions=[...this.initialPropsSetupFunctions,this.setDel]}setDel(){this.cell.itemClick=this.del}del(){let e=this.props.app;this.cell.popop?e.dispatch({popupSwitch:"del",delComponent:this.obj}):this.obj.del()}getOption(){return v.jsx("div",{children:"X"})}}class HI extends Ei{constructor(e){super(e),this.state.classKey="MCEditItem",this.state.itemClick=this.edit}edit(){this.props.app.dispatch({popupSwitch:"edit",currentPopupComponent:this.obj})}getOption(){return"edit"}}class Ab extends Ei{constructor(e){super(e),this.state.classKey="MCAttributeItem"}getName(){let e=this.cell;this.name=e.name,this.name||(this.name=e)}getOption(){return this.getName(),this.obj.getJson()[this.name]}}class gJ extends Ab{constructor(e){super(e),this.state.classKey="MCTextItem"}getOption(){return v.jsx(v.Fragment,{children:this.cell.name})}}class yJ extends Ei{constructor(e){super(e),this.state.classKey="MCCustom"}getOption(){let e=this.cell.custom;return v.jsx(e,{...this.props,masterCell:this})}}class VB extends Ei{constructor(e){super(e),this.state.defaultClassName="MCImgItem",this.state.itemType="img"}getPicSrc(){var e,t;return this.obj.getJson&&(this.src=(t=this.obj)==null?void 0:t.getJson()[((e=this.state.cell)==null?void 0:e.src)||"picURL"]),this.cell.imgSrc&&(this.src=this.cell.imgSrc),this.src}additionalPostSetup(){this.getPicSrc(),this.src&&this.item.addProps({src:this.src,alt:"picture goes here"})}}class vJ extends Ei{constructor(e){super(e)}getOption(){({...this.cell,...this.props})}}class zI extends Ei{constructor(e){super(e),this.initialPropsSetupFunctions=[...this.initialPropsSetupFunctions,this.setList,this.setFactory],this.state={...this.state,mapContainerClass:"MCMapContainer",interface:"map",mapSectionClass:"MCMapSection"},this.defaultTypes=["del","edit","img"]}setFactory(){this.factory=this.interface.getFactory()}getDefaultTypes(){return this.defaultTypes}checkCellForDefaults(e){let t=this.getDefaultTypes();return t[t.indexOf(e)]}textOrAttribute(e,t){return e.getJson&&(e!=null&&e.getJson()[t])?"attribute":"text"}getType(e,t){let n=e.type;return n||(n=this.checkCellForDefaults(e),n||(n=this.textOrAttribute(t,e))),n}getProps(e,t){return{obj:t,...this.props,interface:this.interface,cell:e,theme:this.props.theme}}getCellList(e){let t=this.props.cells;return v.jsx(v.Fragment,{children:t.map((n,r)=>{let s=this.getType(n,e),o=this.getProps(n,e);return this.factory.getComponent(s,o)})})}getListHtml(){return v.jsx(v.Fragment,{children:this.list.map((e,t)=>this.mapSection.getHtml({type:"div",content:this.getCellList(e)}))})}setList(){this.list=this.props.list}preSetup(){this.setComponents(["mapContainer","mapSection","link"])}getHtml(){let e=this.mapContainer.getHtml({type:"div",content:this.getListHtml()});return this.html=v.jsx(v.Fragment,{children:e}),this.html}}class gL extends VI{constructor(e){super(e),this.state.classKey="MCCustomDelItem"}getOption(){return v.jsx(this.cell.custom,{...this.props,masterCell:this})}}class wJ extends VI{constructor(e){super(e),this.state.classKey="MCDelItem"}getOption(){return this.props.delText||"delete"}}const _J="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAFRGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgICB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgZXhpZjpDb2xvclNwYWNlPSIxIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNDgiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI0OCIKICAgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIKICAgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIgogICB0aWZmOkltYWdlTGVuZ3RoPSI0OCIKICAgdGlmZjpJbWFnZVdpZHRoPSI0OCIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iNzIvMSIKICAgdGlmZjpZUmVzb2x1dGlvbj0iNzIvMSIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMy0wOS0wOFQxNDo0NDozNi0wNjowMCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjMtMDktMDhUMTQ6NDQ6MzYtMDY6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgeG1wTU06YWN0aW9uPSJwcm9kdWNlZCIKICAgICAgeG1wTU06c29mdHdhcmVBZ2VudD0iQWZmaW5pdHkgRGVzaWduZXIgMiAyLjEuMSIKICAgICAgeG1wTU06d2hlbj0iMjAyMy0wOC0wNFQxMDoyNTozOC0wNjowMCIvPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJwcm9kdWNlZCIKICAgICAgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWZmaW5pdHkgRGVzaWduZXIgMiAyLjEuMSIKICAgICAgc3RFdnQ6d2hlbj0iMjAyMy0wOS0wOFQxNDo0NDozNi0wNjowMCIvPgogICAgPC9yZGY6U2VxPgogICA8L3htcE1NOkhpc3Rvcnk+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+zw4Y8wAAAYFpQ0NQc1JHQiBJRUM2MTk2Ni0yLjEAACiRdZHPK0RRFMc/ZshgRJmFhcUkZGE0KLGxmMmvwmJmlF+bmee9GTUzXu89SbbKVlFi49eCv4CtslaKSMmWNbFhes7z1Ejm3M49n/u995zuPRc8iaySM8vDkMtbRmw4EpyanglWPlGFjwDthJOKqY/HhxKUtPdbypx4HXJqlT73r9XMq6YCZT7hAUU3LOER4bFlS3d4SzigZJLzwifCHYZcUPjG0VMuPzucdvnTYSMRi4KnXjiY/sWpX6xkjJywvJyWXHZJ+bmP8xK/mp+MS2wWb8IkxjARgowySJReuuiXuZcQ3XTKihL54e/8CRYlV5FZZwWDBdJksOgQdUmqqxI10VUZWVac/v/tq6n1dLvV/RGoeLTt11ao3ITChm1/HNh24RC8D3CeL+Yv7kPfm+gbRa1lD+rW4PSiqKW24WwdGu/1pJH8lrziHk2Dl2OonYaGK6iedXv2s8/RHSRW5asuYWcX2uR83dwXqRtoBLx59Y4AAAAJcEhZcwAACxMAAAsTAQCanBgAAAU5SURBVGiB1ZpfbFNVHMc/bW/H7d3WGujaMeqy8ECMEcgiICDDOI0hEpco8iDECMHEByBRSAwvxCgJ0ZhIzEBjAma8QEyEBwUejEyibg/GYcKYYRCIQEHaVZa2621v/10f7m1pu/5d/9B9k5vc3nvOuZ9v77nn3+8YqIFsdpcIPA88CzhyDgBvzjEGjPh97ki1zzbMNaPN7rIBLwH9aPBihUVEgBHgIjDs97n9c+Go2IDN7rIAO4B3AWkuD82jEHACGPL73OFKMpZtwGZ3mYA3gT2AvSK88jUFHAXO+H3uRDkZyjJgs7s6gUHgmbmzVaSrwB6/z+0pldBUKoHN7loBDAE9VWMVkNEI/WstrZtfbG1f+qTZ/J8/sWgmpL4qStYxRQ4UNVH0DdjsrgHgENBSS+BMdTkF4ehH9q6VT7Wkvyc5oiYPfzX94PS5GR9w0O9z/1Aof8E3oMN/VixNtVriFITTRxzdy3rMWS2YWTAY+tdZ2uWwql6eUPpEyXpXkQOT+crIC6dXm8FC92uhJU5BOHXE0e3qFAq+3b5VYpscVuOXJ5TnRMk6mq86zQLUP9ghoL2mxDn6/MCizt6nF2Q1w6oKhpxK3bdKbPM9TCTHr0fXipL1giIHQpn3swzoTeW31PGDTem3PyOhvtWi1LHQZE5dMxg0E6nzlNb1iq0/DsuJwEyyV5SsZxU5oKbuGXPK3UKDmkp/MJncvs97d+JGNKvjyn0DABbRYHx5vaUVWA68kXkvbUDvYffWhRbocQnmbQNttsxrgRnNxPj10iYcdpOgn+7VWYHsN7CDOvWwPS7BfOoLZ/eh9xcu3rW1/YnMe8FQMvn2fu/dK9eicrEyJm/GFP20A3gndd0E6YHZl4B5dtbqlIJ32rW63rfa0haSk/G//o6mR6LRmKqevyQH1/UusHR2CLMYJm5Ew58cm/aq6ZrPclGyfqfIAcUEIErWzcCmesOnVNhEOLh25QLLYscjE+4H8ejOA1PuQDCZzCiiBbilyIFrKQO7gaWNgC9mIhZT1XOX5OCaFaLY5RRa3A/i0bc+8N6574nH85WhyIELJn0y8jEg5EtUD/iiJuKo5y/JwS6HIOz/9OG/heCBLlGynjSJkvUFYKDe8L/+EQke/nra+8oGqV0wPWpn8pmIx+Gn38MzwVBWtcmVAIybRMm6FeitN/x7B6fu37gdi169Hgtv2ljaRJnymETJ+jqwrN7w0ZjWhty+F49N3opFXutvzeoT+lZb2nzTidj4ZFShfN0z8mjiXXd4gBazwbB9ILsvAPD4ErHRy5GifUEeOao2UCn8N4c6ujauEbMGih5fIrZtn+fOP+54rMLHV2fgMcODbmBOagJ4QBsLeecrPOCt2EATwUOlBpoMHiox0ITwoBsYm6fwAGNGtAXWgl14E8NHgFGjvsQ9Ms/gQV+eT/UDw/MMHrRl+fSc+CLaEndaTQ4fQv/TjQB6cOFEZoomhgc4ngqIZA4lhtDW5/OqieCngJOpH2kDemTkaKFcTQIPMJgZxckdzJ1BCy4U1GOGHwfOZl6YtQZms7ucwPc3h7s3lFtqg+CngK25UZtZw2k9we5yS20QfJQCIae88wG/z32lnFIbBA9alCYv05wnNA385z8sFmIqGaXUozXHqF9otZCm0KpN0dpQMoSkyAGPKFkvAKuowQpGmRoHdvp97lulElYa6N6CFkOoZ6B7EDhb00B3pjK2GuwCWivNX0Ah4Dhwsm5bDXKlxxT60TZ8VLPZ42fgl4Zt9sgnfYV7PZVttxmtxXab/wFJap9Ow0di3gAAAABJRU5ErkJggg==";class bJ extends HI{constructor(e){super(e),this.state.classKey="MCEditImgItem",this.state.itemType="img"}additionalPostSetup(){this.getImg(),this.item.setProps({src:this.src})}getImg(){return this.src=this.cell.imgSrc||_J,this.src}}class AJ extends HI{constructor(e){super(e),this.state.classKey="MCCustomEditItem"}getOption(){return v.jsx(this.cell.custom,{...this.props,masterCell:this})}}let EJ=class extends zI{constructor(e){super(e),this.mapContainer=ze.createRef(),this.initialPropsSetupFunctions=[...this.initialPropsSetupFunctions,this.getPicObj,this.getAddComponentButton],this.state={...this.state,index:0,isDragging:void 0,defaultTheme:"interactiveMap"}}_addEventListeners(){var t;this.props;let e=[];for(let n of this.list){let r=document.getElementById(n.getJson()._id);r.addEventListener("mousedown",s=>{this.setState({isDragging:r})}),r.addEventListener("mouseup",s=>{this.setState({isDragging:void 0})}),e.push(r),this.setState({saveList:e})}(t=this.mapContainer)!=null&&t.current&&(this.mapContainer.current.addEventListener("mouseup",n=>{this.currentComp!==void 0&&this.currentComp.update(),this.setState({isDragging:void 0})}),this.mapContainer.current.addEventListener("mousemove",n=>{if(this.state.isDragging!==void 0){let r=this.state.isDragging,s=r.id,o=this.list.find(a=>a.getJson()._id===s);if((o==null?void 0:o.getJson().draggable)!==!1){const a=this.mapContainer.current.getBoundingClientRect(),u=n.pageX-a.left-25,c=n.pageY-a.top-25;o.setCompState({x:u,y:c}),this.currentComp=o,r.style.left=`${u}px`,r.style.top=`${c}px`}}}))}componentDidMount(){this._addEventListeners()}zoom(e){let t=this.mapContainer.current.getBoundingClientRect(),n=t.width*e,r=t.height*e;this.mapContainer.current.style.width=n+"px",this.mapContainer.current.style.height=r+"px";let s=this.state.saveList;for(let o of s){const a=o.style.left||"0",u=o.style.top||"0",c=a.match(/(-?\d*\.?\d+)/),d=u.match(/(-?\d*\.?\d+)/),m=c?parseFloat(c[0]):0,p=d?parseFloat(d[0]):0,g=m*e,w=p*e;o.style.left=g+"px",o.style.top=w+"px"}}componentDidUpdate(e,t){this.props.list.length!==e.list.length&&this._addEventListeners()}getAddComponentButton(){var e,t;if(this.addComponentButton=this.props.addComponentButton,this.addComponentButton!==void 0){let n=typeof this.addComponentButton=="string"?this.addComponentButton:this.addComponentButton.type||"addComponentButton",r=this.props.pinKey||((e=this.mapObj)==null?void 0:e.getJson().pinType)||"pin";this.addComponentButton=this.factory.getComponent(n,{...this.props,theme:this.props.theme||this.state.defaultTheme,mapId:this.mapObj?(t=this.mapObj)==null?void 0:t.getJson()._id:void 0,addType:r,addPinProps:this.props.addPinProps,pinAdded:this._addEventListeners})}}getPicObj(){var t;let e=this.props.imgAttribute||"picURL";this.mapObj&&(this.picSrc=(t=this.mapObj)==null?void 0:t.getJson()[e])}preSetup(){this.setComponents([])}async changePic(e){let t=this.props.list;e=e<0?e=t.length-1:e,e=e>=t.length?0:e,this.mapObj=t[e],await this.setState({index:e}),this._addEventListeners()}setList(){if(!this.listSet){let t=this.props.list[this.state.index];this.mapObj=t;let n=this.props.pinKey||(t==null?void 0:t.getJson().pinType)||"pin",r=this.props.pinAttribute||(t==null?void 0:t.getJson().type)+"Id"||"mapId",s=this.props.mapId||(t==null?void 0:t.getJson()._id);this.list=this.componentList.getList(n,s,r)}}preSetup(){this.setComponents(["mapContainer","right","left","image","zoomIn","zoomOut"])}getIndexAndChangeMap(e){let t=this.props.list.indexOf(this.mapObj)+e;this.changePic(t)}getListHtml(){let e=this.props,t=this.theme,n=this.factory;return v.jsx(v.Fragment,{children:this.list.map((r,s)=>{let o={obj:r,props:e,interface:this.interface,cell:e.pinCell,theme:this.props.them||this.state.defaultTheme,pinProps:this.props.pinProps};return v.jsx("div",{id:r.getJson()._id,className:e.mapSectionClass?e.mapSectionClass:t.MCMapSection,style:{...e.mapSectionStyle,left:r.getJson().x+"px",top:r.getJson().y+"px"},children:v.jsx(v.Fragment,{children:n.getComponent(e.pinType?e.pinType:"attribute",o)})},s)})})}getHtml(){if(this.props.list.length>0){let e=this.props,t=this.theme;return v.jsxs("div",{ref:this.mapContainer,className:e.mapContainerClass?e.mapContainerClass:t.MCMapContainer,style:{...e.mapContainerStyle},children:[v.jsx("img",{src:this.picSrc,className:e.mapClass?e.mapClass:t.MCMap,style:{...e.mapStyle}}),this.getListHtml(),e.addComponentButton&&v.jsx(v.Fragment,{children:this.addComponentButton}),v.jsx("div",{style:{position:"absolute",top:"0px",right:"0px"},onClick:()=>{this.zoom(.5)},children:"zoom out"}),v.jsx("div",{style:{position:"absolute",top:"20px",right:"0px"},onClick:()=>{this.zoom(2)},children:"zoom in"}),v.jsx("div",{style:{position:"absolute",top:"0px",left:"-20px"},onClick:()=>{this.getIndexAndChangeMap(-1)},children:"prev"}),v.jsx("div",{style:{position:"absolute",top:"20px",right:"-20px"},onClick:()=>{this.getIndexAndChangeMap(1)},children:"next"})]})}else this.list=[]}};class CJ extends Ei{constructor(e){super(e)}preSetup(){this.setComponents([])}async createObjType(){let e=this.operationsFactory,t=this.props.addType;await e.prepare({prepare:{type:t,mapId:this.props.mapId,...this.props.addPinProps},clean:!0,run:!0}),this.props.pinAdded()}getHtml(){let e=this.props.text||"+ Add Item";return v.jsxs("div",{onClick:this.createObjType,style:this.props.style,className:this.props.class||this.theme.MCAddButton,children:[e," "]})}}class xJ extends Ei{constructor(e){super(e),this.state.classKey="MCAttributeItem"}getOption(){return this.state.obj}}class SJ extends Ab{constructor(e){super(e),this.state.classKey="MCAttributeItem"}getItemClass(){var r;let e=this.cell,t=e.activeAttribute?e.activeAttribute:"_id";if(this.state.obj.getJson()[t]===((r=e.activeItem)==null?void 0:r.getJson()[t])){let s=e.activeClass?e.activeClass:this.theme.MCActiveItem;this.item.setClass(this.item.getClass()+" "+s)}}additionalPostSetup(){this.getItemClass()}}class TJ extends VB{constructor(e){super(e),this.state.classKey="MCLogoItem"}}class IJ extends Ei{constructor(e){super(e),this.state.itemType="div"}getList(){return this.list=this.props.cell.links.filter(e=>(e==null?void 0:e.name)!==void 0),this.list}getHome(){var e;if(!this.state.active){this.home=this.list.find(t=>t.path==="/");for(let t of this.list)t.active=(e=this.home)==null?void 0:e.name}}getOption(){let e=this.props.cell.links.filter(t=>(t==null?void 0:t.name)!==void 0&&t.display!==!1);return v.jsx(er,{list:e,theme:this.cell.linksTheme||"links",mapSectionClass:this.props.cell.linkSectionClass||void 0,mapSectionStyle:this.props.cell.linkSectionStyle||void 0,cells:[{type:"linkItem",class:this.props.cell.linkItemClass||void 0,activeClass:this.props.cell.activeClass||void 0,style:this.props.cell.linkItemStyle||void 0,linkClick:t=>{for(let n of this.props.cell.links)n.active=t==null?void 0:t.name;this.setState({active:t==null?void 0:t.name})}}]})}additionalSetup(){this.getList(),this.getHome()}}class DJ extends Ei{constructor(e){super(e),this.initialPropsSetupFunctions=[...this.initialPropsSetupFunctions,this.setUpLinks],this.state.classKey="MCLinkItem",this.state.itemType="div"}setUpLinks(){this.cell.to=this.obj.path,this.useId="",this.cell.hasLink=!0}getActiveClass(){return this.activeClass=this.cell.activeClass||this.theme.MCActiveLink,this.activeClass}setActiveClass(){var n,r,s,o,a;const e=((n=this.obj)==null?void 0:n.path)==="/"||((r=this.obj)==null?void 0:r.path)==="/home",t=window.location.pathname;if(e){const u=t.split("/").filter(Boolean);if(u.length>0&&u[0]!=="home")return}if(((s=this.obj)==null?void 0:s.active)===((o=this.obj)==null?void 0:o.name)||t.includes((a=this.obj)==null?void 0:a.path)){let u=this.obj.name===""?"none":this.getActiveClass();u=u||"",this.item.setClass(this.item.getClass()+" "+u)}}additionalSetup(){this.setActiveClass()}getOption(){var e;return(e=this.props.obj)==null?void 0:e.name}}class kJ extends Ei{constructor(e){super(e),this.state.classKey="MCTextItem"}additionalPostSetup(){this.item.setOnClick(this.cell.logoutFunc||this.APIService.logout)}getOption(){return"logout"}}class RJ extends Ei{constructor(e){super(e),this.state.classKey="MCOrderedArrows",this.state.increment=1,this.state.decrement=-1}increasePosition(){this.obj.updateOrder(this.state.increment)}decreasePosition(){this.obj.updateOrder(this.state.decrement)}increaseArrowUI(){return this.increaseArrow=v.jsx("div",{className:"upward-arrow",onClick:this.decreasePosition}),this.increaseArrow}decreaseArrowUI(){return this.decreaseArrow=v.jsx("div",{style:{marginTop:"5px"},className:"downward-arrow",onClick:this.increasePosition}),this.decreaseArrow}getOption(){return this.increaseArrowUI(),this.decreaseArrowUI(),v.jsxs("div",{style:{marginTop:"-4px"},className:"fitCC",children:[this.increaseArrow,this.decreaseArrow]})}}class PJ extends Ei{constructor(e){super(e),this.state.displayState=!1,this.state.itemType="div"}displayOption(){return v.jsx("div",{style:{position:"absolute",left:"0px",top:"0px"},className:this.state.displayState?"downward-arrow":"right-arrow",onClick:()=>{this.wrapper.setStyle({...this.wrapper.getStyle(),height:"200px"}),this.setState({displayState:!this.state.displayState})}})}mapOption(){return v.jsx(er,{name:this.props.name,filter:{attribute:this.props.filter.attribute,search:this.obj.getJson()._id},cells:[...this.props.cells]})}additionalPostSetup(){this.item.setStyle({...this.item.getStyle(),position:"relative"})}getOption(){return v.jsxs("div",{style:{position:"absolute",width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[this.displayOption(),"  ",this.state.displayState&&this.mapOption(),"  "]})}}class NJ extends Ab{constructor(){super(),this.state.classKey="MCBackgroundItem",this.state.wrapperClass="MCCellBackground",this.state.linkClass="MCBackgroundLink"}additionalPostSetup(){let t={width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center",color:"white",textAlign:"center",fontSize:"50px",background:`linear-gradient(to bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(${this.cell.pirSRC||this.obj.getJson()[this.cell.picAttribute||"picURL"]}) no-repeat center center`,backgroundSize:"cover",textDecoration:"none"};this.wrapper.setStyle({...this.wrapper.getStyle(),...t}),this.link.setStyle({...this.wrapper.getStyle(),...t})}}class OJ extends Ei{constructor(e){super(e),this.state.classKey="MCCustom"}getOption(){return this.cell.custom}}const Eb=0,th=1,rg=2,HB=4;function yL(i){return()=>i}function LJ(i){i()}function zB(i,e){return t=>i(e(t))}function vL(i,e){return()=>i(e)}function FJ(i,e){return t=>i(e,t)}function $I(i){return i!==void 0}function MJ(...i){return()=>{i.map(LJ)}}function ig(){}function Cb(i,e){return e(i),i}function BJ(i,e){return e(i)}function vn(...i){return i}function Zt(i,e){return i(th,e)}function St(i,e){i(Eb,e)}function WI(i){i(rg)}function Sr(i){return i(HB)}function it(i,e){return Zt(i,FJ(e,Eb))}function Ia(i,e){const t=i(th,n=>{t(),e(n)});return t}function wL(i){let e,t;return n=>r=>{e=r,t&&clearTimeout(t),t=setTimeout(()=>{n(e)},i)}}function $B(i,e){return i===e}function gn(i=$B){let e;return t=>n=>{i(e,n)||(e=n,t(n))}}function vt(i){return e=>t=>{i(t)&&e(t)}}function Ye(i){return e=>zB(e,i)}function ya(i){return e=>()=>{e(i)}}function ke(i,...e){const t=jJ(...e);return(n,r)=>{switch(n){case rg:WI(i);return;case th:return Zt(i,t(r))}}}function _a(i,e){return t=>n=>{t(e=i(e,n))}}function $m(i){return e=>t=>{i>0?i--:e(t)}}function Rc(i){let e=null,t;return n=>r=>{e=r,!t&&(t=setTimeout(()=>{t=void 0,n(e)},i))}}function kt(...i){const e=new Array(i.length);let t=0,n=null;const r=Math.pow(2,i.length)-1;return i.forEach((s,o)=>{const a=Math.pow(2,o);Zt(s,u=>{const c=t;t=t|a,e[o]=u,c!==r&&t===r&&n&&(n(),n=null)})}),s=>o=>{const a=()=>{s([o].concat(e))};t===r?a():n=a}}function jJ(...i){return e=>i.reduceRight(BJ,e)}function qJ(i){let e,t;const n=()=>e==null?void 0:e();return function(r,s){switch(r){case th:return s?t===s?void 0:(n(),t=s,e=Zt(i,s),e):(n(),ig);case rg:n(),t=null;return}}}function Ne(i){let e=i;const t=qt();return(n,r)=>{switch(n){case Eb:e=r;break;case th:{r(e);break}case HB:return e}return t(n,r)}}function ii(i,e){return Cb(Ne(e),t=>it(i,t))}function qt(){const i=[];return(e,t)=>{switch(e){case Eb:i.slice().forEach(n=>{n(t)});return;case rg:i.splice(0,i.length);return;case th:return i.push(t),()=>{const n=i.indexOf(t);n>-1&&i.splice(n,1)}}}}function bs(i){return Cb(qt(),e=>it(i,e))}function Gt(i,e=[],{singleton:t}={singleton:!0}){return{constructor:i,dependencies:e,id:UJ(),singleton:t}}const UJ=()=>Symbol();function VJ(i){const e=new Map,t=({constructor:n,dependencies:r,id:s,singleton:o})=>{if(o&&e.has(s))return e.get(s);const a=n(r.map(u=>t(u)));return o&&e.set(s,a),a};return t(i)}function hr(...i){const e=qt(),t=new Array(i.length);let n=0;const r=Math.pow(2,i.length)-1;return i.forEach((s,o)=>{const a=Math.pow(2,o);Zt(s,u=>{t[o]=u,n=n|a,n===r&&St(e,t)})}),function(s,o){switch(s){case rg:{WI(e);return}case th:return n===r&&o(t),Zt(e,o)}}}function _t(i,e=$B){return ke(i,gn(e))}function _L(...i){return function(e,t){switch(e){case rg:return;case th:return MJ(...i.map(n=>Zt(n,t)))}}}var Vi=(i=>(i[i.DEBUG=0]="DEBUG",i[i.INFO=1]="INFO",i[i.WARN=2]="WARN",i[i.ERROR=3]="ERROR",i))(Vi||{});const HJ={0:"debug",3:"error",1:"log",2:"warn"},zJ=()=>typeof globalThis>"u"?window:globalThis,nh=Gt(()=>{const i=Ne(3);return{log:Ne((e,t,n=1)=>{var r;const s=(r=zJ().VIRTUOSO_LOG_LEVEL)!=null?r:Sr(i);n>=s&&console[HJ[n]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",e,t)}),logLevel:i}},[],{singleton:!0});function of(i,e,t){return GI(i,e,t).callbackRef}function GI(i,e,t){const n=ze.useRef(null);let r=o=>{};const s=ze.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(o=>{const a=()=>{const u=o[0].target;u.offsetParent!==null&&i(u)};t?a():requestAnimationFrame(a)}):null,[i,t]);return r=o=>{o&&e?(s==null||s.observe(o),n.current=o):(n.current&&(s==null||s.unobserve(n.current)),n.current=null)},{callbackRef:r,ref:n}}function $J(i,e,t,n,r,s,o,a,u){const c=ze.useCallback(d=>{const m=WJ(d.children,e,a?"offsetWidth":"offsetHeight",r);let p=d.parentElement;for(;!p.dataset.virtuosoScroller;)p=p.parentElement;const g=p.lastElementChild.dataset.viewportType==="window";let w;g&&(w=p.ownerDocument.defaultView);const b=o?a?o.scrollLeft:o.scrollTop:g?a?w.scrollX||w.document.documentElement.scrollLeft:w.scrollY||w.document.documentElement.scrollTop:a?p.scrollLeft:p.scrollTop,A=o?a?o.scrollWidth:o.scrollHeight:g?a?w.document.documentElement.scrollWidth:w.document.documentElement.scrollHeight:a?p.scrollWidth:p.scrollHeight,_=o?a?o.offsetWidth:o.offsetHeight:g?a?w.innerWidth:w.innerHeight:a?p.offsetWidth:p.offsetHeight;n({scrollHeight:A,scrollTop:Math.max(b,0),viewportHeight:_}),s==null||s(a?bL("column-gap",getComputedStyle(d).columnGap,r):bL("row-gap",getComputedStyle(d).rowGap,r)),m!==null&&i(m)},[i,e,r,s,o,n,a]);return GI(c,t,u)}function WJ(i,e,t,n){const r=i.length;if(r===0)return null;const s=[];for(let o=0;o<r;o++){const a=i.item(o);if(a.dataset.index===void 0)continue;const u=parseInt(a.dataset.index),c=parseFloat(a.dataset.knownSize),d=e(a,t);if(d===0&&n("Zero-sized element, this should not happen",{child:a},Vi.ERROR),d===c)continue;const m=s[s.length-1];s.length===0||m.size!==d||m.endIndex!==u-1?s.push({endIndex:u,size:d,startIndex:u}):s[s.length-1].endIndex++}return s}function bL(i,e,t){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&t(`${i} was not resolved to pixel value correctly`,e,Vi.WARN),e==="normal"?0:parseInt(e??"0",10)}function WB(i,e,t){const n=ze.useRef(null),r=ze.useCallback(u=>{if(!(u!=null&&u.offsetParent))return;const c=u.getBoundingClientRect(),d=c.width;let m,p;if(e){const g=e.getBoundingClientRect(),w=c.top-g.top;p=g.height-Math.max(0,w),m=w+e.scrollTop}else{const g=o.current.ownerDocument.defaultView;p=g.innerHeight-Math.max(0,c.top),m=c.top+g.scrollY}n.current={offsetTop:m,visibleHeight:p,visibleWidth:d},i(n.current)},[i,e]),{callbackRef:s,ref:o}=GI(r,!0,t),a=ze.useCallback(()=>{r(o.current)},[r,o]);return ze.useEffect(()=>{var u;if(e){e.addEventListener("scroll",a);const c=new ResizeObserver(()=>{requestAnimationFrame(a)});return c.observe(e),()=>{e.removeEventListener("scroll",a),c.unobserve(e)}}else{const c=(u=o.current)==null?void 0:u.ownerDocument.defaultView;return c==null||c.addEventListener("scroll",a),c==null||c.addEventListener("resize",a),()=>{c==null||c.removeEventListener("scroll",a),c==null||c.removeEventListener("resize",a)}}},[a,e,o]),s}const Ci=Gt(()=>{const i=qt(),e=qt(),t=Ne(0),n=qt(),r=Ne(0),s=qt(),o=qt(),a=Ne(0),u=Ne(0),c=Ne(0),d=Ne(0),m=qt(),p=qt(),g=Ne(!1),w=Ne(!1),b=Ne(!1);return it(ke(i,Ye(({scrollTop:A})=>A)),e),it(ke(i,Ye(({scrollHeight:A})=>A)),o),it(e,r),{deviation:t,fixedFooterHeight:c,fixedHeaderHeight:u,footerHeight:d,headerHeight:a,horizontalDirection:w,scrollBy:p,scrollContainerState:i,scrollHeight:o,scrollingInProgress:g,scrollTo:m,scrollTop:e,skipAnimationFrameInResizeObserver:b,smoothScrollTargetReached:n,statefulScrollTop:r,viewportHeight:s}},[],{singleton:!0}),Xy={lvl:0};function GB(i,e){const t=i.length;if(t===0)return[];let{index:n,value:r}=e(i[0]);const s=[];for(let o=1;o<t;o++){const{index:a,value:u}=e(i[o]);s.push({end:a-1,start:n,value:r}),n=a,r=u}return s.push({end:1/0,start:n,value:r}),s}function on(i){return i===Xy}function Qy(i,e){if(!on(i))return e===i.k?i.v:e<i.k?Qy(i.l,e):Qy(i.r,e)}function Po(i,e,t="k"){if(on(i))return[-1/0,void 0];if(Number(i[t])===e)return[i.k,i.v];if(Number(i[t])<e){const n=Po(i.r,e,t);return n[0]===-1/0?[i.k,i.v]:n}return Po(i.l,e,t)}function vs(i,e,t){return on(i)?YB(e,t,1):e===i.k?cr(i,{k:e,v:t}):e<i.k?AL(cr(i,{l:vs(i.l,e,t)})):AL(cr(i,{r:vs(i.r,e,t)}))}function _p(){return Xy}function xb(i,e,t){if(on(i))return[];const n=Po(i,e)[0];return GJ(nS(i,n,t))}function tS(i,e){if(on(i))return Xy;const{k:t,l:n,r}=i;if(e===t){if(on(n))return r;if(on(r))return n;{const[s,o]=JB(n);return i_(cr(i,{k:s,l:KB(n),v:o}))}}else return e<t?i_(cr(i,{l:tS(n,e)})):i_(cr(i,{r:tS(r,e)}))}function Mh(i){return on(i)?[]:[...Mh(i.l),{k:i.k,v:i.v},...Mh(i.r)]}function nS(i,e,t){if(on(i))return[];const{k:n,l:r,r:s,v:o}=i;let a=[];return n>e&&(a=a.concat(nS(r,e,t))),n>=e&&n<=t&&a.push({k:n,v:o}),n<=t&&(a=a.concat(nS(s,e,t))),a}function i_(i){const{l:e,lvl:t,r:n}=i;if(n.lvl>=t-1&&e.lvl>=t-1)return i;if(t>n.lvl+1){if(fx(e))return XB(cr(i,{lvl:t-1}));if(!on(e)&&!on(e.r))return cr(e.r,{l:cr(e,{r:e.r.l}),lvl:t,r:cr(i,{l:e.r.r,lvl:t-1})});throw new Error("Unexpected empty nodes")}else{if(fx(i))return rS(cr(i,{lvl:t-1}));if(!on(n)&&!on(n.l)){const r=n.l,s=fx(r)?n.lvl-1:n.lvl;return cr(r,{l:cr(i,{lvl:t-1,r:r.l}),lvl:r.lvl+1,r:rS(cr(n,{l:r.r,lvl:s}))})}else throw new Error("Unexpected empty nodes")}}function cr(i,e){return YB(e.k!==void 0?e.k:i.k,e.v!==void 0?e.v:i.v,e.lvl!==void 0?e.lvl:i.lvl,e.l!==void 0?e.l:i.l,e.r!==void 0?e.r:i.r)}function KB(i){return on(i.r)?i.l:i_(cr(i,{r:KB(i.r)}))}function fx(i){return on(i)||i.lvl>i.r.lvl}function JB(i){return on(i.r)?[i.k,i.v]:JB(i.r)}function YB(i,e,t,n=Xy,r=Xy){return{k:i,l:n,lvl:t,r,v:e}}function AL(i){return rS(XB(i))}function XB(i){const{l:e}=i;return!on(e)&&e.lvl===i.lvl?cr(e,{r:cr(i,{l:e.r})}):i}function rS(i){const{lvl:e,r:t}=i;return!on(t)&&!on(t.r)&&t.lvl===e&&t.r.lvl===e?cr(t,{l:cr(i,{r:t.l}),lvl:e+1}):i}function GJ(i){return GB(i,({k:e,v:t})=>({index:e,value:t}))}function QB(i,e){return!!(i&&i.startIndex===e.startIndex&&i.endIndex===e.endIndex)}function Zy(i,e){return!!(i&&i[0]===e[0]&&i[1]===e[1])}const KI=Gt(()=>({recalcInProgress:Ne(!1)}),[],{singleton:!0});function ZB(i,e,t){return i[i1(i,e,t)]}function i1(i,e,t,n=0){let r=i.length-1;for(;n<=r;){const s=Math.floor((n+r)/2),o=i[s],a=t(o,e);if(a===0)return s;if(a===-1){if(r-n<2)return s-1;r=s-1}else{if(r===n)return s;n=s+1}}throw new Error(`Failed binary finding record in array - ${i.join(",")}, searched for ${e}`)}function KJ(i,e,t,n){const r=i1(i,e,n),s=i1(i,t,n,r);return i.slice(r,s+1)}function zc(i,e){return Math.round(i.getBoundingClientRect()[e])}function Sb(i){return!on(i.groupOffsetTree)}function JI({index:i},e){return e===i?0:e<i?-1:1}function JJ(){return{groupIndices:[],groupOffsetTree:_p(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:_p()}}function YJ(i,e){let t=on(i)?0:1/0;for(const n of e){const{endIndex:r,size:s,startIndex:o}=n;if(t=Math.min(t,o),on(i)){i=vs(i,0,s);continue}const a=xb(i,o-1,r+1);if(a.some(rY(n)))continue;let u=!1,c=!1;for(const{end:d,start:m,value:p}of a)u?(r>=m||s===p)&&(i=tS(i,m)):(c=p!==s,u=!0),d>r&&r>=m&&p!==s&&(i=vs(i,r+1,p));c&&(i=vs(i,o,s))}return[i,t]}function XJ(i){return typeof i.groupIndex<"u"}function QJ({offset:i},e){return e===i?0:e<i?-1:1}function ev(i,e,t){if(e.length===0)return 0;const{index:n,offset:r,size:s}=ZB(e,i,JI),o=i-n,a=s*o+(o-1)*t+r;return a>0?a+t:a}function e5(i,e){if(!Sb(e))return i;let t=0;for(;e.groupIndices[t]<=i+t;)t++;return i+t}function t5(i,e,t){if(XJ(i))return e.groupIndices[i.groupIndex]+1;{const n=i.index==="LAST"?t:i.index;let r=e5(n,e);return r=Math.max(0,r,Math.min(t,r)),r}}function ZJ(i,e,t,n=0){return n>0&&(e=Math.max(e,ZB(i,n,JI).offset)),GB(KJ(i,e,t,QJ),nY)}function eY(i,[e,t,n,r]){e.length>0&&n("received item sizes",e,Vi.DEBUG);const s=i.sizeTree;let o=s,a=0;if(t.length>0&&on(s)&&e.length===2){const p=e[0].size,g=e[1].size;o=t.reduce((w,b)=>vs(vs(w,b,p),b+1,g),o)}else[o,a]=YJ(o,e);if(o===s)return i;const{lastIndex:u,lastOffset:c,lastSize:d,offsetTree:m}=iS(i.offsetTree,a,o,r);return{groupIndices:t,groupOffsetTree:t.reduce((p,g)=>vs(p,g,ev(g,m,r)),_p()),lastIndex:u,lastOffset:c,lastSize:d,offsetTree:m,sizeTree:o}}function tY(i){return Mh(i).map(({k:e,v:t},n,r)=>{const s=r[n+1];return{endIndex:s?s.k-1:1/0,size:t,startIndex:e}})}function EL(i,e){let t=0,n=0;for(;t<i;)t+=e[n+1]-e[n]-1,n++;return n-(t===i?0:1)}function iS(i,e,t,n){let r=i,s=0,o=0,a=0,u=0;if(e!==0){u=i1(r,e-1,JI),a=r[u].offset;const c=Po(t,e-1);s=c[0],o=c[1],r.length&&r[u].size===Po(t,e)[1]&&(u-=1),r=r.slice(0,u+1)}else r=[];for(const{start:c,value:d}of xb(t,e,1/0)){const m=c-s,p=m*o+a+m*n;r.push({index:c,offset:p,size:d}),s=c,a=p,o=d}return{lastIndex:s,lastOffset:a,lastSize:o,offsetTree:r}}function nY(i){return{index:i.index,value:i}}function rY(i){const{endIndex:e,size:t,startIndex:n}=i;return r=>r.start===n&&(r.end===e||r.end===1/0)&&r.value===t}const iY={offsetHeight:"height",offsetWidth:"width"},Oa=Gt(([{log:i},{recalcInProgress:e}])=>{const t=qt(),n=qt(),r=ii(n,0),s=qt(),o=qt(),a=Ne(0),u=Ne([]),c=Ne(void 0),d=Ne(void 0),m=Ne((R,L)=>zc(R,iY[L])),p=Ne(void 0),g=Ne(0),w=JJ(),b=ii(ke(t,kt(u,i,g),_a(eY,w),gn()),w),A=ii(ke(u,gn(),_a((R,L)=>({current:L,prev:R.current}),{current:[],prev:[]}),Ye(({prev:R})=>R)),[]);it(ke(u,vt(R=>R.length>0),kt(b,g),Ye(([R,L,k])=>{const T=R.reduce((D,P,N)=>vs(D,P,ev(P,L.offsetTree,k)||N),_p());return{...L,groupIndices:R,groupOffsetTree:T}})),b),it(ke(n,kt(b),vt(([R,{lastIndex:L}])=>R<L),Ye(([R,{lastIndex:L,lastSize:k}])=>[{endIndex:L,size:k,startIndex:R}])),t),it(c,d);const _=ii(ke(c,Ye(R=>R===void 0)),!0);it(ke(d,vt(R=>R!==void 0&&on(Sr(b).sizeTree)),Ye(R=>[{endIndex:0,size:R,startIndex:0}])),t);const C=bs(ke(t,kt(b),_a(({sizes:R},[L,k])=>({changed:k!==R,sizes:k}),{changed:!1,sizes:w}),Ye(R=>R.changed)));Zt(ke(a,_a((R,L)=>({diff:R.prev-L,prev:L}),{diff:0,prev:0}),Ye(R=>R.diff)),R=>{const{groupIndices:L}=Sr(b);if(R>0)St(e,!0),St(s,R+EL(R,L));else if(R<0){const k=Sr(A);k.length>0&&(R-=EL(-R,k)),St(o,R)}}),Zt(ke(a,kt(i)),([R,L])=>{R<0&&L("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:a},Vi.ERROR)});const I=bs(s);it(ke(s,kt(b),Ye(([R,L])=>{const k=L.groupIndices.length>0,T=[],D=L.lastSize;if(k){const P=Qy(L.sizeTree,0);let N=0,F=0;for(;N<R;){const $=L.groupIndices[F],Q=L.groupIndices.length===F+1?1/0:L.groupIndices[F+1]-$-1;T.push({endIndex:$,size:P,startIndex:$}),T.push({endIndex:$+1+Q-1,size:D,startIndex:$+1}),F++,N+=Q+1}const M=Mh(L.sizeTree);return N!==R&&M.shift(),M.reduce(($,{k:Q,v:ie})=>{let ee=$.ranges;return $.prevSize!==0&&(ee=[...$.ranges,{endIndex:Q+R-1,size:$.prevSize,startIndex:$.prevIndex}]),{prevIndex:Q+R,prevSize:ie,ranges:ee}},{prevIndex:R,prevSize:0,ranges:T}).ranges}return Mh(L.sizeTree).reduce((P,{k:N,v:F})=>({prevIndex:N+R,prevSize:F,ranges:[...P.ranges,{endIndex:N+R-1,size:P.prevSize,startIndex:P.prevIndex}]}),{prevIndex:0,prevSize:D,ranges:[]}).ranges})),t);const S=bs(ke(o,kt(b,g),Ye(([R,{offsetTree:L},k])=>{const T=-R;return ev(T,L,k)})));return it(ke(o,kt(b,g),Ye(([R,L,k])=>{if(L.groupIndices.length>0){if(on(L.sizeTree))return L;let T=_p();const D=Sr(A);let P=0,N=0,F=0;for(;P<-R;){F=D[N];const M=D[N+1]-F-1;N++,P+=M+1}if(T=Mh(L.sizeTree).reduce((M,{k:$,v:Q})=>vs(M,Math.max(0,$+R),Q),T),P!==-R){const M=Qy(L.sizeTree,F);T=vs(T,0,M);const $=Po(L.sizeTree,-R+1)[1];T=vs(T,1,$)}return{...L,sizeTree:T,...iS(L.offsetTree,0,T,k)}}else{const T=Mh(L.sizeTree).reduce((D,{k:P,v:N})=>vs(D,Math.max(0,P+R),N),_p());return{...L,sizeTree:T,...iS(L.offsetTree,0,T,k)}}})),b),{beforeUnshiftWith:I,data:p,defaultItemSize:d,firstItemIndex:a,fixedItemSize:c,gap:g,groupIndices:u,itemSize:m,listRefresh:C,shiftWith:o,shiftWithOffset:S,sizeRanges:t,sizes:b,statefulTotalCount:r,totalCount:n,trackItemSizes:_,unshiftWith:s}},vn(nh,KI),{singleton:!0});function sY(i){return i.reduce((e,t)=>(e.groupIndices.push(e.totalCount),e.totalCount+=t+1,e),{groupIndices:[],totalCount:0})}const n5=Gt(([{groupIndices:i,sizes:e,totalCount:t},{headerHeight:n,scrollTop:r}])=>{const s=qt(),o=qt(),a=bs(ke(s,Ye(sY)));return it(ke(a,Ye(u=>u.totalCount)),t),it(ke(a,Ye(u=>u.groupIndices)),i),it(ke(hr(r,e,n),vt(([u,c])=>Sb(c)),Ye(([u,c,d])=>Po(c.groupOffsetTree,Math.max(u-d,0),"v")[0]),gn(),Ye(u=>[u])),o),{groupCounts:s,topItemsIndexes:o}},vn(Oa,Ci)),rh=Gt(([{log:i}])=>{const e=Ne(!1),t=bs(ke(e,vt(n=>n),gn()));return Zt(e,n=>{n&&Sr(i)("props updated",{},Vi.DEBUG)}),{didMount:t,propsReady:e}},vn(nh),{singleton:!0}),oY=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function r5(i){const e=typeof i=="number"?{index:i}:i;return e.align||(e.align="start"),(!e.behavior||!oY)&&(e.behavior="auto"),e.offset||(e.offset=0),e}const Z0=Gt(([{gap:i,listRefresh:e,sizes:t,totalCount:n},{fixedFooterHeight:r,fixedHeaderHeight:s,footerHeight:o,headerHeight:a,scrollingInProgress:u,scrollTo:c,smoothScrollTargetReached:d,viewportHeight:m},{log:p}])=>{const g=qt(),w=qt(),b=Ne(0);let A=null,_=null,C=null;function I(){A&&(A(),A=null),C&&(C(),C=null),_&&(clearTimeout(_),_=null),St(u,!1)}return it(ke(g,kt(t,m,n,b,a,o,p),kt(i,s,r),Ye(([[S,R,L,k,T,D,P,N],F,M,$])=>{const Q=r5(S),{align:ie,behavior:ee,offset:ue}=Q,Y=k-1,J=t5(Q,R,Y);let q=ev(J,R.offsetTree,F)+D;ie==="end"?(q+=M+Po(R.sizeTree,J)[1]-L+$,J===Y&&(q+=P)):ie==="center"?q+=(M+Po(R.sizeTree,J)[1]-L+$)/2:q-=T,ue&&(q+=ue);const H=G=>{I(),G?(N("retrying to scroll to",{location:S},Vi.DEBUG),St(g,S)):(St(w,!0),N("list did not change, scroll successful",{},Vi.DEBUG))};if(I(),ee==="smooth"){let G=!1;C=Zt(e,le=>{G=G||le}),A=Ia(d,()=>{H(G)})}else A=Ia(ke(e,aY(150)),H);return _=setTimeout(()=>{I()},1200),St(u,!0),N("scrolling from index to",{behavior:ee,index:J,top:q},Vi.DEBUG),{behavior:ee,top:q}})),c),{scrollTargetReached:w,scrollToIndex:g,topListHeight:b}},vn(Oa,Ci,nh),{singleton:!0});function aY(i){return e=>{const t=setTimeout(()=>{e(!1)},i);return n=>{n&&(e(!0),clearTimeout(t))}}}function YI(i,e){i==0?e():requestAnimationFrame(()=>{YI(i-1,e)})}function XI(i,e){const t=e-1;return typeof i=="number"?i:i.index==="LAST"?t:i.index}const e2=Gt(([{defaultItemSize:i,listRefresh:e,sizes:t},{scrollTop:n},{scrollTargetReached:r,scrollToIndex:s},{didMount:o}])=>{const a=Ne(!0),u=Ne(0),c=Ne(!0);return it(ke(o,kt(u),vt(([d,m])=>!!m),ya(!1)),a),it(ke(o,kt(u),vt(([d,m])=>!!m),ya(!1)),c),Zt(ke(hr(e,o),kt(a,t,i,c),vt(([[,d],m,{sizeTree:p},g,w])=>d&&(!on(p)||$I(g))&&!m&&!w),kt(u)),([,d])=>{Ia(r,()=>{St(c,!0)}),YI(4,()=>{Ia(n,()=>{St(a,!0)}),St(s,d)})}),{initialItemFinalLocationReached:c,initialTopMostItemIndex:u,scrolledToInitialItem:a}},vn(Oa,Ci,Z0,rh),{singleton:!0});function i5(i,e){return Math.abs(i-e)<1.01}const tv="up",My="down",lY="none",uY={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},cY=0,t2=Gt(([{footerHeight:i,headerHeight:e,scrollBy:t,scrollContainerState:n,scrollTop:r,viewportHeight:s}])=>{const o=Ne(!1),a=Ne(!0),u=qt(),c=qt(),d=Ne(4),m=Ne(cY),p=ii(ke(_L(ke(_t(r),$m(1),ya(!0)),ke(_t(r),$m(1),ya(!1),wL(100))),gn()),!1),g=ii(ke(_L(ke(t,ya(!0)),ke(t,ya(!1),wL(200))),gn()),!1);it(ke(hr(_t(r),_t(m)),Ye(([C,I])=>C<=I),gn()),a),it(ke(a,Rc(50)),c);const w=bs(ke(hr(n,_t(s),_t(e),_t(i),_t(d)),_a((C,[{scrollHeight:I,scrollTop:S},R,L,k,T])=>{const D=S+R-I>-T,P={scrollHeight:I,scrollTop:S,viewportHeight:R};if(D){let F,M;return S>C.state.scrollTop?(F="SCROLLED_DOWN",M=C.state.scrollTop-S):(F="SIZE_DECREASED",M=C.state.scrollTop-S||C.scrollTopDelta),{atBottom:!0,atBottomBecause:F,scrollTopDelta:M,state:P}}let N;return P.scrollHeight>C.state.scrollHeight?N="SIZE_INCREASED":R<C.state.viewportHeight?N="VIEWPORT_HEIGHT_DECREASING":S<C.state.scrollTop?N="SCROLLING_UPWARDS":N="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:N,state:P}},uY),gn((C,I)=>C&&C.atBottom===I.atBottom))),b=ii(ke(n,_a((C,{scrollHeight:I,scrollTop:S,viewportHeight:R})=>{if(i5(C.scrollHeight,I))return{changed:!1,jump:0,scrollHeight:I,scrollTop:S};{const L=I-(S+R)<1;return C.scrollTop!==S&&L?{changed:!0,jump:C.scrollTop-S,scrollHeight:I,scrollTop:S}:{changed:!0,jump:0,scrollHeight:I,scrollTop:S}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),vt(C=>C.changed),Ye(C=>C.jump)),0);it(ke(w,Ye(C=>C.atBottom)),o),it(ke(o,Rc(50)),u);const A=Ne(My);it(ke(n,Ye(({scrollTop:C})=>C),gn(),_a((C,I)=>Sr(g)?{direction:C.direction,prevScrollTop:I}:{direction:I<C.prevScrollTop?tv:My,prevScrollTop:I},{direction:My,prevScrollTop:0}),Ye(C=>C.direction)),A),it(ke(n,Rc(50),ya(lY)),A);const _=Ne(0);return it(ke(p,vt(C=>!C),ya(0)),_),it(ke(r,Rc(100),kt(p),vt(([C,I])=>!!I),_a(([C,I],[S])=>[I,S],[0,0]),Ye(([C,I])=>I-C)),_),{atBottomState:w,atBottomStateChange:u,atBottomThreshold:d,atTopStateChange:c,atTopThreshold:m,isAtBottom:o,isAtTop:a,isScrolling:p,lastJumpDueToItemResize:b,scrollDirection:A,scrollVelocity:_}},vn(Ci)),s1="top",o1="bottom",CL="none";function xL(i,e,t){return typeof i=="number"?t===tv&&e===s1||t===My&&e===o1?i:0:t===tv?e===s1?i.main:i.reverse:e===o1?i.main:i.reverse}function SL(i,e){var t;return typeof i=="number"?i:(t=i[e])!=null?t:0}const QI=Gt(([{deviation:i,fixedHeaderHeight:e,headerHeight:t,scrollTop:n,viewportHeight:r}])=>{const s=qt(),o=Ne(0),a=Ne(0),u=Ne(0),c=ii(ke(hr(_t(n),_t(r),_t(t),_t(s,Zy),_t(u),_t(o),_t(e),_t(i),_t(a)),Ye(([d,m,p,[g,w],b,A,_,C,I])=>{const S=d-C,R=A+_,L=Math.max(p-S,0);let k=CL;const T=SL(I,s1),D=SL(I,o1);return g-=C,g+=p+_,w+=p+_,w-=C,g>d+R-T&&(k=tv),w<d-L+m+D&&(k=My),k!==CL?[Math.max(S-p-xL(b,s1,k)-T,0),S-L-_+m+xL(b,o1,k)+D]:null}),vt(d=>d!=null),gn(Zy)),[0,0]);return{increaseViewportBy:a,listBoundary:s,overscan:u,topListHeight:o,visibleRange:c}},vn(Ci),{singleton:!0});function hY(i,e,t){if(Sb(e)){const n=e5(i,e);return[{index:Po(e.groupOffsetTree,n)[0],offset:0,size:0},{data:t==null?void 0:t[0],index:n,offset:0,size:0}]}return[{data:t==null?void 0:t[0],index:i,offset:0,size:0}]}const px={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function s_(i,e,t,n,r,s){const{lastIndex:o,lastOffset:a,lastSize:u}=r;let c=0,d=0;if(i.length>0){c=i[0].offset;const b=i[i.length-1];d=b.offset+b.size}const m=t-o,p=a+m*u+(m-1)*n,g=c,w=p-d;return{bottom:d,firstItemIndex:s,items:TL(i,r,s),offsetBottom:w,offsetTop:c,top:g,topItems:TL(e,r,s),topListHeight:e.reduce((b,A)=>A.size+b,0),totalCount:t}}function s5(i,e,t,n,r,s){let o=0;if(t.groupIndices.length>0)for(const d of t.groupIndices){if(d-o>=i)break;o++}const a=i+o,u=XI(e,a),c=Array.from({length:a}).map((d,m)=>({data:s[m+u],index:m+u,offset:0,size:0}));return s_(c,[],a,r,t,n)}function TL(i,e,t){if(i.length===0)return[];if(!Sb(e))return i.map(c=>({...c,index:c.index+t,originalIndex:c.index}));const n=i[0].index,r=i[i.length-1].index,s=[],o=xb(e.groupOffsetTree,n,r);let a,u=0;for(const c of i){(!a||a.end<c.index)&&(a=o.shift(),u=e.groupIndices.indexOf(a.start));let d;c.index===a.start?d={index:u,type:"group"}:d={groupIndex:u,index:c.index-(u+1)+t},s.push({...d,data:c.data,offset:c.offset,originalIndex:c.index,size:c.size})}return s}const af=Gt(([{data:i,firstItemIndex:e,gap:t,sizes:n,totalCount:r},s,{listBoundary:o,topListHeight:a,visibleRange:u},{initialTopMostItemIndex:c,scrolledToInitialItem:d},{topListHeight:m},p,{didMount:g},{recalcInProgress:w}])=>{const b=Ne([]),A=Ne(0),_=qt();it(s.topItemsIndexes,b);const C=ii(ke(hr(g,w,_t(u,Zy),_t(r),_t(n),_t(c),d,_t(b),_t(e),_t(t),i),vt(([L,k,,T,,,,,,,D])=>{const P=D&&D.length!==T;return L&&!k&&!P}),Ye(([,,[L,k],T,D,P,N,F,M,$,Q])=>{const ie=D,{offsetTree:ee,sizeTree:ue}=ie,Y=Sr(A);if(T===0)return{...px,totalCount:T};if(L===0&&k===0)return Y===0?{...px,totalCount:T}:s5(Y,P,D,M,$,Q||[]);if(on(ue))return Y>0?null:s_(hY(XI(P,T),ie,Q),[],T,$,ie,M);const J=[];if(F.length>0){const se=F[0],X=F[F.length-1];let ne=0;for(const te of xb(ue,se,X)){const ae=te.value,de=Math.max(te.start,se),ye=Math.min(te.end,X);for(let xe=de;xe<=ye;xe++)J.push({data:Q==null?void 0:Q[xe],index:xe,offset:ne,size:ae}),ne+=ae}}if(!N)return s_([],J,T,$,ie,M);const q=F.length>0?F[F.length-1]+1:0,H=ZJ(ee,L,k,q);if(H.length===0)return null;const G=T-1,le=Cb([],se=>{for(const X of H){const ne=X.value;let te=ne.offset,ae=X.start;const de=ne.size;if(ne.offset<L){ae+=Math.floor((L-ne.offset+$)/(de+$));const xe=ae-X.start;te+=xe*de+xe*$}ae<q&&(te+=(q-ae)*de,ae=q);const ye=Math.min(X.end,G);for(let xe=ae;xe<=ye&&!(te>=k);xe++)se.push({data:Q==null?void 0:Q[xe],index:xe,offset:te,size:de}),te+=de+$}});return s_(le,J,T,$,ie,M)}),vt(L=>L!==null),gn()),px);it(ke(i,vt($I),Ye(L=>L==null?void 0:L.length)),r),it(ke(C,Ye(L=>L.topListHeight)),m),it(m,a),it(ke(C,Ye(L=>[L.top,L.bottom])),o),it(ke(C,Ye(L=>L.items)),_);const I=bs(ke(C,vt(({items:L})=>L.length>0),kt(r,i),vt(([{items:L},k])=>L[L.length-1].originalIndex===k-1),Ye(([,L,k])=>[L-1,k]),gn(Zy),Ye(([L])=>L))),S=bs(ke(C,Rc(200),vt(({items:L,topItems:k})=>L.length>0&&L[0].originalIndex===k.length),Ye(({items:L})=>L[0].index),gn())),R=bs(ke(C,vt(({items:L})=>L.length>0),Ye(({items:L})=>{let k=0,T=L.length-1;for(;L[k].type==="group"&&k<T;)k++;for(;L[T].type==="group"&&T>k;)T--;return{endIndex:L[T].index,startIndex:L[k].index}}),gn(QB)));return{endReached:I,initialItemCount:A,itemsRendered:_,listState:C,rangeChanged:R,startReached:S,topItemsIndexes:b,...p}},vn(Oa,n5,QI,e2,Z0,t2,rh,KI),{singleton:!0}),o5=Gt(([{fixedFooterHeight:i,fixedHeaderHeight:e,footerHeight:t,headerHeight:n},{listState:r}])=>{const s=qt(),o=ii(ke(hr(t,i,n,e,r),Ye(([a,u,c,d,m])=>a+u+c+d+m.offsetBottom+m.bottom)),0);return it(_t(o),s),{totalListHeight:o,totalListHeightChanged:s}},vn(Ci,af),{singleton:!0}),dY=Gt(([{viewportHeight:i},{totalListHeight:e}])=>{const t=Ne(!1),n=ii(ke(hr(t,i,e),vt(([r])=>r),Ye(([,r,s])=>Math.max(0,r-s)),Rc(0),gn()),0);return{alignToBottom:t,paddingTopAddition:n}},vn(Ci,o5),{singleton:!0});function IL(i){return i?i==="smooth"?"smooth":"auto":!1}const fY=(i,e)=>typeof i=="function"?IL(i(e)):e&&IL(i),pY=Gt(([{listRefresh:i,totalCount:e,fixedItemSize:t},{atBottomState:n,isAtBottom:r},{scrollToIndex:s},{scrolledToInitialItem:o},{didMount:a,propsReady:u},{log:c},{scrollingInProgress:d}])=>{const m=Ne(!1),p=qt();let g=null;function w(A){St(s,{align:"end",behavior:A,index:"LAST"})}Zt(ke(hr(ke(_t(e),$m(1)),a),kt(_t(m),r,o,d),Ye(([[A,_],C,I,S,R])=>{let L=_&&S,k="auto";return L&&(k=fY(C,I||R),L=L&&!!k),{followOutputBehavior:k,shouldFollow:L,totalCount:A}}),vt(({shouldFollow:A})=>A)),({followOutputBehavior:A,totalCount:_})=>{g&&(g(),g=null),Sr(t)?requestAnimationFrame(()=>{Sr(c)("following output to ",{totalCount:_},Vi.DEBUG),w(A)}):g=Ia(i,()=>{Sr(c)("following output to ",{totalCount:_},Vi.DEBUG),w(A),g=null})});function b(A){const _=Ia(n,C=>{A&&!C.atBottom&&C.notAtBottomBecause==="SIZE_INCREASED"&&!g&&(Sr(c)("scrolling to bottom due to increased size",{},Vi.DEBUG),w("auto"))});setTimeout(_,100)}return Zt(ke(hr(_t(m),e,u),vt(([A,,_])=>A&&_),_a(({value:A},[,_])=>({refreshed:A===_,value:_}),{refreshed:!1,value:0}),vt(({refreshed:A})=>A),kt(m,e)),([,A])=>{Sr(o)&&b(A!==!1)}),Zt(p,()=>{b(Sr(m)!==!1)}),Zt(hr(_t(m),n),([A,_])=>{A&&!_.atBottom&&_.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&w("auto")}),{autoscrollToBottom:p,followOutput:m}},vn(Oa,t2,Z0,e2,rh,nh,Ci)),mY=Gt(([{data:i,firstItemIndex:e,gap:t,sizes:n},{initialTopMostItemIndex:r},{initialItemCount:s,listState:o},{didMount:a}])=>(it(ke(a,kt(s),vt(([,u])=>u!==0),kt(r,n,e,t,i),Ye(([[,u],c,d,m,p,g=[]])=>s5(u,c,d,m,p,g))),o),{}),vn(Oa,e2,af,rh),{singleton:!0}),gY=Gt(([{didMount:i},{scrollTo:e},{listState:t}])=>{const n=Ne(0);return Zt(ke(i,kt(n),vt(([,r])=>r!==0),Ye(([,r])=>({top:r}))),r=>{Ia(ke(t,$m(1),vt(s=>s.items.length>1)),()=>{requestAnimationFrame(()=>{St(e,r)})})}),{initialScrollTop:n}},vn(rh,Ci,af),{singleton:!0}),yY=({itemBottom:i,itemTop:e,locationParams:{align:t,behavior:n,...r},viewportBottom:s,viewportTop:o})=>e<o?{...r,align:t??"start",behavior:n}:i>s?{...r,align:t??"end",behavior:n}:null,vY=Gt(([{gap:i,sizes:e,totalCount:t},{fixedFooterHeight:n,fixedHeaderHeight:r,headerHeight:s,scrollingInProgress:o,scrollTop:a,viewportHeight:u},{scrollToIndex:c}])=>{const d=qt();return it(ke(d,kt(e,u,t,s,r,n,a),kt(i),Ye(([[m,p,g,w,b,A,_,C],I])=>{const{align:S,behavior:R,calculateViewLocation:L=yY,done:k,...T}=m,D=t5(m,p,w-1),P=ev(D,p.offsetTree,I)+b+A,N=P+Po(p.sizeTree,D)[1],F=C+A,M=C+g-_,$=L({itemBottom:N,itemTop:P,locationParams:{align:S,behavior:R,...T},viewportBottom:M,viewportTop:F});return $?k&&Ia(ke(o,vt(Q=>!Q),$m(Sr(o)?1:2)),k):k&&k(),$}),vt(m=>m!==null)),c),{scrollIntoView:d}},vn(Oa,Ci,Z0,af,nh),{singleton:!0}),a5=Gt(([{scrollVelocity:i}])=>{const e=Ne(!1),t=qt(),n=Ne(!1);return it(ke(i,kt(n,e,t),vt(([r,s])=>!!s),Ye(([r,s,o,a])=>{const{enter:u,exit:c}=s;if(o){if(c(r,a))return!1}else if(u(r,a))return!0;return o}),gn()),e),Zt(ke(hr(e,i,t),kt(n)),([[r,s,o],a])=>{r&&a&&a.change&&a.change(s,o)}),{isSeeking:e,scrollSeekConfiguration:n,scrollSeekRangeChanged:t,scrollVelocity:i}},vn(t2),{singleton:!0}),ZI=Gt(([{scrollContainerState:i,scrollTo:e}])=>{const t=qt(),n=qt(),r=qt(),s=Ne(!1),o=Ne(void 0);return it(ke(hr(t,n),Ye(([{scrollHeight:a,scrollTop:u,viewportHeight:c},{offsetTop:d}])=>({scrollHeight:a,scrollTop:Math.max(0,u-d),viewportHeight:c}))),i),it(ke(e,kt(n),Ye(([a,{offsetTop:u}])=>({...a,top:a.top+u}))),r),{customScrollParent:o,useWindowScroll:s,windowScrollContainerState:t,windowScrollTo:r,windowViewportRect:n}},vn(Ci)),wY=Gt(([{sizeRanges:i,sizes:e},{headerHeight:t,scrollTop:n},{initialTopMostItemIndex:r},{didMount:s},{useWindowScroll:o,windowScrollContainerState:a,windowViewportRect:u}])=>{const c=qt(),d=Ne(void 0),m=Ne(null),p=Ne(null);return it(a,m),it(u,p),Zt(ke(c,kt(e,n,o,m,p,t)),([g,w,b,A,_,C,I])=>{const S=tY(w.sizeTree);A&&_!==null&&C!==null&&(b=_.scrollTop-C.offsetTop),b-=I,g({ranges:S,scrollTop:b})}),it(ke(d,vt($I),Ye(_Y)),r),it(ke(s,kt(d),vt(([,g])=>g!==void 0),gn(),Ye(([,g])=>g.ranges)),i),{getState:c,restoreStateFrom:d}},vn(Oa,Ci,e2,rh,ZI));function _Y(i){return{align:"start",index:0,offset:i.scrollTop}}const bY=Gt(([{topItemsIndexes:i}])=>{const e=Ne(0);return it(ke(e,vt(t=>t>=0),Ye(t=>Array.from({length:t}).map((n,r)=>r))),i),{topItemCount:e}},vn(af));function l5(i){let e=!1,t;return()=>(e||(e=!0,t=i()),t)}const AY=l5(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),EY=Gt(([{deviation:i,scrollBy:e,scrollingInProgress:t,scrollTop:n},{isAtBottom:r,isScrolling:s,lastJumpDueToItemResize:o,scrollDirection:a},{listState:u},{beforeUnshiftWith:c,gap:d,shiftWithOffset:m,sizes:p},{log:g},{recalcInProgress:w}])=>{const b=bs(ke(u,kt(o),_a(([,_,C,I],[{bottom:S,items:R,offsetBottom:L,totalCount:k},T])=>{const D=S+L;let P=0;return C===k&&_.length>0&&R.length>0&&(R[0].originalIndex===0&&_[0].originalIndex===0||(P=D-I,P!==0&&(P+=T))),[P,R,k,D]},[0,[],0,0]),vt(([_])=>_!==0),kt(n,a,t,r,g,w),vt(([,_,C,I,,,S])=>!S&&!I&&_!==0&&C===tv),Ye(([[_],,,,,C])=>(C("Upward scrolling compensation",{amount:_},Vi.DEBUG),_))));function A(_){_>0?(St(e,{behavior:"auto",top:-_}),St(i,0)):(St(i,0),St(e,{behavior:"auto",top:-_}))}return Zt(ke(b,kt(i,s)),([_,C,I])=>{I&&AY()?St(i,C-_):A(-_)}),Zt(ke(hr(ii(s,!1),i,w),vt(([_,C,I])=>!_&&!I&&C!==0),Ye(([_,C])=>C),Rc(1)),A),it(ke(m,Ye(_=>({top:-_}))),e),Zt(ke(c,kt(p,d),Ye(([_,{groupIndices:C,lastSize:I,sizeTree:S},R])=>{function L(k){return k*(I+R)}if(C.length===0)return L(_);{let k=0;const T=Qy(S,0);let D=0,P=0;for(;D<_;){D++,k+=T;let N=C.length===P+1?1/0:C[P+1]-C[P]-1;D+N>_&&(k-=T,N=_-D+1),D+=N,k+=L(N),P++}return k}})),_=>{St(i,_),requestAnimationFrame(()=>{St(e,{top:_}),requestAnimationFrame(()=>{St(i,0),St(w,!1)})})}),{deviation:i}},vn(Ci,t2,af,Oa,nh,KI)),CY=Gt(([i,e,t,n,r,s,o,a,u,c])=>({...i,...e,...t,...n,...r,...s,...o,...a,...u,...c}),vn(QI,mY,rh,a5,o5,gY,dY,ZI,vY,nh)),u5=Gt(([{data:i,defaultItemSize:e,firstItemIndex:t,fixedItemSize:n,gap:r,groupIndices:s,itemSize:o,sizeRanges:a,sizes:u,statefulTotalCount:c,totalCount:d,trackItemSizes:m},{initialItemFinalLocationReached:p,initialTopMostItemIndex:g,scrolledToInitialItem:w},b,A,_,{listState:C,topItemsIndexes:I,...S},{scrollToIndex:R},L,{topItemCount:k},{groupCounts:T},D])=>(it(S.rangeChanged,D.scrollSeekRangeChanged),it(ke(D.windowViewportRect,Ye(P=>P.visibleHeight)),b.viewportHeight),{data:i,defaultItemHeight:e,firstItemIndex:t,fixedItemHeight:n,gap:r,groupCounts:T,initialItemFinalLocationReached:p,initialTopMostItemIndex:g,scrolledToInitialItem:w,sizeRanges:a,topItemCount:k,topItemsIndexes:I,totalCount:d,..._,groupIndices:s,itemSize:o,listState:C,scrollToIndex:R,statefulTotalCount:c,trackItemSizes:m,...S,...D,...b,sizes:u,...A}),vn(Oa,e2,Ci,wY,pY,af,Z0,EY,bY,n5,CY));function xY(i,e){const t={},n={};let r=0;const s=i.length;for(;r<s;)n[i[r]]=1,r+=1;for(const o in e)Object.hasOwn(n,o)||(t[o]=e[o]);return t}const Pw=typeof document<"u"?ze.useLayoutEffect:ze.useEffect;function c5(i,e,t){const n=Object.keys(e.required||{}),r=Object.keys(e.optional||{}),s=Object.keys(e.methods||{}),o=Object.keys(e.events||{}),a=ze.createContext({});function u(A,_){A.propsReady&&St(A.propsReady,!1);for(const C of n){const I=A[e.required[C]];St(I,_[C])}for(const C of r)if(C in _){const I=A[e.optional[C]];St(I,_[C])}A.propsReady&&St(A.propsReady,!0)}function c(A){return s.reduce((_,C)=>(_[C]=I=>{const S=A[e.methods[C]];St(S,I)},_),{})}function d(A){return o.reduce((_,C)=>(_[C]=qJ(A[e.events[C]]),_),{})}const m=ze.forwardRef((A,_)=>{const{children:C,...I}=A,[S]=ze.useState(()=>Cb(VJ(i),k=>{u(k,I)})),[R]=ze.useState(vL(d,S));Pw(()=>{for(const k of o)k in I&&Zt(R[k],I[k]);return()=>{Object.values(R).map(WI)}},[I,R,S]),Pw(()=>{u(S,I)}),ze.useImperativeHandle(_,yL(c(S)));const L=t;return v.jsx(a.Provider,{value:S,children:t?v.jsx(L,{...xY([...n,...r,...o],I),children:C}):C})}),p=A=>{const _=ze.useContext(a);return ze.useCallback(C=>{St(_[A],C)},[_,A])},g=A=>{const _=ze.useContext(a)[A],C=ze.useCallback(I=>Zt(_,I),[_]);return ze.useSyncExternalStore(C,()=>Sr(_),()=>Sr(_))},w=A=>{const _=ze.useContext(a)[A],[C,I]=ze.useState(vL(Sr,_));return Pw(()=>Zt(_,S=>{S!==C&&I(yL(S))}),[_,C]),C},b=ze.version.startsWith("18")?g:w;return{Component:m,useEmitter:(A,_)=>{const C=ze.useContext(a)[A];Pw(()=>Zt(C,_),[_,C])},useEmitterValue:b,usePublisher:p}}const h5=ze.createContext(void 0),d5=ze.createContext(void 0),f5=typeof document<"u"?ze.useLayoutEffect:ze.useEffect;function mx(i){return"self"in i}function SY(i){return"body"in i}function p5(i,e,t,n=ig,r,s){const o=ze.useRef(null),a=ze.useRef(null),u=ze.useRef(null),c=ze.useCallback(p=>{let g,w,b;const A=p.target;if(SY(A)||mx(A)){const C=mx(A)?A:A.defaultView;b=s?C.scrollX:C.scrollY,g=s?C.document.documentElement.scrollWidth:C.document.documentElement.scrollHeight,w=s?C.innerWidth:C.innerHeight}else b=s?A.scrollLeft:A.scrollTop,g=s?A.scrollWidth:A.scrollHeight,w=s?A.offsetWidth:A.offsetHeight;const _=()=>{i({scrollHeight:g,scrollTop:Math.max(b,0),viewportHeight:w})};p.suppressFlushSync?_():xG.flushSync(_),a.current!==null&&(b===a.current||b<=0||b===g-w)&&(a.current=null,e(!0),u.current&&(clearTimeout(u.current),u.current=null))},[i,e,s]);ze.useEffect(()=>{const p=r||o.current;return n(r||o.current),c({suppressFlushSync:!0,target:p}),p.addEventListener("scroll",c,{passive:!0}),()=>{n(null),p.removeEventListener("scroll",c)}},[o,c,t,n,r]);function d(p){const g=o.current;if(!g||(s?"offsetWidth"in g&&g.offsetWidth===0:"offsetHeight"in g&&g.offsetHeight===0))return;const w=p.behavior==="smooth";let b,A,_;mx(g)?(A=Math.max(zc(g.document.documentElement,s?"width":"height"),s?g.document.documentElement.scrollWidth:g.document.documentElement.scrollHeight),b=s?g.innerWidth:g.innerHeight,_=s?window.scrollX:window.scrollY):(A=g[s?"scrollWidth":"scrollHeight"],b=zc(g,s?"width":"height"),_=g[s?"scrollLeft":"scrollTop"]);const C=A-b;if(p.top=Math.ceil(Math.max(Math.min(C,p.top),0)),i5(b,A)||p.top===_){i({scrollHeight:A,scrollTop:_,viewportHeight:b}),w&&e(!0);return}w?(a.current=p.top,u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{u.current=null,a.current=null,e(!0)},1e3)):a.current=null,s&&(p={behavior:p.behavior,left:p.top}),g.scrollTo(p)}function m(p){s&&(p={behavior:p.behavior,left:p.top}),o.current.scrollBy(p)}return{scrollByCallback:m,scrollerRef:o,scrollToCallback:d}}const gx="-webkit-sticky",DL="sticky",eD=l5(()=>{if(typeof document>"u")return DL;const i=document.createElement("div");return i.style.position=gx,i.style.position===gx?gx:DL});function tD(i){return i}const TY=Gt(()=>{const i=Ne(u=>`Item ${u}`),e=Ne(null),t=Ne(u=>`Group ${u}`),n=Ne({}),r=Ne(tD),s=Ne("div"),o=Ne(ig),a=(u,c=null)=>ii(ke(n,Ye(d=>d[u]),gn()),c);return{components:n,computeItemKey:r,context:e,EmptyPlaceholder:a("EmptyPlaceholder"),FooterComponent:a("Footer"),GroupComponent:a("Group","div"),groupContent:t,HeaderComponent:a("Header"),HeaderFooterTag:s,ItemComponent:a("Item","div"),itemContent:i,ListComponent:a("List","div"),ScrollerComponent:a("Scroller","div"),scrollerRef:o,ScrollSeekPlaceholder:a("ScrollSeekPlaceholder"),TopItemListComponent:a("TopItemList")}}),IY=Gt(([i,e])=>({...i,...e}),vn(u5,TY)),DY=({height:i})=>v.jsx("div",{style:{height:i}}),kY={overflowAnchor:"none",position:eD(),zIndex:1},m5={overflowAnchor:"none"},RY={...m5,display:"inline-block",height:"100%"},kL=ze.memo(function({showTopList:i=!1}){const e=At("listState"),t=Ws("sizeRanges"),n=At("useWindowScroll"),r=At("customScrollParent"),s=Ws("windowScrollContainerState"),o=Ws("scrollContainerState"),a=r||n?s:o,u=At("itemContent"),c=At("context"),d=At("groupContent"),m=At("trackItemSizes"),p=At("itemSize"),g=At("log"),w=Ws("gap"),b=At("horizontalDirection"),{callbackRef:A}=$J(t,p,m,i?ig:a,g,w,r,b,At("skipAnimationFrameInResizeObserver")),[_,C]=ze.useState(0);nD("deviation",$=>{_!==$&&C($)});const I=At("EmptyPlaceholder"),S=At("ScrollSeekPlaceholder")||DY,R=At("ListComponent"),L=At("ItemComponent"),k=At("GroupComponent"),T=At("computeItemKey"),D=At("isSeeking"),P=At("groupIndices").length>0,N=At("alignToBottom"),F=At("initialItemFinalLocationReached"),M=i?{}:{boxSizing:"border-box",...b?{display:"inline-block",height:"100%",marginLeft:_!==0?_:N?"auto":0,paddingLeft:e.offsetTop,paddingRight:e.offsetBottom,whiteSpace:"nowrap"}:{marginTop:_!==0?_:N?"auto":0,paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},...F?{}:{visibility:"hidden"}};return!i&&e.totalCount===0&&I?v.jsx(I,{...Hr(I,c)}):v.jsx(R,{...Hr(R,c),"data-testid":i?"virtuoso-top-item-list":"virtuoso-item-list",ref:A,style:M,children:(i?e.topItems:e.items).map($=>{const Q=$.originalIndex,ie=T(Q+e.firstItemIndex,$.data,c);return D?Ae.createElement(S,{...Hr(S,c),height:$.size,index:$.index,key:ie,type:$.type||"item",...$.type==="group"?{}:{groupIndex:$.groupIndex}}):$.type==="group"?Ae.createElement(k,{...Hr(k,c),"data-index":Q,"data-item-index":$.index,"data-known-size":$.size,key:ie,style:kY},d($.index,c)):Ae.createElement(L,{...Hr(L,c),...LY(L,$.data),"data-index":Q,"data-item-group-index":$.groupIndex,"data-item-index":$.index,"data-known-size":$.size,key:ie,style:b?RY:m5},P?u($.index,$.groupIndex,$.data,c):u($.index,$.data,c))})})}),PY={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},NY={outline:"none",overflowX:"auto",position:"relative"},Tb=i=>({height:"100%",position:"absolute",top:0,width:"100%",...i?{display:"flex",flexDirection:"column"}:{}}),OY={position:eD(),top:0,width:"100%",zIndex:1};function Hr(i,e){if(typeof i!="string")return{context:e}}function LY(i,e){return{item:typeof i=="string"?void 0:e}}const FY=ze.memo(function(){const i=At("HeaderComponent"),e=Ws("headerHeight"),t=At("HeaderFooterTag"),n=of(ze.useMemo(()=>s=>{e(zc(s,"height"))},[e]),!0,At("skipAnimationFrameInResizeObserver")),r=At("context");return i?v.jsx(t,{ref:n,children:v.jsx(i,{...Hr(i,r)})}):null}),MY=ze.memo(function(){const i=At("FooterComponent"),e=Ws("footerHeight"),t=At("HeaderFooterTag"),n=of(ze.useMemo(()=>s=>{e(zc(s,"height"))},[e]),!0,At("skipAnimationFrameInResizeObserver")),r=At("context");return i?v.jsx(t,{ref:n,children:v.jsx(i,{...Hr(i,r)})}):null});function g5({useEmitter:i,useEmitterValue:e,usePublisher:t}){return ze.memo(function({children:n,style:r,...s}){const o=t("scrollContainerState"),a=e("ScrollerComponent"),u=t("smoothScrollTargetReached"),c=e("scrollerRef"),d=e("context"),m=e("horizontalDirection")||!1,{scrollByCallback:p,scrollerRef:g,scrollToCallback:w}=p5(o,u,a,c,void 0,m);return i("scrollTo",w),i("scrollBy",p),v.jsx(a,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:g,style:{...m?NY:PY,...r},tabIndex:0,...s,...Hr(a,d),children:n})})}function y5({useEmitter:i,useEmitterValue:e,usePublisher:t}){return ze.memo(function({children:n,style:r,...s}){const o=t("windowScrollContainerState"),a=e("ScrollerComponent"),u=t("smoothScrollTargetReached"),c=e("totalListHeight"),d=e("deviation"),m=e("customScrollParent"),p=e("context"),g=ze.useRef(null),w=e("scrollerRef"),{scrollByCallback:b,scrollerRef:A,scrollToCallback:_}=p5(o,u,a,w,m);return f5(()=>{var C;return A.current=m||((C=g.current)==null?void 0:C.ownerDocument.defaultView),()=>{A.current=null}},[A,m]),i("windowScrollTo",_),i("scrollBy",b),v.jsx(a,{ref:g,"data-virtuoso-scroller":!0,style:{position:"relative",...r,...c!==0?{height:c+d}:{}},...s,...Hr(a,p),children:n})})}const BY=({children:i})=>{const e=ze.useContext(h5),t=Ws("viewportHeight"),n=Ws("fixedItemHeight"),r=At("alignToBottom"),s=At("horizontalDirection"),o=ze.useMemo(()=>zB(t,u=>zc(u,s?"width":"height")),[t,s]),a=of(o,!0,At("skipAnimationFrameInResizeObserver"));return ze.useEffect(()=>{e&&(t(e.viewportHeight),n(e.itemHeight))},[e,t,n]),v.jsx("div",{"data-viewport-type":"element",ref:a,style:Tb(r),children:i})},jY=({children:i})=>{const e=ze.useContext(h5),t=Ws("windowViewportRect"),n=Ws("fixedItemHeight"),r=At("customScrollParent"),s=WB(t,r,At("skipAnimationFrameInResizeObserver")),o=At("alignToBottom");return ze.useEffect(()=>{e&&(n(e.itemHeight),t({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:100}))},[e,t,n]),v.jsx("div",{"data-viewport-type":"window",ref:s,style:Tb(o),children:i})},qY=({children:i})=>{const e=At("TopItemListComponent")||"div",t=At("headerHeight"),n={...OY,marginTop:`${t}px`},r=At("context");return v.jsx(e,{style:n,...Hr(e,r),children:i})},UY=ze.memo(function(i){const e=At("useWindowScroll"),t=At("topItemsIndexes").length>0,n=At("customScrollParent"),r=At("context"),s=n||e?zY:HY,o=n||e?jY:BY;return v.jsxs(s,{...i,...Hr(s,r),children:[t&&v.jsx(qY,{children:v.jsx(kL,{showTopList:!0})}),v.jsxs(o,{children:[v.jsx(FY,{}),v.jsx(kL,{}),v.jsx(MY,{})]})]})}),{Component:VY,useEmitter:nD,useEmitterValue:At,usePublisher:Ws}=c5(IY,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},UY),HY=g5({useEmitter:nD,useEmitterValue:At,usePublisher:Ws}),zY=y5({useEmitter:nD,useEmitterValue:At,usePublisher:Ws}),$Y=VY,WY=Gt(()=>{const i=Ne(c=>v.jsxs("td",{children:["Item $",c]})),e=Ne(null),t=Ne(c=>v.jsxs("td",{colSpan:1e3,children:["Group ",c]})),n=Ne(null),r=Ne(null),s=Ne({}),o=Ne(tD),a=Ne(ig),u=(c,d=null)=>ii(ke(s,Ye(m=>m[c]),gn()),d);return{components:s,computeItemKey:o,context:e,EmptyPlaceholder:u("EmptyPlaceholder"),FillerRow:u("FillerRow"),fixedFooterContent:r,fixedHeaderContent:n,itemContent:i,groupContent:t,ScrollerComponent:u("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:u("ScrollSeekPlaceholder"),TableBodyComponent:u("TableBody","tbody"),TableComponent:u("Table","table"),TableFooterComponent:u("TableFoot","tfoot"),TableHeadComponent:u("TableHead","thead"),TableRowComponent:u("TableRow","tr"),GroupComponent:u("Group","tr")}});vn(u5,WY);eD();const RL={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},GY={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:PL,floor:a1,max:By,min:yx,round:NL}=Math;function OL(i,e,t){return Array.from({length:e-i+1}).map((n,r)=>({data:t===null?null:t[r+i],index:r+i}))}function KY(i){return{...GY,items:i}}function Nw(i,e){return i&&i.width===e.width&&i.height===e.height}function JY(i,e){return i&&i.column===e.column&&i.row===e.row}const YY=Gt(([{increaseViewportBy:i,listBoundary:e,overscan:t,visibleRange:n},{footerHeight:r,headerHeight:s,scrollBy:o,scrollContainerState:a,scrollTo:u,scrollTop:c,smoothScrollTargetReached:d,viewportHeight:m},p,g,{didMount:w,propsReady:b},{customScrollParent:A,useWindowScroll:_,windowScrollContainerState:C,windowScrollTo:I,windowViewportRect:S},R])=>{const L=Ne(0),k=Ne(0),T=Ne(RL),D=Ne({height:0,width:0}),P=Ne({height:0,width:0}),N=qt(),F=qt(),M=Ne(0),$=Ne(null),Q=Ne({column:0,row:0}),ie=qt(),ee=qt(),ue=Ne(!1),Y=Ne(0),J=Ne(!0),q=Ne(!1),H=Ne(!1);Zt(ke(w,kt(Y),vt(([te,ae])=>!!ae)),()=>{St(J,!1)}),Zt(ke(hr(w,J,P,D,Y,q),vt(([te,ae,de,ye,,xe])=>te&&!ae&&de.height!==0&&ye.height!==0&&!xe)),([,,,,te])=>{St(q,!0),YI(1,()=>{St(N,te)}),Ia(ke(c),()=>{St(e,[0,0]),St(J,!0)})}),it(ke(ee,vt(te=>te!=null&&te.scrollTop>0),ya(0)),k),Zt(ke(w,kt(ee),vt(([,te])=>te!=null)),([,te])=>{te&&(St(D,te.viewport),St(P,te.item),St(Q,te.gap),te.scrollTop>0&&(St(ue,!0),Ia(ke(c,$m(1)),ae=>{St(ue,!1)}),St(u,{top:te.scrollTop})))}),it(ke(D,Ye(({height:te})=>te)),m),it(ke(hr(_t(D,Nw),_t(P,Nw),_t(Q,(te,ae)=>te&&te.column===ae.column&&te.row===ae.row),_t(c)),Ye(([te,ae,de,ye])=>({gap:de,item:ae,scrollTop:ye,viewport:te}))),ie),it(ke(hr(_t(L),n,_t(Q,JY),_t(P,Nw),_t(D,Nw),_t($),_t(k),_t(ue),_t(J),_t(Y)),vt(([,,,,,,,te])=>!te),Ye(([te,[ae,de],ye,xe,Oe,Fe,Be,,We,mt])=>{const{column:fe,row:ve}=ye,{height:Ie,width:Re}=xe,{width:be}=Oe;if(Be===0&&(te===0||be===0))return RL;if(Re===0){const an=XI(mt,te),Hn=an+Math.max(Be-1,0);return KY(OL(an,Hn,Fe))}const rt=v5(be,Re,fe);let qe,Ze;We?ae===0&&de===0&&Be>0?(qe=0,Ze=Be-1):(qe=rt*a1((ae+ve)/(Ie+ve)),Ze=rt*PL((de+ve)/(Ie+ve))-1,Ze=yx(te-1,By(Ze,rt-1)),qe=yx(Ze,By(0,qe))):(qe=0,Ze=-1);const st=OL(qe,Ze,Fe),{bottom:ft,top:gt}=LL(Oe,ye,xe,st),xi=PL(te/rt),Mt=xi*Ie+(xi-1)*ve-ft;return{bottom:ft,itemHeight:Ie,items:st,itemWidth:Re,offsetBottom:Mt,offsetTop:gt,top:gt}})),T),it(ke($,vt(te=>te!==null),Ye(te=>te.length)),L),it(ke(hr(D,P,T,Q),vt(([te,ae,{items:de}])=>de.length>0&&ae.height!==0&&te.height!==0),Ye(([te,ae,{items:de},ye])=>{const{bottom:xe,top:Oe}=LL(te,ye,ae,de);return[Oe,xe]}),gn(Zy)),e);const G=Ne(!1);it(ke(c,kt(G),Ye(([te,ae])=>ae||te!==0)),G);const le=bs(ke(hr(T,L),vt(([{items:te}])=>te.length>0),kt(G),vt(([[te,ae],de])=>{const ye=te.items[te.items.length-1].index===ae-1;return(de||te.bottom>0&&te.itemHeight>0&&te.offsetBottom===0&&te.items.length===ae)&&ye}),Ye(([[,te]])=>te-1),gn())),se=bs(ke(_t(T),vt(({items:te})=>te.length>0&&te[0].index===0),ya(0),gn())),X=bs(ke(_t(T),kt(ue),vt(([{items:te},ae])=>te.length>0&&!ae),Ye(([{items:te}])=>({endIndex:te[te.length-1].index,startIndex:te[0].index})),gn(QB),Rc(0)));it(X,g.scrollSeekRangeChanged),it(ke(N,kt(D,P,L,Q),Ye(([te,ae,de,ye,xe])=>{const Oe=r5(te),{align:Fe,behavior:Be,offset:We}=Oe;let mt=Oe.index;mt==="LAST"&&(mt=ye-1),mt=By(0,mt,yx(ye-1,mt));let fe=sS(ae,xe,de,mt);return Fe==="end"?fe=NL(fe-ae.height+de.height):Fe==="center"&&(fe=NL(fe-ae.height/2+de.height/2)),We&&(fe+=We),{behavior:Be,top:fe}})),u);const ne=ii(ke(T,Ye(te=>te.offsetBottom+te.bottom)),0);return it(ke(S,Ye(te=>({height:te.visibleHeight,width:te.visibleWidth}))),D),{customScrollParent:A,data:$,deviation:M,footerHeight:r,gap:Q,headerHeight:s,increaseViewportBy:i,initialItemCount:k,itemDimensions:P,overscan:t,restoreStateFrom:ee,scrollBy:o,scrollContainerState:a,scrollHeight:F,scrollTo:u,scrollToIndex:N,scrollTop:c,smoothScrollTargetReached:d,totalCount:L,useWindowScroll:_,viewportDimensions:D,windowScrollContainerState:C,windowScrollTo:I,windowViewportRect:S,...g,gridState:T,horizontalDirection:H,initialTopMostItemIndex:Y,totalListHeight:ne,...p,endReached:le,propsReady:b,rangeChanged:X,startReached:se,stateChanged:ie,stateRestoreInProgress:ue,...R}},vn(QI,Ci,t2,a5,rh,ZI,nh));function v5(i,e,t){return By(1,a1((i+t)/(a1(e)+t)))}function LL(i,e,t,n){const{height:r}=t;if(r===void 0||n.length===0)return{bottom:0,top:0};const s=sS(i,e,t,n[0].index);return{bottom:sS(i,e,t,n[n.length-1].index)+r,top:s}}function sS(i,e,t,n){const r=v5(i.width,t.width,e.column),s=a1(n/r),o=s*t.height+By(0,s-1)*e.row;return o>0?o+e.row:o}const XY=Gt(()=>{const i=Ne(m=>`Item ${m}`),e=Ne({}),t=Ne(null),n=Ne("virtuoso-grid-item"),r=Ne("virtuoso-grid-list"),s=Ne(tD),o=Ne("div"),a=Ne(ig),u=(m,p=null)=>ii(ke(e,Ye(g=>g[m]),gn()),p),c=Ne(!1),d=Ne(!1);return it(_t(d),c),{components:e,computeItemKey:s,context:t,FooterComponent:u("Footer"),HeaderComponent:u("Header"),headerFooterTag:o,itemClassName:n,ItemComponent:u("Item","div"),itemContent:i,listClassName:r,ListComponent:u("List","div"),readyStateChanged:c,reportReadyState:d,ScrollerComponent:u("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:u("ScrollSeekPlaceholder","div")}}),QY=Gt(([i,e])=>({...i,...e}),vn(YY,XY)),ZY=ze.memo(function(){const i=Cn("gridState"),e=Cn("listClassName"),t=Cn("itemClassName"),n=Cn("itemContent"),r=Cn("computeItemKey"),s=Cn("isSeeking"),o=Gs("scrollHeight"),a=Cn("ItemComponent"),u=Cn("ListComponent"),c=Cn("ScrollSeekPlaceholder"),d=Cn("context"),m=Gs("itemDimensions"),p=Gs("gap"),g=Cn("log"),w=Cn("stateRestoreInProgress"),b=Gs("reportReadyState"),A=of(ze.useMemo(()=>_=>{const C=_.parentElement.parentElement.scrollHeight;o(C);const I=_.firstChild;if(I){const{height:S,width:R}=I.getBoundingClientRect();m({height:S,width:R})}p({column:FL("column-gap",getComputedStyle(_).columnGap,g),row:FL("row-gap",getComputedStyle(_).rowGap,g)})},[o,m,p,g]),!0,!1);return f5(()=>{i.itemHeight>0&&i.itemWidth>0&&b(!0)},[i]),w?null:v.jsx(u,{className:e,ref:A,...Hr(u,d),"data-testid":"virtuoso-item-list",style:{paddingBottom:i.offsetBottom,paddingTop:i.offsetTop},children:i.items.map(_=>{const C=r(_.index,_.data,d);return s?v.jsx(c,{...Hr(c,d),height:i.itemHeight,index:_.index,width:i.itemWidth},C):Ae.createElement(a,{...Hr(a,d),className:t,"data-index":_.index,key:C},n(_.index,_.data,d))})})}),eX=ze.memo(function(){const i=Cn("HeaderComponent"),e=Gs("headerHeight"),t=Cn("headerFooterTag"),n=of(ze.useMemo(()=>s=>{e(zc(s,"height"))},[e]),!0,!1),r=Cn("context");return i?v.jsx(t,{ref:n,children:v.jsx(i,{...Hr(i,r)})}):null}),tX=ze.memo(function(){const i=Cn("FooterComponent"),e=Gs("footerHeight"),t=Cn("headerFooterTag"),n=of(ze.useMemo(()=>s=>{e(zc(s,"height"))},[e]),!0,!1),r=Cn("context");return i?v.jsx(t,{ref:n,children:v.jsx(i,{...Hr(i,r)})}):null}),nX=({children:i})=>{const e=ze.useContext(d5),t=Gs("itemDimensions"),n=Gs("viewportDimensions"),r=of(ze.useMemo(()=>s=>{n(s.getBoundingClientRect())},[n]),!0,!1);return ze.useEffect(()=>{e&&(n({height:e.viewportHeight,width:e.viewportWidth}),t({height:e.itemHeight,width:e.itemWidth}))},[e,n,t]),v.jsx("div",{ref:r,style:Tb(!1),children:i})},rX=({children:i})=>{const e=ze.useContext(d5),t=Gs("windowViewportRect"),n=Gs("itemDimensions"),r=Cn("customScrollParent"),s=WB(t,r,!1);return ze.useEffect(()=>{e&&(n({height:e.itemHeight,width:e.itemWidth}),t({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:e.viewportWidth}))},[e,t,n]),v.jsx("div",{ref:s,style:Tb(!1),children:i})},iX=ze.memo(function({...i}){const e=Cn("useWindowScroll"),t=Cn("customScrollParent"),n=t||e?oX:sX,r=t||e?rX:nX,s=Cn("context");return v.jsx(n,{...i,...Hr(n,s),children:v.jsxs(r,{children:[v.jsx(eX,{}),v.jsx(ZY,{}),v.jsx(tX,{})]})})}),{useEmitter:w5,useEmitterValue:Cn,usePublisher:Gs}=c5(QY,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},iX),sX=g5({useEmitter:w5,useEmitterValue:Cn,usePublisher:Gs}),oX=y5({useEmitter:w5,useEmitterValue:Cn,usePublisher:Gs});function FL(i,e,t){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&t(`${i} was not resolved to pixel value correctly`,e,Vi.WARN),e==="normal"?0:parseInt(e??"0",10)}class aX extends zI{getListHtml(){return v.jsx(v.Fragment,{children:v.jsx($Y,{className:this.props.ViewPortMCClassName||"flinnTechVirtuoso",style:{height:this.props.vHeight||"100%"},totalCount:this.list.length,itemContent:e=>{const t=this.list[e];return this.mapSection.getHtml({type:"div",content:this.getCellList(t)})}})})}}class lX extends IB{constructor(){super(...arguments);re(this,"factory",{text:gJ,attribute:Ab,custom:yJ,customBuilt:OJ,img:VB,form:vJ,del:VI,delIcon:gL,delCustom:gL,delText:wJ,edit:HI,editIcon:bJ,editCustom:AJ,interactiveMap:EJ,addComponentButton:CJ,plain:xJ,select:SJ,logo:TJ,links:IJ,linkItem:DJ,logout:kJ,default:er,map:zI,order:RJ,innerMap:PJ,backgroundImage:NJ,viewPortMap:aX})}}class rD{constructor(){re(this,"MCMapContainer","Map-Container");re(this,"MCMapSection","Map-Section");re(this,"MCLink","Map-Link");re(this,"MCCell","Map-Cell");re(this,"MCCustomDelItem","Map-Custom-Del-Item");re(this,"MCDelItem","Map-Del-Item");re(this,"MCDelImgItem","Map-Del-imgItem");re(this,"MCCustomEditItem","Map-Custom-Edit-Item");re(this,"MCEditImgItem","Map-Edit-imgItem");re(this,"MCEditItem","Map-Edit-Item");re(this,"MCAttributeItem","Map-Attribute-Item");re(this,"MCImgItem","Map-imgItem");re(this,"MCTextItem","Map-Text-Item");re(this,"MCActiveItem","Map-Active-Item");re(this,"MCCustom","");re(this,"MCBackgroundItem","background-item");re(this,"MCCellBackground","cell-background");re(this,"MCBackgroundLink","cell-background");re(this,"MCLogoItem","navLogo")}}class Ib extends rD{constructor(){super(...arguments);re(this,"MCSectionHover","DC-Map-Section:hover");re(this,"MCCustomDelItem","DC-Custom-Del-Item");re(this,"MCDelItem","DC-Del-Item");re(this,"MCDelImgItem","DC-Del-imgItem");re(this,"MCCustomEditItem","Map-Custom-Edit-Item");re(this,"MCEditImgItem","DC-Edit-imgItem");re(this,"MCEditItem","DC-Edit-Item")}}class Db extends Ib{constructor(){super(...arguments);re(this,"MCMapContainer","DR-Map-Container");re(this,"MCMapSection","DR-Map-Section")}}class uX extends Db{constructor(){super(...arguments);re(this,"MCMapContainer","DRW-Map-Container")}}class cX extends Db{constructor(){super(...arguments);re(this,"MCMapContainer","IM-Map-Container");re(this,"MCMapSection","IM-Map-Section");re(this,"MCMap","IM-Map");re(this,"MCAddButton","IM-addButton");re(this,"MCActiveItem","IM-Active-Item");re(this,"MCCell","IM-Cell")}}class hX extends Db{constructor(){super(...arguments);re(this,"MCActiveLink",this.MCActiveItem);re(this,"MCLinkItem",this.MCLink);re(this,"MCMapSection","SB-Map-Section")}}class dX extends Ib{constructor(){super(...arguments);re(this,"MCActiveLink",this.MCActiveItem);re(this,"MCLinkItem",this.MCLink);re(this,"MCMapSection","SB-link");re(this,"MCCell","SB-Cell-Link");re(this,"MCLink","SB-Map-Link");re(this,"MCLinkItem","SB-Map-Link")}}class fX extends Ib{constructor(){super(...arguments);re(this,"MCActiveLink",this.MCActiveItem);re(this,"MCLinkItem",this.MCLink)}}const pX=Object.freeze(Object.defineProperty({__proto__:null,DefaultColumn:Ib,DefaultRegistry:rD,DefaultRow:Db,DefaultWrapRow:uX,InteractiveMap:cX,Links:dX,SideBar:hX,TopBar:fX},Symbol.toStringTag,{value:"Module"}));class mX extends MI{constructor(){super(pX),this.factory.default=rD}}class gX{constructor(){re(this,"factory",{text:nv,tag:_5,plain:_X,textAndTag:wX,textAndTag2:vX,bool:AX,textAttributeList:bX})}getFilter(e){if(e)return this.factory[e]}registerFilter(e,t){this.factory[e]=t}}function _5(i){let{list:e,attribute:t,tagList:n}=i;return e.length>0&&(e=e.filter(r=>!!n.find(o=>(t?o.getJson()[t]:o.getJson().connectedId)===r.getJson()._id))),e}function yX(i){let e=[];if(i.search&&i.list){const t=i.search.toLowerCase().split(" ").map(n=>n.trim());e=i.list.filter(n=>{const r=n.getJson()[i.attribute||"tags"];if(r){let s=r.split(i.splitStr||",");s=s.map(o=>o.toLowerCase());for(let o of t)if(s.includes(o))return!0}else return!1})}return e}function vX(i){let{list:e,attributes:t,search:n}=i,r=[],s=[],o=t.split(",");for(let u of o)s.push(nv({...i,attribute:u}));let a=yX({...i});return r=[...s[0],...a,...s[1],...s[2]],r=iD(r),r}function wX(i){let{list:e,attribute:t,tagList:n,attribute2:r,attributeTag:s,search:o}=i,a=nv({...i,attribute:t}),u=_5({...i,attribute:s}),c=nv({...i,attribute:r});return e=[...a,...u,...c],iD(e)}function iD(i){const e=new Map;return i.forEach(t=>{const r=t.getJson()._id;e.has(r)||e.set(r,t)}),Array.from(e.values())}function nv(i){let{list:e,attribute:t,search:n}=i;return n&&n.length>0&&(e=e.filter(r=>{var s;return(s=r.getJson()[t])==null?void 0:s.toLowerCase().includes(n==null?void 0:n.toLowerCase())})),e}function _X(i){let{list:e,attribute:t,search:n}=i;return n&&n.length>0&&(e=e.filter(r=>{var s;return(s=r[t])==null?void 0:s.toLowerCase().includes(n==null?void 0:n.toLowerCase())})),e}function bX(i){let{attributeList:e}=i,t=[];for(let n of e)t=[...t,...nv({...i,attribute:n})];return t=iD(t),t}function AX(i){let{list:e,attribute:t,search:n}=i;return e=e.filter(r=>r.getJson()[t]===n),e}class b5 extends eg{constructor(){super();re(this,"FilterFactory");this.getFilterFactory(),this.mainFunc=this.getMapComponent}getFactory(){return this.factory===void 0&&(this.factory=new lX),this.factory}getThemeFactory(){return this.themeFactory===void 0&&(this.themeFactory=new mX),this.themeFactory}getFilterFactory(){return this.filterFactory===void 0&&(this.filterFactory=new gX),this.filterFactory}getMapComponent(t,n){return n=n||"default",this.factory.getComponent(n,t)}}class er extends UI{constructor(e){super(e),this.state={type:"map"},this.interface=A5}setFilterInfo(){this.filterFacotry=this.interface.getFilterFactory(),this.filters=this.props.filters,this.filterFunc=this.props.filterFunc,this.filter=this.props.filter}getFilterFunc(){var e;if(!this.filterFunc&&this.filters!==void 0){let t=(e=this.filters)==null?void 0:e.find(n=>n.type==="filterFunc");t&&(this.filterFunc=t.func)}}getFilter(){var e;if(!this.filter&&this.filters!==void 0){let t=(e=this.filters)==null?void 0:e.find(n=>n.type==="filter");t&&(this.filter={...t})}}getList(){var t,n,r,s;let e=this.props.name;this.list=this.props.list?this.props.list:this.filter?(r=this.componentList)==null?void 0:r.getList(e,(t=this.filter)==null?void 0:t.search,(n=this.filter)==null?void 0:n.attribute):(s=this.componentList)==null?void 0:s.getList(e)}filterListByFilterFunc(){this.list&&(this.list=this.list.filter(e=>this.filterFunc?this.filterFunc(e):!0))}filterListByFilterFactory(){if(this.filters)for(let e of this.filters){let t=this.filterFacotry.getFilter(e.type);t&&(this.list=t({list:this.list,...e}))}}setProps(){let e=this.props.cells;this.addToProps={cells:e,list:this.list}}componentPreSetup(){this.addToInitialSetup=[this.setFilterInfo,this.getFilterFunc,this.getFilter,this.getList,this.filterListByFilterFunc,this.filterListByFilterFactory]}}const A5=new b5;class E5 extends ct{constructor(e){super(e),this.initialPropsSetupFunctions=[...this.initialPropsSetupFunctions,this.getNavLists],this.state={}}getLinks(){var e,t;return this.props.links?this.props.links:(t=(e=this.props.app)==null?void 0:e.state)==null?void 0:t.routes}getDefaultNavItem(e){return{logo:{imgSrc:this.props.logoURL,label:this.props.logoLabel,...this.props},links:{links:this.getLinks(),...this.props,class:"fit"},logout:{logoutFunc:this.props.logoutFunc,auth:this.props.auth,wrapperClass:"SB-logout",...this.props}}[e]}getList(){let e=this.props.navList,t=e.getList();for(let n=0;n<t.length;n++)if(t[n].default){let r=this.getDefaultNavItem(t[n].type);r.type=t[n].type,e.update(n,r)}return this.props.type==="topBar"&&(t=t.filter(n=>n.type!=="links")),t}getHtml(){return v.jsx(er,{theme:this.props.mapTheme,list:this.mapList,cells:this.list,...this.props.navMapProps})}getNavLists(){this.list=this.props.list?this.props.list:this.getList(),this.mapList=this.props.mapList?this.props.mapList:[{}]}}class EX{constructor(){re(this,"factory",{default:E5})}getComponent(e,t){let n;return this.factory[e]&&(n=this.factory[e]),v.jsx(n,{...t})}registerComponent(e,t){this.factory[e]=t}}class CX extends ct{constructor(e){super(e),this.state={defaultStyle:"navMenu",renderComp:void 0}}async open(){let e=await this.props.open();this.props.type==="topBar"&&(this.state.renderComp?this.setState({renderComp:void 0}):this.setState({renderComp:e}))}render(){return this.props.app,v.jsxs("div",{children:[v.jsxs("div",{onClick:this.open,className:this.props.menuClass?this.props.menuClass:this.state.defaultStyle,children:[this.props.menuContent&&v.jsx(v.Fragment,{children:this.props.menuContent})," "]}),this.state.renderComp&&v.jsx(v.Fragment,{children:this.state.renderComp})]})}}class xX extends pr{constructor(e){super(e),this.state={...this.state,defaultType:this.props.type?this.props.type:"sideBar",typeKey:"layout",defaultNavType:"default",phoneSize:850,left:-400}}getProps(){var e,t;return{mapTheme:this.props.mapTheme||this.state.defaultType,links:this.props.links||((t=(e=this.props.app)==null?void 0:e.state)==null?void 0:t.routes),...this.props}}getFactoryComponent(e){let t=this.props.mapType?this.props.mapType:this.state.defaultNavType;return this.props.factory.getComponent(t,e)}componentDidMount(){this.resize!==void 0&&(window.addEventListener("resize",this.resize),this.resize())}componentWillUnmount(){this.resize!==void 0&&window.removeEventListener("resize",this.resize)}resize(){if(window.innerWidth<850){this.setState({phone:!0,tablet:!1,defaultType:this.props.phoneLayout?this.props.phoneLayout:this.state.ogType?this.state.ogType:this.state.defaultType,ogType:this.state.ogType?this.state.ogType:this.state.defaultType});return}if(window.innerWidth<1224){this.setState({phone:!1,tablet:!0,defaultType:this.props.tabletLayout?this.props.tabletLayout:this.state.ogType?this.state.ogType:this.state.defaultType,ogType:this.state.ogType?this.state.ogType:this.state.defaultType});return}window.innerWidth>1224&&(this.state.phone&&this.setState({phone:!1,defaultType:this.state.ogType}),this.state.tablet&&this.setState({tablet:!1,defaultType:this.state.ogType}))}async setStyleOnMenuClick(e){const t=n=>new Promise(r=>setTimeout(r,n));this.card.setStyle({...this.card.getStyle(),left:e.toString()+"px"}),await this.setState({left:e}),await t(10)}async setNavOpenClose(){if(this.state.left===-400)for(let e=-400;e<600;e=e+15){if(e>0){this.setState({left:0});break}await this.setStyleOnMenuClick(e)}else for(let e=0;e>-450;e=e-15){if(e<-400){this.setState({left:-400});break}await this.setStyleOnMenuClick(e)}}async openCloseLinks(){var n,r;let e=v.jsx(er,{list:this.props.links||((r=(n=this.props.app)==null?void 0:n.state)==null?void 0:r.routes),cells:[{type:"link"}]});return v.jsx(pr,{content:e})}async openCloseNavFun(){return await{topBar:this.openCloseLinks,sideBar:this.setNavOpenClose}[this.state.defaultType]()}getMenu(){return this.props.menuComponent?v.jsx(this.props.menuComponent,{...this.props.menuComponentProps,open:this.openCloseNavFun,type:this.state.defaultType}):v.jsx(CX,{open:this.openCloseNavFun,type:this.state.defaultType,...this.props.menuComponentProps})}getContent(){let e=this.getProps(),t=this.getFactoryComponent(e);return this.content=v.jsxs(v.Fragment,{children:[t,this.props.type!=="type"&&(this.state.phone||window.innerWidth<this.state.phoneSize)&&v.jsx(v.Fragment,{children:this.getMenu()})]}),this.content}}class SX{constructor(){Ai.bind(this),this.list=[{type:"logo",picURL:void 0,label:void 0,default:!0},{type:"links",linkJson:void 0,default:!0},{type:"logout",logoutFunc:void 0,auth:void 0,default:!0}]}setList(e){this.list=e}getList(){return this.list}insert(e,t){if(e<0||e>=this.list.length){console.error("Index out of bounds");return}this.list.splice(e,0,t)}add(e,t){t?this.list.unshift(e):this.list.push(e)}addCustomJSX(e,t,n){let r={type:"custom",custom:e};t?this.insert(t,r):this.add(r,n)}update(e,t){if(e<0||e>=this.list.length){console.error("Index out of bounds");return}this.list[e]={...this.list[e],...t}}remove(e){if(e<0||e>=this.list.length){console.error("Index out of bounds");return}this.list.splice(e,1)}}class C5 extends eg{constructor(){super();re(this,"factory");re(this,"navList");Ai.bind(this),this.getFactory(),this.getNavList(),this.mainFunc=this.getNav}getFactory(){return this.factory||(this.factory=new EX),this.factory}getNav(t){return v.jsx(xX,{factory:this.factory,navInterface:this,navList:this.navList,...t})}getNewNavList(){return new SX}setNavListForce(t){this.navList=t}getNavList(){return this.navList||(this.navList=this.getNewNavList()),this.navList}}const l1=new C5;class TX extends UI{constructor(e){super(e),this.interface=l1}}class IX{constructor(){re(this,"factory",{})}getComponent(e){return this.factory[e]}registerComponent(e,t){this.factory[e]=t}}class DX extends IX{constructor(){super(...arguments);re(this,"factory",{})}}class kX extends ct{constructor(e){super(e),this.state={}}checkPopupSwitch(e){var t,n;return this.popupSwitch=this.props.popupSwitch||((n=(t=this.props.app)==null?void 0:t.state)==null?void 0:n.popupSwitch),this.popupSwitch!==""&&this.popupSwitch!==void 0&&(e=!0),e}checkType(e){var r,s,o,a,u;let t=this.props.currentPopupComponent||((s=(r=this.props.app)==null?void 0:r.state)==null?void 0:s.currentPopupComponent),n=(o=this.popupFactory.getComponent(this.popupSwitch))==null?void 0:o.componentType;return n&&(t=this.isArray(t),e=((u=(a=t[0])==null?void 0:a.getJson())==null?void 0:u.type)===n&&t.length>0),e}render(){var n;let e=this.checkPopupSwitch(!1);e&&(e=this.checkType(e)),this.popupFactory=this.props.factory||this.props.app.state.popupFactory;let t=(n=this.popupFactory)==null?void 0:n.getComponent(this.popupSwitch);return v.jsx(v.Fragment,{children:e&&(t==null?void 0:t.content)&&v.jsx(pr,{content:v.jsx(t.content,{}),popup:!0,type:t.popupType||"biggerCard",theme:t.popupTheme||"Default",handleClose:()=>{if(t.handleClose)t.handleClose();else{let r=this.props.app.state.currentPopupComponent;r&&this.props.app.state.operationsFactory.removeFromList(r),this.props.app.dispatch({currentPopupComponent:void 0,popupSwitch:void 0})}}})})}}class RX extends eg{constructor(){super();re(this,"factory");Ai.bind(this),this.getFactory()}getFactory(){return this.factory||(this.factory=new DX),this.factory}createPopupMachine(t){return v.jsx(kX,{app:(t==null?void 0:t.app)||this.getAppComponent(),factory:this.factory})}}let ML=new RX;class PX{constructor(){re(this,"convertStringToLink",e=>e&&(!e.startsWith("http://")&&!e.startsWith("https://")?"https://"+e:e))}isLikelyUrl(e){return/\.(com|net|org|io|gov|edu|co)\b/.test(e)||/^(?:f|ht)tps?\:\/\//.test(e)||/^mailto\:/i.test(e)}checkURLforString(e){return window.location.href.includes(e)}getIdFromURL(e,t){let r=window.location.href.split("/"),s=r[r.length-1],o=e?s.split("-"):[s];return t?o[t]:o[0]}getTypeFromURL(){let t=window.location.href.split("/");return t[t.length-2]}}let Js=new PX;class x5 extends ct{constructor(t,n){super(t);re(this,"dispatchItems",{});this.state={...this.state,type:n==null?void 0:n.type,ids:n==null?void 0:n.ids,filterKeys:n==null?void 0:n.filterKeys,path:n==null?void 0:n.path,snapShot:n==null?void 0:n.snapShot,owner:!0},(n==null?void 0:n.owner)===!1&&(this.state.owner=!1)}async getComponentsFromBackend(){let{type:t,ids:n,filterKeys:r,path:s,snapShot:o,owner:a}=this.state;this.compList=await this.componentList.getList(t,n,r),this.compList.length>0&&await this.setState({gotComponents:!0}),this.compList=await this.componentList.getComponentsFromBackend({type:t,ids:n,filterKeys:r,path:s,snapShot:o,owner:a}),this.setState({gotComponents:!0,getComponentsFromBackend:!0,components:this.compList,urlId:n})}async componentDidMount(){this.getComponentsFromBackend();let t=this;window.addEventListener("popstate",function(n){t.onBackClick(n)})}onBackClick(t){this.getComponentsFromBackend()}componentDidUpdate(){this.getComponentsAgain()}async getComponentsAgain(t,n){this.getFromURL(),(this.app.state.urlChange||this.state.reRender&&this.urlId!==this.state.urlId)&&(await this.setState({urlId:this.urlId}),await this.dispatch({urlChange:void 0}),this.forceRerender=!1,this.getComponentsFromBackend())}async getFromURL(){this.urlType=Js.getTypeFromURL(),this.urlId=Js.getIdFromURL()}}class lf extends x5{constructor(t,n){super(t,n);re(this,"dispatchItems",{});this.state={...this.state,type:n==null?void 0:n.type,ids:n==null?void 0:n.ids,filterKeys:n==null?void 0:n.filterKeys,path:n==null?void 0:n.path,snapShot:n==null?void 0:n.snapShot,owner:n==null?void 0:n.owner},(n==null?void 0:n.owner)===!1&&(this.state.owner=!1)}async getComponentsFromBackend(){let{type:t,ids:n,filterKeys:r,path:s,snapShot:o,owner:a}=this.state;this.compList=await this.componentList.getComponents(),this.compList.length>0&&await this.setState({gotComponents:!0}),this.compList=await this.componentList.getComponentsFromBackend({type:this.state.owner,ids:n,filterKeys:r,path:s,snapShot:o,typeAttribute:"owner"}),this.setState({gotComponents:!0,getComponentsFromBackend:!0,components:this.compList,urlId:n})}}class sg extends x5{async getComponentsFromBackend(){await this.getFromURL(),await this.getFirstComponent(),this.comp&&await this.getAssociatedItems(),this.setGotComponents()}async getFirstComponent(e,t){let n=e||this.urlType,r=t||this.urlId;this.comp=this.componentList.getComponent(n,r),this.comp||(this.comp=await this.componentList.getComponentsFromBackend({type:n,ids:r,filterKeys:"_id",owner:this.state.owner}),this.comp=this.comp.length>0?this.comp[0]:void 0)}async getAssociatedItems(){this.compList=await this.comp.getAssociatedItems(this.state.itemTypes),this.compList.length>0&&this.setState({gotComponents:!0}),this.compList=await this.comp.getAssociatedItemsFromBackend(this.state.itemTypes),await this.setCurrentItems()}setCurrentItems(){this.dispatch({currentComponent:this.comp,["current"+this.getCapitalFirstLetter(this.comp.getJson().type)]:this.comp,...this.dispatchItems})}setGotComponents(){this.setState({gotComponents:!0,gotComponentsFromBackend:!0,components:this.compList,urlId:this.urlId})}}class S5 extends ct{constructor(e){super(e),this.state={...this.state,email:"",password:""}}validate(){return!0}onChange(e){let{name:t,value:n}=e.target;this.setState({[t]:n})}onSub(){this.validate()&&this.APIService.login(this.state.email,this.state.password)}getSwitchLink(){return v.jsxs("div",{id:"signUpFT",children:["Don't have an Account? ",v.jsx(yn,{to:"/register",children:"Sign Up"})]})}preSetup(){this.setComponents(["container","header","form","submitButton"])}getHeaderHtml(){return this.header.getHtml({type:"h1",content:"Login"})}getFormHtml(){let e=v.jsxs(v.Fragment,{children:[v.jsx("div",{children:"Email"}),v.jsx("input",{className:"defaultInputFormAuth",name:"email",onChange:this.onChange,value:this.state.email}),v.jsx("div",{style:{marginTop:"10px"},children:"Password"}),v.jsx("input",{className:"defaultInputFormAuth",name:"password",type:"password",onChange:this.onChange,value:this.state.password})]});return this.form.setClass("defaultLoginForm"),this.form.getHtml({type:"div",content:e})}getSubmitHtml(){return this.submitButton.setClass("defaultLoginButton"),this.submitButton.setOnClick(this.onSub),this.submitButton.getHtml({type:"div",content:"Submit"})}getContainerHtml(){this.container.setClass(this.props.loginContainer||"fitCC");let e=v.jsxs(v.Fragment,{children:[this.getHeaderHtml(),this.getFormHtml(),this.getSubmitHtml(),this.getSwitchLink()]});return this.container.getHtml({type:"div",content:e})}getHtml(){let e=this.getContainerHtml();return v.jsx("div",{className:"fullCCLayoutRow",children:v.jsx(pr,{type:this.props.loginCardType||"biggerCard",content:e})})}}class NX extends S5{async onSub(){if(this.validate()){let e=await this.APIService.register(this.state.email,this.state.password);if(!e.error){let t={type:"user",email:this.state.email,_id:this.state.email};e=await this.componentList.addComponents(t),window.history.pushState({},"","/"),this.dispatch({currentUser:e})}}}getHeaderHtml(){return this.header.getHtml({type:"h1",content:"Register"})}getSwitchLink(){return v.jsxs("div",{children:["Have an Account? ",v.jsx(yn,{to:"/login",children:"Login"})]})}}class OX extends ct{constructor(e){super(e),this.state={...this.state,routes:[],loginComp:S5,registerComp:NX}}addToRouter(e){let t=[...this.state.routes,e];this.setState({routes:t})}getRouteMap(e,t){let n=v.jsx(v.Fragment,{});return e&&(e=[...e],n=e==null?void 0:e.map((r,s)=>(r.path||(r.path=this.classNameToString(r.comp),s===0&&(r.path="/")),v.jsxs(v.Fragment,{children:[v.jsx(Du,{path:r.path,element:v.jsx(r.comp,{props:{...t,...r.props}})}),v.jsx(Du,{path:r.path+"/:id",element:v.jsx(r.idComp,{props:{...t,...r.props}})})]})))),n}getRoutes(e,t){var r;let n=v.jsxs(kN,{children:[this.getRouteMap(e,t),this.state.routes.map((s,o)=>v.jsx(v.Fragment,{children:s}))]});return(r=this.app)!=null&&r.state.currentUser||(n=this.getUserAuthRoutes(t)),n}getUserAuthRoutes(e){let t=e.extraAuthRoutes,n=e.loginComp||this.state.loginComp,r=e.registerComp||this.state.registerComp;return v.jsxs(kN,{children:[v.jsx(Du,{path:"/",element:v.jsx(n,{props:{...e}})}),v.jsx(Du,{path:"/login",element:v.jsx(n,{props:{...e}})}),v.jsx(Du,{path:"/register",element:v.jsx(r,{props:{...e}})}),t==null?void 0:t.map((o,a)=>v.jsxs(v.Fragment,{children:[v.jsx(Du,{path:o.path,element:v.jsx(o.comp,{props:{...e,...o.props}})}),v.jsx(Du,{path:o.path+"/:id",element:v.jsx(o.idComp,{props:{...e,...o.props}})})]}))]})}getHtml(){var s;let e={...this.props};e.app=this.app;let t=(s=this.app)==null?void 0:s.state,n=this.props.routes||(t==null?void 0:t.routes),r=this.getRoutes(n,e);return v.jsx(v.Fragment,{children:r})}}class LX{constructor(){re(this,"registry",{})}getRegistry(){return this.registry}addToRegistry(e,t){this.registry[e]=t}getItemFromRegistry(e){return this.registry[e]}}class FX extends ct{constructor(t,n,r){super(t);re(this,"endpoint");re(this,"db");re(this,"storage");re(this,"auth");re(this,"popupComponents");re(this,"popupComponentsProps");n=this.props.config||n,this.popupComponents=this.props.popupComponents,this.componentListInterface=new FG(this.dispatch,n.endpoint,n.db,n.storage,n.auth),this.componentList=this.componentListInterface.createComponentList(),this.factory=this.componentListInterface.getFactory(),this.operationsFactory=this.componentList.getOperationsFactory(),this.interfaceRegistry=new LX,this.initialPropsSetupFunctions=[this.propogateApp,...this.initialPropsSetupFunctions],this.state={componentList:this.componentList,componentListInterface:this.componentListInterface,operationsFactory:this.operationsFactory,factory:this.factory,theme:this.props.theme||"default",pageClass:this.props.pageClass||"fullScreen",pageStyle:this.props.pageStyle,extraRouteKey:this.props.extraRouteKey||"extraRoutes",navBarProps:this.props.NavBarProps||{},popupFactory:ML.getFactory(),popups:this.props.popups||[],global:this.props.global||{},routes:this.props.routes||[]},r&&this.registerListWithFactory(r)}async checkForUser(){let t=await this.APIService.getCurrentUser();t&&await this.APIService.checkIfLoggedIn()&&this.APIService.getuser(t.email)}componentDidMount(){this.checkForUser()}registerListWithFactory(t){for(let n of t){let s=new n().getJson().type;this.factory.registerComponents({name:s,component:n}),this.createPopupDefaultsByType(s)}}createPopupDefaultsByType(t){var n;if((n=this.popupComponents)!=null&&n[t]){let r=this.getCapitalFirstLetter(t),s={content:this.popupComponents[t],popupSwitch:"add"+r,componentType:t},o={...s,popupSwitch:"update"+r};this.state.popups=[...this.state.popups,s,o]}}dispatch(t){t=t||{},this.setState({...t})}setPopups(){for(let t of this.state.popups){let n=t.componentType;n&&(t={...t,...this.popupComponentsProps[n]}),t.popupSwitch||(t.popupSwitch=this.classNameToString(t.content)),this.state.popupFactory.registerComponent(t.popupSwitch,t)}}propogateApp(){this.app={state:this.state,dispatch:this.dispatch.bind(this),...this.state.global},A5.setAppComponent(this.app),UB.setAppComponent(this.app),SB.setAppComponent(this.app),l1.setAppComponent(this.app),xB.setAppComponent(this.app)}getHtml(t){this.setPopups();let n=[...this.state.routes];return this.state[this.state.extraRouteKey]&&(n=[...n,...this.state[this.state.extraRouteKey]]),v.jsx("div",{className:this.state.pageClass,style:this.state.pageStyle,children:v.jsxs(pG,{children:[ML.createPopupMachine({app:this.app}),this.state.currentUser&&v.jsx(TX,{...this.state.navBarProps}),t?v.jsx(t.content,{props:{...t.props}}):v.jsx(v.Fragment,{}),v.jsx(OX,{routes:n,extraAuthRoutes:this.state.extraAuthRoutes})]})})}}class T5 extends MI{constructor(){super(...arguments);re(this,"factory",{form:qB,map:b5,nav:C5})}}new T5;new T5;class Tr extends kG{constructor(t){super(t);re(this,"json",{...this.json,type:"",name:"",owner:"",picURL:""})}}class MX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"user"})}}class sD extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"contact",phone:"",autoAI:!0,email:"",title:"",company:"",mobile:"",firstName:"",lastName:"",address:"",city:"",state:"",zip:"",source:"",finishedSequenceTags:"",tags:"",conversationIds:[]})}}let BX=class extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"conversation",contactIds:[]})}};class jX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"template",content:""})}}class qX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"sequence",steps:[],finished:0,replyRate:0,limit:"20"})}}class UX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"step",delay:0,messageId:""})}}class I5 extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,conversationIds:[],ownerMessage:!1})}}class VX extends I5{constructor(){super(...arguments);re(this,"json",{...this.json,type:"textMessage",content:"",timestamp:""})}}class HX extends I5{constructor(){super(...arguments);re(this,"json",{...this.json,type:"email",subject:"",body:"",timeStamp:""})}}class zX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"potentialProspect",phone:"",email:"",researchId:"",conversationIds:[],source:"Success AI"})}}class $X extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"research",searchFrequency:"",AIPrompt:"",active:!0,skipCompanySearch:!1,hasPeopleCsv:!1,hasCompanyCsv:!1,mode:"Auto",newDataSrcs:["zoominfo"],vettingThreshold:"70",searchFrequency:"daily",actionToFindDisplay:"Sequence",actionOnFind:{enpoint:"https://sequencecontacts-7c5i3vsqma-uc.a.run.app",technology:[]}})}}class WX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"client",name:"",email:"",researchId:"",conversationIds:[]})}}class GX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"AIPrompt"})}}class KX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"aiSettings",autoAI:""})}}class JX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"todo",attribute1:"Create Authenticated User",attribute2:"Create User Data",attribute3:"Create Limiter",attribute4:"Set Up Google Auth",attribute5:"Setting Obj",attribute6:"Firebase AI Training",complete1:!1,complete2:!1,complete3:!1,complete4:!1,complete5:!1,complete6:!1,clientId:""})}}class YX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"limit",limit:500})}}let XX=class extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"csv"})}};class QX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"open"})}}class ZX extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"outreachUser",mailboxId:"",mailboxEmail:""})}}class eQ extends sD{constructor(){super(...arguments);re(this,"json",{...this.json,type:"peopleToResearch"})}}class tQ extends sD{constructor(){super(...arguments);re(this,"json",{...this.json,type:"companiesToResearch"})}}class nQ extends Tr{constructor(){super(...arguments);re(this,"json",{...this.json,type:"training"})}}const rQ=Object.freeze(Object.defineProperty({__proto__:null,AIPrompt:GX,AISettings:KX,Client:WX,CompaniesToResearch:tQ,Contact:sD,Conversations:BX,CsvUpload:XX,Email:HX,Limit:YX,Open:QX,OutreachUser:ZX,PeopleToResearch:eQ,PotentialProspect:zX,Research:$X,Sequence:qX,Step:UX,Template:jX,TextMessage:VX,Todo:JX,Training:nQ,User:MX},Symbol.toStringTag,{value:"Module"})),iQ="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%200%2024%2024'%20width='24px'%20fill='%23505050'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M20%204H4c-1.1%200-1.99.9-1.99%202L2%2018c0%201.1.9%202%202%202h16c1.1%200%202-.9%202-2V6c0-1.1-.9-2-2-2zm0%204l-8%205-8-5V6l8%205%208-5v2z'/%3e%3c/svg%3e",sQ="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%200%2024%2024'%20width='24px'%20fill='%23505050'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M20.01%2015.38c-1.23%200-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57%201.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53%200-.54-.45-.99-.99-.99H4.19C3.65%203%203%203.24%203%203.99%203%2013.28%2010.73%2021%2020.01%2021c.71%200%20.99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z'/%3e%3c/svg%3e";class u1 extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit scroller"}}formatDate(e){console.log(this);const t=new Date((e==null?void 0:e.seconds)*1e3+(e==null?void 0:e.nanoseconds)/1e6),r=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()],s=t.getDate(),o=t.getFullYear();return`${r} ${s}, ${o}`}async componentDidMount(){var t,n,r,s,o;debugger;const e=this.propsState.currentContact;e.getJson().type==="potentialProspect"&&(Object.prototype.toString.call(e.getJson().moble)==="[object Object]"&&((t=e.getJson().raw.phone_numbers)!=null&&t[0])&&await e.setCompState({mobile:e.getJson().mobile.raw_number}),(n=e.getJson().raw)!=null&&n.city&&await e.setCompState({moble:(r=e.getJson().raw)==null?void 0:r.city}),(s=e.getJson().raw)!=null&&s.state&&await e.setCompState({moble:(o=e.getJson().raw)==null?void 0:o.state}),await e.update(),this.dispatch())}render(){var u,c,d,m,p,g,w,b,A;let e=window.innerWidth>600;(u=this.propsState.popupSwitch)!=null&&u.includes("addContact")&&(e=!1);let t=e?this.propsState.currentContact:this.props.obj,n=t&&(t!=null&&t.getJson().date)?this.formatDate(t==null?void 0:t.getJson().date):"";const r=e?this.propsState.currentContact:this.propsState.currentPopupComponent,s=!e;let o=t?"Edit":"Add",a=v.jsx(Es,{formClass:"dark-button-1",content:"Save",isPopup:s});return((c=this.propsState.popupSwitch)!=null&&c.includes("updateContact")||window.innerWidth>600&&!((d=this.propsState.popupSwitch)!=null&&d.includes("addContact")))&&(a=v.jsx(Q0,{formClass:"dark-button-1",obj:r,content:"Save",isPopup:s,callbackFunc:this.props.callbackFunc})),v.jsxs(v.Fragment,{children:[v.jsxs("h2",{style:{position:"sticky",top:0,padding:"2%",width:"80%"},children:[o," Contact"]}),e&&v.jsx("div",{className:"close-contact-button",onClick:()=>{this.dispatch({currentContact:null})},children:"X"}),t&&v.jsxs("h3",{style:{padding:"10px",font:"normal normal 900 15px/16px Satoshi"},children:[t.getJson().firstName," ",t.getJson().lastName]}),v.jsxs("div",{style:{padding:"2%",paddingBottom:"80px",height:"100%",paddingTop:"12px"},className:this.props.pageClass||this.state.defaultClass,children:[v.jsxs("div",{className:"contact-Add-container",children:[v.jsxs("div",{className:"contact-contact-data",children:[v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().firstName?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"First Name:"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{obj:t,formClass:"underline-form",name:"firstName",placeholder:"FirstName",inPopup:s})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().lastName?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"Last Name:"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{obj:t,placeholder:"LastName",formClass:"underline-form",name:"lastName",inPopup:s})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().email?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:v.jsx("span",{children:v.jsx("img",{src:iQ,className:"contact-img-ico"})})}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{formClass:"underline-form",obj:t,name:"email",inPopup:s,placeholder:"1234@mail.com"})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().mobile?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:v.jsx("span",{children:v.jsx("img",{src:sQ,className:"contact-img-ico"})})}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{formClass:"underline-form",obj:t,name:"mobile",inPopup:s,placeholder:"XXX-XXX-XXXX"})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().company?"":"unfilled-container"}`,style:{marginTop:"24px"},children:[v.jsx("div",{className:"row-name",children:"Company:"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{formClass:"underline-form",obj:t,name:"company",inPopup:s,placeholder:"SalesCapture AI"})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().title?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"Title:"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{formClass:"underline-form",obj:t,placeholder:"ie. Vice President of People",name:"title",inPopup:s})})]}),t&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().address?"":"unfilled-container"}`,style:{marginTop:"24px"},children:[v.jsx("div",{className:"row-name",children:"Address:"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{formClass:"underline-form",obj:t,name:"address",inPopup:s,placeholder:"123 Street Way"})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().city?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"City:"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{formClass:"underline-form",obj:t,name:"city",inPopup:s,placeholder:"Sales Lake City"})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().state?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"State:"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{formClass:"underline-form",obj:t,name:"state",inPopup:s,placeholder:"State/Territory"})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().zip?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"ZIPcode:"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{formClass:"underline-form",obj:t,name:"zip",inPopup:s,placeholder:"ZIP"})})]})]})]}),v.jsxs("div",{className:"contact-contact-data",children:[v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().source?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"Lead Source:"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{formClass:"underline-form",obj:t,name:"source",inPopup:s,placeholder:"unknown"})})]}),v.jsxs("div",{className:"row-container",title:"Comma separated",children:[v.jsx("div",{className:"row-name",style:{width:"fit-content"},children:"Tags:"}),v.jsx("div",{className:"row-field",title:"comma seperated",children:v.jsx(Qe,{formClass:"underline-form",obj:t,placeholder:"ie. contacted, tag1, tag3",name:"tags",inPopup:s})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:"12px"},children:[v.jsx("div",{className:"row-name",style:{borderRight:"none"},children:"Notes"}),v.jsx("div",{children:v.jsx(Qe,{obj:t,type:"quill",name:"notes",inPopup:s})})]}),t&&(t==null?void 0:t.getJson().date)&&v.jsx(v.Fragment,{children:v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:"12px"},children:[v.jsx("div",{className:"row-name",style:{borderRight:"none"},children:"Contact Create Date"}),v.jsx("div",{style:{fontSize:"14px"},children:n})]})})]}),v.jsxs("div",{style:{paddingBottom:"20px",width:"100%",display:"flex",justifyContent:"flex-end",alignContent:"flex-end",gap:"8px"},children:[v.jsx("div",{style:{marginRight:"0px"}}),!((p=(m=this.propsState)==null?void 0:m.currentContact)!=null&&p.getJson().finished)&&!((w=(g=this.propsState)==null?void 0:g.popupSwitch)!=null&&w.includes("add"))?v.jsx("div",{onClick:()=>{var _;if((_=this.propsState.currentContact)==null||_.setCompState({autoAI:!1},{run:!0},!0),sequence){let C=parseInt(sequence.getJson().finished)+1;sequence.setCompState({finished:C}),sequence.update()}},className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:"Turn off AI"}):v.jsx("div",{onClick:()=>{var _;(_=this.propsState.currentContact)==null||_.setCompState({autoAI:!0},{run:!0},!0)},className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:"Turn on AI"}),!((b=this.propsState.currentContact)!=null&&b.getJson().finished)&&v.jsxs(v.Fragment,{children:[" ",!((A=this.propsState.currentContact)!=null&&A.getJson().finished)&&v.jsx("div",{onClick:()=>{var I,S,R;(I=this.propsState.currentContact)==null||I.setCompState({finished:!0}),(S=this.propsState.currentContact)==null||S.update();let _=this.componentList.getComponent("sequence",(R=this.propsState.currentContact)==null?void 0:R.getJson().sequenceId),C=parseInt(_==null?void 0:_.getJson().finished)+1;_.setCompState({finished:C}),_.update()},className:"dark-button-1",style:{position:"relative",width:"fit-content",height:"fit-content"},children:"Remove From Sequence"})]}),a]})]})," "]})]})}}class kb extends ct{constructor(e){super(e),this.state={...this.state,checked:!1,activeBool:!1}}componentDidMount(){this.checkIfActive()}async componentDidUpdate(e,t){var r,s;let n=this.props.obj;n&&((r=this.propsState[this.props.checkKey])!=null&&r.includes(n)&&this.state.activeBool===!1?this.setState({checked:!0,activeBool:!0}):!((s=this.propsState[this.props.checkKey])!=null&&s.includes(n))&&this.state.activeBool===!0&&this.setState({checked:!1,activeBool:!1}))}checkIfActive(){var t;let e=this.props.obj;e&&(t=this.propsState[this.props.checkKey])!=null&&t.includes(e)&&this.setState({checked:!0})}async handleToggle(){await this.setState(e=>({checked:!e.checked})),this.state.checked?this.check(this.props.obj):this.uncheck(this.props.obj)}check(e){this.setState({checked:!0}),this.props.check?this.props.check(e):this.props.cell.check(this.props.obj)}uncheck(e){this.setState({checked:!1}),this.props.uncheck?this.props.uncheck(e):this.props.cell.uncheck(this.props.obj)}render(){const{checked:e}=this.state;return v.jsxs("label",{className:this.props.class||"checkbox-container",children:[this.props.label||"",v.jsx("input",{type:"checkbox",checked:e,onChange:this.handleToggle}),v.jsx("span",{className:"checkmark"})]})}}class Rb extends eh{async buttonClickFunc(){let e=this.obj,t=e.type;this.props.popupSwitch.includes("add")&&(e=e[0]?e[0]:{type:this.getFactoryTypeString(this.props.popupSwitch.slice(3))},e={prepare:{...e},amount:this.props.amount,clean:this.props.clean},e=await this.operationsFactory.prepare(e),e.length===1&&(e=e[0],t=e.getJson().type)),Array.isArray(e)&&e.length===1&&(e=e[0]);let n=this.props.setCurrnetItem&&{["current"+this.getCapitalFirstLetter(t)]:e},r={popupSwitch:this.props.popupSwitch,currentPopupComponent:e,...n};await this.dispatch({...r})}}class D5 extends ct{constructor(t){super(t);re(this,"handleCheckContact",t=>{let n=this.props.app.state.selectedContacts?[...this.props.app.state.selectedContacts]:[];n.includes(t)||n.push(t),this.dispatch({selectedContacts:n})});re(this,"handleUncheckContact",t=>{let n=this.props.app.state.selectedContacts?[...this.props.app.state.selectedContacts]:[];n=n.filter(r=>r!==t),this.dispatch({selectedContacts:n})})}getTagUI(t){var n,r,s,o,a,u;return v.jsxs("div",{className:"contact-tag-container active",children:[(n=t.tags)==null?void 0:n.split(",").filter(c=>c!=="").map((c,d)=>v.jsx("button",{className:"contact-tag-btn",children:c},d)),((r=t.finishedSequenceTags)==null?void 0:r.length)>0&&v.jsx(v.Fragment,{children:(s=t.finishedSequenceTags)==null?void 0:s.split(",").map((c,d)=>v.jsx(v.Fragment,{children:c.length>0&&v.jsx("button",{className:"contact-tag-btn finished-sequence-tags",children:c},d)}))}),t.sequenceId&&v.jsxs(v.Fragment,{children:[t.finishedSequenceTags.includes((o=this.componentList.getComponent("sequence",t.sequenceId))==null?void 0:o.getJson().name)&&t.finished?v.jsx(v.Fragment,{}):v.jsx(v.Fragment,{children:((a=this.componentList.getComponent("sequence",t.sequenceId))==null?void 0:a.getJson().name.length)>0&&v.jsx("button",{className:`contact-tag-btn ${t.finished?"finished-sequence-tags":"unfinished-sequence-tags"}`,children:(u=this.componentList.getComponent("sequence",t.sequenceId))==null?void 0:u.getJson().name})}),t.replied&&v.jsx("button",{className:"contact-tag-btn unfinished-sequence-tags",children:"Replied"})]})]})}render(){const{obj:t}=this.props;let n=t.getJson(),s=(this.props.app.state.selectedContacts?[...this.props.app.state.selectedContacts]:[]).includes(t);return v.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[v.jsxs("div",{className:"contact-item hover-darken",style:{background:s?"#2374ab10":"white",position:"relative",paddingLeft:"5px"},children:[v.jsx(kb,{checkKey:"selectedContacts",obj:t,check:this.handleCheckContact,uncheck:this.handleUncheckContact}),v.jsxs("div",{className:"contact-info-expanded",style:{cursor:"pointer",display:"flex",width:"100%"},onClick:()=>{window.innerWidth>600?this.dispatch({currentContact:t}):this.dispatch({currentPopupComponent:t,popupSwitch:"updateContact"})},children:[v.jsx("div",{className:"contact-avatar",children:v.jsx("i",{className:"fa-solid fa-user"})}),v.jsxs("div",{className:"contact-info",children:[v.jsx("div",{className:"contact-name",children:`${n.firstName} ${n.lastName}`}),v.jsx("div",{className:"contact-desc",children:(n==null?void 0:n.company)||(n==null?void 0:n.title)||(n==null?void 0:n.email)||(n==null?void 0:n.mobile)||""})]})]}),v.jsx(Rb,{formClass:"hover-basic",wrapperClass:"icon-row",newProp:"asdf",content:v.jsx("div",{style:{width:"fit-content"},onClick:async()=>{await this.operationsFactory.clear();let o=t,a=this.componentList.getComponent("conversation",o.getJson().email,"contact");a||(await this.componentList.addComponents({type:"conversation",contact:o.getJson().email,contactName:`${o.getJson().firstName} ${o.getJson().lastName}`,conversationOwner:this.propsState.currentUser.getJson()._id,ownerName:`${this.propsState.currentUser.getJson().firstName} ${this.propsState.currentUser.getJson().lastName}`}),a=this.componentList.getComponent("conversation",o.getJson().email,"contact"));let u={type:"email"};u={prepare:{...u},clean:!0},u=await this.operationsFactory.prepare(u),Array.isArray(u)&&u.length===1&&(u=u[0]);let c={popupSwitch:"addEmail",currentPopupComponent:u};await this.dispatch({...c,currentConversation:a,currentContact:o})},className:"contact-icon",children:v.jsx("i",{className:"fa-solid fa-message"})})})]}),this.getTagUI(n)]})}}var o_={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var oQ=o_.exports,BL;function aQ(){return BL||(BL=1,function(i,e){((t,n)=>{i.exports=n()})(oQ,function t(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},r,s=!n.document&&!!n.postMessage,o=n.IS_PAPA_WORKER||!1,a={},u=0,c={};function d(T){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(D){var P=R(D);P.chunkSize=parseInt(P.chunkSize),D.step||D.chunk||(P.chunkSize=null),this._handle=new b(P),(this._handle.streamer=this)._config=P}).call(this,T),this.parseChunk=function(D,P){var N=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<N){let M=this._config.newline;M||(F=this._config.quoteChar||'"',M=this._handle.guessLineEndings(D,F)),D=[...D.split(M).slice(N)].join(M)}this.isFirstChunk&&k(this._config.beforeFirstChunk)&&(F=this._config.beforeFirstChunk(D))!==void 0&&(D=F),this.isFirstChunk=!1,this._halted=!1;var N=this._partialLine+D,F=(this._partialLine="",this._handle.parse(N,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(D=F.meta.cursor,N=(this._finished||(this._partialLine=N.substring(D-this._baseIndex),this._baseIndex=D),F&&F.data&&(this._rowCount+=F.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)n.postMessage({results:F,workerId:c.WORKER_ID,finished:N});else if(k(this._config.chunk)&&!P){if(this._config.chunk(F,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=F=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(F.data),this._completeResults.errors=this._completeResults.errors.concat(F.errors),this._completeResults.meta=F.meta),this._completed||!N||!k(this._config.complete)||F&&F.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),N||F&&F.meta.paused||this._nextChunk(),F}this._halted=!0},this._sendError=function(D){k(this._config.error)?this._config.error(D):o&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:D,finished:!1})}}function m(T){var D;(T=T||{}).chunkSize||(T.chunkSize=c.RemoteChunkSize),d.call(this,T),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(P){this._input=P,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(D=new XMLHttpRequest,this._config.withCredentials&&(D.withCredentials=this._config.withCredentials),s||(D.onload=L(this._chunkLoaded,this),D.onerror=L(this._chunkError,this)),D.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var P,N=this._config.downloadRequestHeaders;for(P in N)D.setRequestHeader(P,N[P])}var F;this._config.chunkSize&&(F=this._start+this._config.chunkSize-1,D.setRequestHeader("Range","bytes="+this._start+"-"+F));try{D.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}s&&D.status===0&&this._chunkError()}},this._chunkLoaded=function(){D.readyState===4&&(D.status<200||400<=D.status?this._chunkError():(this._start+=this._config.chunkSize||D.responseText.length,this._finished=!this._config.chunkSize||this._start>=(P=>(P=P.getResponseHeader("Content-Range"))!==null?parseInt(P.substring(P.lastIndexOf("/")+1)):-1)(D),this.parseChunk(D.responseText)))},this._chunkError=function(P){P=D.statusText||P,this._sendError(new Error(P))}}function p(T){(T=T||{}).chunkSize||(T.chunkSize=c.LocalChunkSize),d.call(this,T);var D,P,N=typeof FileReader<"u";this.stream=function(F){this._input=F,P=F.slice||F.webkitSlice||F.mozSlice,N?((D=new FileReader).onload=L(this._chunkLoaded,this),D.onerror=L(this._chunkError,this)):D=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var F=this._input,M=(this._config.chunkSize&&(M=Math.min(this._start+this._config.chunkSize,this._input.size),F=P.call(F,this._start,M)),D.readAsText(F,this._config.encoding));N||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(F){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(F.target.result)},this._chunkError=function(){this._sendError(D.error)}}function g(T){var D;d.call(this,T=T||{}),this.stream=function(P){return D=P,this._nextChunk()},this._nextChunk=function(){var P,N;if(!this._finished)return P=this._config.chunkSize,D=P?(N=D.substring(0,P),D.substring(P)):(N=D,""),this._finished=!D,this.parseChunk(N)}}function w(T){d.call(this,T=T||{});var D=[],P=!0,N=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(F){this._input=F,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){N&&D.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),D.length?this.parseChunk(D.shift()):P=!0},this._streamData=L(function(F){try{D.push(typeof F=="string"?F:F.toString(this._config.encoding)),P&&(P=!1,this._checkIsFinished(),this.parseChunk(D.shift()))}catch(M){this._streamError(M)}},this),this._streamError=L(function(F){this._streamCleanUp(),this._sendError(F)},this),this._streamEnd=L(function(){this._streamCleanUp(),N=!0,this._streamData("")},this),this._streamCleanUp=L(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function b(T){var D,P,N,F,M=Math.pow(2,53),$=-M,Q=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ie=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,ee=this,ue=0,Y=0,J=!1,q=!1,H=[],G={data:[],errors:[],meta:{}};function le(te){return T.skipEmptyLines==="greedy"?te.join("").trim()==="":te.length===1&&te[0].length===0}function se(){if(G&&N&&(ne("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),N=!1),T.skipEmptyLines&&(G.data=G.data.filter(function(ye){return!le(ye)})),X()){let ye=function(xe,Oe){k(T.transformHeader)&&(xe=T.transformHeader(xe,Oe)),H.push(xe)};if(G)if(Array.isArray(G.data[0])){for(var te=0;X()&&te<G.data.length;te++)G.data[te].forEach(ye);G.data.splice(0,1)}else G.data.forEach(ye)}function ae(ye,xe){for(var Oe=T.header?{}:[],Fe=0;Fe<ye.length;Fe++){var Be=Fe,We=ye[Fe],We=((mt,fe)=>(ve=>(T.dynamicTypingFunction&&T.dynamicTyping[ve]===void 0&&(T.dynamicTyping[ve]=T.dynamicTypingFunction(ve)),(T.dynamicTyping[ve]||T.dynamicTyping)===!0))(mt)?fe==="true"||fe==="TRUE"||fe!=="false"&&fe!=="FALSE"&&((ve=>{if(Q.test(ve)&&(ve=parseFloat(ve),$<ve&&ve<M))return 1})(fe)?parseFloat(fe):ie.test(fe)?new Date(fe):fe===""?null:fe):fe)(Be=T.header?Fe>=H.length?"__parsed_extra":H[Fe]:Be,We=T.transform?T.transform(We,Be):We);Be==="__parsed_extra"?(Oe[Be]=Oe[Be]||[],Oe[Be].push(We)):Oe[Be]=We}return T.header&&(Fe>H.length?ne("FieldMismatch","TooManyFields","Too many fields: expected "+H.length+" fields but parsed "+Fe,Y+xe):Fe<H.length&&ne("FieldMismatch","TooFewFields","Too few fields: expected "+H.length+" fields but parsed "+Fe,Y+xe)),Oe}var de;G&&(T.header||T.dynamicTyping||T.transform)&&(de=1,!G.data.length||Array.isArray(G.data[0])?(G.data=G.data.map(ae),de=G.data.length):G.data=ae(G.data,0),T.header&&G.meta&&(G.meta.fields=H),Y+=de)}function X(){return T.header&&H.length===0}function ne(te,ae,de,ye){te={type:te,code:ae,message:de},ye!==void 0&&(te.row=ye),G.errors.push(te)}k(T.step)&&(F=T.step,T.step=function(te){G=te,X()?se():(se(),G.data.length!==0&&(ue+=te.data.length,T.preview&&ue>T.preview?P.abort():(G.data=G.data[0],F(G,ee))))}),this.parse=function(te,ae,de){var ye=T.quoteChar||'"',ye=(T.newline||(T.newline=this.guessLineEndings(te,ye)),N=!1,T.delimiter?k(T.delimiter)&&(T.delimiter=T.delimiter(te),G.meta.delimiter=T.delimiter):((ye=((xe,Oe,Fe,Be,We)=>{var mt,fe,ve,Ie;We=We||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var Re=0;Re<We.length;Re++){for(var be,rt=We[Re],qe=0,Ze=0,st=0,ft=(ve=void 0,new _({comments:Be,delimiter:rt,newline:Oe,preview:10}).parse(xe)),gt=0;gt<ft.data.length;gt++)Fe&&le(ft.data[gt])?st++:(be=ft.data[gt].length,Ze+=be,ve===void 0?ve=be:0<be&&(qe+=Math.abs(be-ve),ve=be));0<ft.data.length&&(Ze/=ft.data.length-st),(fe===void 0||qe<=fe)&&(Ie===void 0||Ie<Ze)&&1.99<Ze&&(fe=qe,mt=rt,Ie=Ze)}return{successful:!!(T.delimiter=mt),bestDelimiter:mt}})(te,T.newline,T.skipEmptyLines,T.comments,T.delimitersToGuess)).successful?T.delimiter=ye.bestDelimiter:(N=!0,T.delimiter=c.DefaultDelimiter),G.meta.delimiter=T.delimiter),R(T));return T.preview&&T.header&&ye.preview++,D=te,P=new _(ye),G=P.parse(D,ae,de),se(),J?{meta:{paused:!0}}:G||{meta:{paused:!1}}},this.paused=function(){return J},this.pause=function(){J=!0,P.abort(),D=k(T.chunk)?"":D.substring(P.getCharIndex())},this.resume=function(){ee.streamer._halted?(J=!1,ee.streamer.parseChunk(D,!0)):setTimeout(ee.resume,3)},this.aborted=function(){return q},this.abort=function(){q=!0,P.abort(),G.meta.aborted=!0,k(T.complete)&&T.complete(G),D=""},this.guessLineEndings=function(xe,ye){xe=xe.substring(0,1048576);var ye=new RegExp(A(ye)+"([^]*?)"+A(ye),"gm"),de=(xe=xe.replace(ye,"")).split("\r"),ye=xe.split(`
`),xe=1<ye.length&&ye[0].length<de[0].length;if(de.length===1||xe)return`
`;for(var Oe=0,Fe=0;Fe<de.length;Fe++)de[Fe][0]===`
`&&Oe++;return Oe>=de.length/2?`\r
`:"\r"}}function A(T){return T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function _(T){var D=(T=T||{}).delimiter,P=T.newline,N=T.comments,F=T.step,M=T.preview,$=T.fastMode,Q=null,ie=!1,ee=T.quoteChar==null?'"':T.quoteChar,ue=ee;if(T.escapeChar!==void 0&&(ue=T.escapeChar),(typeof D!="string"||-1<c.BAD_DELIMITERS.indexOf(D))&&(D=","),N===D)throw new Error("Comment character same as delimiter");N===!0?N="#":(typeof N!="string"||-1<c.BAD_DELIMITERS.indexOf(N))&&(N=!1),P!==`
`&&P!=="\r"&&P!==`\r
`&&(P=`
`);var Y=0,J=!1;this.parse=function(q,H,G){if(typeof q!="string")throw new Error("Input must be a string");var le=q.length,se=D.length,X=P.length,ne=N.length,te=k(F),ae=[],de=[],ye=[],xe=Y=0;if(!q)return qe();if($||$!==!1&&q.indexOf(ee)===-1){for(var Oe=q.split(P),Fe=0;Fe<Oe.length;Fe++){if(ye=Oe[Fe],Y+=ye.length,Fe!==Oe.length-1)Y+=P.length;else if(G)return qe();if(!N||ye.substring(0,ne)!==N){if(te){if(ae=[],Ie(ye.split(D)),Ze(),J)return qe()}else Ie(ye.split(D));if(M&&M<=Fe)return ae=ae.slice(0,M),qe(!0)}}return qe()}for(var Be=q.indexOf(D,Y),We=q.indexOf(P,Y),mt=new RegExp(A(ue)+A(ee),"g"),fe=q.indexOf(ee,Y);;)if(q[Y]===ee)for(fe=Y,Y++;;){if((fe=q.indexOf(ee,fe+1))===-1)return G||de.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ae.length,index:Y}),be();if(fe===le-1)return be(q.substring(Y,fe).replace(mt,ee));if(ee===ue&&q[fe+1]===ue)fe++;else if(ee===ue||fe===0||q[fe-1]!==ue){Be!==-1&&Be<fe+1&&(Be=q.indexOf(D,fe+1));var ve=Re((We=We!==-1&&We<fe+1?q.indexOf(P,fe+1):We)===-1?Be:Math.min(Be,We));if(q.substr(fe+1+ve,se)===D){ye.push(q.substring(Y,fe).replace(mt,ee)),q[Y=fe+1+ve+se]!==ee&&(fe=q.indexOf(ee,Y)),Be=q.indexOf(D,Y),We=q.indexOf(P,Y);break}if(ve=Re(We),q.substring(fe+1+ve,fe+1+ve+X)===P){if(ye.push(q.substring(Y,fe).replace(mt,ee)),rt(fe+1+ve+X),Be=q.indexOf(D,Y),fe=q.indexOf(ee,Y),te&&(Ze(),J))return qe();if(M&&ae.length>=M)return qe(!0);break}de.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ae.length,index:Y}),fe++}}else if(N&&ye.length===0&&q.substring(Y,Y+ne)===N){if(We===-1)return qe();Y=We+X,We=q.indexOf(P,Y),Be=q.indexOf(D,Y)}else if(Be!==-1&&(Be<We||We===-1))ye.push(q.substring(Y,Be)),Y=Be+se,Be=q.indexOf(D,Y);else{if(We===-1)break;if(ye.push(q.substring(Y,We)),rt(We+X),te&&(Ze(),J))return qe();if(M&&ae.length>=M)return qe(!0)}return be();function Ie(st){ae.push(st),xe=Y}function Re(st){var ft=0;return ft=st!==-1&&(st=q.substring(fe+1,st))&&st.trim()===""?st.length:ft}function be(st){return G||(st===void 0&&(st=q.substring(Y)),ye.push(st),Y=le,Ie(ye),te&&Ze()),qe()}function rt(st){Y=st,Ie(ye),ye=[],We=q.indexOf(P,Y)}function qe(st){if(T.header&&!H&&ae.length&&!ie){var ft=ae[0],gt=Object.create(null),xi=new Set(ft);let Mt=!1;for(let an=0;an<ft.length;an++){let Hn=ft[an];if(gt[Hn=k(T.transformHeader)?T.transformHeader(Hn,an):Hn]){let Qs,iu=gt[Hn];for(;Qs=Hn+"_"+iu,iu++,xi.has(Qs););xi.add(Qs),ft[an]=Qs,gt[Hn]++,Mt=!0,(Q=Q===null?{}:Q)[Qs]=Hn}else gt[Hn]=1,ft[an]=Hn;xi.add(Hn)}Mt&&console.warn("Duplicate headers found and renamed."),ie=!0}return{data:ae,errors:de,meta:{delimiter:D,linebreak:P,aborted:J,truncated:!!st,cursor:xe+(H||0),renamedHeaders:Q}}}function Ze(){F(qe()),ae=[],de=[]}},this.abort=function(){J=!0},this.getCharIndex=function(){return Y}}function C(T){var D=T.data,P=a[D.workerId],N=!1;if(D.error)P.userError(D.error,D.file);else if(D.results&&D.results.data){var F={abort:function(){N=!0,I(D.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:S,resume:S};if(k(P.userStep)){for(var M=0;M<D.results.data.length&&(P.userStep({data:D.results.data[M],errors:D.results.errors,meta:D.results.meta},F),!N);M++);delete D.results}else k(P.userChunk)&&(P.userChunk(D.results,F,D.file),delete D.results)}D.finished&&!N&&I(D.workerId,D.results)}function I(T,D){var P=a[T];k(P.userComplete)&&P.userComplete(D),P.terminate(),delete a[T]}function S(){throw new Error("Not implemented.")}function R(T){if(typeof T!="object"||T===null)return T;var D,P=Array.isArray(T)?[]:{};for(D in T)P[D]=R(T[D]);return P}function L(T,D){return function(){T.apply(D,arguments)}}function k(T){return typeof T=="function"}return c.parse=function(T,D){var P=(D=D||{}).dynamicTyping||!1;if(k(P)&&(D.dynamicTypingFunction=P,P={}),D.dynamicTyping=P,D.transform=!!k(D.transform)&&D.transform,!D.worker||!c.WORKERS_SUPPORTED)return P=null,c.NODE_STREAM_INPUT,typeof T=="string"?(T=(N=>N.charCodeAt(0)!==65279?N:N.slice(1))(T),P=new(D.download?m:g)(D)):T.readable===!0&&k(T.read)&&k(T.on)?P=new w(D):(n.File&&T instanceof File||T instanceof Object)&&(P=new p(D)),P.stream(T);(P=(()=>{var N;return!!c.WORKERS_SUPPORTED&&(N=(()=>{var F=n.URL||n.webkitURL||null,M=t.toString();return c.BLOB_URL||(c.BLOB_URL=F.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",M,")();"],{type:"text/javascript"})))})(),(N=new n.Worker(N)).onmessage=C,N.id=u++,a[N.id]=N)})()).userStep=D.step,P.userChunk=D.chunk,P.userComplete=D.complete,P.userError=D.error,D.step=k(D.step),D.chunk=k(D.chunk),D.complete=k(D.complete),D.error=k(D.error),delete D.worker,P.postMessage({input:T,config:D,workerId:P.id})},c.unparse=function(T,D){var P=!1,N=!0,F=",",M=`\r
`,$='"',Q=$+$,ie=!1,ee=null,ue=!1,Y=((()=>{if(typeof D=="object"){if(typeof D.delimiter!="string"||c.BAD_DELIMITERS.filter(function(H){return D.delimiter.indexOf(H)!==-1}).length||(F=D.delimiter),typeof D.quotes!="boolean"&&typeof D.quotes!="function"&&!Array.isArray(D.quotes)||(P=D.quotes),typeof D.skipEmptyLines!="boolean"&&typeof D.skipEmptyLines!="string"||(ie=D.skipEmptyLines),typeof D.newline=="string"&&(M=D.newline),typeof D.quoteChar=="string"&&($=D.quoteChar),typeof D.header=="boolean"&&(N=D.header),Array.isArray(D.columns)){if(D.columns.length===0)throw new Error("Option columns is empty");ee=D.columns}D.escapeChar!==void 0&&(Q=D.escapeChar+$),D.escapeFormulae instanceof RegExp?ue=D.escapeFormulae:typeof D.escapeFormulae=="boolean"&&D.escapeFormulae&&(ue=/^[=+\-@\t\r].*$/)}})(),new RegExp(A($),"g"));if(typeof T=="string"&&(T=JSON.parse(T)),Array.isArray(T)){if(!T.length||Array.isArray(T[0]))return J(null,T,ie);if(typeof T[0]=="object")return J(ee||Object.keys(T[0]),T,ie)}else if(typeof T=="object")return typeof T.data=="string"&&(T.data=JSON.parse(T.data)),Array.isArray(T.data)&&(T.fields||(T.fields=T.meta&&T.meta.fields||ee),T.fields||(T.fields=Array.isArray(T.data[0])?T.fields:typeof T.data[0]=="object"?Object.keys(T.data[0]):[]),Array.isArray(T.data[0])||typeof T.data[0]=="object"||(T.data=[T.data])),J(T.fields||[],T.data||[],ie);throw new Error("Unable to serialize unrecognized input");function J(H,G,le){var se="",X=(typeof H=="string"&&(H=JSON.parse(H)),typeof G=="string"&&(G=JSON.parse(G)),Array.isArray(H)&&0<H.length),ne=!Array.isArray(G[0]);if(X&&N){for(var te=0;te<H.length;te++)0<te&&(se+=F),se+=q(H[te],te);0<G.length&&(se+=M)}for(var ae=0;ae<G.length;ae++){var de=(X?H:G[ae]).length,ye=!1,xe=X?Object.keys(G[ae]).length===0:G[ae].length===0;if(le&&!X&&(ye=le==="greedy"?G[ae].join("").trim()==="":G[ae].length===1&&G[ae][0].length===0),le==="greedy"&&X){for(var Oe=[],Fe=0;Fe<de;Fe++){var Be=ne?H[Fe]:Fe;Oe.push(G[ae][Be])}ye=Oe.join("").trim()===""}if(!ye){for(var We=0;We<de;We++){0<We&&!xe&&(se+=F);var mt=X&&ne?H[We]:We;se+=q(G[ae][mt],We)}ae<G.length-1&&(!le||0<de&&!xe)&&(se+=M)}}return se}function q(H,G){var le,se;return H==null?"":H.constructor===Date?JSON.stringify(H).slice(1,25):(se=!1,ue&&typeof H=="string"&&ue.test(H)&&(H="'"+H,se=!0),le=H.toString().replace(Y,Q),(se=se||P===!0||typeof P=="function"&&P(H,G)||Array.isArray(P)&&P[G]||((X,ne)=>{for(var te=0;te<ne.length;te++)if(-1<X.indexOf(ne[te]))return!0;return!1})(le,c.BAD_DELIMITERS)||-1<le.indexOf(F)||le.charAt(0)===" "||le.charAt(le.length-1)===" ")?$+le+$:le)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!s&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=_,c.ParserHandle=b,c.NetworkStreamer=m,c.FileStreamer=p,c.StringStreamer=g,c.ReadableStreamStreamer=w,n.jQuery&&((r=n.jQuery).fn.parse=function(T){var D=T.config||{},P=[];return this.each(function(M){if(!(r(this).prop("tagName").toUpperCase()==="INPUT"&&r(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var $=0;$<this.files.length;$++)P.push({file:this.files[$],inputElem:this,instanceConfig:r.extend({},D)})}),N(),this;function N(){if(P.length===0)k(T.complete)&&T.complete();else{var M,$,Q,ie,ee=P[0];if(k(T.before)){var ue=T.before(ee.file,ee.inputElem);if(typeof ue=="object"){if(ue.action==="abort")return M="AbortError",$=ee.file,Q=ee.inputElem,ie=ue.reason,void(k(T.error)&&T.error({name:M},$,Q,ie));if(ue.action==="skip")return void F();typeof ue.config=="object"&&(ee.instanceConfig=r.extend(ee.instanceConfig,ue.config))}else if(ue==="skip")return void F()}var Y=ee.instanceConfig.complete;ee.instanceConfig.complete=function(J){k(Y)&&Y(J,ee.file,ee.inputElem),F()},c.parse(ee.file,ee.instanceConfig)}}function F(){P.splice(0,1),N()}}),o&&(n.onmessage=function(T){T=T.data,c.WORKER_ID===void 0&&T&&(c.WORKER_ID=T.workerId),typeof T.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(T.input,T.config),finished:!0}):(n.File&&T.input instanceof File||T.input instanceof Object)&&(T=c.parse(T.input,T.config))&&n.postMessage({workerId:c.WORKER_ID,results:T,finished:!0})}),(m.prototype=Object.create(d.prototype)).constructor=m,(p.prototype=Object.create(d.prototype)).constructor=p,(g.prototype=Object.create(g.prototype)).constructor=g,(w.prototype=Object.create(d.prototype)).constructor=w,c})}(o_)),o_.exports}var lQ=aQ();const k5=M0(lQ);class oS extends Ae.Component{constructor(e){super(e),this.state={data:[]},this.handleFileUpload=this.handleFileUpload.bind(this)}handleFileUpload(e){const t=e.target.files[0];t&&k5.parse(t,{header:!0,skipEmptyLines:!0,complete:n=>{console.log("Parsed CSV data:",n.data),this.props.callBack({data:n.data})},error:n=>{console.error("Error while parsing:",n)}})}render(){const{data:e}=this.state;return v.jsxs("div",{className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:[v.jsx("label",{htmlFor:"file-upload",className:"",children:"Upload"}),v.jsx("input",{id:"file-upload",type:"file",accept:".csv",onChange:this.handleFileUpload})]})}}class uQ extends ct{constructor(t){super(t);re(this,"handleClickOutside",t=>{this.dropdownRef.current&&!this.dropdownRef.current.contains(t.target)&&!this.buttonRef.current.contains(t.target)&&this.state.showFilter&&this.setState({showFilter:!1})});re(this,"toggleFilter",()=>{this.setState({showFilter:!this.state.showFilter})});re(this,"onAllChange",t=>{const n=t.target.checked;this.setState({filterAll:n,filterTags:n,filterCompany:n,filterName:n})});re(this,"onFilterChange",t=>n=>{this.setState({[t]:n.target.checked,filterAll:!1})});this.state={...this.state,defaultClass:"fit",title:"Contacts",showFilter:!1,filterAll:!0,filterTags:!0,filterCompany:!0,filterName:!0},this.dropdownRef=ze.createRef(),this.buttonRef=ze.createRef()}async componentDidMount(){this.dispatch({selectedContacts:[]}),this.APIService.subscribeToReadObserver(async()=>{await this.componentList.sortSelectedListbyFirebaseDate("contact",!0),this.setState({start:!0})}),this.APIService.subscribeToDispatchObserver(async t=>{debugger;const n=this.componentList.getList("contact");for(let r of t)if(r.added){for(let s of r.added)if(s.type==="contact"){const o=n.findIndex(u=>u.getJson()._id===s._id);let a=n[o];o>-1&&n.splice(o,1),n.unshift(a)}}await this.componentList.setSelectedList("contact",n),await this.componentList.sortSelectedListbyFirebaseDate("contact",!0),this.dispatch({})}),document.addEventListener("mousedown",this.handleClickOutside)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}filterFunc(){const{tags:t}=this.propsState,n=this.componentList.getList("contact");if(!t){this.dispatch({selectedContacts:[...n]});return}if(!this.state.filterName&&!this.state.filterCompany&&!this.state.filterTags){this.dispatch({selectedContacts:[]});return}const s=t.toLowerCase().split(",").map(a=>a.trim()).filter(a=>a),o=n.filter(a=>{const u=a.getJson();return s.some(c=>{if(this.state.filterName){const d=(u.firstName||"").toLowerCase(),m=(u.lastName||"").toLowerCase();if(`${d} ${m}`.includes(c))return!0}return!!(this.state.filterCompany&&u.company&&u.company.toLowerCase().includes(c)||this.state.filterTags&&(typeof u.tags=="string"&&u.tags.toLowerCase().split(",").map(m=>m.trim()).some(m=>m.includes(c))||typeof u.finishedSequenceTags=="string"&&u.finishedSequenceTags.toLowerCase().split(",").map(m=>m.trim()).some(m=>m.includes(c))||c==="replied"&&u.replied))})});this.dispatch({selectedContacts:o})}getInnerContent(){var a,u;let t=this.propsState.selectedContacts,n=this.propsState.componentList.getList("contact"),r=(t==null?void 0:t.length)>0,s=n!=null&&n.length?"/"+(n==null?void 0:n.length):"",o=(t==null?void 0:t.length)===(n==null?void 0:n.length);return v.jsx(v.Fragment,{children:this.state.start&&v.jsxs("div",{className:"map-container",children:[v.jsxs("div",{className:"top-nav-float",children:[v.jsxs("nav",{className:"top-nav",children:[v.jsxs("div",{className:"nav-left",children:[v.jsx("div",{className:"nav-icon",children:v.jsx("i",{className:"fas fa-circle"})}),v.jsx("div",{className:"nav-title",children:"Contacts"})]}),v.jsx("div",{className:"nav-right",children:v.jsxs("div",{className:"nav-icon",children:[v.jsx("button",{ref:this.buttonRef,onClick:()=>{this.setState({showFilter:!this.state.showFilter})},className:"btn",children:v.jsx("i",{className:"fa-solid fa-filter"})}),v.jsx("div",{children:this.state.showFilter&&v.jsxs("div",{className:"filter-dropdown",ref:this.dropdownRef,children:[v.jsx("div",{style:{fontWeight:"bold",marginBottom:8},children:"Search:"}),v.jsxs("label",{className:"filter-row",children:[v.jsx("input",{style:{marginRight:"8px"},type:"checkbox",checked:this.state.filterAll,onChange:this.onAllChange})," All:"]}),v.jsxs("label",{className:"filter-row",children:[v.jsx("input",{className:"filter-check",type:"checkbox",checked:this.state.filterTags,onChange:this.onFilterChange("filterTags")})," Tags"]}),v.jsxs("label",{className:"filter-row",children:[v.jsx("input",{className:"filter-check",type:"checkbox",checked:this.state.filterCompany,onChange:this.onFilterChange("filterCompany")})," Company"]}),v.jsxs("label",{className:"filter-row",children:[v.jsx("input",{className:"filter-check",type:"checkbox",checked:this.state.filterName,onChange:this.onFilterChange("filterName")})," Name"]})]})})]})})]}),v.jsx("div",{className:"search-container",children:v.jsxs("div",{className:"search-bar",children:[v.jsx("i",{className:"fas fa-search search-icon"}),v.jsx("input",{onChange:c=>{this.dispatch({tags:c.target.value})},className:"search-input",placeholder:"Search"})]})}),v.jsxs("div",{className:"filter-nav",children:[v.jsxs("div",{className:"filter-nav-left",children:[v.jsx(v.Fragment,{children:v.jsx("div",{id:"selectBtn",style:{height:"fit-content",marginLeft:"5px",alignContent:"center"},children:v.jsx(kb,{label:o?"Deselect All":"Select All",check:this.filterFunc,uncheck:()=>{this.dispatch({selectedContacts:[]})}})})}),v.jsx("span",{className:"count-desc",children:(a=this.propsState.selectedContacts)!=null&&a.length?this.propsState.selectedContacts.length+`${s} Selected`:""})]}),!r&&v.jsxs("div",{className:"filter-nav-right",children:[v.jsx(oS,{callBack:async c=>{c=c.data.map((d,m)=>(d.owner=this.propsState.currentUser.getJson()._id,d.type="contact",d.companyOwnerId=this.propsState.currentUser.getJson().companyId,d)),this.dispatch({uploadData:c,popupSwitch:"uploadData"}),await this.operationsFactory.prepare({prepare:c}),this.operationsFactory.run()}}),v.jsx(Rb,{wrapperclassName:"none",content:v.jsx("div",{className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:"Add Contact"}),popupSwitch:"addContact"})]})]})]}),v.jsxs("div",{style:{paddingBottom:"60px"},children:[" ",v.jsx(er,{filterFunc:c=>{if(!this.propsState.tags)return!0;if(!this.state.filterName&&!this.state.filterCompany&&!this.state.filterTags)return!1;const m=this.propsState.tags.toLowerCase().split(",").map(g=>g.trim()).filter(g=>g),p=c.getJson();for(const g of m){if(this.state.filterName){const w=(p.firstName||"").toLowerCase(),b=(p.lastName||"").toLowerCase();if(`${w} ${b}`.includes(g))return!0}if(this.state.filterCompany&&p.company&&p.company.toLowerCase().includes(g))return!0;if(this.state.filterTags){if(p.tags&&typeof p.tags=="string"){const w=p.tags.split(",").map(b=>b.trim().toLowerCase());for(let b of w)if(b.includes(g))return!0}if(p.finishedSequenceTags&&typeof p.finishedSequenceTags=="string"){const w=p.finishedSequenceTags.split(",").map(b=>b.trim().toLowerCase());for(let b of w)if(b.includes(g))return!0}if(g==="replied"&&p.replied)return!0}}return!1},name:"contact",type:"viewPortMap",mapContainerClass:"contact-list",mapSectionClass:"contact",wrapperClass:"none",cells:[{type:"custom",custom:D5,wrapperClass:"none"}],hasLink:!0})," "]}),((u=this.propsState.selectedContacts)==null?void 0:u.length)>0&&v.jsxs("div",{id:"floating-select-set",className:"floating-select-set",children:[v.jsx("button",{onClick:()=>{this.dispatch({popupSwitch:"addTags"})},className:"floating-select-btn",children:v.jsx("span",{className:"floating-select-btn-text",children:"Tags"})}),v.jsx("button",{onClick:()=>{for(let c of this.propsState.selectedContacts)c.del();this.dispatch({selectedContacts:[]})},className:"floating-select-btn",children:v.jsx("span",{className:"floating-select-btn-text",children:"Delete"})}),v.jsx("button",{className:"floating-select-btn floating-select-primary-btn",children:v.jsx(bb,{content:v.jsx("span",{className:"floating-select-btn-text",style:{color:"white"},children:"Add to Sequence"}),popupSwitch:"addToSequence"})})]})]})})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class jL extends lf{constructor(e){super(e),this.state={...this.state,defaultClass:"fit",owner:this.app.state.currentUser.getJson()._id,visible:!0}}async componentDidMount(){await this.getComponentsFromBackend()}componentWillUnmount(){this.dispatch({selectedContacts:[]})}render(){return v.jsxs("div",{className:this.props.pageClass||this.state.defaultClass,style:{display:"flex"},children:[v.jsx("div",{style:{width:window.innerWidth>600?"50%":"100%"},children:v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(uQ,{})})}),v.jsx("div",{style:{width:window.innerWidth>600?"50%":"0%",position:"relative"},children:this.propsState.currentContact&&window.innerWidth>600&&this.state.visible&&v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(u1,{})})})]})}}var uy={exports:{}};/*! https://mths.be/he v1.2.0 by @mathias | MIT license */var cQ=uy.exports,qL;function hQ(){return qL||(qL=1,function(i,e){(function(t){var n=e,r=i&&i.exports==n&&i,s=typeof cp=="object"&&cp;(s.global===s||s.window===s)&&(t=s);var o=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,a=/[\x01-\x7F]/g,u=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,c=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,d={"­":"shy","‌":"zwnj","‍":"zwj","‎":"lrm","⁣":"ic","⁢":"it","⁡":"af","‏":"rlm","​":"ZeroWidthSpace","⁠":"NoBreak","̑":"DownBreve","⃛":"tdot","⃜":"DotDot","	":"Tab","\n":"NewLine"," ":"puncsp"," ":"MediumSpace"," ":"thinsp"," ":"hairsp"," ":"emsp13"," ":"ensp"," ":"emsp14"," ":"emsp"," ":"numsp"," ":"nbsp","  ":"ThickSpace","‾":"oline",_:"lowbar","‐":"dash","–":"ndash","—":"mdash","―":"horbar",",":"comma",";":"semi","⁏":"bsemi",":":"colon","⩴":"Colone","!":"excl","¡":"iexcl","?":"quest","¿":"iquest",".":"period","‥":"nldr","…":"mldr","·":"middot","'":"apos","‘":"lsquo","’":"rsquo","‚":"sbquo","‹":"lsaquo","›":"rsaquo",'"':"quot","“":"ldquo","”":"rdquo","„":"bdquo","«":"laquo","»":"raquo","(":"lpar",")":"rpar","[":"lsqb","]":"rsqb","{":"lcub","}":"rcub","⌈":"lceil","⌉":"rceil","⌊":"lfloor","⌋":"rfloor","⦅":"lopar","⦆":"ropar","⦋":"lbrke","⦌":"rbrke","⦍":"lbrkslu","⦎":"rbrksld","⦏":"lbrksld","⦐":"rbrkslu","⦑":"langd","⦒":"rangd","⦓":"lparlt","⦔":"rpargt","⦕":"gtlPar","⦖":"ltrPar","⟦":"lobrk","⟧":"robrk","⟨":"lang","⟩":"rang","⟪":"Lang","⟫":"Rang","⟬":"loang","⟭":"roang","❲":"lbbrk","❳":"rbbrk","‖":"Vert","§":"sect","¶":"para","@":"commat","*":"ast","/":"sol",undefined:null,"&":"amp","#":"num","%":"percnt","‰":"permil","‱":"pertenk","†":"dagger","‡":"Dagger","•":"bull","⁃":"hybull","′":"prime","″":"Prime","‴":"tprime","⁗":"qprime","‵":"bprime","⁁":"caret","`":"grave","´":"acute","˜":"tilde","^":"Hat","¯":"macr","˘":"breve","˙":"dot","¨":"die","˚":"ring","˝":"dblac","¸":"cedil","˛":"ogon","ˆ":"circ","ˇ":"caron","°":"deg","©":"copy","®":"reg","℗":"copysr","℘":"wp","℞":"rx","℧":"mho","℩":"iiota","←":"larr","↚":"nlarr","→":"rarr","↛":"nrarr","↑":"uarr","↓":"darr","↔":"harr","↮":"nharr","↕":"varr","↖":"nwarr","↗":"nearr","↘":"searr","↙":"swarr","↝":"rarrw","↝̸":"nrarrw","↞":"Larr","↟":"Uarr","↠":"Rarr","↡":"Darr","↢":"larrtl","↣":"rarrtl","↤":"mapstoleft","↥":"mapstoup","↦":"map","↧":"mapstodown","↩":"larrhk","↪":"rarrhk","↫":"larrlp","↬":"rarrlp","↭":"harrw","↰":"lsh","↱":"rsh","↲":"ldsh","↳":"rdsh","↵":"crarr","↶":"cularr","↷":"curarr","↺":"olarr","↻":"orarr","↼":"lharu","↽":"lhard","↾":"uharr","↿":"uharl","⇀":"rharu","⇁":"rhard","⇂":"dharr","⇃":"dharl","⇄":"rlarr","⇅":"udarr","⇆":"lrarr","⇇":"llarr","⇈":"uuarr","⇉":"rrarr","⇊":"ddarr","⇋":"lrhar","⇌":"rlhar","⇐":"lArr","⇍":"nlArr","⇑":"uArr","⇒":"rArr","⇏":"nrArr","⇓":"dArr","⇔":"iff","⇎":"nhArr","⇕":"vArr","⇖":"nwArr","⇗":"neArr","⇘":"seArr","⇙":"swArr","⇚":"lAarr","⇛":"rAarr","⇝":"zigrarr","⇤":"larrb","⇥":"rarrb","⇵":"duarr","⇽":"loarr","⇾":"roarr","⇿":"hoarr","∀":"forall","∁":"comp","∂":"part","∂̸":"npart","∃":"exist","∄":"nexist","∅":"empty","∇":"Del","∈":"in","∉":"notin","∋":"ni","∌":"notni","϶":"bepsi","∏":"prod","∐":"coprod","∑":"sum","+":"plus","±":"pm","÷":"div","×":"times","<":"lt","≮":"nlt","<⃒":"nvlt","=":"equals","≠":"ne","=⃥":"bne","⩵":"Equal",">":"gt","≯":"ngt",">⃒":"nvgt","¬":"not","|":"vert","¦":"brvbar","−":"minus","∓":"mp","∔":"plusdo","⁄":"frasl","∖":"setmn","∗":"lowast","∘":"compfn","√":"Sqrt","∝":"prop","∞":"infin","∟":"angrt","∠":"ang","∠⃒":"nang","∡":"angmsd","∢":"angsph","∣":"mid","∤":"nmid","∥":"par","∦":"npar","∧":"and","∨":"or","∩":"cap","∩︀":"caps","∪":"cup","∪︀":"cups","∫":"int","∬":"Int","∭":"tint","⨌":"qint","∮":"oint","∯":"Conint","∰":"Cconint","∱":"cwint","∲":"cwconint","∳":"awconint","∴":"there4","∵":"becaus","∶":"ratio","∷":"Colon","∸":"minusd","∺":"mDDot","∻":"homtht","∼":"sim","≁":"nsim","∼⃒":"nvsim","∽":"bsim","∽̱":"race","∾":"ac","∾̳":"acE","∿":"acd","≀":"wr","≂":"esim","≂̸":"nesim","≃":"sime","≄":"nsime","≅":"cong","≇":"ncong","≆":"simne","≈":"ap","≉":"nap","≊":"ape","≋":"apid","≋̸":"napid","≌":"bcong","≍":"CupCap","≭":"NotCupCap","≍⃒":"nvap","≎":"bump","≎̸":"nbump","≏":"bumpe","≏̸":"nbumpe","≐":"doteq","≐̸":"nedot","≑":"eDot","≒":"efDot","≓":"erDot","≔":"colone","≕":"ecolon","≖":"ecir","≗":"cire","≙":"wedgeq","≚":"veeeq","≜":"trie","≟":"equest","≡":"equiv","≢":"nequiv","≡⃥":"bnequiv","≤":"le","≰":"nle","≤⃒":"nvle","≥":"ge","≱":"nge","≥⃒":"nvge","≦":"lE","≦̸":"nlE","≧":"gE","≧̸":"ngE","≨︀":"lvnE","≨":"lnE","≩":"gnE","≩︀":"gvnE","≪":"ll","≪̸":"nLtv","≪⃒":"nLt","≫":"gg","≫̸":"nGtv","≫⃒":"nGt","≬":"twixt","≲":"lsim","≴":"nlsim","≳":"gsim","≵":"ngsim","≶":"lg","≸":"ntlg","≷":"gl","≹":"ntgl","≺":"pr","⊀":"npr","≻":"sc","⊁":"nsc","≼":"prcue","⋠":"nprcue","≽":"sccue","⋡":"nsccue","≾":"prsim","≿":"scsim","≿̸":"NotSucceedsTilde","⊂":"sub","⊄":"nsub","⊂⃒":"vnsub","⊃":"sup","⊅":"nsup","⊃⃒":"vnsup","⊆":"sube","⊈":"nsube","⊇":"supe","⊉":"nsupe","⊊︀":"vsubne","⊊":"subne","⊋︀":"vsupne","⊋":"supne","⊍":"cupdot","⊎":"uplus","⊏":"sqsub","⊏̸":"NotSquareSubset","⊐":"sqsup","⊐̸":"NotSquareSuperset","⊑":"sqsube","⋢":"nsqsube","⊒":"sqsupe","⋣":"nsqsupe","⊓":"sqcap","⊓︀":"sqcaps","⊔":"sqcup","⊔︀":"sqcups","⊕":"oplus","⊖":"ominus","⊗":"otimes","⊘":"osol","⊙":"odot","⊚":"ocir","⊛":"oast","⊝":"odash","⊞":"plusb","⊟":"minusb","⊠":"timesb","⊡":"sdotb","⊢":"vdash","⊬":"nvdash","⊣":"dashv","⊤":"top","⊥":"bot","⊧":"models","⊨":"vDash","⊭":"nvDash","⊩":"Vdash","⊮":"nVdash","⊪":"Vvdash","⊫":"VDash","⊯":"nVDash","⊰":"prurel","⊲":"vltri","⋪":"nltri","⊳":"vrtri","⋫":"nrtri","⊴":"ltrie","⋬":"nltrie","⊴⃒":"nvltrie","⊵":"rtrie","⋭":"nrtrie","⊵⃒":"nvrtrie","⊶":"origof","⊷":"imof","⊸":"mumap","⊹":"hercon","⊺":"intcal","⊻":"veebar","⊽":"barvee","⊾":"angrtvb","⊿":"lrtri","⋀":"Wedge","⋁":"Vee","⋂":"xcap","⋃":"xcup","⋄":"diam","⋅":"sdot","⋆":"Star","⋇":"divonx","⋈":"bowtie","⋉":"ltimes","⋊":"rtimes","⋋":"lthree","⋌":"rthree","⋍":"bsime","⋎":"cuvee","⋏":"cuwed","⋐":"Sub","⋑":"Sup","⋒":"Cap","⋓":"Cup","⋔":"fork","⋕":"epar","⋖":"ltdot","⋗":"gtdot","⋘":"Ll","⋘̸":"nLl","⋙":"Gg","⋙̸":"nGg","⋚︀":"lesg","⋚":"leg","⋛":"gel","⋛︀":"gesl","⋞":"cuepr","⋟":"cuesc","⋦":"lnsim","⋧":"gnsim","⋨":"prnsim","⋩":"scnsim","⋮":"vellip","⋯":"ctdot","⋰":"utdot","⋱":"dtdot","⋲":"disin","⋳":"isinsv","⋴":"isins","⋵":"isindot","⋵̸":"notindot","⋶":"notinvc","⋷":"notinvb","⋹":"isinE","⋹̸":"notinE","⋺":"nisd","⋻":"xnis","⋼":"nis","⋽":"notnivc","⋾":"notnivb","⌅":"barwed","⌆":"Barwed","⌌":"drcrop","⌍":"dlcrop","⌎":"urcrop","⌏":"ulcrop","⌐":"bnot","⌒":"profline","⌓":"profsurf","⌕":"telrec","⌖":"target","⌜":"ulcorn","⌝":"urcorn","⌞":"dlcorn","⌟":"drcorn","⌢":"frown","⌣":"smile","⌭":"cylcty","⌮":"profalar","⌶":"topbot","⌽":"ovbar","⌿":"solbar","⍼":"angzarr","⎰":"lmoust","⎱":"rmoust","⎴":"tbrk","⎵":"bbrk","⎶":"bbrktbrk","⏜":"OverParenthesis","⏝":"UnderParenthesis","⏞":"OverBrace","⏟":"UnderBrace","⏢":"trpezium","⏧":"elinters","␣":"blank","─":"boxh","│":"boxv","┌":"boxdr","┐":"boxdl","└":"boxur","┘":"boxul","├":"boxvr","┤":"boxvl","┬":"boxhd","┴":"boxhu","┼":"boxvh","═":"boxH","║":"boxV","╒":"boxdR","╓":"boxDr","╔":"boxDR","╕":"boxdL","╖":"boxDl","╗":"boxDL","╘":"boxuR","╙":"boxUr","╚":"boxUR","╛":"boxuL","╜":"boxUl","╝":"boxUL","╞":"boxvR","╟":"boxVr","╠":"boxVR","╡":"boxvL","╢":"boxVl","╣":"boxVL","╤":"boxHd","╥":"boxhD","╦":"boxHD","╧":"boxHu","╨":"boxhU","╩":"boxHU","╪":"boxvH","╫":"boxVh","╬":"boxVH","▀":"uhblk","▄":"lhblk","█":"block","░":"blk14","▒":"blk12","▓":"blk34","□":"squ","▪":"squf","▫":"EmptyVerySmallSquare","▭":"rect","▮":"marker","▱":"fltns","△":"xutri","▴":"utrif","▵":"utri","▸":"rtrif","▹":"rtri","▽":"xdtri","▾":"dtrif","▿":"dtri","◂":"ltrif","◃":"ltri","◊":"loz","○":"cir","◬":"tridot","◯":"xcirc","◸":"ultri","◹":"urtri","◺":"lltri","◻":"EmptySmallSquare","◼":"FilledSmallSquare","★":"starf","☆":"star","☎":"phone","♀":"female","♂":"male","♠":"spades","♣":"clubs","♥":"hearts","♦":"diams","♪":"sung","✓":"check","✗":"cross","✠":"malt","✶":"sext","❘":"VerticalSeparator","⟈":"bsolhsub","⟉":"suphsol","⟵":"xlarr","⟶":"xrarr","⟷":"xharr","⟸":"xlArr","⟹":"xrArr","⟺":"xhArr","⟼":"xmap","⟿":"dzigrarr","⤂":"nvlArr","⤃":"nvrArr","⤄":"nvHarr","⤅":"Map","⤌":"lbarr","⤍":"rbarr","⤎":"lBarr","⤏":"rBarr","⤐":"RBarr","⤑":"DDotrahd","⤒":"UpArrowBar","⤓":"DownArrowBar","⤖":"Rarrtl","⤙":"latail","⤚":"ratail","⤛":"lAtail","⤜":"rAtail","⤝":"larrfs","⤞":"rarrfs","⤟":"larrbfs","⤠":"rarrbfs","⤣":"nwarhk","⤤":"nearhk","⤥":"searhk","⤦":"swarhk","⤧":"nwnear","⤨":"toea","⤩":"tosa","⤪":"swnwar","⤳":"rarrc","⤳̸":"nrarrc","⤵":"cudarrr","⤶":"ldca","⤷":"rdca","⤸":"cudarrl","⤹":"larrpl","⤼":"curarrm","⤽":"cularrp","⥅":"rarrpl","⥈":"harrcir","⥉":"Uarrocir","⥊":"lurdshar","⥋":"ldrushar","⥎":"LeftRightVector","⥏":"RightUpDownVector","⥐":"DownLeftRightVector","⥑":"LeftUpDownVector","⥒":"LeftVectorBar","⥓":"RightVectorBar","⥔":"RightUpVectorBar","⥕":"RightDownVectorBar","⥖":"DownLeftVectorBar","⥗":"DownRightVectorBar","⥘":"LeftUpVectorBar","⥙":"LeftDownVectorBar","⥚":"LeftTeeVector","⥛":"RightTeeVector","⥜":"RightUpTeeVector","⥝":"RightDownTeeVector","⥞":"DownLeftTeeVector","⥟":"DownRightTeeVector","⥠":"LeftUpTeeVector","⥡":"LeftDownTeeVector","⥢":"lHar","⥣":"uHar","⥤":"rHar","⥥":"dHar","⥦":"luruhar","⥧":"ldrdhar","⥨":"ruluhar","⥩":"rdldhar","⥪":"lharul","⥫":"llhard","⥬":"rharul","⥭":"lrhard","⥮":"udhar","⥯":"duhar","⥰":"RoundImplies","⥱":"erarr","⥲":"simrarr","⥳":"larrsim","⥴":"rarrsim","⥵":"rarrap","⥶":"ltlarr","⥸":"gtrarr","⥹":"subrarr","⥻":"suplarr","⥼":"lfisht","⥽":"rfisht","⥾":"ufisht","⥿":"dfisht","⦚":"vzigzag","⦜":"vangrt","⦝":"angrtvbd","⦤":"ange","⦥":"range","⦦":"dwangle","⦧":"uwangle","⦨":"angmsdaa","⦩":"angmsdab","⦪":"angmsdac","⦫":"angmsdad","⦬":"angmsdae","⦭":"angmsdaf","⦮":"angmsdag","⦯":"angmsdah","⦰":"bemptyv","⦱":"demptyv","⦲":"cemptyv","⦳":"raemptyv","⦴":"laemptyv","⦵":"ohbar","⦶":"omid","⦷":"opar","⦹":"operp","⦻":"olcross","⦼":"odsold","⦾":"olcir","⦿":"ofcir","⧀":"olt","⧁":"ogt","⧂":"cirscir","⧃":"cirE","⧄":"solb","⧅":"bsolb","⧉":"boxbox","⧍":"trisb","⧎":"rtriltri","⧏":"LeftTriangleBar","⧏̸":"NotLeftTriangleBar","⧐":"RightTriangleBar","⧐̸":"NotRightTriangleBar","⧜":"iinfin","⧝":"infintie","⧞":"nvinfin","⧣":"eparsl","⧤":"smeparsl","⧥":"eqvparsl","⧫":"lozf","⧴":"RuleDelayed","⧶":"dsol","⨀":"xodot","⨁":"xoplus","⨂":"xotime","⨄":"xuplus","⨆":"xsqcup","⨍":"fpartint","⨐":"cirfnint","⨑":"awint","⨒":"rppolint","⨓":"scpolint","⨔":"npolint","⨕":"pointint","⨖":"quatint","⨗":"intlarhk","⨢":"pluscir","⨣":"plusacir","⨤":"simplus","⨥":"plusdu","⨦":"plussim","⨧":"plustwo","⨩":"mcomma","⨪":"minusdu","⨭":"loplus","⨮":"roplus","⨯":"Cross","⨰":"timesd","⨱":"timesbar","⨳":"smashp","⨴":"lotimes","⨵":"rotimes","⨶":"otimesas","⨷":"Otimes","⨸":"odiv","⨹":"triplus","⨺":"triminus","⨻":"tritime","⨼":"iprod","⨿":"amalg","⩀":"capdot","⩂":"ncup","⩃":"ncap","⩄":"capand","⩅":"cupor","⩆":"cupcap","⩇":"capcup","⩈":"cupbrcap","⩉":"capbrcup","⩊":"cupcup","⩋":"capcap","⩌":"ccups","⩍":"ccaps","⩐":"ccupssm","⩓":"And","⩔":"Or","⩕":"andand","⩖":"oror","⩗":"orslope","⩘":"andslope","⩚":"andv","⩛":"orv","⩜":"andd","⩝":"ord","⩟":"wedbar","⩦":"sdote","⩪":"simdot","⩭":"congdot","⩭̸":"ncongdot","⩮":"easter","⩯":"apacir","⩰":"apE","⩰̸":"napE","⩱":"eplus","⩲":"pluse","⩳":"Esim","⩷":"eDDot","⩸":"equivDD","⩹":"ltcir","⩺":"gtcir","⩻":"ltquest","⩼":"gtquest","⩽":"les","⩽̸":"nles","⩾":"ges","⩾̸":"nges","⩿":"lesdot","⪀":"gesdot","⪁":"lesdoto","⪂":"gesdoto","⪃":"lesdotor","⪄":"gesdotol","⪅":"lap","⪆":"gap","⪇":"lne","⪈":"gne","⪉":"lnap","⪊":"gnap","⪋":"lEg","⪌":"gEl","⪍":"lsime","⪎":"gsime","⪏":"lsimg","⪐":"gsiml","⪑":"lgE","⪒":"glE","⪓":"lesges","⪔":"gesles","⪕":"els","⪖":"egs","⪗":"elsdot","⪘":"egsdot","⪙":"el","⪚":"eg","⪝":"siml","⪞":"simg","⪟":"simlE","⪠":"simgE","⪡":"LessLess","⪡̸":"NotNestedLessLess","⪢":"GreaterGreater","⪢̸":"NotNestedGreaterGreater","⪤":"glj","⪥":"gla","⪦":"ltcc","⪧":"gtcc","⪨":"lescc","⪩":"gescc","⪪":"smt","⪫":"lat","⪬":"smte","⪬︀":"smtes","⪭":"late","⪭︀":"lates","⪮":"bumpE","⪯":"pre","⪯̸":"npre","⪰":"sce","⪰̸":"nsce","⪳":"prE","⪴":"scE","⪵":"prnE","⪶":"scnE","⪷":"prap","⪸":"scap","⪹":"prnap","⪺":"scnap","⪻":"Pr","⪼":"Sc","⪽":"subdot","⪾":"supdot","⪿":"subplus","⫀":"supplus","⫁":"submult","⫂":"supmult","⫃":"subedot","⫄":"supedot","⫅":"subE","⫅̸":"nsubE","⫆":"supE","⫆̸":"nsupE","⫇":"subsim","⫈":"supsim","⫋︀":"vsubnE","⫋":"subnE","⫌︀":"vsupnE","⫌":"supnE","⫏":"csub","⫐":"csup","⫑":"csube","⫒":"csupe","⫓":"subsup","⫔":"supsub","⫕":"subsub","⫖":"supsup","⫗":"suphsub","⫘":"supdsub","⫙":"forkv","⫚":"topfork","⫛":"mlcp","⫤":"Dashv","⫦":"Vdashl","⫧":"Barv","⫨":"vBar","⫩":"vBarv","⫫":"Vbar","⫬":"Not","⫭":"bNot","⫮":"rnmid","⫯":"cirmid","⫰":"midcir","⫱":"topcir","⫲":"nhpar","⫳":"parsim","⫽":"parsl","⫽⃥":"nparsl","♭":"flat","♮":"natur","♯":"sharp","¤":"curren","¢":"cent",$:"dollar","£":"pound","¥":"yen","€":"euro","¹":"sup1","½":"half","⅓":"frac13","¼":"frac14","⅕":"frac15","⅙":"frac16","⅛":"frac18","²":"sup2","⅔":"frac23","⅖":"frac25","³":"sup3","¾":"frac34","⅗":"frac35","⅜":"frac38","⅘":"frac45","⅚":"frac56","⅝":"frac58","⅞":"frac78","𝒶":"ascr","𝕒":"aopf","𝔞":"afr","𝔸":"Aopf","𝔄":"Afr","𝒜":"Ascr",ª:"ordf",á:"aacute",Á:"Aacute",à:"agrave",À:"Agrave",ă:"abreve",Ă:"Abreve",â:"acirc",Â:"Acirc",å:"aring",Å:"angst",ä:"auml",Ä:"Auml",ã:"atilde",Ã:"Atilde",ą:"aogon",Ą:"Aogon",ā:"amacr",Ā:"Amacr",æ:"aelig",Æ:"AElig","𝒷":"bscr","𝕓":"bopf","𝔟":"bfr","𝔹":"Bopf",ℬ:"Bscr","𝔅":"Bfr","𝔠":"cfr","𝒸":"cscr","𝕔":"copf",ℭ:"Cfr","𝒞":"Cscr",ℂ:"Copf",ć:"cacute",Ć:"Cacute",ĉ:"ccirc",Ĉ:"Ccirc",č:"ccaron",Č:"Ccaron",ċ:"cdot",Ċ:"Cdot",ç:"ccedil",Ç:"Ccedil","℅":"incare","𝔡":"dfr","ⅆ":"dd","𝕕":"dopf","𝒹":"dscr","𝒟":"Dscr","𝔇":"Dfr","ⅅ":"DD","𝔻":"Dopf",ď:"dcaron",Ď:"Dcaron",đ:"dstrok",Đ:"Dstrok",ð:"eth",Ð:"ETH","ⅇ":"ee",ℯ:"escr","𝔢":"efr","𝕖":"eopf",ℰ:"Escr","𝔈":"Efr","𝔼":"Eopf",é:"eacute",É:"Eacute",è:"egrave",È:"Egrave",ê:"ecirc",Ê:"Ecirc",ě:"ecaron",Ě:"Ecaron",ë:"euml",Ë:"Euml",ė:"edot",Ė:"Edot",ę:"eogon",Ę:"Eogon",ē:"emacr",Ē:"Emacr","𝔣":"ffr","𝕗":"fopf","𝒻":"fscr","𝔉":"Ffr","𝔽":"Fopf",ℱ:"Fscr",ﬀ:"fflig",ﬃ:"ffilig",ﬄ:"ffllig",ﬁ:"filig",fj:"fjlig",ﬂ:"fllig",ƒ:"fnof",ℊ:"gscr","𝕘":"gopf","𝔤":"gfr","𝒢":"Gscr","𝔾":"Gopf","𝔊":"Gfr",ǵ:"gacute",ğ:"gbreve",Ğ:"Gbreve",ĝ:"gcirc",Ĝ:"Gcirc",ġ:"gdot",Ġ:"Gdot",Ģ:"Gcedil","𝔥":"hfr",ℎ:"planckh","𝒽":"hscr","𝕙":"hopf",ℋ:"Hscr",ℌ:"Hfr",ℍ:"Hopf",ĥ:"hcirc",Ĥ:"Hcirc",ℏ:"hbar",ħ:"hstrok",Ħ:"Hstrok","𝕚":"iopf","𝔦":"ifr","𝒾":"iscr","ⅈ":"ii","𝕀":"Iopf",ℐ:"Iscr",ℑ:"Im",í:"iacute",Í:"Iacute",ì:"igrave",Ì:"Igrave",î:"icirc",Î:"Icirc",ï:"iuml",Ï:"Iuml",ĩ:"itilde",Ĩ:"Itilde",İ:"Idot",į:"iogon",Į:"Iogon",ī:"imacr",Ī:"Imacr",ĳ:"ijlig",Ĳ:"IJlig",ı:"imath","𝒿":"jscr","𝕛":"jopf","𝔧":"jfr","𝒥":"Jscr","𝔍":"Jfr","𝕁":"Jopf",ĵ:"jcirc",Ĵ:"Jcirc","ȷ":"jmath","𝕜":"kopf","𝓀":"kscr","𝔨":"kfr","𝒦":"Kscr","𝕂":"Kopf","𝔎":"Kfr",ķ:"kcedil",Ķ:"Kcedil","𝔩":"lfr","𝓁":"lscr",ℓ:"ell","𝕝":"lopf",ℒ:"Lscr","𝔏":"Lfr","𝕃":"Lopf",ĺ:"lacute",Ĺ:"Lacute",ľ:"lcaron",Ľ:"Lcaron",ļ:"lcedil",Ļ:"Lcedil",ł:"lstrok",Ł:"Lstrok",ŀ:"lmidot",Ŀ:"Lmidot","𝔪":"mfr","𝕞":"mopf","𝓂":"mscr","𝔐":"Mfr","𝕄":"Mopf",ℳ:"Mscr","𝔫":"nfr","𝕟":"nopf","𝓃":"nscr",ℕ:"Nopf","𝒩":"Nscr","𝔑":"Nfr",ń:"nacute",Ń:"Nacute",ň:"ncaron",Ň:"Ncaron",ñ:"ntilde",Ñ:"Ntilde",ņ:"ncedil",Ņ:"Ncedil","№":"numero",ŋ:"eng",Ŋ:"ENG","𝕠":"oopf","𝔬":"ofr",ℴ:"oscr","𝒪":"Oscr","𝔒":"Ofr","𝕆":"Oopf",º:"ordm",ó:"oacute",Ó:"Oacute",ò:"ograve",Ò:"Ograve",ô:"ocirc",Ô:"Ocirc",ö:"ouml",Ö:"Ouml",ő:"odblac",Ő:"Odblac",õ:"otilde",Õ:"Otilde",ø:"oslash",Ø:"Oslash",ō:"omacr",Ō:"Omacr",œ:"oelig",Œ:"OElig","𝔭":"pfr","𝓅":"pscr","𝕡":"popf",ℙ:"Popf","𝔓":"Pfr","𝒫":"Pscr","𝕢":"qopf","𝔮":"qfr","𝓆":"qscr","𝒬":"Qscr","𝔔":"Qfr",ℚ:"Qopf",ĸ:"kgreen","𝔯":"rfr","𝕣":"ropf","𝓇":"rscr",ℛ:"Rscr",ℜ:"Re",ℝ:"Ropf",ŕ:"racute",Ŕ:"Racute",ř:"rcaron",Ř:"Rcaron",ŗ:"rcedil",Ŗ:"Rcedil","𝕤":"sopf","𝓈":"sscr","𝔰":"sfr","𝕊":"Sopf","𝔖":"Sfr","𝒮":"Sscr","Ⓢ":"oS",ś:"sacute",Ś:"Sacute",ŝ:"scirc",Ŝ:"Scirc",š:"scaron",Š:"Scaron",ş:"scedil",Ş:"Scedil",ß:"szlig","𝔱":"tfr","𝓉":"tscr","𝕥":"topf","𝒯":"Tscr","𝔗":"Tfr","𝕋":"Topf",ť:"tcaron",Ť:"Tcaron",ţ:"tcedil",Ţ:"Tcedil","™":"trade",ŧ:"tstrok",Ŧ:"Tstrok","𝓊":"uscr","𝕦":"uopf","𝔲":"ufr","𝕌":"Uopf","𝔘":"Ufr","𝒰":"Uscr",ú:"uacute",Ú:"Uacute",ù:"ugrave",Ù:"Ugrave",ŭ:"ubreve",Ŭ:"Ubreve",û:"ucirc",Û:"Ucirc",ů:"uring",Ů:"Uring",ü:"uuml",Ü:"Uuml",ű:"udblac",Ű:"Udblac",ũ:"utilde",Ũ:"Utilde",ų:"uogon",Ų:"Uogon",ū:"umacr",Ū:"Umacr","𝔳":"vfr","𝕧":"vopf","𝓋":"vscr","𝔙":"Vfr","𝕍":"Vopf","𝒱":"Vscr","𝕨":"wopf","𝓌":"wscr","𝔴":"wfr","𝒲":"Wscr","𝕎":"Wopf","𝔚":"Wfr",ŵ:"wcirc",Ŵ:"Wcirc","𝔵":"xfr","𝓍":"xscr","𝕩":"xopf","𝕏":"Xopf","𝔛":"Xfr","𝒳":"Xscr","𝔶":"yfr","𝓎":"yscr","𝕪":"yopf","𝒴":"Yscr","𝔜":"Yfr","𝕐":"Yopf",ý:"yacute",Ý:"Yacute",ŷ:"ycirc",Ŷ:"Ycirc",ÿ:"yuml",Ÿ:"Yuml","𝓏":"zscr","𝔷":"zfr","𝕫":"zopf",ℨ:"Zfr",ℤ:"Zopf","𝒵":"Zscr",ź:"zacute",Ź:"Zacute",ž:"zcaron",Ž:"Zcaron",ż:"zdot",Ż:"Zdot",Ƶ:"imped",þ:"thorn",Þ:"THORN",ŉ:"napos",α:"alpha",Α:"Alpha",β:"beta",Β:"Beta",γ:"gamma",Γ:"Gamma",δ:"delta",Δ:"Delta",ε:"epsi","ϵ":"epsiv",Ε:"Epsilon",ϝ:"gammad",Ϝ:"Gammad",ζ:"zeta",Ζ:"Zeta",η:"eta",Η:"Eta",θ:"theta",ϑ:"thetav",Θ:"Theta",ι:"iota",Ι:"Iota",κ:"kappa",ϰ:"kappav",Κ:"Kappa",λ:"lambda",Λ:"Lambda",μ:"mu",µ:"micro",Μ:"Mu",ν:"nu",Ν:"Nu",ξ:"xi",Ξ:"Xi",ο:"omicron",Ο:"Omicron",π:"pi",ϖ:"piv",Π:"Pi",ρ:"rho",ϱ:"rhov",Ρ:"Rho",σ:"sigma",Σ:"Sigma",ς:"sigmaf",τ:"tau",Τ:"Tau",υ:"upsi",Υ:"Upsilon",ϒ:"Upsi",φ:"phi",ϕ:"phiv",Φ:"Phi",χ:"chi",Χ:"Chi",ψ:"psi",Ψ:"Psi",ω:"omega",Ω:"ohm",а:"acy",А:"Acy",б:"bcy",Б:"Bcy",в:"vcy",В:"Vcy",г:"gcy",Г:"Gcy",ѓ:"gjcy",Ѓ:"GJcy",д:"dcy",Д:"Dcy",ђ:"djcy",Ђ:"DJcy",е:"iecy",Е:"IEcy",ё:"iocy",Ё:"IOcy",є:"jukcy",Є:"Jukcy",ж:"zhcy",Ж:"ZHcy",з:"zcy",З:"Zcy",ѕ:"dscy",Ѕ:"DScy",и:"icy",И:"Icy",і:"iukcy",І:"Iukcy",ї:"yicy",Ї:"YIcy",й:"jcy",Й:"Jcy",ј:"jsercy",Ј:"Jsercy",к:"kcy",К:"Kcy",ќ:"kjcy",Ќ:"KJcy",л:"lcy",Л:"Lcy",љ:"ljcy",Љ:"LJcy",м:"mcy",М:"Mcy",н:"ncy",Н:"Ncy",њ:"njcy",Њ:"NJcy",о:"ocy",О:"Ocy",п:"pcy",П:"Pcy",р:"rcy",Р:"Rcy",с:"scy",С:"Scy",т:"tcy",Т:"Tcy",ћ:"tshcy",Ћ:"TSHcy",у:"ucy",У:"Ucy",ў:"ubrcy",Ў:"Ubrcy",ф:"fcy",Ф:"Fcy",х:"khcy",Х:"KHcy",ц:"tscy",Ц:"TScy",ч:"chcy",Ч:"CHcy",џ:"dzcy",Џ:"DZcy",ш:"shcy",Ш:"SHcy",щ:"shchcy",Щ:"SHCHcy",ъ:"hardcy",Ъ:"HARDcy",ы:"ycy",Ы:"Ycy",ь:"softcy",Ь:"SOFTcy",э:"ecy",Э:"Ecy",ю:"yucy",Ю:"YUcy",я:"yacy",Я:"YAcy",ℵ:"aleph",ℶ:"beth",ℷ:"gimel",ℸ:"daleth"},m=/["&'<>`]/g,p={'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;"},g=/&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/,w=/[\0-\x08\x0B\x0E-\x1F\x7F-\x9F\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,b=/&(CounterClockwiseContourIntegral|DoubleLongLeftRightArrow|ClockwiseContourIntegral|NotNestedGreaterGreater|NotSquareSupersetEqual|DiacriticalDoubleAcute|NotRightTriangleEqual|NotSucceedsSlantEqual|NotPrecedesSlantEqual|CloseCurlyDoubleQuote|NegativeVeryThinSpace|DoubleContourIntegral|FilledVerySmallSquare|CapitalDifferentialD|OpenCurlyDoubleQuote|EmptyVerySmallSquare|NestedGreaterGreater|DoubleLongRightArrow|NotLeftTriangleEqual|NotGreaterSlantEqual|ReverseUpEquilibrium|DoubleLeftRightArrow|NotSquareSubsetEqual|NotDoubleVerticalBar|RightArrowLeftArrow|NotGreaterFullEqual|NotRightTriangleBar|SquareSupersetEqual|DownLeftRightVector|DoubleLongLeftArrow|leftrightsquigarrow|LeftArrowRightArrow|NegativeMediumSpace|blacktriangleright|RightDownVectorBar|PrecedesSlantEqual|RightDoubleBracket|SucceedsSlantEqual|NotLeftTriangleBar|RightTriangleEqual|SquareIntersection|RightDownTeeVector|ReverseEquilibrium|NegativeThickSpace|longleftrightarrow|Longleftrightarrow|LongLeftRightArrow|DownRightTeeVector|DownRightVectorBar|GreaterSlantEqual|SquareSubsetEqual|LeftDownVectorBar|LeftDoubleBracket|VerticalSeparator|rightleftharpoons|NotGreaterGreater|NotSquareSuperset|blacktriangleleft|blacktriangledown|NegativeThinSpace|LeftDownTeeVector|NotLessSlantEqual|leftrightharpoons|DoubleUpDownArrow|DoubleVerticalBar|LeftTriangleEqual|FilledSmallSquare|twoheadrightarrow|NotNestedLessLess|DownLeftTeeVector|DownLeftVectorBar|RightAngleBracket|NotTildeFullEqual|NotReverseElement|RightUpDownVector|DiacriticalTilde|NotSucceedsTilde|circlearrowright|NotPrecedesEqual|rightharpoondown|DoubleRightArrow|NotSucceedsEqual|NonBreakingSpace|NotRightTriangle|LessEqualGreater|RightUpTeeVector|LeftAngleBracket|GreaterFullEqual|DownArrowUpArrow|RightUpVectorBar|twoheadleftarrow|GreaterEqualLess|downharpoonright|RightTriangleBar|ntrianglerighteq|NotSupersetEqual|LeftUpDownVector|DiacriticalAcute|rightrightarrows|vartriangleright|UpArrowDownArrow|DiacriticalGrave|UnderParenthesis|EmptySmallSquare|LeftUpVectorBar|leftrightarrows|DownRightVector|downharpoonleft|trianglerighteq|ShortRightArrow|OverParenthesis|DoubleLeftArrow|DoubleDownArrow|NotSquareSubset|bigtriangledown|ntrianglelefteq|UpperRightArrow|curvearrowright|vartriangleleft|NotLeftTriangle|nleftrightarrow|LowerRightArrow|NotHumpDownHump|NotGreaterTilde|rightthreetimes|LeftUpTeeVector|NotGreaterEqual|straightepsilon|LeftTriangleBar|rightsquigarrow|ContourIntegral|rightleftarrows|CloseCurlyQuote|RightDownVector|LeftRightVector|nLeftrightarrow|leftharpoondown|circlearrowleft|SquareSuperset|OpenCurlyQuote|hookrightarrow|HorizontalLine|DiacriticalDot|NotLessGreater|ntriangleright|DoubleRightTee|InvisibleComma|InvisibleTimes|LowerLeftArrow|DownLeftVector|NotSubsetEqual|curvearrowleft|trianglelefteq|NotVerticalBar|TildeFullEqual|downdownarrows|NotGreaterLess|RightTeeVector|ZeroWidthSpace|looparrowright|LongRightArrow|doublebarwedge|ShortLeftArrow|ShortDownArrow|RightVectorBar|GreaterGreater|ReverseElement|rightharpoonup|LessSlantEqual|leftthreetimes|upharpoonright|rightarrowtail|LeftDownVector|Longrightarrow|NestedLessLess|UpperLeftArrow|nshortparallel|leftleftarrows|leftrightarrow|Leftrightarrow|LeftRightArrow|longrightarrow|upharpoonleft|RightArrowBar|ApplyFunction|LeftTeeVector|leftarrowtail|NotEqualTilde|varsubsetneqq|varsupsetneqq|RightTeeArrow|SucceedsEqual|SucceedsTilde|LeftVectorBar|SupersetEqual|hookleftarrow|DifferentialD|VerticalTilde|VeryThinSpace|blacktriangle|bigtriangleup|LessFullEqual|divideontimes|leftharpoonup|UpEquilibrium|ntriangleleft|RightTriangle|measuredangle|shortparallel|longleftarrow|Longleftarrow|LongLeftArrow|DoubleLeftTee|Poincareplane|PrecedesEqual|triangleright|DoubleUpArrow|RightUpVector|fallingdotseq|looparrowleft|PrecedesTilde|NotTildeEqual|NotTildeTilde|smallsetminus|Proportional|triangleleft|triangledown|UnderBracket|NotHumpEqual|exponentiale|ExponentialE|NotLessTilde|HilbertSpace|RightCeiling|blacklozenge|varsupsetneq|HumpDownHump|GreaterEqual|VerticalLine|LeftTeeArrow|NotLessEqual|DownTeeArrow|LeftTriangle|varsubsetneq|Intersection|NotCongruent|DownArrowBar|LeftUpVector|LeftArrowBar|risingdotseq|GreaterTilde|RoundImplies|SquareSubset|ShortUpArrow|NotSuperset|quaternions|precnapprox|backepsilon|preccurlyeq|OverBracket|blacksquare|MediumSpace|VerticalBar|circledcirc|circleddash|CircleMinus|CircleTimes|LessGreater|curlyeqprec|curlyeqsucc|diamondsuit|UpDownArrow|Updownarrow|RuleDelayed|Rrightarrow|updownarrow|RightVector|nRightarrow|nrightarrow|eqslantless|LeftCeiling|Equilibrium|SmallCircle|expectation|NotSucceeds|thickapprox|GreaterLess|SquareUnion|NotPrecedes|NotLessLess|straightphi|succnapprox|succcurlyeq|SubsetEqual|sqsupseteq|Proportion|Laplacetrf|ImaginaryI|supsetneqq|NotGreater|gtreqqless|NotElement|ThickSpace|TildeEqual|TildeTilde|Fouriertrf|rmoustache|EqualTilde|eqslantgtr|UnderBrace|LeftVector|UpArrowBar|nLeftarrow|nsubseteqq|subsetneqq|nsupseteqq|nleftarrow|succapprox|lessapprox|UpTeeArrow|upuparrows|curlywedge|lesseqqgtr|varepsilon|varnothing|RightFloor|complement|CirclePlus|sqsubseteq|Lleftarrow|circledast|RightArrow|Rightarrow|rightarrow|lmoustache|Bernoullis|precapprox|mapstoleft|mapstodown|longmapsto|dotsquare|downarrow|DoubleDot|nsubseteq|supsetneq|leftarrow|nsupseteq|subsetneq|ThinSpace|ngeqslant|subseteqq|HumpEqual|NotSubset|triangleq|NotCupCap|lesseqgtr|heartsuit|TripleDot|Leftarrow|Coproduct|Congruent|varpropto|complexes|gvertneqq|LeftArrow|LessTilde|supseteqq|MinusPlus|CircleDot|nleqslant|NotExists|gtreqless|nparallel|UnionPlus|LeftFloor|checkmark|CenterDot|centerdot|Mellintrf|gtrapprox|bigotimes|OverBrace|spadesuit|therefore|pitchfork|rationals|PlusMinus|Backslash|Therefore|DownBreve|backsimeq|backprime|DownArrow|nshortmid|Downarrow|lvertneqq|eqvparsl|imagline|imagpart|infintie|integers|Integral|intercal|LessLess|Uarrocir|intlarhk|sqsupset|angmsdaf|sqsubset|llcorner|vartheta|cupbrcap|lnapprox|Superset|SuchThat|succnsim|succneqq|angmsdag|biguplus|curlyvee|trpezium|Succeeds|NotTilde|bigwedge|angmsdah|angrtvbd|triminus|cwconint|fpartint|lrcorner|smeparsl|subseteq|urcorner|lurdshar|laemptyv|DDotrahd|approxeq|ldrushar|awconint|mapstoup|backcong|shortmid|triangle|geqslant|gesdotol|timesbar|circledR|circledS|setminus|multimap|naturals|scpolint|ncongdot|RightTee|boxminus|gnapprox|boxtimes|andslope|thicksim|angmsdaa|varsigma|cirfnint|rtriltri|angmsdab|rppolint|angmsdac|barwedge|drbkarow|clubsuit|thetasym|bsolhsub|capbrcup|dzigrarr|doteqdot|DotEqual|dotminus|UnderBar|NotEqual|realpart|otimesas|ulcorner|hksearow|hkswarow|parallel|PartialD|elinters|emptyset|plusacir|bbrktbrk|angmsdad|pointint|bigoplus|angmsdae|Precedes|bigsqcup|varkappa|notindot|supseteq|precneqq|precnsim|profalar|profline|profsurf|leqslant|lesdotor|raemptyv|subplus|notnivb|notnivc|subrarr|zigrarr|vzigzag|submult|subedot|Element|between|cirscir|larrbfs|larrsim|lotimes|lbrksld|lbrkslu|lozenge|ldrdhar|dbkarow|bigcirc|epsilon|simrarr|simplus|ltquest|Epsilon|luruhar|gtquest|maltese|npolint|eqcolon|npreceq|bigodot|ddagger|gtrless|bnequiv|harrcir|ddotseq|equivDD|backsim|demptyv|nsqsube|nsqsupe|Upsilon|nsubset|upsilon|minusdu|nsucceq|swarrow|nsupset|coloneq|searrow|boxplus|napprox|natural|asympeq|alefsym|congdot|nearrow|bigstar|diamond|supplus|tritime|LeftTee|nvinfin|triplus|NewLine|nvltrie|nvrtrie|nwarrow|nexists|Diamond|ruluhar|Implies|supmult|angzarr|suplarr|suphsub|questeq|because|digamma|Because|olcross|bemptyv|omicron|Omicron|rotimes|NoBreak|intprod|angrtvb|orderof|uwangle|suphsol|lesdoto|orslope|DownTee|realine|cudarrl|rdldhar|OverBar|supedot|lessdot|supdsub|topfork|succsim|rbrkslu|rbrksld|pertenk|cudarrr|isindot|planckh|lessgtr|pluscir|gesdoto|plussim|plustwo|lesssim|cularrp|rarrsim|Cayleys|notinva|notinvb|notinvc|UpArrow|Uparrow|uparrow|NotLess|dwangle|precsim|Product|curarrm|Cconint|dotplus|rarrbfs|ccupssm|Cedilla|cemptyv|notniva|quatint|frac35|frac38|frac45|frac56|frac58|frac78|tridot|xoplus|gacute|gammad|Gammad|lfisht|lfloor|bigcup|sqsupe|gbreve|Gbreve|lharul|sqsube|sqcups|Gcedil|apacir|llhard|lmidot|Lmidot|lmoust|andand|sqcaps|approx|Abreve|spades|circeq|tprime|divide|topcir|Assign|topbot|gesdot|divonx|xuplus|timesd|gesles|atilde|solbar|SOFTcy|loplus|timesb|lowast|lowbar|dlcorn|dlcrop|softcy|dollar|lparlt|thksim|lrhard|Atilde|lsaquo|smashp|bigvee|thinsp|wreath|bkarow|lsquor|lstrok|Lstrok|lthree|ltimes|ltlarr|DotDot|simdot|ltrPar|weierp|xsqcup|angmsd|sigmav|sigmaf|zeetrf|Zcaron|zcaron|mapsto|vsupne|thetav|cirmid|marker|mcomma|Zacute|vsubnE|there4|gtlPar|vsubne|bottom|gtrarr|SHCHcy|shchcy|midast|midcir|middot|minusb|minusd|gtrdot|bowtie|sfrown|mnplus|models|colone|seswar|Colone|mstpos|searhk|gtrsim|nacute|Nacute|boxbox|telrec|hairsp|Tcedil|nbumpe|scnsim|ncaron|Ncaron|ncedil|Ncedil|hamilt|Scedil|nearhk|hardcy|HARDcy|tcedil|Tcaron|commat|nequiv|nesear|tcaron|target|hearts|nexist|varrho|scedil|Scaron|scaron|hellip|Sacute|sacute|hercon|swnwar|compfn|rtimes|rthree|rsquor|rsaquo|zacute|wedgeq|homtht|barvee|barwed|Barwed|rpargt|horbar|conint|swarhk|roplus|nltrie|hslash|hstrok|Hstrok|rmoust|Conint|bprime|hybull|hyphen|iacute|Iacute|supsup|supsub|supsim|varphi|coprod|brvbar|agrave|Supset|supset|igrave|Igrave|notinE|Agrave|iiiint|iinfin|copysr|wedbar|Verbar|vangrt|becaus|incare|verbar|inodot|bullet|drcorn|intcal|drcrop|cularr|vellip|Utilde|bumpeq|cupcap|dstrok|Dstrok|CupCap|cupcup|cupdot|eacute|Eacute|supdot|iquest|easter|ecaron|Ecaron|ecolon|isinsv|utilde|itilde|Itilde|curarr|succeq|Bumpeq|cacute|ulcrop|nparsl|Cacute|nprcue|egrave|Egrave|nrarrc|nrarrw|subsup|subsub|nrtrie|jsercy|nsccue|Jsercy|kappav|kcedil|Kcedil|subsim|ulcorn|nsimeq|egsdot|veebar|kgreen|capand|elsdot|Subset|subset|curren|aacute|lacute|Lacute|emptyv|ntilde|Ntilde|lagran|lambda|Lambda|capcap|Ugrave|langle|subdot|emsp13|numero|emsp14|nvdash|nvDash|nVdash|nVDash|ugrave|ufisht|nvHarr|larrfs|nvlArr|larrhk|larrlp|larrpl|nvrArr|Udblac|nwarhk|larrtl|nwnear|oacute|Oacute|latail|lAtail|sstarf|lbrace|odblac|Odblac|lbrack|udblac|odsold|eparsl|lcaron|Lcaron|ograve|Ograve|lcedil|Lcedil|Aacute|ssmile|ssetmn|squarf|ldquor|capcup|ominus|cylcty|rharul|eqcirc|dagger|rfloor|rfisht|Dagger|daleth|equals|origof|capdot|equest|dcaron|Dcaron|rdquor|oslash|Oslash|otilde|Otilde|otimes|Otimes|urcrop|Ubreve|ubreve|Yacute|Uacute|uacute|Rcedil|rcedil|urcorn|parsim|Rcaron|Vdashl|rcaron|Tstrok|percnt|period|permil|Exists|yacute|rbrack|rbrace|phmmat|ccaron|Ccaron|planck|ccedil|plankv|tstrok|female|plusdo|plusdu|ffilig|plusmn|ffllig|Ccedil|rAtail|dfisht|bernou|ratail|Rarrtl|rarrtl|angsph|rarrpl|rarrlp|rarrhk|xwedge|xotime|forall|ForAll|Vvdash|vsupnE|preceq|bigcap|frac12|frac13|frac14|primes|rarrfs|prnsim|frac15|Square|frac16|square|lesdot|frac18|frac23|propto|prurel|rarrap|rangle|puncsp|frac25|Racute|qprime|racute|lesges|frac34|abreve|AElig|eqsim|utdot|setmn|urtri|Equal|Uring|seArr|uring|searr|dashv|Dashv|mumap|nabla|iogon|Iogon|sdote|sdotb|scsim|napid|napos|equiv|natur|Acirc|dblac|erarr|nbump|iprod|erDot|ucirc|awint|esdot|angrt|ncong|isinE|scnap|Scirc|scirc|ndash|isins|Ubrcy|nearr|neArr|isinv|nedot|ubrcy|acute|Ycirc|iukcy|Iukcy|xutri|nesim|caret|jcirc|Jcirc|caron|twixt|ddarr|sccue|exist|jmath|sbquo|ngeqq|angst|ccaps|lceil|ngsim|UpTee|delta|Delta|rtrif|nharr|nhArr|nhpar|rtrie|jukcy|Jukcy|kappa|rsquo|Kappa|nlarr|nlArr|TSHcy|rrarr|aogon|Aogon|fflig|xrarr|tshcy|ccirc|nleqq|filig|upsih|nless|dharl|nlsim|fjlig|ropar|nltri|dharr|robrk|roarr|fllig|fltns|roang|rnmid|subnE|subne|lAarr|trisb|Ccirc|acirc|ccups|blank|VDash|forkv|Vdash|langd|cedil|blk12|blk14|laquo|strns|diams|notin|vDash|larrb|blk34|block|disin|uplus|vdash|vBarv|aelig|starf|Wedge|check|xrArr|lates|lbarr|lBarr|notni|lbbrk|bcong|frasl|lbrke|frown|vrtri|vprop|vnsup|gamma|Gamma|wedge|xodot|bdquo|srarr|doteq|ldquo|boxdl|boxdL|gcirc|Gcirc|boxDl|boxDL|boxdr|boxdR|boxDr|TRADE|trade|rlhar|boxDR|vnsub|npart|vltri|rlarr|boxhd|boxhD|nprec|gescc|nrarr|nrArr|boxHd|boxHD|boxhu|boxhU|nrtri|boxHu|clubs|boxHU|times|colon|Colon|gimel|xlArr|Tilde|nsime|tilde|nsmid|nspar|THORN|thorn|xlarr|nsube|nsubE|thkap|xhArr|comma|nsucc|boxul|boxuL|nsupe|nsupE|gneqq|gnsim|boxUl|boxUL|grave|boxur|boxuR|boxUr|boxUR|lescc|angle|bepsi|boxvh|varpi|boxvH|numsp|Theta|gsime|gsiml|theta|boxVh|boxVH|boxvl|gtcir|gtdot|boxvL|boxVl|boxVL|crarr|cross|Cross|nvsim|boxvr|nwarr|nwArr|sqsup|dtdot|Uogon|lhard|lharu|dtrif|ocirc|Ocirc|lhblk|duarr|odash|sqsub|Hacek|sqcup|llarr|duhar|oelig|OElig|ofcir|boxvR|uogon|lltri|boxVr|csube|uuarr|ohbar|csupe|ctdot|olarr|olcir|harrw|oline|sqcap|omacr|Omacr|omega|Omega|boxVR|aleph|lneqq|lnsim|loang|loarr|rharu|lobrk|hcirc|operp|oplus|rhard|Hcirc|orarr|Union|order|ecirc|Ecirc|cuepr|szlig|cuesc|breve|reals|eDDot|Breve|hoarr|lopar|utrif|rdquo|Umacr|umacr|efDot|swArr|ultri|alpha|rceil|ovbar|swarr|Wcirc|wcirc|smtes|smile|bsemi|lrarr|aring|parsl|lrhar|bsime|uhblk|lrtri|cupor|Aring|uharr|uharl|slarr|rbrke|bsolb|lsime|rbbrk|RBarr|lsimg|phone|rBarr|rbarr|icirc|lsquo|Icirc|emacr|Emacr|ratio|simne|plusb|simlE|simgE|simeq|pluse|ltcir|ltdot|empty|xharr|xdtri|iexcl|Alpha|ltrie|rarrw|pound|ltrif|xcirc|bumpe|prcue|bumpE|asymp|amacr|cuvee|Sigma|sigma|iiint|udhar|iiota|ijlig|IJlig|supnE|imacr|Imacr|prime|Prime|image|prnap|eogon|Eogon|rarrc|mdash|mDDot|cuwed|imath|supne|imped|Amacr|udarr|prsim|micro|rarrb|cwint|raquo|infin|eplus|range|rangd|Ucirc|radic|minus|amalg|veeeq|rAarr|epsiv|ycirc|quest|sharp|quot|zwnj|Qscr|race|qscr|Qopf|qopf|qint|rang|Rang|Zscr|zscr|Zopf|zopf|rarr|rArr|Rarr|Pscr|pscr|prop|prod|prnE|prec|ZHcy|zhcy|prap|Zeta|zeta|Popf|popf|Zdot|plus|zdot|Yuml|yuml|phiv|YUcy|yucy|Yscr|yscr|perp|Yopf|yopf|part|para|YIcy|Ouml|rcub|yicy|YAcy|rdca|ouml|osol|Oscr|rdsh|yacy|real|oscr|xvee|andd|rect|andv|Xscr|oror|ordm|ordf|xscr|ange|aopf|Aopf|rHar|Xopf|opar|Oopf|xopf|xnis|rhov|oopf|omid|xmap|oint|apid|apos|ogon|ascr|Ascr|odot|odiv|xcup|xcap|ocir|oast|nvlt|nvle|nvgt|nvge|nvap|Wscr|wscr|auml|ntlg|ntgl|nsup|nsub|nsim|Nscr|nscr|nsce|Wopf|ring|npre|wopf|npar|Auml|Barv|bbrk|Nopf|nopf|nmid|nLtv|beta|ropf|Ropf|Beta|beth|nles|rpar|nleq|bnot|bNot|nldr|NJcy|rscr|Rscr|Vscr|vscr|rsqb|njcy|bopf|nisd|Bopf|rtri|Vopf|nGtv|ngtr|vopf|boxh|boxH|boxv|nges|ngeq|boxV|bscr|scap|Bscr|bsim|Vert|vert|bsol|bull|bump|caps|cdot|ncup|scnE|ncap|nbsp|napE|Cdot|cent|sdot|Vbar|nang|vBar|chcy|Mscr|mscr|sect|semi|CHcy|Mopf|mopf|sext|circ|cire|mldr|mlcp|cirE|comp|shcy|SHcy|vArr|varr|cong|copf|Copf|copy|COPY|malt|male|macr|lvnE|cscr|ltri|sime|ltcc|simg|Cscr|siml|csub|Uuml|lsqb|lsim|uuml|csup|Lscr|lscr|utri|smid|lpar|cups|smte|lozf|darr|Lopf|Uscr|solb|lopf|sopf|Sopf|lneq|uscr|spar|dArr|lnap|Darr|dash|Sqrt|LJcy|ljcy|lHar|dHar|Upsi|upsi|diam|lesg|djcy|DJcy|leqq|dopf|Dopf|dscr|Dscr|dscy|ldsh|ldca|squf|DScy|sscr|Sscr|dsol|lcub|late|star|Star|Uopf|Larr|lArr|larr|uopf|dtri|dzcy|sube|subE|Lang|lang|Kscr|kscr|Kopf|kopf|KJcy|kjcy|KHcy|khcy|DZcy|ecir|edot|eDot|Jscr|jscr|succ|Jopf|jopf|Edot|uHar|emsp|ensp|Iuml|iuml|eopf|isin|Iscr|iscr|Eopf|epar|sung|epsi|escr|sup1|sup2|sup3|Iota|iota|supe|supE|Iopf|iopf|IOcy|iocy|Escr|esim|Esim|imof|Uarr|QUOT|uArr|uarr|euml|IEcy|iecy|Idot|Euml|euro|excl|Hscr|hscr|Hopf|hopf|TScy|tscy|Tscr|hbar|tscr|flat|tbrk|fnof|hArr|harr|half|fopf|Fopf|tdot|gvnE|fork|trie|gtcc|fscr|Fscr|gdot|gsim|Gscr|gscr|Gopf|gopf|gneq|Gdot|tosa|gnap|Topf|topf|geqq|toea|GJcy|gjcy|tint|gesl|mid|Sfr|ggg|top|ges|gla|glE|glj|geq|gne|gEl|gel|gnE|Gcy|gcy|gap|Tfr|tfr|Tcy|tcy|Hat|Tau|Ffr|tau|Tab|hfr|Hfr|ffr|Fcy|fcy|icy|Icy|iff|ETH|eth|ifr|Ifr|Eta|eta|int|Int|Sup|sup|ucy|Ucy|Sum|sum|jcy|ENG|ufr|Ufr|eng|Jcy|jfr|els|ell|egs|Efr|efr|Jfr|uml|kcy|Kcy|Ecy|ecy|kfr|Kfr|lap|Sub|sub|lat|lcy|Lcy|leg|Dot|dot|lEg|leq|les|squ|div|die|lfr|Lfr|lgE|Dfr|dfr|Del|deg|Dcy|dcy|lne|lnE|sol|loz|smt|Cup|lrm|cup|lsh|Lsh|sim|shy|map|Map|mcy|Mcy|mfr|Mfr|mho|gfr|Gfr|sfr|cir|Chi|chi|nap|Cfr|vcy|Vcy|cfr|Scy|scy|ncy|Ncy|vee|Vee|Cap|cap|nfr|scE|sce|Nfr|nge|ngE|nGg|vfr|Vfr|ngt|bot|nGt|nis|niv|Rsh|rsh|nle|nlE|bne|Bfr|bfr|nLl|nlt|nLt|Bcy|bcy|not|Not|rlm|wfr|Wfr|npr|nsc|num|ocy|ast|Ocy|ofr|xfr|Xfr|Ofr|ogt|ohm|apE|olt|Rho|ape|rho|Rfr|rfr|ord|REG|ang|reg|orv|And|and|AMP|Rcy|amp|Afr|ycy|Ycy|yen|yfr|Yfr|rcy|par|pcy|Pcy|pfr|Pfr|phi|Phi|afr|Acy|acy|zcy|Zcy|piv|acE|acd|zfr|Zfr|pre|prE|psi|Psi|qfr|Qfr|zwj|Or|ge|Gg|gt|gg|el|oS|lt|Lt|LT|Re|lg|gl|eg|ne|Im|it|le|DD|wp|wr|nu|Nu|dd|lE|Sc|sc|pi|Pi|ee|af|ll|Ll|rx|gE|xi|pm|Xi|ic|pr|Pr|in|ni|mp|mu|ac|Mu|or|ap|Gt|GT|ii);|&(Aacute|Agrave|Atilde|Ccedil|Eacute|Egrave|Iacute|Igrave|Ntilde|Oacute|Ograve|Oslash|Otilde|Uacute|Ugrave|Yacute|aacute|agrave|atilde|brvbar|ccedil|curren|divide|eacute|egrave|frac12|frac14|frac34|iacute|igrave|iquest|middot|ntilde|oacute|ograve|oslash|otilde|plusmn|uacute|ugrave|yacute|AElig|Acirc|Aring|Ecirc|Icirc|Ocirc|THORN|Ucirc|acirc|acute|aelig|aring|cedil|ecirc|icirc|iexcl|laquo|micro|ocirc|pound|raquo|szlig|thorn|times|ucirc|Auml|COPY|Euml|Iuml|Ouml|QUOT|Uuml|auml|cent|copy|euml|iuml|macr|nbsp|ordf|ordm|ouml|para|quot|sect|sup1|sup2|sup3|uuml|yuml|AMP|ETH|REG|amp|deg|eth|not|reg|shy|uml|yen|GT|LT|gt|lt)(?!;)([=a-zA-Z0-9]?)|&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+)/g,A={aacute:"á",Aacute:"Á",abreve:"ă",Abreve:"Ă",ac:"∾",acd:"∿",acE:"∾̳",acirc:"â",Acirc:"Â",acute:"´",acy:"а",Acy:"А",aelig:"æ",AElig:"Æ",af:"⁡",afr:"𝔞",Afr:"𝔄",agrave:"à",Agrave:"À",alefsym:"ℵ",aleph:"ℵ",alpha:"α",Alpha:"Α",amacr:"ā",Amacr:"Ā",amalg:"⨿",amp:"&",AMP:"&",and:"∧",And:"⩓",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",aogon:"ą",Aogon:"Ą",aopf:"𝕒",Aopf:"𝔸",ap:"≈",apacir:"⩯",ape:"≊",apE:"⩰",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",aring:"å",Aring:"Å",ascr:"𝒶",Ascr:"𝒜",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",barwed:"⌅",Barwed:"⌆",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",bcy:"б",Bcy:"Б",bdquo:"„",becaus:"∵",because:"∵",Because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",beta:"β",Beta:"Β",beth:"ℶ",between:"≬",bfr:"𝔟",Bfr:"𝔅",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bnot:"⌐",bNot:"⫭",bopf:"𝕓",Bopf:"𝔹",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxhD:"╥",boxHd:"╤",boxHD:"╦",boxhu:"┴",boxhU:"╨",boxHu:"╧",boxHU:"╩",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"˘",Breve:"˘",brvbar:"¦",bscr:"𝒷",Bscr:"ℬ",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpe:"≏",bumpE:"⪮",bumpeq:"≏",Bumpeq:"≎",cacute:"ć",Cacute:"Ć",cap:"∩",Cap:"⋒",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",ccaron:"č",Ccaron:"Č",ccedil:"ç",Ccedil:"Ç",ccirc:"ĉ",Ccirc:"Ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",cdot:"ċ",Cdot:"Ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",CenterDot:"·",cfr:"𝔠",Cfr:"ℭ",chcy:"ч",CHcy:"Ч",check:"✓",checkmark:"✓",chi:"χ",Chi:"Χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cire:"≗",cirE:"⧃",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",colon:":",Colon:"∷",colone:"≔",Colone:"⩴",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",conint:"∮",Conint:"∯",ContourIntegral:"∮",copf:"𝕔",Copf:"ℂ",coprod:"∐",Coproduct:"∐",copy:"©",COPY:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",cross:"✗",Cross:"⨯",cscr:"𝒸",Cscr:"𝒞",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cup:"∪",Cup:"⋓",cupbrcap:"⩈",cupcap:"⩆",CupCap:"≍",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dagger:"†",Dagger:"‡",daleth:"ℸ",darr:"↓",dArr:"⇓",Darr:"↡",dash:"‐",dashv:"⊣",Dashv:"⫤",dbkarow:"⤏",dblac:"˝",dcaron:"ď",Dcaron:"Ď",dcy:"д",Dcy:"Д",dd:"ⅆ",DD:"ⅅ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",delta:"δ",Delta:"Δ",demptyv:"⦱",dfisht:"⥿",dfr:"𝔡",Dfr:"𝔇",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",diamond:"⋄",Diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",djcy:"ђ",DJcy:"Ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",dopf:"𝕕",Dopf:"𝔻",dot:"˙",Dot:"¨",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",downarrow:"↓",Downarrow:"⇓",DownArrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",dscr:"𝒹",Dscr:"𝒟",dscy:"ѕ",DScy:"Ѕ",dsol:"⧶",dstrok:"đ",Dstrok:"Đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",dzcy:"џ",DZcy:"Џ",dzigrarr:"⟿",eacute:"é",Eacute:"É",easter:"⩮",ecaron:"ě",Ecaron:"Ě",ecir:"≖",ecirc:"ê",Ecirc:"Ê",ecolon:"≕",ecy:"э",Ecy:"Э",eDDot:"⩷",edot:"ė",eDot:"≑",Edot:"Ė",ee:"ⅇ",efDot:"≒",efr:"𝔢",Efr:"𝔈",eg:"⪚",egrave:"è",Egrave:"È",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",emacr:"ē",Emacr:"Ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",eng:"ŋ",ENG:"Ŋ",ensp:" ",eogon:"ę",Eogon:"Ę",eopf:"𝕖",Eopf:"𝔼",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",epsilon:"ε",Epsilon:"Ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",escr:"ℯ",Escr:"ℰ",esdot:"≐",esim:"≂",Esim:"⩳",eta:"η",Eta:"Η",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",exponentiale:"ⅇ",ExponentialE:"ⅇ",fallingdotseq:"≒",fcy:"ф",Fcy:"Ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",ffr:"𝔣",Ffr:"𝔉",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",fopf:"𝕗",Fopf:"𝔽",forall:"∀",ForAll:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",Fscr:"ℱ",gacute:"ǵ",gamma:"γ",Gamma:"Γ",gammad:"ϝ",Gammad:"Ϝ",gap:"⪆",gbreve:"ğ",Gbreve:"Ğ",Gcedil:"Ģ",gcirc:"ĝ",Gcirc:"Ĝ",gcy:"г",Gcy:"Г",gdot:"ġ",Gdot:"Ġ",ge:"≥",gE:"≧",gel:"⋛",gEl:"⪌",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",gfr:"𝔤",Gfr:"𝔊",gg:"≫",Gg:"⋙",ggg:"⋙",gimel:"ℷ",gjcy:"ѓ",GJcy:"Ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gnE:"≩",gneq:"⪈",gneqq:"≩",gnsim:"⋧",gopf:"𝕘",Gopf:"𝔾",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",gscr:"ℊ",Gscr:"𝒢",gsim:"≳",gsime:"⪎",gsiml:"⪐",gt:">",Gt:"≫",GT:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",hardcy:"ъ",HARDcy:"Ъ",harr:"↔",hArr:"⇔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",hcirc:"ĥ",Hcirc:"Ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",Hfr:"ℌ",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",Hopf:"ℍ",horbar:"―",HorizontalLine:"─",hscr:"𝒽",Hscr:"ℋ",hslash:"ℏ",hstrok:"ħ",Hstrok:"Ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",iacute:"í",Iacute:"Í",ic:"⁣",icirc:"î",Icirc:"Î",icy:"и",Icy:"И",Idot:"İ",iecy:"е",IEcy:"Е",iexcl:"¡",iff:"⇔",ifr:"𝔦",Ifr:"ℑ",igrave:"ì",Igrave:"Ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",ijlig:"ĳ",IJlig:"Ĳ",Im:"ℑ",imacr:"ī",Imacr:"Ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",int:"∫",Int:"∬",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",iocy:"ё",IOcy:"Ё",iogon:"į",Iogon:"Į",iopf:"𝕚",Iopf:"𝕀",iota:"ι",Iota:"Ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",Iscr:"ℐ",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",itilde:"ĩ",Itilde:"Ĩ",iukcy:"і",Iukcy:"І",iuml:"ï",Iuml:"Ï",jcirc:"ĵ",Jcirc:"Ĵ",jcy:"й",Jcy:"Й",jfr:"𝔧",Jfr:"𝔍",jmath:"ȷ",jopf:"𝕛",Jopf:"𝕁",jscr:"𝒿",Jscr:"𝒥",jsercy:"ј",Jsercy:"Ј",jukcy:"є",Jukcy:"Є",kappa:"κ",Kappa:"Κ",kappav:"ϰ",kcedil:"ķ",Kcedil:"Ķ",kcy:"к",Kcy:"К",kfr:"𝔨",Kfr:"𝔎",kgreen:"ĸ",khcy:"х",KHcy:"Х",kjcy:"ќ",KJcy:"Ќ",kopf:"𝕜",Kopf:"𝕂",kscr:"𝓀",Kscr:"𝒦",lAarr:"⇚",lacute:"ĺ",Lacute:"Ĺ",laemptyv:"⦴",lagran:"ℒ",lambda:"λ",Lambda:"Λ",lang:"⟨",Lang:"⟪",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",larr:"←",lArr:"⇐",Larr:"↞",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",latail:"⤙",lAtail:"⤛",late:"⪭",lates:"⪭︀",lbarr:"⤌",lBarr:"⤎",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",lcaron:"ľ",Lcaron:"Ľ",lcedil:"ļ",Lcedil:"Ļ",lceil:"⌈",lcub:"{",lcy:"л",Lcy:"Л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",lE:"≦",LeftAngleBracket:"⟨",leftarrow:"←",Leftarrow:"⇐",LeftArrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",Leftrightarrow:"⇔",LeftRightArrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",leg:"⋚",lEg:"⪋",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",lfr:"𝔩",Lfr:"𝔏",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",ljcy:"љ",LJcy:"Љ",ll:"≪",Ll:"⋘",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",lmidot:"ŀ",Lmidot:"Ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lnE:"≨",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",Longleftarrow:"⟸",LongLeftArrow:"⟵",longleftrightarrow:"⟷",Longleftrightarrow:"⟺",LongLeftRightArrow:"⟷",longmapsto:"⟼",longrightarrow:"⟶",Longrightarrow:"⟹",LongRightArrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",lopf:"𝕝",Lopf:"𝕃",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",Lscr:"ℒ",lsh:"↰",Lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",lstrok:"ł",Lstrok:"Ł",lt:"<",Lt:"≪",LT:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",map:"↦",Map:"⤅",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",mcy:"м",Mcy:"М",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",mfr:"𝔪",Mfr:"𝔐",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",mopf:"𝕞",Mopf:"𝕄",mp:"∓",mscr:"𝓂",Mscr:"ℳ",mstpos:"∾",mu:"μ",Mu:"Μ",multimap:"⊸",mumap:"⊸",nabla:"∇",nacute:"ń",Nacute:"Ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",ncaron:"ň",Ncaron:"Ň",ncedil:"ņ",Ncedil:"Ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",ncy:"н",Ncy:"Н",ndash:"–",ne:"≠",nearhk:"⤤",nearr:"↗",neArr:"⇗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",nfr:"𝔫",Nfr:"𝔑",nge:"≱",ngE:"≧̸",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",ngt:"≯",nGt:"≫⃒",ngtr:"≯",nGtv:"≫̸",nharr:"↮",nhArr:"⇎",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",njcy:"њ",NJcy:"Њ",nlarr:"↚",nlArr:"⇍",nldr:"‥",nle:"≰",nlE:"≦̸",nleftarrow:"↚",nLeftarrow:"⇍",nleftrightarrow:"↮",nLeftrightarrow:"⇎",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nlt:"≮",nLt:"≪⃒",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",nopf:"𝕟",Nopf:"ℕ",not:"¬",Not:"⫬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrarr:"↛",nrArr:"⇏",nrarrc:"⤳̸",nrarrw:"↝̸",nrightarrow:"↛",nRightarrow:"⇏",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",nscr:"𝓃",Nscr:"𝒩",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsube:"⊈",nsubE:"⫅̸",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupe:"⊉",nsupE:"⫆̸",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",ntilde:"ñ",Ntilde:"Ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",nu:"ν",Nu:"Ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwarr:"↖",nwArr:"⇖",nwarrow:"↖",nwnear:"⤧",oacute:"ó",Oacute:"Ó",oast:"⊛",ocir:"⊚",ocirc:"ô",Ocirc:"Ô",ocy:"о",Ocy:"О",odash:"⊝",odblac:"ő",Odblac:"Ő",odiv:"⨸",odot:"⊙",odsold:"⦼",oelig:"œ",OElig:"Œ",ofcir:"⦿",ofr:"𝔬",Ofr:"𝔒",ogon:"˛",ograve:"ò",Ograve:"Ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",omacr:"ō",Omacr:"Ō",omega:"ω",Omega:"Ω",omicron:"ο",Omicron:"Ο",omid:"⦶",ominus:"⊖",oopf:"𝕠",Oopf:"𝕆",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",or:"∨",Or:"⩔",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",oscr:"ℴ",Oscr:"𝒪",oslash:"ø",Oslash:"Ø",osol:"⊘",otilde:"õ",Otilde:"Õ",otimes:"⊗",Otimes:"⨷",otimesas:"⨶",ouml:"ö",Ouml:"Ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",pcy:"п",Pcy:"П",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",pfr:"𝔭",Pfr:"𝔓",phi:"φ",Phi:"Φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",pi:"π",Pi:"Π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",popf:"𝕡",Popf:"ℙ",pound:"£",pr:"≺",Pr:"⪻",prap:"⪷",prcue:"≼",pre:"⪯",prE:"⪳",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",prime:"′",Prime:"″",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",pscr:"𝓅",Pscr:"𝒫",psi:"ψ",Psi:"Ψ",puncsp:" ",qfr:"𝔮",Qfr:"𝔔",qint:"⨌",qopf:"𝕢",Qopf:"ℚ",qprime:"⁗",qscr:"𝓆",Qscr:"𝒬",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',QUOT:'"',rAarr:"⇛",race:"∽̱",racute:"ŕ",Racute:"Ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",Rang:"⟫",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarr:"→",rArr:"⇒",Rarr:"↠",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",rarrtl:"↣",Rarrtl:"⤖",rarrw:"↝",ratail:"⤚",rAtail:"⤜",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rBarr:"⤏",RBarr:"⤐",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",rcaron:"ř",Rcaron:"Ř",rcedil:"ŗ",Rcedil:"Ŗ",rceil:"⌉",rcub:"}",rcy:"р",Rcy:"Р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",reg:"®",REG:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",Rfr:"ℜ",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",rho:"ρ",Rho:"Ρ",rhov:"ϱ",RightAngleBracket:"⟩",rightarrow:"→",Rightarrow:"⇒",RightArrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",Ropf:"ℝ",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",rscr:"𝓇",Rscr:"ℛ",rsh:"↱",Rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",sacute:"ś",Sacute:"Ś",sbquo:"‚",sc:"≻",Sc:"⪼",scap:"⪸",scaron:"š",Scaron:"Š",sccue:"≽",sce:"⪰",scE:"⪴",scedil:"ş",Scedil:"Ş",scirc:"ŝ",Scirc:"Ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",scy:"с",Scy:"С",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",searr:"↘",seArr:"⇘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",sfr:"𝔰",Sfr:"𝔖",sfrown:"⌢",sharp:"♯",shchcy:"щ",SHCHcy:"Щ",shcy:"ш",SHcy:"Ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",sigma:"σ",Sigma:"Σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",softcy:"ь",SOFTcy:"Ь",sol:"/",solb:"⧄",solbar:"⌿",sopf:"𝕤",Sopf:"𝕊",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",square:"□",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",sscr:"𝓈",Sscr:"𝒮",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",star:"☆",Star:"⋆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",Sub:"⋐",subdot:"⪽",sube:"⊆",subE:"⫅",subedot:"⫃",submult:"⫁",subne:"⊊",subnE:"⫋",subplus:"⪿",subrarr:"⥹",subset:"⊂",Subset:"⋐",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",sum:"∑",Sum:"∑",sung:"♪",sup:"⊃",Sup:"⋑",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supe:"⊇",supE:"⫆",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supne:"⊋",supnE:"⫌",supplus:"⫀",supset:"⊃",Supset:"⋑",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swarr:"↙",swArr:"⇙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",tau:"τ",Tau:"Τ",tbrk:"⎴",tcaron:"ť",Tcaron:"Ť",tcedil:"ţ",Tcedil:"Ţ",tcy:"т",Tcy:"Т",tdot:"⃛",telrec:"⌕",tfr:"𝔱",Tfr:"𝔗",there4:"∴",therefore:"∴",Therefore:"∴",theta:"θ",Theta:"Θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",thorn:"þ",THORN:"Þ",tilde:"˜",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",topf:"𝕥",Topf:"𝕋",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",TRADE:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",tscr:"𝓉",Tscr:"𝒯",tscy:"ц",TScy:"Ц",tshcy:"ћ",TSHcy:"Ћ",tstrok:"ŧ",Tstrok:"Ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",uacute:"ú",Uacute:"Ú",uarr:"↑",uArr:"⇑",Uarr:"↟",Uarrocir:"⥉",ubrcy:"ў",Ubrcy:"Ў",ubreve:"ŭ",Ubreve:"Ŭ",ucirc:"û",Ucirc:"Û",ucy:"у",Ucy:"У",udarr:"⇅",udblac:"ű",Udblac:"Ű",udhar:"⥮",ufisht:"⥾",ufr:"𝔲",Ufr:"𝔘",ugrave:"ù",Ugrave:"Ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",umacr:"ū",Umacr:"Ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",uogon:"ų",Uogon:"Ų",uopf:"𝕦",Uopf:"𝕌",uparrow:"↑",Uparrow:"⇑",UpArrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",updownarrow:"↕",Updownarrow:"⇕",UpDownArrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"ϒ",upsih:"ϒ",upsilon:"υ",Upsilon:"Υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",uring:"ů",Uring:"Ů",urtri:"◹",uscr:"𝓊",Uscr:"𝒰",utdot:"⋰",utilde:"ũ",Utilde:"Ũ",utri:"▵",utrif:"▴",uuarr:"⇈",uuml:"ü",Uuml:"Ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",vArr:"⇕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vBar:"⫨",Vbar:"⫫",vBarv:"⫩",vcy:"в",Vcy:"В",vdash:"⊢",vDash:"⊨",Vdash:"⊩",VDash:"⊫",Vdashl:"⫦",vee:"∨",Vee:"⋁",veebar:"⊻",veeeq:"≚",vellip:"⋮",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",vfr:"𝔳",Vfr:"𝔙",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",vopf:"𝕧",Vopf:"𝕍",vprop:"∝",vrtri:"⊳",vscr:"𝓋",Vscr:"𝒱",vsubne:"⊊︀",vsubnE:"⫋︀",vsupne:"⊋︀",vsupnE:"⫌︀",Vvdash:"⊪",vzigzag:"⦚",wcirc:"ŵ",Wcirc:"Ŵ",wedbar:"⩟",wedge:"∧",Wedge:"⋀",wedgeq:"≙",weierp:"℘",wfr:"𝔴",Wfr:"𝔚",wopf:"𝕨",Wopf:"𝕎",wp:"℘",wr:"≀",wreath:"≀",wscr:"𝓌",Wscr:"𝒲",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",xfr:"𝔵",Xfr:"𝔛",xharr:"⟷",xhArr:"⟺",xi:"ξ",Xi:"Ξ",xlarr:"⟵",xlArr:"⟸",xmap:"⟼",xnis:"⋻",xodot:"⨀",xopf:"𝕩",Xopf:"𝕏",xoplus:"⨁",xotime:"⨂",xrarr:"⟶",xrArr:"⟹",xscr:"𝓍",Xscr:"𝒳",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",yacute:"ý",Yacute:"Ý",yacy:"я",YAcy:"Я",ycirc:"ŷ",Ycirc:"Ŷ",ycy:"ы",Ycy:"Ы",yen:"¥",yfr:"𝔶",Yfr:"𝔜",yicy:"ї",YIcy:"Ї",yopf:"𝕪",Yopf:"𝕐",yscr:"𝓎",Yscr:"𝒴",yucy:"ю",YUcy:"Ю",yuml:"ÿ",Yuml:"Ÿ",zacute:"ź",Zacute:"Ź",zcaron:"ž",Zcaron:"Ž",zcy:"з",Zcy:"З",zdot:"ż",Zdot:"Ż",zeetrf:"ℨ",ZeroWidthSpace:"​",zeta:"ζ",Zeta:"Ζ",zfr:"𝔷",Zfr:"ℨ",zhcy:"ж",ZHcy:"Ж",zigrarr:"⇝",zopf:"𝕫",Zopf:"ℤ",zscr:"𝓏",Zscr:"𝒵",zwj:"‍",zwnj:"‌"},_={aacute:"á",Aacute:"Á",acirc:"â",Acirc:"Â",acute:"´",aelig:"æ",AElig:"Æ",agrave:"à",Agrave:"À",amp:"&",AMP:"&",aring:"å",Aring:"Å",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",brvbar:"¦",ccedil:"ç",Ccedil:"Ç",cedil:"¸",cent:"¢",copy:"©",COPY:"©",curren:"¤",deg:"°",divide:"÷",eacute:"é",Eacute:"É",ecirc:"ê",Ecirc:"Ê",egrave:"è",Egrave:"È",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",frac12:"½",frac14:"¼",frac34:"¾",gt:">",GT:">",iacute:"í",Iacute:"Í",icirc:"î",Icirc:"Î",iexcl:"¡",igrave:"ì",Igrave:"Ì",iquest:"¿",iuml:"ï",Iuml:"Ï",laquo:"«",lt:"<",LT:"<",macr:"¯",micro:"µ",middot:"·",nbsp:" ",not:"¬",ntilde:"ñ",Ntilde:"Ñ",oacute:"ó",Oacute:"Ó",ocirc:"ô",Ocirc:"Ô",ograve:"ò",Ograve:"Ò",ordf:"ª",ordm:"º",oslash:"ø",Oslash:"Ø",otilde:"õ",Otilde:"Õ",ouml:"ö",Ouml:"Ö",para:"¶",plusmn:"±",pound:"£",quot:'"',QUOT:'"',raquo:"»",reg:"®",REG:"®",sect:"§",shy:"­",sup1:"¹",sup2:"²",sup3:"³",szlig:"ß",thorn:"þ",THORN:"Þ",times:"×",uacute:"ú",Uacute:"Ú",ucirc:"û",Ucirc:"Û",ugrave:"ù",Ugrave:"Ù",uml:"¨",uuml:"ü",Uuml:"Ü",yacute:"ý",Yacute:"Ý",yen:"¥",yuml:"ÿ"},C={0:"�",128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},I=[1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65e3,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111],S=String.fromCharCode,R={},L=R.hasOwnProperty,k=function(Y,J){return L.call(Y,J)},T=function(Y,J){for(var q=-1,H=Y.length;++q<H;)if(Y[q]==J)return!0;return!1},D=function(Y,J){if(!Y)return J;var q={},H;for(H in J)q[H]=k(Y,H)?Y[H]:J[H];return q},P=function(Y,J){var q="";return Y>=55296&&Y<=57343||Y>1114111?(J&&M("character reference outside the permissible Unicode range"),"�"):k(C,Y)?(J&&M("disallowed character reference"),C[Y]):(J&&T(I,Y)&&M("disallowed character reference"),Y>65535&&(Y-=65536,q+=S(Y>>>10&1023|55296),Y=56320|Y&1023),q+=S(Y),q)},N=function(Y){return"&#x"+Y.toString(16).toUpperCase()+";"},F=function(Y){return"&#"+Y+";"},M=function(Y){throw Error("Parse error: "+Y)},$=function(Y,J){J=D(J,$.options);var q=J.strict;q&&w.test(Y)&&M("forbidden code point");var H=J.encodeEverything,G=J.useNamedReferences,le=J.allowUnsafeSymbols,se=J.decimal?F:N,X=function(ne){return se(ne.charCodeAt(0))};return H?(Y=Y.replace(a,function(ne){return G&&k(d,ne)?"&"+d[ne]+";":X(ne)}),G&&(Y=Y.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;").replace(/&#x66;&#x6A;/g,"&fjlig;")),G&&(Y=Y.replace(c,function(ne){return"&"+d[ne]+";"}))):G?(le||(Y=Y.replace(m,function(ne){return"&"+d[ne]+";"})),Y=Y.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;"),Y=Y.replace(c,function(ne){return"&"+d[ne]+";"})):le||(Y=Y.replace(m,X)),Y.replace(o,function(ne){var te=ne.charCodeAt(0),ae=ne.charCodeAt(1),de=(te-55296)*1024+ae-56320+65536;return se(de)}).replace(u,X)};$.options={allowUnsafeSymbols:!1,encodeEverything:!1,strict:!1,useNamedReferences:!1,decimal:!1};var Q=function(Y,J){J=D(J,Q.options);var q=J.strict;return q&&g.test(Y)&&M("malformed character reference"),Y.replace(b,function(H,G,le,se,X,ne,te,ae,de){var ye,xe,Oe,Fe,Be,We;return G?(Be=G,A[Be]):le?(Be=le,We=se,We&&J.isAttributeValue?(q&&We=="="&&M("`&` did not start a character reference"),H):(q&&M("named character reference was not terminated by a semicolon"),_[Be]+(We||""))):X?(Oe=X,xe=ne,q&&!xe&&M("character reference was not terminated by a semicolon"),ye=parseInt(Oe,10),P(ye,q)):te?(Fe=te,xe=ae,q&&!xe&&M("character reference was not terminated by a semicolon"),ye=parseInt(Fe,16),P(ye,q)):(q&&M("named character reference was not terminated by a semicolon"),H)})};Q.options={isAttributeValue:!1,strict:!1};var ie=function(Y){return Y.replace(m,function(J){return p[J]})},ee={version:"1.2.0",encode:$,decode:Q,escape:ie,unescape:Q};if(n&&!n.nodeType)if(r)r.exports=ee;else for(var ue in ee)k(ee,ue)&&(n[ue]=ee[ue]);else t.he=ee})(cQ)}(uy,uy.exports)),uy.exports}var dQ=hQ();const fQ=M0(dQ);function No(i){if(typeof i=="string"){const e=i.replace(/<[^>]+>/g,"");return fQ.decode(e).replace(/\s+/g," ").trim()}}class pQ extends ct{constructor(e){super(e),this.state={...this.state,plainText:""}}componentDidMount(){var n;const e=(n=this.props.obj)==null?void 0:n.getJson().body,t=No(e);this.setState({plainText:t})}componentDidUpdate(e){const t=this.props.obj.getJson().body,n=e.obj.getJson().body;if(t!==n){const r=No(t);this.setState({plainText:r})}}render(){let e=this.props.obj.getJson().ownerMessage?"outgoing":"incoming";return v.jsx("div",{children:this.props.obj.getJson().suggestion?v.jsxs("div",{className:"message-item outgoing",children:[v.jsxs("div",{className:"close-or-accept",children:[v.jsx("div",{className:"accept-suggested-message hover-darken",onClick:async()=>{let t=this.props.obj;t.setCompState({suggestion:!1,ownerMessage:!0},{run:!0});let n={originalMessageId:t.getJson().originalMessageId||"",from:this.propsState.currentUser.getJson()._id,to:this.propsState.currentConversation.getJson().contact,subject:t.getJson().subject,text:t.getJson().body},r=this.propsState.currentUser.getJson().gmailAuthenticated?"https://gmailapiemailhandler-7c5i3vsqma-uc.a.run.app":"https://sendgridemailhandler-7c5i3vsqma-uc.a.run.app";await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(s=>{if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);return s.json()}).then(s=>{console.log("Reply sent successfully in thread.",s)}).catch(s=>{console.error("Error sending reply:",s)})},children:v.jsx("i",{className:"fas fa-check"})}),v.jsx(ng,{obj:this.props.obj,formClass:"none",content:v.jsx("div",{className:"decline-suggested-message hover-darken",children:v.jsx("i",{className:"fas fa-times"})})})]}),v.jsx("div",{className:"message message-item-suggested",children:this.state.plainText})]}):v.jsxs(v.Fragment,{children:[this.props.obj.getJson().timeStamp&&v.jsx("div",{className:"date-divider",children:v.jsx("span",{className:"timestamp",children:this.props.obj.getJson().timeStamp})}),v.jsx("div",{className:"message-item "+e,children:v.jsx("div",{className:"message "+e,children:this.state.plainText})})]})})}}const mQ="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23696969'%3e%3cpath%20d='M400-80%200-480l400-400%2071%2071-329%20329%20329%20329-71%2071Z'/%3e%3c/svg%3e";class gQ extends ct{constructor(t){super(t);re(this,"handleCheckContact",t=>{let n=this.props.app.state.selectedContacts?[...this.props.app.state.selectedContacts]:[];n.includes(t)||n.push(t),this.dispatch({selectedContacts:n})});re(this,"handleUncheckContact",t=>{let n=this.props.app.state.selectedContacts?[...this.props.app.state.selectedContacts]:[];n=n.filter(r=>r!==t),this.dispatch({selectedContacts:n})})}async componentDidMount(){var r,s,o,a,u,c,d,m;const{obj:t}=this.props;let n=!1;Object.prototype.toString.call(t.getJson().mobile)==="[object Object]"&&((r=t.getJson().raw.phone_numbers)!=null&&r[0])&&t.getJson().mobile!==((s=t.getJson().raw)==null?void 0:s.raw_number)&&(await t.setCompState({mobile:t.getJson().mobile.raw_number}),n=!0),(o=t.getJson().raw)!=null&&o.city&&t.getJson().city!==((a=t.getJson().raw)==null?void 0:a.city)&&(await t.setCompState({city:(u=t.getJson().raw)==null?void 0:u.city}),n=!0),(c=t.getJson().raw)!=null&&c.state&&t.getJson().state!==((d=t.getJson().raw)==null?void 0:d.state)&&(await t.setCompState({state:(m=t.getJson().raw)==null?void 0:m.state}),n=!0),n&&(await t.update(),this.dispatch())}render(){var o;const{obj:t}=this.props;let n=t.getJson(),s=(this.props.app.state.selectedContacts?[...this.props.app.state.selectedContacts]:[]).includes(t);return v.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[v.jsxs("div",{className:"contact-item hover-darken",style:{background:s?"#2374ab10":"white",position:"relative",paddingLeft:"5px"},children:[v.jsx(kb,{checkKey:"selectedContacts",obj:t,check:this.handleCheckContact,uncheck:this.handleUncheckContact}),v.jsx("div",{className:"contact-avatar",children:v.jsx("i",{className:"fa-solid fa-user"})}),v.jsxs("div",{className:"contact-info",children:[v.jsx("div",{onClick:()=>{window.innerWidth>600?this.dispatch({currentContact:t}):this.dispatch({currentContact:t,currentPopupComponent:t,popupSwitch:"viewPotentialProspect"})},className:"contact-name",children:`${n.firstName} ${n.lastName}`}),v.jsx("div",{className:"contact-desc",children:n.company})]}),v.jsx("div",{style:{cursor:"pointer",width:"fit-content"},children:v.jsx("div",{className:"contact-icon",children:v.jsx("i",{className:"fa-solid fa-message"})})})]}),v.jsx("div",{className:"contact-tag-container active",children:(o=n.tags)==null?void 0:o.split(",").map((a,u)=>v.jsx("button",{className:"contact-tag-btn",children:a},u))})]})}}class yQ extends ct{constructor(t){super(t);re(this,"onResize",()=>{this.setState({isMobile:this.isNarrow(),viewportH:window.innerHeight},this.scrollToBottom)});re(this,"isNarrow",()=>typeof window<"u"?window.matchMedia("(max-width: 768px)").matches:!1);re(this,"detectMobile",()=>{this.setState({isMobile:this.isNarrow(),viewportH:window.innerHeight})});re(this,"scrollToBottom",()=>{this.messagesEndRef.current&&this.messagesEndRef.current.scrollIntoView({behavior:"smooth",block:"end"})});re(this,"setInput",t=>this.setState({input:t.target.value}));re(this,"handleKeyDown",t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),this.sendMessage())});re(this,"handleComposerFocus",()=>{setTimeout(this.scrollToBottom,50)});re(this,"addMessage",t=>{this.setState(n=>({messages:[...n.messages,t]}))});re(this,"formatContactMessage",t=>{var p,g,w,b,A,_,C,I,S,R,L,k,T;if(!t)return"(No contact data)";const n=[t.firstName,t.lastName].filter(Boolean).join(" "),r=t.title||t.jobTitle||"",s=t.company||((g=(p=t==null?void 0:t.raw)==null?void 0:p.company)==null?void 0:g.name)||"",o=t.email||((w=t.raw)==null?void 0:w.email)||"",a=t.phone||((b=t.raw)==null?void 0:b.phone)||"",u=(I=(C=(_=(A=t.raw)==null?void 0:A.company)==null?void 0:_.socialMediaUrls)==null?void 0:C.find(D=>{var P;return(P=D.type)==null?void 0:P.toLowerCase().includes("linked")}))==null?void 0:I.url,d=[(S=t.raw)==null?void 0:S.street,(R=t.raw)==null?void 0:R.city,(L=t.raw)==null?void 0:L.state,(k=t.raw)==null?void 0:k.zipCode,(T=t.raw)==null?void 0:T.country].filter(Boolean).join(", ");let m=`👤 ${n}`;return r&&(m+=`
📌 ${r}`),s&&(m+=`
🏢 ${s}`),o&&(m+=`
✉️ ${o}`),a&&(m+=`
📞 ${a}`),u&&(m+=`
🔗 ${u}`),d&&(m+=`
📍 ${d}`),m});re(this,"sendMessage",async()=>{debugger;const{input:t,currentConversation:n}=this.state,r=(t||"").trim();if(!r)return;this.addMessage({role:"user",text:r,ts:Date.now()});let s=Js.getIdFromURL(),o=this.componentList.getComponent("research",s);this.setState({input:"",loading:!0,error:null});let a=o.getJson().companyOwnerId,u=o.getJson().owner;try{const c=await fetch("https://runaskisaac-7c5i3vsqma-uc.a.run.app",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:r,options:{owner:u,companyOwnerId:a,newDataSrcs:["zoomInfoSrc"],temperature:.1,webSearch:!1,timeoutMs:45e3}})}),d=await c.text();let m=null;try{m=d?JSON.parse(d):null}catch{}if(!c.ok)throw new Error((m==null?void 0:m.error)||`HTTP ${c.status}`);if(m!=null&&m.data&&Array.isArray(m.data)){const p=m.data.map(g=>({role:"assistant",text:this.formatContactMessage(g),ts:Date.now()}));this.setState(g=>({messages:[...g.messages,...p]})),this.setState({input:"",loading:!1,error:null})}else typeof(m==null?void 0:m.text)=="string"?console.log("assistant text:",m.text):console.log("(No response)")}catch(c){console.error("Error:",c.message)}finally{}});re(this,"renderBubble",(t,n)=>{const r=t.role==="user",{isMobile:s}=this.state,o={maxWidth:s?"85vw":"72ch",padding:"12px 14px",borderRadius:16,lineHeight:1.5,whiteSpace:"pre-wrap",wordBreak:"break-word",boxShadow:"0 1px 2px rgba(0,0,0,0.06)",background:r?"#DCF2FF":"#FFFFFF",border:r?"1px solid #B6E4FF":"1px solid #ECECEC",alignSelf:r?"flex-end":"flex-start",fontSize:15},a={display:"flex",justifyContent:r?"flex-end":"flex-start",padding:"6px 10px"};return v.jsx("div",{style:a,children:v.jsx("div",{style:o,children:t.text})},`${t.ts||n}-${n}`)});this.state={...this.state,defaultClass:"fit",currentConversation:t.conversationId||null,messages:Array.isArray(t.initialMessages)?t.initialMessages:[],input:"",loading:!1,error:null,isMobile:!1,viewportH:typeof window<"u"?window.innerHeight:0},this.messagesEndRef=ze.createRef(),this.scrollWrapRef=ze.createRef()}componentDidMount(){this.detectMobile(),this.scrollToBottom(),window.addEventListener("resize",this.onResize,{passive:!0}),window.addEventListener("orientationchange",this.onResize,{passive:!0})}componentWillUnmount(){window.removeEventListener("resize",this.onResize),window.removeEventListener("orientationchange",this.onResize)}componentDidUpdate(t,n){(n.messages!==this.state.messages||n.loading!==this.state.loading)&&this.scrollToBottom()}getInnerContent(){const{loading:t,input:n,messages:r,error:s,isMobile:o,viewportH:a}=this.state,u={position:"relative",height:"80vh",display:"flex",flexDirection:"column",background:"#fafafa",border:"1px solid #eaeaea",borderRadius:12,overflow:"hidden"},c={position:"sticky",top:0,padding:"12px calc(12px + env(safe-area-inset-right)) 12px calc(12px + env(safe-area-inset-left))",borderBottom:"1px solid #eaeaea",fontSize:15,fontWeight:600,background:"#fff",zIndex:2},d={flex:1,overflowY:"auto",WebkitOverflowScrolling:"touch",padding:"10px 0",scrollBehavior:"smooth"},m={position:"sticky",bottom:0,borderTop:"1px solid #eaeaea",background:"#fff",padding:"10px 10px calc(10px + env(safe-area-inset-bottom)) 10px",display:"flex",gap:8,alignItems:"flex-end",zIndex:3},p={flex:1,minHeight:48,maxHeight:o?"40vh":160,resize:"vertical",padding:"12px",borderRadius:12,border:"1px solid #dcdcdc",outline:"none",fontSize:16,lineHeight:1.4},g={padding:"12px 16px",minHeight:48,minWidth:56,borderRadius:12,background:t?"#ddd":"#0b69ff",color:"#fff",border:"none",cursor:t?"not-allowed":"pointer",fontWeight:700,fontSize:15,touchAction:"manipulation"},w={padding:"6px 12px calc(6px + env(safe-area-inset-bottom)) 12px",fontSize:12,color:"#666"};return v.jsxs("div",{style:u,children:[v.jsx("div",{style:c,children:"AskIsaac"}),v.jsxs("div",{ref:this.scrollWrapRef,style:d,children:[r.map(this.renderBubble),t&&v.jsx("div",{style:{padding:"6px 10px",display:"flex"},children:v.jsx("div",{style:{fontSize:14,color:"#666",padding:"10px 12px",border:"1px solid #ececec",background:"#fff",borderRadius:12},children:"Getting Your Data…"})}),v.jsx("div",{ref:this.messagesEndRef,style:{height:1,scrollMarginBottom:80}})]}),s&&v.jsx("div",{style:{color:"#b00020",fontSize:13,padding:"4px 12px"},children:String(s.message||s)}),v.jsxs("div",{style:m,children:[v.jsx("textarea",{value:n,onChange:this.setInput,onKeyDown:this.handleKeyDown,onFocus:this.handleComposerFocus,placeholder:t?"Waiting for response…":"Send a message…",style:p,disabled:t,rows:1,"aria-label":"Message AskIsaac"}),v.jsx("button",{type:"button",onClick:this.sendMessage,disabled:t,style:g,"aria-label":"Send message",title:t?"Please wait":"Send (Enter)",children:t?"…":"Send"})]}),v.jsx("div",{style:w,children:"Press Enter to send • Shift+Enter for a new line"})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}const vQ="https://analyzebusinesscard-7c5i3vsqma-uc.a.run.app";class wQ extends ct{constructor(t){super(t);re(this,"handleBusinessCardFile",async t=>{var n,r;try{const s=(r=(n=t==null?void 0:t.target)==null?void 0:n.files)==null?void 0:r[0];if(!s)return;this.setState({uploadingCard:!0,analyzeMsg:null});const o=this.id,a=await this.fileToBase64NoHeader(s),c=await fetch(vQ,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({researchId:o,image:a})}),d=await c.json();if(!c.ok)throw new Error((d==null?void 0:d.error)||`HTTP ${c.status}`);const m=(d==null?void 0:d.counts)||{};this.setState({analyzeMsg:`Analyzed. Created: ${m.created||0}, Updated: ${m.upserted||0}, Skipped: ${m.skipped||0}`}),this.setState({})}catch(s){this.setState({analyzeMsg:`Analyze failed: ${(s==null?void 0:s.message)||String(s)}`}),console.error("Business card analyze error:",s)}finally{this.setState({uploadingCard:!1}),t!=null&&t.target&&(t.target.value="")}});this.state={...this.state,uploadingCard:!1,analyzeMsg:null,defaultClass:"fit",title:"Contacts"},this.id=Js.getIdFromURL(),this.state={...this.state,defaultClass:"fit",title:"Contacts",start:!1},this.setSearch=this.debounce(n=>this.dispatch({tags:n}),220)}fileToBase64NoHeader(t){return new Promise((n,r)=>{const s=new FileReader;s.onload=()=>{const o=String(s.result||""),a=o.indexOf(",");n(a>=0?o.slice(a+1):o)},s.onerror=r,s.readAsDataURL(t)})}debounce(t,n){let r;return(...s)=>{clearTimeout(r),r=setTimeout(()=>t(...s),n)}}componentDidMount(){this.dispatch({selectedContacts:[]}),"requestIdleCallback"in window?requestIdleCallback(()=>this.setState({start:!0}),{timeout:300}):setTimeout(()=>this.setState({start:!0}),0)}filterFunc(){var o;let t=Js.getIdFromURL(),n=((o=this.propsState.tags)==null?void 0:o.split(","))||"",r=this.componentList.getList("potentialProspect",t,"researchId"),s=[];if(n)for(let a of n){let u=r.filter(c=>c==null?void 0:c.getJson().tags.includes(a));s=[...s,...u]}else s=[...r];this.dispatch({selectedContacts:s})}getInnerContent(){var u,c;let t=Js.getIdFromURL(),n=this.componentList.getComponent("research",t),r=this.propsState.selectedContacts,s=this.propsState.componentList.getList("potentialProspect",t,"researchId");(r==null?void 0:r.length)>0;let o=s!=null&&s.length?"/"+(s==null?void 0:s.length):"",a=(r==null?void 0:r.length)===(s==null?void 0:s.length);return v.jsx("div",{className:"mobile-container",children:(n==null?void 0:n.getJson().agentType)==="askIsaac"?v.jsx(v.Fragment,{children:v.jsx(yQ,{})}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"top-nav-float",children:[v.jsxs("nav",{className:"top-nav",children:[v.jsxs("div",{className:"nav-left",children:[v.jsx("div",{className:"nav-icon",children:v.jsx("i",{className:"fas fa-circle"})}),v.jsx("div",{className:"nav-title",children:"Researched Potential Prospects"})]}),v.jsx("div",{onClick:()=>{n.setCompState({active:!(n!=null&&n.getJson().active)}),n.update(),this.setState()},children:n!=null&&n.getJson().active?"Pause":"activate"}),(n==null?void 0:n.getJson().researchType)==="businessCard"&&v.jsxs("div",{className:"bizcard-uploader",style:{display:"flex",alignItems:"center",gap:8},children:[v.jsx("input",{id:"bizcard-input",type:"file",accept:"image/*",capture:"environment",onChange:this.handleBusinessCardFile,style:{display:"none"}}),v.jsx("label",{htmlFor:"bizcard-input",className:"btn",children:this.state.uploadingCard?"Analyzing...":"Scan Business Card"}),this.state.analyzeMsg&&v.jsx("span",{style:{fontSize:12,opacity:.8},children:this.state.analyzeMsg})]}),v.jsxs("div",{className:"nav-right",children:[v.jsx("div",{className:"nav-icon",children:v.jsxs("button",{className:"btn",children:["A to Z ",v.jsx("i",{className:"fa-solid fa-angle-down"})]})}),v.jsx("div",{className:"nav-icon",children:v.jsxs("button",{onClick:async()=>{var d;try{const m=((d=n==null?void 0:n.getJson)==null?void 0:d.call(n))||n||{},p={companyId:m.companyId||m.companyOwnerId,researchIds:[m._id||m.id].filter(Boolean)};if(!p.companyId)throw new Error("Missing companyId on research");if(p.researchIds.length===0)throw new Error("Missing research id");const w=await fetch("https://getcontacts-7c5i3vsqma-uc.a.run.app",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!w.ok)throw new Error(`HTTP error! Status: ${w.status}`);const b=await w.json();console.log("getContacts triggered:",b)}catch(m){console.error("Error calling getContacts:",m)}},className:"btn",children:["Get Research ",v.jsx("i",{className:"fa-solid fa-angle-down"})]})}),v.jsx("div",{className:"nav-icon",children:v.jsx("button",{className:"btn",children:v.jsx("i",{className:"fa-solid fa-filter"})})})]})]}),v.jsx("div",{className:"search-container",children:v.jsxs("div",{className:"search-bar",children:[v.jsx("i",{className:"fas fa-search search-icon"}),v.jsx("input",{onChange:d=>this.setSearch(d.target.value),className:"search-input",placeholder:"Search"})]})}),v.jsx("div",{className:"filter-nav",children:v.jsxs("div",{className:"filter-nav-left",children:[v.jsx(v.Fragment,{children:v.jsx("div",{id:"selectBtn",style:{height:"fit-content",marginLeft:"5px",alignContent:"center"},children:v.jsx(kb,{label:a?"Deselect All":"Select All",check:this.filterFunc,uncheck:()=>{this.dispatch({selectedContacts:[]})}})})}),v.jsx("span",{className:"count-desc",children:(u=this.propsState.selectedContacts)!=null&&u.length?this.propsState.selectedContacts.length+`${o} Selected`:""})]})})]}),this.state.start&&v.jsx("div",{style:{paddingBottom:"60px"},children:v.jsx(er,{filterFunc:d=>{if(!this.propsState.tags)return!0;let m=this.propsState.tags.split(",");for(let p of m)if(p!==""&&d!=null&&d.getJson().tags.includes(p))return!0;return!1},filter:{search:t,attribute:"researchId"},name:"potentialProspect",type:"viewPortMap",mapContainerClass:"contact-list",mapSectionClass:"contact",wrapperClass:"none",cells:[{type:"custom",custom:gQ,wrapperClass:"none"}],hasLink:!0})}),((c=this.propsState.selectedContacts)==null?void 0:c.length)>0&&v.jsxs("div",{id:"floating-select-set",className:"floating-select-set",children:[v.jsx("button",{onClick:()=>{for(let d of this.propsState.selectedContacts)d.del();this.dispatch({selectedContacts:[]})},className:"floating-select-btn hover-basic",children:v.jsx("span",{className:"floating-select-btn-text",children:"Remove"})}),v.jsx("button",{onClick:()=>{for(let d of this.propsState.selectedContacts)d.copy({type:"contact",ogPPId:d==null?void 0:d.getJson()._id})},className:"floating-select-btn floating-select-primary-btn hover-basic",children:v.jsx("span",{className:"floating-select-btn-text",children:"Add Prospect"})}),v.jsx("button",{style:{width:"110px"},className:"floating-select-btn floating-select-primary-btn hover-basic",children:v.jsx(bb,{formclassName:"FCImgButton",content:v.jsx("span",{onClick:()=>{let d=this.propsState.selectedContacts;for(let m of d)m.copy({type:"contact",ogPPId:m==null?void 0:m.getJson()._id});this.dispatch({sequenceDataType:"research"})},className:"floating-select-btn-text",style:{color:"white"},children:"Add to Sequence"}),popupSwitch:"addToSequence"})})]})]})})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class _Q extends D5{constructor(e){super(e),this.state={...this.state,count:0}}componentDidMount(){if(this.state.count<=0){const{app:e,obj:t}=this.props;let s=e.state.componentList.getList("potentialProspect",t==null?void 0:t.getJson()._id,"researchId").length;this.setState({count:s})}}render(){const{obj:e,app:t}=this.props;let n=e.getJson(),r=n.active;return v.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[v.jsx("div",{style:{alignSelf:"flex-end"},children:v.jsx(bb,{obj:e,formClass:"none",wrapperClass:"none",content:v.jsx("span",{className:"floating-select-btn-text",style:{color:"black",marginRight:"10px"},children:"edit"}),popupSwitch:"updateResearch"})}),v.jsxs(yn,{to:`./${n==null?void 0:n._id}`,style:{padding:"20px"},className:`contact-item ${r?"contact-item-active":""}`,children:[v.jsxs("div",{className:"contact-info",children:[v.jsx("div",{onClick:()=>{this.dispatch({currentPopupComponent:e,popupSwitch:"updateContact"})},className:"contact-name",children:`${n.name} `}),v.jsx("div",{className:"contact-desc",children:`${this.state.count} Contact${this.state.count!==1?"s":""} Found`})]}),v.jsxs("div",{className:`profile-status ${r?"profile-status-active":""}`,children:[v.jsx("i",{className:"fa-solid fa-circle"}),v.jsx("span",{children:r?"Active":"Paused"})]})]}),v.jsx("div",{className:"contact-tag-container active",children:this.getTagUI(n)})]})}}class bQ extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit",title:"Contacts"}}filterFunc(){var r;let e=((r=this.propsState.tags)==null?void 0:r.split(","))||"",t=this.componentList.getList("contact"),n=[];if(e)for(let s of e){let o=t.filter(a=>a.getJson().tags.includes(s));n=[...n,...o]}else n=[...t];this.dispatch({selectedContacts:n})}getInnerContent(){return v.jsxs("div",{className:"map-container",children:[v.jsxs("div",{className:"top-nav-float",children:[v.jsx("nav",{className:"top-nav",children:v.jsxs("div",{className:"nav-left",children:[v.jsx("div",{className:"nav-icon",children:v.jsx("i",{className:"fas fa-circle"})}),v.jsx("div",{className:"nav-title",children:"Research"})]})}),v.jsx("div",{className:"search-container",children:v.jsxs("div",{className:"search-bar",children:[v.jsx("i",{className:"fas fa-search search-icon"}),v.jsx("input",{onChange:e=>{this.dispatch({searchText:e.target.value})},className:"search-input",placeholder:"Search"})]})}),v.jsx("div",{className:"filter-nav"}),v.jsx(Rb,{wrapperClass:"icon-row",newProp:"asdf",content:v.jsx("div",{className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:"New Research Profile"}),popupSwitch:"addResearch"})]}),v.jsx("div",{className:"card-header",children:"Customer Profiles"}),v.jsxs("div",{children:[" ",v.jsx(er,{filterFunc:e=>{var r;let t=!1;this.propsState.searchText||(t=!0);let n=this.propsState.searchText;return(r=e.getJson().name)!=null&&r.toLowerCase().includes(n==null?void 0:n.toLowerCase())&&(t=!0),t},name:"research",mapContainerclassName:"contact-list",mapSectionclassName:"contact",cells:[{type:"custom",custom:_Q}]})]})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class UL extends lf{constructor(e){super(e),this.state={...this.state,defaultClass:"fit",owner:this.app.state.currentUser.getJson()._id}}async componentDidMount(){await this.getComponentsFromBackend()}render(){return v.jsx("div",{style:{height:window.innerWidth<800&&"90vh"},className:this.props.pageClass||this.state.defaultClass,children:v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(bQ,{})})})}}class AQ extends ct{constructor(e){super(e),this.state={...this.state,opens:"0"}}async componentDidMount(){const{obj:e}=this.props;let t=await this.componentList.getComponentsFromBackend({type:"open",ids:e.getJson()._id,filterKeys:"sequenceId"});this.setState({opens:t.length})}render(){var n,r;const{obj:e}=this.props;let t=e.getJson();return v.jsxs("div",{className:"sequence",children:[v.jsxs("div",{className:"title",style:{justifyContent:"space-between",padding:"2px"},children:[v.jsx(yn,{to:"/sequence/"+t._id,style:{color:"#262626",maxWidth:"50%",minWidth:"50%"},onClick:()=>{this.dispatch({popupSwitch:"",currentPopupComponent:void 0})},className:"title-left",children:v.jsx("span",{style:{width:"100%",display:"inline-block",overflow:"hidden",lineBreak:"anywhere",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name})}),v.jsx(yn,{to:"/sequence/"+t._id,style:{marginRight:"10px"},onClick:()=>{this.dispatch({popupSwitch:"",currentPopupComponent:void 0})},className:"title-right",children:"View Details"})]}),v.jsxs("div",{className:"row row-space-around",style:{fontSize:"14px"},children:[v.jsxs("div",{className:"col",children:[v.jsx("div",{children:"Active"}),v.jsx("div",{children:((r=(n=this.componentList.getList("contact",t._id,"sequenceId"))==null?void 0:n.filter(s=>s.getJson().finished===!1))==null?void 0:r.length)||"0"})]}),v.jsxs("div",{className:"col",children:[v.jsx("div",{children:"Completed"}),v.jsx("div",{children:(t==null?void 0:t.finished)||"0"})]}),v.jsxs("div",{className:"col",children:[v.jsx("div",{children:"Opened"}),v.jsx("div",{children:this.state.opens||"N/A"})]}),v.jsxs("div",{className:"col",children:[v.jsx("div",{children:"Reply"}),v.jsx("div",{children:(t==null?void 0:t.replyRate)!=null?`${t.replyRate}`:"N/A"}),"                "]}),v.jsxs("div",{className:"col",children:[v.jsx("div",{children:"Bounce"}),v.jsx("div",{children:t!=null&&t.bounceRate?`${t==null?void 0:t.bounceRate}%`:"N/A"})]})]}),v.jsx("div",{style:{position:"absolute",right:"4px",cursor:"pointer"},className:"del-icon",children:v.jsx("div",{onClick:()=>{this.dispatch({popupSwitch:"delSequence",delSequence:this.props.obj})},children:v.jsx("i",{className:"fa-solid fa-xmark"})})})]})}}class EQ extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit"}}getInnerContent(){return v.jsxs("div",{className:"fit",children:[v.jsx("h4",{style:{marginBottom:"10px",font:"normal normal 900 16px/22px Satoshi"},children:"Sequences"}),v.jsx(er,{name:"sequence",filterFunc:e=>{var r;if(e.getJson().name===void 0||e.getJson().name==="")return!1;let t=!1;this.propsState.searchText||(t=!0);let n=this.propsState.searchText;return(r=e.getJson().name)!=null&&r.toLowerCase().includes(n==null?void 0:n.toLowerCase())&&(t=!0),t},cells:[{type:"custom",custom:AQ}]})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class CQ extends ct{constructor(e){super(e),this.state={...this.state,plainText:""}}componentDidMount(){var n;const e=(n=this.props.obj)==null?void 0:n.getJson().content,t=No(e);this.setState({plainText:t})}componentDidUpdate(e){var r,s;const t=(r=this.props.obj)==null?void 0:r.getJson().content,n=(s=this.props.obj)==null?void 0:s.getJson().content;if(t!==n){const o=No(t);this.setState({plainText:o})}}render(){const{obj:e}=this.props;let t=e.getJson();return v.jsx("div",{className:"sequence",children:v.jsxs("div",{className:"title",style:{justifyContent:"space-between",padding:"2px"},children:[v.jsx(yn,{style:{color:"#262626",maxWidth:"50%",minWidth:"50%"},to:"/template/"+t._id,onClick:()=>{this.dispatch({popupSwitch:"",currentPopupComponent:void 0})},className:"title-left",children:v.jsx("span",{style:{width:"100%",display:"inline-block",overflow:"hidden",lineBreak:"anywhere",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:this.state.plainText})}),v.jsx(yn,{style:{marginRight:"0px"},to:"/template/"+t._id,onClick:()=>{this.dispatch({popupSwitch:"",currentPopupComponent:void 0})},className:"title-right",children:"View Details"})]})})}}class xQ extends ct{constructor(e){super(e),this.state={...this.state,plainText:""}}componentDidMount(){var n;const e=(n=this.props.obj)==null?void 0:n.getJson().content,t=No(e);this.setState({plainText:t})}componentDidUpdate(e){var r,s;const t=(r=this.props.obj)==null?void 0:r.getJson().content,n=(s=this.props.obj)==null?void 0:s.getJson().content;if(t!==n){const o=No(t);this.setState({plainText:o})}}render(){const{obj:e}=this.props;let t=e.getJson();return v.jsx("div",{className:"sequence",children:v.jsx("div",{className:"title",style:{justifyContent:"space-between",padding:"2px"},children:v.jsx("div",{style:{color:"#262626",maxWidth:"50%",minWidth:"50%"},onClick:()=>{let n=this.props.changeItem||"currentPopupComponent",r=this.props.changeAttribute||"content";this.propsState[n].setCompState({[r]:t.content}),this.dispatch({update:this.propsState[n]})},className:"title-left",children:v.jsx("span",{style:{width:"100%",display:"inline-block",overflow:"hidden",lineBreak:"anywhere",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:this.state.plainText})})})})}}class SQ extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit"}}getInnerContent(){return v.jsxs(v.Fragment,{children:[v.jsx("h4",{style:{marginBottom:"10px",font:"normal normal 900 16px/22px Satoshi"},children:"Templates"}),v.jsx(er,{name:"template",filterFunc:e=>{var r;if(e.getJson().content===void 0||e.getJson().content==="")return!1;let t=!1;this.propsState.searchText||(t=!0);let n=this.propsState.searchText;return(r=e.getJson().content)!=null&&r.toLowerCase().includes(n==null?void 0:n.toLowerCase())&&(t=!0),t},cells:[{type:"custom",custom:CQ}]})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class TQ extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit"}}getInnerContent(){return v.jsxs("div",{className:"map-container",style:{paddingBottom:"62px"},children:[v.jsxs("div",{className:"top-nav-float",children:[v.jsx("nav",{className:"top-nav",children:v.jsxs("div",{className:"nav-left",children:[v.jsx("div",{className:"nav-icon",children:v.jsx("i",{className:"fas fa-circle"})}),v.jsx("div",{className:"title-name",children:"Content"})]})}),v.jsx("div",{className:"search-container",children:v.jsxs("div",{className:"search-bar",children:[v.jsx("i",{className:"fas fa-search search-icon"}),v.jsx("input",{onChange:e=>{this.dispatch({searchText:e.target.value})},className:"search-input",placeholder:"Search"})]})}),v.jsx("div",{className:"filter",children:v.jsxs("div",{className:"row row-space-between",children:[v.jsx(yn,{to:"/sequence",className:"btn-gray",children:"New Sequence"}),v.jsx(yn,{to:"/template",className:"btn-gray",children:"New Template"})]})})]}),v.jsx("div",{children:v.jsx(pr,{theme:"defaultCard",content:v.jsx(EQ,{})})}),v.jsx("div",{children:v.jsx(pr,{theme:"defaultCard",content:v.jsx(SQ,{})})})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class VL extends lf{constructor(e){super(e),this.state={...this.state,defaultClass:"fit",owner:this.propsState.currentUser.getJson()._id}}async componentDidMount(){this.getComponentsFromBackend()}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.state.gotComponents&&v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(TQ,{})})})}}class IQ extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit"}}getInnerContent(){var t;let e=this.componentList.getComponent("aiSettings");return v.jsxs("div",{id:"aiSettings",className:"map-container",style:{width:"fit-content",minWidth:"400px",height:"fit-content",padding:"12px",borderRadius:"8px",border:"1px solid #d1d1d1"},children:[v.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[v.jsx("div",{className:"contact-avatar",style:{maxWidth:"45px",maxHeight:"45px",background:"#323232"},children:v.jsx("i",{className:"fa-solid fa-gears"})}),v.jsx("h1",{children:"AI Settings"})]}),v.jsx("p",{style:{color:"#333333",margin:"12px 0px 12px 0px"},children:"Enable AI functionality within the platform"}),(t=e==null?void 0:e.getJson())!=null&&t.autoAI?v.jsx("div",{onClick:()=>{e.setCompState({autoAI:!1},{run:!0},!0)},className:"blue-button-1",style:{position:"relative",width:"fit-content"},children:"Turn off AI"}):v.jsx("div",{onClick:()=>{e.setCompState({autoAI:!0},{run:!0},!0)},className:"blue-button-1",style:{position:"relative",width:"fit-content"},children:"Turn on AI"})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class DQ extends ct{constructor(t){super(t);re(this,"expectedState","xyz123");this.state={...this.state,defaultClass:"fit",loading:!1,error:null}}componentDidMount(){const n=new URLSearchParams(window.location.search).get("code");n&&!this.state.hasExchanged&&(this.setState({hasExchanged:!0}),setTimeout(()=>{this.exchangeCodeForTokens(n)},100))}async exchangeCodeForTokens(t){this.setState({loading:!0,error:null});let n={code:t,user:this.propsState.currentUser.getJson()};console.log(n);let r=await JSON.stringify(n);try{const s=await fetch("https://exchangecode-7c5i3vsqma-uc.a.run.app",{method:"POST",headers:{"Content-Type":"application/json"},body:r});if(!s.ok)throw new Error(`HTTP ${s.status}`);const{access_token:o,refresh_token:a,expires_in:u}=await s.json();console.log(o),await this.propsState.currentUser.setCompState({outreachAccessToken:o,outreachRefreshToken:a,outreachTokenExpiresAt:Date.now()+u*1e3},{run:!0},!0),window.history.replaceState({},"",window.location.pathname)}catch(s){console.error(s),this.setState({error:s.message})}finally{this.setState({loading:!1})}}getInnerContent(){const{loading:t,error:n}=this.state;return v.jsxs("div",{id:"outreachSettings",style:{width:"fit-content",height:"fit-content",minWidth:"400px",padding:"12px",borderRadius:"8px",border:"1px solid #d1d1d1"},children:[v.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[v.jsx("div",{className:"contact-avatar",style:{maxWidth:"25px",maxHeight:"25px",background:"#323232"},children:v.jsx("i",{class:"fa-solid fa-envelope"})}),v.jsx("h1",{children:"Outreach Settings"})]}),v.jsx("p",{style:{color:"#333333",margin:"12px 0px 12px 0px"},children:"Integrate with Outreach for sales engagement"}),t&&v.jsx("p",{children:"Linking your Outreach account…"}),n&&v.jsxs("p",{style:{color:"red"},children:["Error: ",n]}),!t&&!n&&v.jsx("div",{className:"blue-button-1",onClick:()=>{window.location.href=`https://accounts.outreach.io/oauth/authorize?client_id=FVmbvVzJuXA7v1QqONeErtezeL-Rth2L6.UWzJW8IeZL&redirect_uri=${encodeURIComponent("https://app.salescapture.ai/settings")}&response_type=code&scope=sequences.read%20sequenceStates.write%20users.all%20mailboxes.all%20prospects.all&state=xyz123`},children:"Connect Outreach"})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}const R5="/assets/logo_google_g-DjEGDao7.png";class kQ extends ct{constructor(t){super(t);re(this,"handleAuthClick",()=>{this.setState({statusMessage:"Redirecting to Google..."});const t="786362911238-7q3lb2icdev4ives0ho4loi21n1r1t1g.apps.googleusercontent.com",n="https://www.googleapis.com/auth/gmail.send https://www.googleapis.com/auth/gmail.modify https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile openid",r="https://scaiuserauthentication-7c5i3vsqma-uc.a.run.app/oauth2callback",s=new URL("https://accounts.google.com/o/oauth2/v2/auth");s.searchParams.set("client_id",t),s.searchParams.set("redirect_uri",r),s.searchParams.set("response_type","code"),s.searchParams.set("scope",n),s.searchParams.set("access_type","offline"),s.searchParams.set("prompt","consent");const o=this.propsState.currentUser.getJson()._id,a=window.location.href,c=JSON.stringify({userId:o,postAuthRedirect:a});s.searchParams.set("state",c),window.location.href=s.toString()});this.state={statusMessage:""}}render(){const{statusMessage:t}=this.state;return v.jsxs("div",{className:"gmail-auth-container",children:[v.jsx("h1",{style:{fontSize:"22px"},children:"Gmail API Authorization"}),v.jsx("p",{style:{fontSize:"16px"},children:"Click the button below to authorize your Google account for use with the Firebase Function."}),v.jsx("p",{style:{fontSize:"14px"},children:"- This process will redirect you to Google for authorization and then back to your function, which will save your token to Firestore, linked by your email address."}),v.jsxs("button",{className:"auth-button dark-button-1",style:{fontSize:"14px",background:"#333333"},onClick:this.handleAuthClick,children:[v.jsx("img",{src:R5,style:{width:"30px"}}),v.jsx("div",{children:"Authorize with Google"})]}),t&&v.jsx("div",{className:"status-message",children:t})]})}}class RQ extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit",title:"Contacts"}}getInnerContent(){return v.jsx("div",{id:"googleSettings",style:{border:"1px solid #d1d1d1",width:"fit-content",height:"fit-content",minWidth:"400px",padding:"12px",borderRadius:"8px"},children:this.propsState.currentUser.getJson().gmailAuthenticated?v.jsxs("div",{style:{font:"normal normal 900 12px/18px Satoshi"},children:["Gmail Authenticated:",v.jsxs("div",{style:{font:"normal normal 400 12px/16px Satoshi",color:"#696969",alignItems:"center",display:"flex",marginTop:"20px"},children:[v.jsx("img",{src:R5,style:{width:"30px"}}),this.propsState.currentUser.getJson()._id]})]}):v.jsx(kQ,{})})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class HL extends lf{constructor(e){super(e),this.state={...this.state,defaultClass:"fit",owner:this.app.state.currentUser.getJson()._id}}async componentDidMount(){await this.getComponentsFromBackend()}render(){return v.jsxs("div",{className:this.props.pageClass||this.state.defaultClass,style:{display:"flex",flexDirection:"column"},children:[v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(IQ,{})}),v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(DQ,{})}),v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(RQ,{})})]})}}class PQ extends ct{constructor(e){super(e),this.state={...this.state,plainText:""}}componentDidMount(){var n;const e=(n=this.props.obj)==null?void 0:n.getJson().content,t=No(e);this.setState({plainText:t})}componentDidUpdate(e){var r,s;const t=(r=this.props.obj)==null?void 0:r.getJson().content,n=(s=this.props.obj)==null?void 0:s.getJson().content;if(t!==n){const o=No(t);this.setState({plainText:o})}}render(){return v.jsx("div",{onClick:()=>{this.dispatch({popupSwitch:"updateStep",currentPopupComponent:this.props.obj})},children:v.jsxs("div",{className:"icon-row",children:[v.jsx("div",{className:"icon-container",children:v.jsxs("div",{className:"col",children:[v.jsx("div",{className:"icon",style:{cursor:"pointer"},children:v.jsx("i",{className:"fa-solid fa-envelope"})}),v.jsx("div",{className:"svg",children:v.jsx("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",children:v.jsx("line",{x1:"50%",y1:"0",x2:"50%",y2:"50",stroke:"var(--app-green)",strokeWidth:"3"})})})]})}),v.jsxs("div",{className:"message-container",children:[v.jsx("b",{children:this.props.obj.getJson().subject}),v.jsx("br",{}),v.jsx("span",{children:this.state.plainText})]})]})})}}class NQ extends ct{constructor(e){super(e),this.state={...this.state,style:{width:"fit-content",font:"normal normal 900 10px / 14px Satoshi",padding:"6px 17px",letterSpacing:".5px",color:"white",borderRadius:"53px",marginTop:"0px"},plainText:""}}getText(e){let t="Active",n="#9a9a9a";return e.getJson().finished&&(t="Finished",e.getJson().bounced&&(t="Bounced",n="#BE5858"),e.getJson().replied&&(t="Replied",n="#2374AB")),v.jsx("div",{className:"contact-tag-btn",style:{...this.state.style,background:n+" 0% 0% no-repeat"},children:t})}render(){var r,s;let e=(r=this.props.obj)==null?void 0:r.getJson(),t=e!=null&&e.mobile?e==null?void 0:e.mobile:e==null?void 0:e.email;(e.firstName||e.lastName)&&`${e.firstName}${e.lastName}`;let n=this.getText((s=this.props)==null?void 0:s.obj);return v.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[v.jsxs("div",{className:"contact-info",style:{flex:2},children:[v.jsx("div",{className:"contact-name",children:`${e.firstName} ${e.lastName}`}),v.jsxs("div",{className:"contact-desc",children:[(e==null?void 0:e.company)||(e==null?void 0:e.title)||(e==null?void 0:e.email)||(e==null?void 0:e.mobile)||"",v.jsxs("div",{children:["step: ",parseInt(e.emailNumber)+1]})]})]}),v.jsxs("div",{style:{display:"flex",flex:1,gap:"3px",justifyContent:"flex-end"},children:[v.jsx("div",{children:n}),!this.props.obj.getJson().finished&&v.jsx("div",{title:"Remove from Sequence",onClick:()=>{this.props.obj.setCompState({finished:!0}),this.props.obj.update();let o=this.propsState.currentSequence,a=parseInt(o.getJson().finished)+1;o.setCompState({finished:a}),o.update()},className:"dark-button-1",children:"Remove"})]})]})}}class Ow extends sg{constructor(e){super(e),this.state={...this.state,list:null,spState:"sequenceSteps"}}async componentDidMount(){var n;let e;await this.getComponentsFromBackend(),await this.componentList.getComponentsFromBackend("template"),await this.componentList.getComponentsFromBackend("step"),await this.componentList.getComponentsFromBackend("contact"),e=this.comp,e||(e=await this.operationsFactory.prepare({prepare:{type:"sequence"},clean:!0}),e=e[0]);let t=await this.componentList.getList("step",(n=this.propsState.currentSequence)==null?void 0:n.getJson()._id,"sequenceId");this.state.list||this.setState({list:t}),await this.dispatch({currentSequence:e}),this.componentList.sortSelectedList("step","order")}componentWillUnmount(){this.operationsFactory.clear()}async createStep(e){let t=this.componentList.getList("step",e?e.getJson()._id:this.propsState.currentSequence.getJson()._id,"sequenceId");this.state.list||this.setState({list:t});const n=await this.operationsFactory.prepare({prepare:{type:"step",sequenceId:e?e.getJson()._id:this.propsState.currentSequence.getJson()._id,step:t.length}});this.dispatch({currentStep:n.length===2?n[1]:n[0]})}getStepJson(){var n,r;let e=this.componentList.getList("step",(n=this.propsState.currentSequence)==null?void 0:n.getJson()._id,"sequenceId");return{type:"step",sequenceId:(r=this.propsState.currentSequence)==null?void 0:r.getJson()._id,step:e.length}}getInnerContent(){var n,r,s,o,a,u;let t=((n=this.state.list)==null?void 0:n.length)>0?(r=this.state)==null?void 0:r.list[0].getJson().content:void 0;return v.jsx("div",{className:"fit",children:v.jsxs("div",{className:"mobile-container",children:[v.jsxs("div",{className:"title-bar",children:[v.jsxs("div",{className:"title-left",children:[v.jsx("div",{className:"title-icon",children:v.jsx("i",{className:"fas fa-angle-left",onClick:()=>{history.back()}})}),((s=this.propsState.currentSequence)==null?void 0:s.getJson().name)===""||this.state.edit?v.jsxs("div",{className:"name-a-sequence",children:[v.jsx(Qe,{obj:this.propsState.currentSequence,name:"name"}),v.jsx(Es,{callbackFunc:()=>{this.setState({edit:!1}),this.propsState.currentSequence.update()},content:"save",className:"dark-button-1"})]}):v.jsx(v.Fragment,{children:v.jsxs("div",{className:"title-name",children:[(o=this.propsState.currentSequence)==null?void 0:o.getJson().name,v.jsx("span",{onClick:()=>{this.setState({edit:!0})},children:v.jsx("span",{className:"name-a-sequence-edit-btn",children:"Edit"})})]})})]}),"limit contacts per day:",v.jsx(Qe,{name:"limit",obj:this.propsState.currentSequence,update:!0}),v.jsxs("div",{className:"title-right active-seq-container",children:[v.jsx("div",{className:"title-icon",children:v.jsx("i",{className:"fas fa-circle"})}),v.jsx("div",{className:"title-name",children:"Active"})]})]}),v.jsx("div",{className:"switch-tab",children:v.jsxs("div",{className:"row row-space-around",children:[v.jsxs("div",{onClick:()=>{this.setState({spState:"assignedProspects"})},className:this.state.spState==="sequenceSteps"?"switch-tab-btn":"switch-tab-btn active",children:["Assigned",v.jsx("br",{}),"Prospects"]}),v.jsxs("div",{onClick:()=>{this.setState({spState:"sequenceSteps"})},className:this.state.spState==="assignedProspects"?"switch-tab-btn":"switch-tab-btn active",children:["Sequence",v.jsx("br",{}),"Steps"]})]})}),this.state.spState==="sequenceSteps"?v.jsxs("div",{className:"icon-list",children:[v.jsx(er,{name:"step",mapSectionClass:"none",mapContainerClass:"none",filter:{search:(a=this.propsState.currentSequence)==null?void 0:a.getJson()._id,attribute:"sequenceId"},filterFunc:c=>!(c.getJson().content===void 0||c.getJson().content===""),cells:[{type:"custom",custom:PQ,wrapperClass:"none"}]}),v.jsx(bb,{formClass:"svg-last",newProp:"asdf",obj:this.getStepJson(),content:v.jsxs(v.Fragment,{children:[v.jsx("svg",{width:"50",height:"50",xmlns:"http://www.w3.org/2000/svg",children:t&&this.state.list&&v.jsx(v.Fragment,{children:v.jsx("path",{d:"M25,0 Q25,25 50,25 H50",fill:"none",stroke:"var(--app-green)",strokeWidth:"3",strokeLinecap:"round"})})}),v.jsx("div",{className:"icon-last",children:v.jsx("i",{className:"fa-solid fa-plus"})})]}),popupSwitch:"addStep"}),v.jsx("div",{className:"icon-row",children:v.jsx("div",{className:"svg-last"})})]}):v.jsx("div",{className:"layoutColumn conversation-container",style:{padding:"20px"},children:v.jsx(er,{name:"contact",mapSectionClass:"none",mapContainerClass:"none",filter:{search:(u=this.propsState.currentSequence)==null?void 0:u.getJson()._id,attribute:"sequenceId"},cells:[{type:"custom",custom:NQ,wrapperClass:"none"}]})})]})})}render(){return v.jsx("div",{className:[this.props.pageClass||this.state.defaultClass,"sequence-margin"].join(" "),children:this.getInnerContent()})}}class OQ{async _makeApiCall(e){try{const t=await fetch("https://getemailfromai-7c5i3vsqma-uc.a.run.app",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||`Request failed with status ${t.status}`)}const n=await t.json();if(n.success)return n.data;throw new Error(n.error||"The API call was not successful.")}catch(t){throw console.error("Failed to fetch from AI service:",t),t}}async generateMessage(e,t,n={}){const r={companyID:e.getJson().companyId,emailType:t,currentAIOptions:{model:"gpt-4o-mini",temperature:.9},context:{persona:n.persona||"",details:n.details||"",conversationHistory:n.conversationHistory||{}}};return await this._makeApiCall(r)}extractSubjectAndBody(e){const t=e.match(/^{{\s*([^}]+?)\s*}}/);let n="",r="";t?(n=t[1].trim(),r=e.slice(t[0].length).trim()):r=e.trim();const s=r.split(`

`).map(o=>`<p>${o.replace(/\n/g,"<br>")}</p>`).join(`
`);return{subject:n,body:s}}}const $c=new OQ;class Lw extends sg{async componentDidMount(){await this.getComponentsFromBackend();const e=this.urlId;if(!e||e==="template"){const t=await this.operationsFactory.prepare({prepare:{type:"template"},clean:!0});this.dispatch({currentComponent:t[0]})}}async bridgeAiService(){let{persona:e,details:t,messageType:n}=this.state;n||(n="template");const r=this.propsState.currentComponent,s=this.propsState.currentUser;if(!n){console.log("Please select a message type.");return}const o={persona:e,details:t,conversationHistory:{}};switch(n){case"reply":o.conversationHistory={fullHistory:t,lastProspectReply:t};break;case"sequence":o.conversationHistory={lastSentEmail:t};break;default:o.details=t;break}try{const a=await $c.generateMessage(s,n,o),{subject:u,body:c}=$c.extractSubjectAndBody(a);r.setCompState({content:c,subject:u}),console.log(c),this.dispatch({})}catch(a){console.error("Failed to generate AI message:",a),console.log("There was an error generating the message. Please check the console.")}}getInnerContent(){const e=["Template","Follow Up","Reply","Event","Proposal","Attached Document","Referral","Network","Re-Engage"],t=["template","sequence","reply","event","proposal","document","referral","network","reEngage"];let n="Optional: Add Additional Details or Instructions",r="e.g., Mention our upcoming promotion...";return this.state.messageType==="reply"?(n="Paste Email Thread to Reply To:",r="e.g., On Fri, Jul 25, 2025, Jane Smith wrote: I'm interested..."):this.state.messageType==="sequence"&&(n="Paste Last Email Sent in Sequence:",r="e.g., Subject: Checking In..."),v.jsxs("div",{className:"fit",children:[v.jsx("h1",{children:"Template Details"}),v.jsx("div",{onClick:()=>this.setState({showAIDraft:!this.state.showAIDraft}),className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:this.state.showAIDraft?"Cancel":"Draft With AI"}),this.state.showAIDraft&&v.jsxs("div",{children:["Select Message Type:",v.jsx(Qe,{type:"select",selectOptions:e,handleChange:s=>{let o=e.indexOf(s.target.value),a=t[o];this.setState({messageType:a})}}),'Optional: Specify a Persona (e.g., "friendly and casual" or "formal and direct")',v.jsx("input",{name:"persona",onChange:s=>this.setState({persona:s.target.value})}),"Optional: Add Additional Details or Instructions",v.jsx("div",{children:n}),v.jsx("input",{name:"details",placeholder:r,value:this.state.details||"",onChange:s=>this.setState({details:s.target.value})}),v.jsx("div",{className:"dark-button-1",onClick:()=>this.bridgeAiService(),children:"Generate"})]}),v.jsx("div",{className:"input-container",children:v.jsx("div",{className:"input-bar",children:this.propsState.currentComponent&&v.jsx(Qe,{name:"subject",obj:this.propsState.currentComponent})})}),v.jsx("div",{className:"input-container",children:v.jsx("div",{className:"input-bar",children:this.propsState.currentComponent&&v.jsx(Qe,{type:"quill",name:"content",obj:this.propsState.currentComponent})})}),v.jsx(Es,{content:"Save Template"})]})}render(){return v.jsx("div",{className:this.props.pageClass||"fit",children:this.state.gotComponents&&this.getInnerContent()})}}class LQ extends ct{constructor(e){super(e),this.state={...this.state}}render(){const{obj:e}=this.props;let t=e.getJson();return v.jsx("div",{className:"sequence",children:v.jsxs("div",{className:"title",style:{justifyContent:"space-between",padding:"2px"},children:[v.jsx(yn,{style:{color:"#262626",maxWidth:"50%",minWidth:"50%"},to:"/client/"+t._id,onClick:()=>{this.dispatch({popupSwitch:"",currentPopupComponent:void 0})},className:"title-left",children:v.jsx("span",{style:{width:"100%",display:"inline-block",overflow:"hidden",lineBreak:"anywhere",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name})}),v.jsx(yn,{style:{marginRight:"0px"},to:"/client/"+t._id,onClick:()=>{this.dispatch({popupSwitch:"",currentPopupComponent:void 0})},className:"title-right",children:"View Details"})]})})}}const yi=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),aS=[.001,0,0,.001,0,0],vx=1.35,ps={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Mu={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},P5="pdfjs_internal_editor_",yt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ft={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},FQ={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Pr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},a_={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Gn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},np={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Pb={ERRORS:0,WARNINGS:1,INFOS:5},rv={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Fw={moveTo:0,lineTo:1,curveTo:2,closePath:3},MQ={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Nb=Pb.WARNINGS;function BQ(i){Number.isInteger(i)&&(Nb=i)}function jQ(){return Nb}function Ob(i){Nb>=Pb.INFOS&&console.log(`Info: ${i}`)}function Et(i){Nb>=Pb.WARNINGS&&console.log(`Warning: ${i}`)}function rn(i){throw new Error(i)}function Xn(i,e){i||rn(e)}function qQ(i){switch(i==null?void 0:i.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function N5(i,e=null,t=null){if(!i)return null;if(t&&typeof i=="string"){if(t.addDefaultProtocol&&i.startsWith("www.")){const r=i.match(/\./g);(r==null?void 0:r.length)>=2&&(i=`http://${i}`)}if(t.tryConvertEncoding)try{i=$Q(i)}catch{}}const n=e?URL.parse(i,e):URL.parse(i);return qQ(n)?n:null}function O5(i,e,t=!1){const n=URL.parse(i);return n?(n.hash=e,n.href):t&&N5(i,"http://example.com")?i.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Rt(i,e,t,n=!1){return Object.defineProperty(i,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const uf=function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}();class zL extends uf{constructor(e,t){super(e,"PasswordException"),this.code=t}}class wx extends uf{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class lS extends uf{constructor(e){super(e,"InvalidPDFException")}}class c1 extends uf{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class UQ extends uf{constructor(e){super(e,"FormatError")}}class Wc extends uf{constructor(e){super(e,"AbortException")}}function L5(i){(typeof i!="object"||(i==null?void 0:i.length)===void 0)&&rn("Invalid argument for bytesToString");const e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);const n=[];for(let r=0;r<e;r+=t){const s=Math.min(r+t,e),o=i.subarray(r,s);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function n2(i){typeof i!="string"&&rn("Invalid argument for stringToBytes");const e=i.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=i.charCodeAt(n)&255;return t}function VQ(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function HQ(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function zQ(){try{return new Function(""),!0}catch{return!1}}class $r{static get isLittleEndian(){return Rt(this,"isLittleEndian",HQ())}static get isEvalSupported(){return Rt(this,"isEvalSupported",zQ())}static get isOffscreenCanvasSupported(){return Rt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Rt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Rt(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Rt(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const _x=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));var $l,l_,uS;class Je{static makeHexColor(e,t,n){return`#${_x[e]}${_x[t]}${_x[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const r=e[n],s=e[n+1];e[n]=r*t[0]+s*t[2]+t[4],e[n+1]=r*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const r=t[0],s=t[1],o=t[2],a=t[3],u=t[4],c=t[5];for(let d=0;d<6;d+=2){const m=e[n+d],p=e[n+d+1];e[n+d]=m*r+p*o+u,e[n+d+1]=m*s+p*a+c}}static applyInverseTransform(e,t){const n=e[0],r=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-r*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-n*t[1]+r*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,n){const r=t[0],s=t[1],o=t[2],a=t[3],u=t[4],c=t[5],d=e[0],m=e[1],p=e[2],g=e[3];let w=r*d+u,b=w,A=r*p+u,_=A,C=a*m+c,I=C,S=a*g+c,R=S;if(s!==0||o!==0){const L=s*d,k=s*p,T=o*m,D=o*g;w+=T,_+=T,A+=D,b+=D,C+=L,R+=L,S+=k,I+=k}n[0]=Math.min(n[0],w,A,b,_),n[1]=Math.min(n[1],C,S,I,R),n[2]=Math.max(n[2],w,A,b,_),n[3]=Math.max(n[3],C,S,I,R)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],r=e[1],s=e[2],o=e[3],a=n**2+r**2,u=n*s+r*o,c=s**2+o**2,d=(a+c)/2,m=Math.sqrt(d**2-(a*c-u**2));t[0]=Math.sqrt(d+m||1),t[1]=Math.sqrt(d-m||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>r)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>o?null:[n,s,r,o]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,r,s){s[0]=Math.min(s[0],e,n),s[1]=Math.min(s[1],t,r),s[2]=Math.max(s[2],e,n),s[3]=Math.max(s[3],t,r)}static bezierBoundingBox(e,t,n,r,s,o,a,u,c){c[0]=Math.min(c[0],e,a),c[1]=Math.min(c[1],t,u),c[2]=Math.max(c[2],e,a),c[3]=Math.max(c[3],t,u),W(this,$l,uS).call(this,e,n,s,a,t,r,o,u,3*(-e+3*(n-s)+a),6*(e-2*n+s),3*(n-e),c),W(this,$l,uS).call(this,e,n,s,a,t,r,o,u,3*(-t+3*(r-o)+u),6*(t-2*r+o),3*(r-t),c)}}$l=new WeakSet,l_=function(e,t,n,r,s,o,a,u,c,d){if(c<=0||c>=1)return;const m=1-c,p=c*c,g=p*c,w=m*(m*(m*e+3*c*t)+3*p*n)+g*r,b=m*(m*(m*s+3*c*o)+3*p*a)+g*u;d[0]=Math.min(d[0],w),d[1]=Math.min(d[1],b),d[2]=Math.max(d[2],w),d[3]=Math.max(d[3],b)},uS=function(e,t,n,r,s,o,a,u,c,d,m,p){if(Math.abs(c)<1e-12){Math.abs(d)>=1e-12&&W(this,$l,l_).call(this,e,t,n,r,s,o,a,u,-m/d,p);return}const g=d**2-4*m*c;if(g<0)return;const w=Math.sqrt(g),b=2*c;W(this,$l,l_).call(this,e,t,n,r,s,o,a,u,(-d+w)/b,p),W(this,$l,l_).call(this,e,t,n,r,s,o,a,u,(-d-w)/b,p)},z(Je,$l);function $Q(i){return decodeURIComponent(escape(i))}let bx=null,$L=null;function WQ(i){return bx||(bx=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,$L=new Map([["ﬅ","ſt"]])),i.replaceAll(bx,(e,t,n)=>t?t.normalize("NFKC"):$L.get(n))}function F5(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),L5(i)}const oD="pdfjs_internal_id_";function GQ(i,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,r,...s]=t;if(!i(n)&&!Number.isInteger(n)||!e(r))return!1;const o=s.length;let a=!0;switch(r.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const u of s)if(!(typeof u=="number"||a&&u===null))return!1;return!0}function vi(i,e,t){return Math.min(Math.max(i,e),t)}function M5(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(L5(i))}function KQ(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):n2(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...e){return new Promise(t=>{t(i(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((e,t)=>e+t,0)});const Ja="http://www.w3.org/2000/svg",Nh=class Nh{};re(Nh,"CSS",96),re(Nh,"PDF",72),re(Nh,"PDF_TO_CSS_UNITS",Nh.CSS/Nh.PDF);let Gc=Nh;async function r2(i,e="text"){if(cy(i,document.baseURI)){const t=await fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const r=new XMLHttpRequest;r.open("GET",i,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}n(new Error(r.statusText))}},r.send(null)})}class i2{constructor({viewBox:e,userUnit:t,scale:n,rotation:r,offsetX:s=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=r,this.offsetX=s,this.offsetY=o,n*=t;const u=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let d,m,p,g;switch(r%=360,r<0&&(r+=360),r){case 180:d=-1,m=0,p=0,g=1;break;case 90:d=0,m=1,p=1,g=0;break;case 270:d=0,m=-1,p=-1,g=0;break;case 0:d=1,m=0,p=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(p=-p,g=-g);let w,b,A,_;d===0?(w=Math.abs(c-e[1])*n+s,b=Math.abs(u-e[0])*n+o,A=(e[3]-e[1])*n,_=(e[2]-e[0])*n):(w=Math.abs(u-e[0])*n+s,b=Math.abs(c-e[1])*n+o,A=(e[2]-e[0])*n,_=(e[3]-e[1])*n),this.transform=[d*n,m*n,p*n,g*n,w-d*n*u-p*n*c,b-m*n*u-g*n*c],this.width=A,this.height=_}get rawDims(){const e=this.viewBox;return Rt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:s=!1}={}){return new i2({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:s})}convertToViewportPoint(e,t){const n=[e,t];return Je.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];Je.applyTransform(t,this.transform);const n=[e[2],e[3]];return Je.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return Je.applyInverseTransform(n,this.transform),n}}class aD extends uf{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Lb(i){const e=i.length;let t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function lD(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function JQ(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function YQ(i,e="document.pdf"){if(typeof i!="string")return e;if(Lb(i))return Et('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(a=>{try{return new URL(a)}catch{try{return new URL(decodeURIComponent(a))}catch{try{return new URL(a,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(a),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return e;const r=a=>{try{let u=decodeURIComponent(a);return u.includes("/")?(u=u.split("/").at(-1),u.test(/^\.pdf$/i)?u:a):u}catch{return a}},s=/\.pdf$/i,o=n.pathname.split("/").at(-1);if(s.test(o))return r(o);if(n.searchParams.size>0){const a=Array.from(n.searchParams.values()).reverse();for(const c of a)if(s.test(c))return r(c);const u=Array.from(n.searchParams.keys()).reverse();for(const c of u)if(s.test(c))return r(c)}if(n.hash){const u=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(u)return r(u[0])}return e}class WL{constructor(){re(this,"started",Object.create(null));re(this,"times",[])}time(e){e in this.started&&Et(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Et(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:r,end:s}of this.times)e.push(`${n.padEnd(t)} ${s-r}ms
`);return e.join("")}}function cy(i,e){const t=e?URL.parse(i,e):URL.parse(i);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Xs(i){i.preventDefault()}function Jn(i){i.preventDefault(),i.stopPropagation()}function XQ(i){console.log("Deprecated API usage: "+i)}var av;class h1{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;f(this,av)||U(this,av,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=f(this,av).exec(e);if(!t)return null;const n=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let u=parseInt(t[6],10);u=u>=0&&u<=59?u:0;const c=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let m=parseInt(t[9],10)||0;return m=m>=0&&m<=59?m:0,c==="-"?(o+=d,a+=m):c==="+"&&(o-=d,a-=m),new Date(Date.UTC(n,r,s,o,a,u))}}av=new WeakMap,z(h1,av);function QQ(i,{scale:e=1,rotation:t=0}){const{width:n,height:r}=i.attributes.style,s=[0,0,parseInt(n),parseInt(r)];return new i2({viewBox:s,userUnit:1,scale:e,rotation:t})}function Fb(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Et(`Not a valid color format: "${i}"`),[0,0,0])}function ZQ(i){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of i.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;i.set(t,Fb(n))}e.remove()}function kn(i){const{a:e,b:t,c:n,d:r,e:s,f:o}=i.getTransform();return[e,t,n,r,s,o]}function Wo(i){const{a:e,b:t,c:n,d:r,e:s,f:o}=i.getTransform().invertSelf();return[e,t,n,r,s,o]}function Xd(i,e,t=!1,n=!0){if(e instanceof i2){const{pageWidth:r,pageHeight:s}=e.rawDims,{style:o}=i,a=$r.isCSSRoundSupported,u=`var(--total-scale-factor) * ${r}px`,c=`var(--total-scale-factor) * ${s}px`,d=a?`round(down, ${u}, var(--scale-round-x))`:`calc(${u})`,m=a?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(o.width=d,o.height=m):(o.width=m,o.height=d)}n&&i.setAttribute("data-main-rotation",e.rotation)}class Da{constructor(){const{pixelRatio:e}=Da;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,r,s=-1){let o=1/0,a=1/0,u=1/0;n=Da.capPixels(n,s),n>0&&(o=Math.sqrt(n/(e*t))),r!==-1&&(a=r/e,u=r/t);const c=Math.min(o,a,u);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const cS=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var Bu,ju,Fs,el,lv,Ap,Ep,uv,b1,B5,zr,j5,q5,rp,hy;const Qa=class Qa{constructor(e){z(this,zr);z(this,Bu,null);z(this,ju,null);z(this,Fs);z(this,el,null);z(this,lv,null);z(this,Ap,null);z(this,Ep,null);U(this,Fs,e),f(Qa,uv)||U(Qa,uv,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=U(this,Bu,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=f(this,Fs)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Xs,{signal:t}),e.addEventListener("pointerdown",W(Qa,b1,B5),{signal:t}));const n=U(this,el,document.createElement("div"));n.className="buttons",e.append(n);const r=f(this,Fs).toolbarPosition;if(r){const{style:s}=e,o=f(this,Fs)._uiManager.direction==="ltr"?1-r[0]:r[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return f(this,Bu)}hide(){var e;f(this,Bu).classList.add("hidden"),(e=f(this,ju))==null||e.hideDropdown()}show(){var e,t;f(this,Bu).classList.remove("hidden"),(e=f(this,lv))==null||e.shown(),(t=f(this,Ap))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=f(this,Fs),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",f(Qa,uv)[e]),W(this,zr,rp).call(this,n)&&n.addEventListener("click",r=>{t.delete()},{signal:t._signal}),f(this,el).append(n)}async addAltText(e){const t=await e.render();W(this,zr,rp).call(this,t),f(this,el).append(t,f(this,zr,hy)),U(this,lv,e)}addComment(e){if(f(this,Ap))return;const t=e.render();t&&(W(this,zr,rp).call(this,t),f(this,el).append(t,f(this,zr,hy)),U(this,Ap,e),e.toolbar=this)}addColorPicker(e){if(f(this,ju))return;U(this,ju,e);const t=e.renderButton();W(this,zr,rp).call(this,t),f(this,el).append(t,f(this,zr,hy))}async addEditSignatureButton(e){const t=U(this,Ep,await e.renderEditButton(f(this,Fs)));W(this,zr,rp).call(this,t),f(this,el).append(t,f(this,zr,hy))}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}updateEditSignatureButton(e){f(this,Ep)&&(f(this,Ep).title=e)}remove(){var e;f(this,Bu).remove(),(e=f(this,ju))==null||e.destroy(),U(this,ju,null)}};Bu=new WeakMap,ju=new WeakMap,Fs=new WeakMap,el=new WeakMap,lv=new WeakMap,Ap=new WeakMap,Ep=new WeakMap,uv=new WeakMap,b1=new WeakSet,B5=function(e){e.stopPropagation()},zr=new WeakSet,j5=function(e){f(this,Fs)._focusEventsAllowed=!1,Jn(e)},q5=function(e){f(this,Fs)._focusEventsAllowed=!0,Jn(e)},rp=function(e){const t=f(this,Fs)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",W(this,zr,j5).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",W(this,zr,q5).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Xs,{signal:t}),!0)},hy=function(){const e=document.createElement("div");return e.className="divider",e},z(Qa,b1),z(Qa,uv,null);let hS=Qa;var cv,Bh,tl,Ql,U5,V5,dS;class eZ{constructor(e){z(this,Ql);z(this,cv,null);z(this,Bh,null);z(this,tl);U(this,tl,e)}show(e,t,n){const[r,s]=W(this,Ql,V5).call(this,t,n),{style:o}=f(this,Bh)||U(this,Bh,W(this,Ql,U5).call(this));e.append(f(this,Bh)),o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){f(this,Bh).remove()}}cv=new WeakMap,Bh=new WeakMap,tl=new WeakMap,Ql=new WeakSet,U5=function(){const e=U(this,Bh,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=f(this,tl)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Xs,{signal:t});const n=U(this,cv,document.createElement("div"));return n.className="buttons",e.append(n),f(this,tl).hasCommentManager()&&W(this,Ql,dS).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{f(this,tl).commentSelection("floating_button")}),W(this,Ql,dS).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{f(this,tl).highlightSelection("floating_button")}),e},V5=function(e,t){let n=0,r=0;for(const s of e){const o=s.y+s.height;if(o<n)continue;const a=s.x+(t?s.width:0);if(o>n){r=a,n=o;continue}t?a>r&&(r=a):a<r&&(r=a)}return[t?1-r:r,n]},dS=function(e,t,n,r){const s=document.createElement("button");s.classList.add("basic",e),s.tabIndex=0,s.setAttribute("data-l10n-id",t);const o=document.createElement("span");s.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",n);const a=f(this,tl)._signal;a instanceof AbortSignal&&!a.aborted&&(s.addEventListener("contextmenu",Xs,{signal:a}),s.addEventListener("click",r,{signal:a})),f(this,cv).append(s)};function H5(i,e,t){for(const n of t)e.addEventListener(n,i[n].bind(i))}var A1;class tZ{constructor(){z(this,A1,0)}get id(){return`${P5}${ir(this,A1)._++}`}}A1=new WeakMap;var Cp,hv,Zr,xp,u_;const yD=class yD{constructor(){z(this,xp);z(this,Cp,F5());z(this,hv,0);z(this,Zr,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const s=r.decode().then(()=>(n.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Rt(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:t,name:n,size:r,type:s}=e;return W(this,xp,u_).call(this,`${t}_${n}_${r}_${s}`,e)}async getFromUrl(e){return W(this,xp,u_).call(this,e,e)}async getFromBlob(e,t){const n=await t;return W(this,xp,u_).call(this,e,n)}async getFromId(e){f(this,Zr)||U(this,Zr,new Map);const t=f(this,Zr).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){f(this,Zr)||U(this,Zr,new Map);let n=f(this,Zr).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),n={bitmap:r.transferToImageBitmap(),id:`image_${f(this,Cp)}_${ir(this,hv)._++}`,refCounter:1,isSvg:!1},f(this,Zr).set(e,n),f(this,Zr).set(n.id,n),n}getSvgUrl(e){const t=f(this,Zr).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var r;f(this,Zr)||U(this,Zr,new Map);const t=f(this,Zr).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=s.convertToBlob()}(r=n.close)==null||r.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${f(this,Cp)}_`)}};Cp=new WeakMap,hv=new WeakMap,Zr=new WeakMap,xp=new WeakSet,u_=async function(e,t){f(this,Zr)||U(this,Zr,new Map);let n=f(this,Zr).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${f(this,Cp)}_${ir(this,hv)._++}`,refCounter:0,isSvg:!1});let r;if(typeof t=="string"?(n.url=t,r=await r2(t,"blob")):t instanceof File?r=n.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const s=yD._isSVGFittingCanvas,o=new FileReader,a=new Image,u=new Promise((c,d)=>{a.onload=()=>{n.bitmap=a,n.isSvg=!0,c()},o.onload=async()=>{const m=n.svgUrl=o.result;a.src=await s?`${m}#svgView(preserveAspectRatio(none))`:m},a.onerror=o.onerror=d});o.readAsDataURL(r),await u}else n.bitmap=await createImageBitmap(r);n.refCounter=1}catch(r){Et(r),n=null}return f(this,Zr).set(e,n),n&&f(this,Zr).set(n.id,n),n};let fS=yD;var jn,qu,dv,In;class nZ{constructor(e=128){z(this,jn,[]);z(this,qu,!1);z(this,dv);z(this,In,-1);U(this,dv,e)}add({cmd:e,undo:t,post:n,mustExec:r,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(r&&e(),f(this,qu))return;const u={cmd:e,undo:t,post:n,type:s};if(f(this,In)===-1){f(this,jn).length>0&&(f(this,jn).length=0),U(this,In,0),f(this,jn).push(u);return}if(o&&f(this,jn)[f(this,In)].type===s){a&&(u.undo=f(this,jn)[f(this,In)].undo),f(this,jn)[f(this,In)]=u;return}const c=f(this,In)+1;c===f(this,dv)?f(this,jn).splice(0,1):(U(this,In,c),c<f(this,jn).length&&f(this,jn).splice(c)),f(this,jn).push(u)}undo(){if(f(this,In)===-1)return;U(this,qu,!0);const{undo:e,post:t}=f(this,jn)[f(this,In)];e(),t==null||t(),U(this,qu,!1),U(this,In,f(this,In)-1)}redo(){if(f(this,In)<f(this,jn).length-1){U(this,In,f(this,In)+1),U(this,qu,!0);const{cmd:e,post:t}=f(this,jn)[f(this,In)];e(),t==null||t(),U(this,qu,!1)}}hasSomethingToUndo(){return f(this,In)!==-1}hasSomethingToRedo(){return f(this,In)<f(this,jn).length-1}cleanType(e){if(f(this,In)!==-1){for(let t=f(this,In);t>=0;t--)if(f(this,jn)[t].type!==e){f(this,jn).splice(t+1,f(this,In)-t),U(this,In,t);return}f(this,jn).length=0,U(this,In,-1)}}destroy(){U(this,jn,null)}}jn=new WeakMap,qu=new WeakMap,dv=new WeakMap,In=new WeakMap;var E1,z5;class s2{constructor(e){z(this,E1);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=$r.platform;for(const[n,r,s={}]of e)for(const o of n){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:r,options:s}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:r,options:s}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(W(this,E1,z5).call(this,t));if(!n)return;const{callback:r,options:{bubbles:s=!1,args:o=[],checker:a=null}}=n;a&&!a(e,t)||(r.bind(e,...o,t)(),s||Jn(t))}}E1=new WeakSet,z5=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const C1=class C1{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return ZQ(e),Rt(this,"_colors",e)}convert(e){const t=Fb(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,r]of this._colors)if(r.every((s,o)=>s===t[o]))return C1._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?Je.makeHexColor(...t):e}};re(C1,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let pS=C1;var Sp,Xi,Tp,ar,Nr,Ip,nl,Dp,Ms,rl,Uu,Vu,kp,jh,Yo,Bs,qh,fv,pv,Rp,mv,Xo,Hu,Pp,zu,Qo,x1,$u,Np,gv,Wu,Uh,Op,Gu,yv,lr,Xt,il,Ku,Ju,vv,Lp,wv,Yu,Zo,sl,_v,bv,js,Me,c_,mS,$5,W5,dy,G5,K5,J5,gS,Y5,yS,vS,X5,hi,Ya,Q5,Z5,wS,ej,fy,_S;const fp=class fp{constructor(e,t,n,r,s,o,a,u,c,d,m,p,g,w,b,A){z(this,Me);z(this,Sp,new AbortController);z(this,Xi,null);z(this,Tp,null);z(this,ar,new Map);z(this,Nr,new Map);z(this,Ip,null);z(this,nl,null);z(this,Dp,null);z(this,Ms,new nZ);z(this,rl,null);z(this,Uu,null);z(this,Vu,null);z(this,kp,0);z(this,jh,new Set);z(this,Yo,null);z(this,Bs,null);z(this,qh,new Set);re(this,"_editorUndoBar",null);z(this,fv,!1);z(this,pv,!1);z(this,Rp,!1);z(this,mv,null);z(this,Xo,null);z(this,Hu,null);z(this,Pp,null);z(this,zu,!1);z(this,Qo,null);z(this,x1,new tZ);z(this,$u,!1);z(this,Np,!1);z(this,gv,!1);z(this,Wu,null);z(this,Uh,null);z(this,Op,null);z(this,Gu,null);z(this,yv,null);z(this,lr,yt.NONE);z(this,Xt,new Set);z(this,il,null);z(this,Ku,null);z(this,Ju,null);z(this,vv,null);z(this,Lp,null);z(this,wv,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});z(this,Yu,[0,0]);z(this,Zo,null);z(this,sl,null);z(this,_v,null);z(this,bv,null);z(this,js,null);const _=this._signal=f(this,Sp).signal;U(this,sl,e),U(this,_v,t),U(this,bv,n),U(this,Ip,r),U(this,rl,s),U(this,Ku,o),U(this,Lp,u),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:_}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),a._on("setpreference",this.onSetPreference.bind(this),{signal:_}),a._on("switchannotationeditorparams",C=>this.updateParams(C.type,C.value),{signal:_}),window.addEventListener("pointerdown",()=>{U(this,Np,!0)},{capture:!0,signal:_}),window.addEventListener("pointerup",()=>{U(this,Np,!1)},{capture:!0,signal:_}),W(this,Me,G5).call(this),W(this,Me,X5).call(this),W(this,Me,gS).call(this),U(this,nl,u.annotationStorage),U(this,mv,u.filterFactory),U(this,Ju,c),U(this,Pp,d||null),U(this,fv,m),U(this,pv,p),U(this,Rp,g),U(this,yv,w||null),this.viewParameters={realScale:Gc.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=A!==!1}static get _keyboardManager(){const e=fp.prototype,t=o=>f(o,sl).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:u}=a;return u!=="text"&&u!=="number"}return!0},r=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Rt(this,"_keyboardManager",new s2([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&f(o,sl).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&f(o,sl).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}destroy(){var e,t,n,r,s,o,a,u,c;(e=f(this,js))==null||e.resolve(),U(this,js,null),(t=f(this,Sp))==null||t.abort(),U(this,Sp,null),this._signal=null;for(const d of f(this,Nr).values())d.destroy();f(this,Nr).clear(),f(this,ar).clear(),f(this,qh).clear(),(n=f(this,Gu))==null||n.clear(),U(this,Xi,null),f(this,Xt).clear(),f(this,Ms).destroy(),(r=f(this,Ip))==null||r.destroy(),(s=f(this,rl))==null||s.destroy(),(o=f(this,Ku))==null||o.destroy(),(a=f(this,Qo))==null||a.hide(),U(this,Qo,null),(u=f(this,Op))==null||u.destroy(),U(this,Op,null),U(this,Tp,null),f(this,Xo)&&(clearTimeout(f(this,Xo)),U(this,Xo,null)),f(this,Zo)&&(clearTimeout(f(this,Zo)),U(this,Zo,null)),(c=this._editorUndoBar)==null||c.destroy(),U(this,Lp,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return f(this,yv)}get useNewAltTextFlow(){return f(this,pv)}get useNewAltTextWhenAddingImage(){return f(this,Rp)}get hcmFilter(){return Rt(this,"hcmFilter",f(this,Ju)?f(this,mv).addHCMFilter(f(this,Ju).foreground,f(this,Ju).background):"none")}get direction(){return Rt(this,"direction",getComputedStyle(f(this,sl)).direction)}get _highlightColors(){return Rt(this,"_highlightColors",f(this,Pp)?new Map(f(this,Pp).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Rt(this,"highlightColors",null);const t=new Map,n=!!f(this,Ju);for(const[r,s]of e){const o=r.endsWith("_HCM");if(n&&o){t.set(r.replace("_HCM",""),s);continue}!n&&!o&&t.set(r,s)}return Rt(this,"highlightColors",t)}get highlightColorNames(){return Rt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),U(this,Vu,e)}setMainHighlightColorPicker(e){U(this,Op,e)}editAltText(e,t=!1){var n;(n=f(this,Ip))==null||n.editAltText(this,e,t)}hasCommentManager(){return!!f(this,rl)}editComment(e,t){var n;(n=f(this,rl))==null||n.open(this,e,t)}getSignature(e){var t;(t=f(this,Ku))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return f(this,Ku)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":U(this,Rp,t);break}}onPageChanging({pageNumber:e}){U(this,kp,e-1)}focusMainContainer(){f(this,sl).focus()}findParent(e,t){for(const n of f(this,Nr).values()){const{x:r,y:s,width:o,height:a}=n.div.getBoundingClientRect();if(e>=r&&e<=r+o&&t>=s&&t<=s+a)return n}return null}disableUserSelect(e=!1){f(this,_v).classList.toggle("noUserSelect",e)}addShouldRescale(e){f(this,qh).add(e)}removeShouldRescale(e){f(this,qh).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Gc.PDF_TO_CSS_UNITS;for(const n of f(this,qh))n.onScaleChanging();(t=f(this,Vu))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:r,anchorOffset:s,focusNode:o,focusOffset:a}=n,u=n.toString(),d=W(this,Me,c_).call(this,n).closest(".textLayer"),m=this.getSelectionBoxes(d);if(!m)return;n.empty();const p=W(this,Me,mS).call(this,d),g=f(this,lr)===yt.NONE,w=()=>{const b=p==null?void 0:p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:m,anchorNode:r,anchorOffset:s,focusNode:o,focusOffset:a,text:u});g&&this.showAllEditors("highlight",!0,!0),t&&(b==null||b.editComment())};if(g){this.switchToMode(yt.HIGHLIGHT,w);return}w()}commentSelection(e=""){this.highlightSelection(e,!0)}addToAnnotationStorage(e){!e.isEmpty()&&f(this,nl)&&!f(this,nl).has(e.id)&&f(this,nl).setValue(e.id,e)}a11yAlert(e,t=null){const n=f(this,bv);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,f(this,zu)&&(U(this,zu,!1),W(this,Me,dy).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of f(this,Xt))if(t.div.contains(e)){U(this,Uh,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!f(this,Uh))return;const[e,t]=f(this,Uh);U(this,Uh,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){W(this,Me,gS).call(this),W(this,Me,yS).call(this)}removeEditListeners(){W(this,Me,Y5).call(this),W(this,Me,vS).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of f(this,Bs))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of f(this,Bs))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=f(this,Xi))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const r of f(this,Xt)){const s=r.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const o of f(this,Bs))if(o.isHandlingMimeForPasting(s.type)){o.paste(s,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(s){Et(`paste: "${s.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const r=this.currentLayer;try{const s=[];for(const u of n){const c=await r.deserialize(u);if(!c)return;s.push(c)}const o=()=>{for(const u of s)W(this,Me,wS).call(this,u);W(this,Me,_S).call(this,s)},a=()=>{for(const u of s)u.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(s){Et(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),f(this,lr)!==yt.NONE&&!this.isEditorHandlingKeyboard&&fp._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,f(this,zu)&&(U(this,zu,!1),W(this,Me,dy).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(W(this,Me,K5).call(this),W(this,Me,yS).call(this),W(this,Me,hi).call(this,{isEditing:f(this,lr)!==yt.NONE,isEmpty:W(this,Me,fy).call(this),hasSomethingToUndo:f(this,Ms).hasSomethingToUndo(),hasSomethingToRedo:f(this,Ms).hasSomethingToRedo(),hasSelectedEditor:!1})):(W(this,Me,J5).call(this),W(this,Me,vS).call(this),W(this,Me,hi).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!f(this,Bs)){U(this,Bs,e);for(const t of f(this,Bs))W(this,Me,Ya).call(this,t.defaultPropertiesToUpdate)}}getId(){return f(this,x1).id}get currentLayer(){return f(this,Nr).get(f(this,kp))}getLayer(e){return f(this,Nr).get(e)}get currentPageIndex(){return f(this,kp)}addLayer(e){f(this,Nr).set(e.pageIndex,e),f(this,$u)?e.enable():e.disable()}removeLayer(e){f(this,Nr).delete(e.pageIndex)}async updateMode(e,t=null,n=!1,r=!1,s=!1){var o,a,u,c,d;if(f(this,lr)!==e&&!(f(this,js)&&(await f(this,js).promise,!f(this,js)))){if(U(this,js,Promise.withResolvers()),(o=f(this,Vu))==null||o.commitOrRemove(),f(this,lr)===yt.POPUP&&((a=f(this,rl))==null||a.hideSidebar()),U(this,lr,e),e===yt.NONE){this.setEditingState(!1),W(this,Me,Z5).call(this),(u=this._editorUndoBar)==null||u.hide(),f(this,js).resolve();return}e===yt.SIGNATURE&&await((c=f(this,Ku))==null?void 0:c.loadSignatures()),e===yt.POPUP&&(f(this,Tp)||U(this,Tp,await f(this,Lp).getAnnotationsByType(new Set(f(this,Bs).map(m=>m._editorType)))),(d=f(this,rl))==null||d.showSidebar(f(this,Tp))),this.setEditingState(!0),await W(this,Me,Q5).call(this),this.unselectAll();for(const m of f(this,Nr).values())m.updateMode(e);if(!t){n&&this.addNewEditorFromKeyboard(),f(this,js).resolve();return}for(const m of f(this,ar).values())m.annotationElementId===t||m.id===t?(this.setSelected(m),s?m.editComment():r&&m.enterInEditMode()):m.unselect();f(this,js).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==f(this,lr)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(f(this,Bs)){switch(e){case Ft.CREATE:this.currentLayer.addNewEditor(t);return;case Ft.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(f(this,vv)||U(this,vv,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of f(this,Xt))n.updateParams(e,t);else for(const n of f(this,Bs))n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var s;for(const o of f(this,ar).values())o.editorType===e&&o.show(t);(((s=f(this,vv))==null?void 0:s.get(Ft.HIGHLIGHT_SHOW_ALL))??!0)!==t&&W(this,Me,Ya).call(this,[[Ft.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(f(this,gv)!==e){U(this,gv,e);for(const t of f(this,Nr).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const n of f(this,ar).values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return f(this,ar).get(e)}addEditor(e){f(this,ar).set(e.id,e)}removeEditor(e){var t,n;e.div.contains(document.activeElement)&&(f(this,Xo)&&clearTimeout(f(this,Xo)),U(this,Xo,setTimeout(()=>{this.focusMainContainer(),U(this,Xo,null)},0))),f(this,ar).delete(e.id),e.annotationElementId&&((t=f(this,Gu))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!f(this,jh).has(e.annotationElementId))&&((n=f(this,nl))==null||n.remove(e.id))}addDeletedAnnotationElement(e){f(this,jh).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return f(this,jh).has(e)}removeDeletedAnnotationElement(e){f(this,jh).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){f(this,Xi)!==e&&(U(this,Xi,e),e&&W(this,Me,Ya).call(this,e.propertiesToUpdate))}updateUI(e){f(this,Me,ej)===e&&W(this,Me,Ya).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){W(this,Me,Ya).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(f(this,Xt).has(e)){f(this,Xt).delete(e),e.unselect(),W(this,Me,hi).call(this,{hasSelectedEditor:this.hasSelection});return}f(this,Xt).add(e),e.select(),W(this,Me,Ya).call(this,e.propertiesToUpdate),W(this,Me,hi).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=f(this,Vu))==null||t.commitOrRemove();for(const n of f(this,Xt))n!==e&&n.unselect();f(this,Xt).clear(),f(this,Xt).add(e),e.select(),W(this,Me,Ya).call(this,e.propertiesToUpdate),W(this,Me,hi).call(this,{hasSelectedEditor:!0})}isSelected(e){return f(this,Xt).has(e)}get firstSelectedEditor(){return f(this,Xt).values().next().value}unselect(e){e.unselect(),f(this,Xt).delete(e),W(this,Me,hi).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return f(this,Xt).size!==0}get isEnterHandled(){return f(this,Xt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;f(this,Ms).undo(),W(this,Me,hi).call(this,{hasSomethingToUndo:f(this,Ms).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:W(this,Me,fy).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){f(this,Ms).redo(),W(this,Me,hi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:f(this,Ms).hasSomethingToRedo(),isEmpty:W(this,Me,fy).call(this)})}addCommands(e){f(this,Ms).add(e),W(this,Me,hi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:W(this,Me,fy).call(this)})}cleanUndoStack(e){f(this,Ms).cleanType(e)}delete(){var s;this.commitOrRemove();const e=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...f(this,Xt)],n=()=>{var o;(o=this._editorUndoBar)==null||o.show(r,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},r=()=>{for(const o of t)W(this,Me,wS).call(this,o)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){var e;(e=f(this,Xi))==null||e.commitOrRemove()}hasSomethingToControl(){return f(this,Xi)||this.hasSelection}selectAll(){for(const e of f(this,Xt))e.commit();W(this,Me,_S).call(this,f(this,ar).values())}unselectAll(){var e;if(!(f(this,Xi)&&(f(this,Xi).commitOrRemove(),f(this,lr)!==yt.NONE))&&!((e=f(this,Vu))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of f(this,Xt))t.unselect();f(this,Xt).clear(),W(this,Me,hi).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;f(this,Yu)[0]+=e,f(this,Yu)[1]+=t;const[r,s]=f(this,Yu),o=[...f(this,Xt)],a=1e3;f(this,Zo)&&clearTimeout(f(this,Zo)),U(this,Zo,setTimeout(()=>{U(this,Zo,null),f(this,Yu)[0]=f(this,Yu)[1]=0,this.addCommands({cmd:()=>{for(const u of o)f(this,ar).has(u.id)&&(u.translateInPage(r,s),u.translationDone())},undo:()=>{for(const u of o)f(this,ar).has(u.id)&&(u.translateInPage(-r,-s),u.translationDone())},mustExec:!1})},a));for(const u of o)u.translateInPage(e,t),u.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),U(this,Yo,new Map);for(const e of f(this,Xt))f(this,Yo).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!f(this,Yo))return!1;this.disableUserSelect(!1);const e=f(this,Yo);U(this,Yo,null);let t=!1;for(const[{x:r,y:s,pageIndex:o},a]of e)a.newX=r,a.newY=s,a.newPageIndex=o,t||(t=r!==a.savedX||s!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const n=(r,s,o,a)=>{if(f(this,ar).has(r.id)){const u=f(this,Nr).get(a);u?r._setParentAndPosition(u,s,o):(r.pageIndex=a,r.x=s,r.y=o)}};return this.addCommands({cmd:()=>{for(const[r,{newX:s,newY:o,newPageIndex:a}]of e)n(r,s,o,a)},undo:()=>{for(const[r,{savedX:s,savedY:o,savedPageIndex:a}]of e)n(r,s,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(f(this,Yo))for(const n of f(this,Yo).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||f(this,Xt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return f(this,Xi)===e}getActive(){return f(this,Xi)}getMode(){return f(this,lr)}get imageManager(){return Rt(this,"imageManager",new fS)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,d=t.rangeCount;c<d;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:n,y:r,width:s,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(c,d,m,p)=>({x:(d-r)/o,y:1-(c+m-n)/s,width:p/o,height:m/s});break;case"180":a=(c,d,m,p)=>({x:1-(c+m-n)/s,y:1-(d+p-r)/o,width:m/s,height:p/o});break;case"270":a=(c,d,m,p)=>({x:1-(d+p-r)/o,y:(c-n)/s,width:p/o,height:m/s});break;default:a=(c,d,m,p)=>({x:(c-n)/s,y:(d-r)/o,width:m/s,height:p/o});break}const u=[];for(let c=0,d=t.rangeCount;c<d;c++){const m=t.getRangeAt(c);if(!m.collapsed)for(const{x:p,y:g,width:w,height:b}of m.getClientRects())w===0||b===0||u.push(a(p,g,w,b))}return u.length===0?null:u}addChangedExistingAnnotation({annotationElementId:e,id:t}){(f(this,Dp)||U(this,Dp,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=f(this,Dp))==null||t.delete(e)}renderAnnotationElement(e){var r;const t=(r=f(this,Dp))==null?void 0:r.get(e.data.id);if(!t)return;const n=f(this,nl).getRawValue(t);n&&(f(this,lr)===yt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){var s;const r=(s=f(this,Gu))==null?void 0:s.get(e);r&&(r.setCanvas(t,n),f(this,Gu).delete(e))}addMissingCanvas(e,t){(f(this,Gu)||U(this,Gu,new Map)).set(e,t)}};Sp=new WeakMap,Xi=new WeakMap,Tp=new WeakMap,ar=new WeakMap,Nr=new WeakMap,Ip=new WeakMap,nl=new WeakMap,Dp=new WeakMap,Ms=new WeakMap,rl=new WeakMap,Uu=new WeakMap,Vu=new WeakMap,kp=new WeakMap,jh=new WeakMap,Yo=new WeakMap,Bs=new WeakMap,qh=new WeakMap,fv=new WeakMap,pv=new WeakMap,Rp=new WeakMap,mv=new WeakMap,Xo=new WeakMap,Hu=new WeakMap,Pp=new WeakMap,zu=new WeakMap,Qo=new WeakMap,x1=new WeakMap,$u=new WeakMap,Np=new WeakMap,gv=new WeakMap,Wu=new WeakMap,Uh=new WeakMap,Op=new WeakMap,Gu=new WeakMap,yv=new WeakMap,lr=new WeakMap,Xt=new WeakMap,il=new WeakMap,Ku=new WeakMap,Ju=new WeakMap,vv=new WeakMap,Lp=new WeakMap,wv=new WeakMap,Yu=new WeakMap,Zo=new WeakMap,sl=new WeakMap,_v=new WeakMap,bv=new WeakMap,js=new WeakMap,Me=new WeakSet,c_=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},mS=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of f(this,Nr).values())if(n.hasTextLayer(e))return n;return null},$5=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=W(this,Me,c_).call(this,e).closest(".textLayer"),r=this.getSelectionBoxes(n);r&&(f(this,Qo)||U(this,Qo,new eZ(this)),f(this,Qo).show(n,r,this.direction==="ltr"))},W5=function(){var s,o,a;const e=document.getSelection();if(!e||e.isCollapsed){f(this,il)&&((s=f(this,Qo))==null||s.hide(),U(this,il,null),W(this,Me,hi).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===f(this,il))return;const r=W(this,Me,c_).call(this,e).closest(".textLayer");if(!r){f(this,il)&&((o=f(this,Qo))==null||o.hide(),U(this,il,null),W(this,Me,hi).call(this,{hasSelectedText:!1}));return}if((a=f(this,Qo))==null||a.hide(),U(this,il,t),W(this,Me,hi).call(this,{hasSelectedText:!0}),!(f(this,lr)!==yt.HIGHLIGHT&&f(this,lr)!==yt.NONE)&&(f(this,lr)===yt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),U(this,zu,this.isShiftKeyDown),!this.isShiftKeyDown)){const u=f(this,lr)===yt.HIGHLIGHT?W(this,Me,mS).call(this,r):null;if(u==null||u.toggleDrawing(),f(this,Np)){const c=new AbortController,d=this.combinedSignal(c),m=p=>{p.type==="pointerup"&&p.button!==0||(c.abort(),u==null||u.toggleDrawing(!0),p.type==="pointerup"&&W(this,Me,dy).call(this,"main_toolbar"))};window.addEventListener("pointerup",m,{signal:d}),window.addEventListener("blur",m,{signal:d})}else u==null||u.toggleDrawing(!0),W(this,Me,dy).call(this,"main_toolbar")}},dy=function(e=""){f(this,lr)===yt.HIGHLIGHT?this.highlightSelection(e):f(this,fv)&&W(this,Me,$5).call(this)},G5=function(){document.addEventListener("selectionchange",W(this,Me,W5).bind(this),{signal:this._signal})},K5=function(){if(f(this,Hu))return;U(this,Hu,new AbortController);const e=this.combinedSignal(f(this,Hu));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},J5=function(){var e;(e=f(this,Hu))==null||e.abort(),U(this,Hu,null)},gS=function(){if(f(this,Wu))return;U(this,Wu,new AbortController);const e=this.combinedSignal(f(this,Wu));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},Y5=function(){var e;(e=f(this,Wu))==null||e.abort(),U(this,Wu,null)},yS=function(){if(f(this,Uu))return;U(this,Uu,new AbortController);const e=this.combinedSignal(f(this,Uu));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},vS=function(){var e;(e=f(this,Uu))==null||e.abort(),U(this,Uu,null)},X5=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},hi=function(e){Object.entries(e).some(([n,r])=>f(this,wv)[n]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(f(this,wv),e)}),f(this,lr)===yt.HIGHLIGHT&&e.hasSelectedEditor===!1&&W(this,Me,Ya).call(this,[[Ft.HIGHLIGHT_FREE,!0]]))},Ya=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Q5=async function(){if(!f(this,$u)){U(this,$u,!0);const e=[];for(const t of f(this,Nr).values())e.push(t.enable());await Promise.all(e);for(const t of f(this,ar).values())t.enable()}},Z5=function(){if(this.unselectAll(),f(this,$u)){U(this,$u,!1);for(const e of f(this,Nr).values())e.disable();for(const e of f(this,ar).values())e.disable()}},wS=function(e){const t=f(this,Nr).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},ej=function(){let e=null;for(e of f(this,Xt));return e},fy=function(){if(f(this,ar).size===0)return!0;if(f(this,ar).size===1)for(const e of f(this,ar).values())return e.isEmpty();return!1},_S=function(e){for(const t of f(this,Xt))t.unselect();f(this,Xt).clear();for(const t of e)t.isEmpty()||(f(this,Xt).add(t),t.select());W(this,Me,hi).call(this,{hasSelectedEditor:this.hasSelection})},re(fp,"TRANSLATE_SMALL",1),re(fp,"TRANSLATE_BIG",10);let Qd=fp;var wr,ea,yo,Fp,ta,Qi,Mp,na,Fi,ol,Vh,ra,Xu,Io,py,h_;const di=class di{constructor(e){z(this,Io);z(this,wr,null);z(this,ea,!1);z(this,yo,null);z(this,Fp,null);z(this,ta,null);z(this,Qi,null);z(this,Mp,!1);z(this,na,null);z(this,Fi,null);z(this,ol,null);z(this,Vh,null);z(this,ra,!1);U(this,Fi,e),U(this,ra,e._uiManager.useNewAltTextFlow),f(di,Xu)||U(di,Xu,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){di._l10n??(di._l10n=e)}async render(){const e=U(this,yo,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=U(this,Fp,document.createElement("span"));e.append(t),f(this,ra)?(e.classList.add("new"),e.setAttribute("data-l10n-id",f(di,Xu).missing),t.setAttribute("data-l10n-id",f(di,Xu)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=f(this,Fi)._uiManager._signal;e.addEventListener("contextmenu",Xs,{signal:n}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:n});const r=s=>{s.preventDefault(),f(this,Fi)._uiManager.editAltText(f(this,Fi)),f(this,ra)&&f(this,Fi)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:f(this,Io,py)}})};return e.addEventListener("click",r,{capture:!0,signal:n}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(U(this,Mp,!0),r(s))},{signal:n}),await W(this,Io,h_).call(this),e}finish(){f(this,yo)&&(f(this,yo).focus({focusVisible:f(this,Mp)}),U(this,Mp,!1))}isEmpty(){return f(this,ra)?f(this,wr)===null:!f(this,wr)&&!f(this,ea)}hasData(){return f(this,ra)?f(this,wr)!==null||!!f(this,ol):this.isEmpty()}get guessedText(){return f(this,ol)}async setGuessedText(e){f(this,wr)===null&&(U(this,ol,e),U(this,Vh,await di._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),W(this,Io,h_).call(this))}toggleAltTextBadge(e=!1){var t;if(!f(this,ra)||f(this,wr)){(t=f(this,na))==null||t.remove(),U(this,na,null);return}if(!f(this,na)){const n=U(this,na,document.createElement("div"));n.className="noAltTextBadge",f(this,Fi).div.append(n)}f(this,na).classList.toggle("hidden",!e)}serialize(e){let t=f(this,wr);return!e&&f(this,ol)===t&&(t=f(this,Vh)),{altText:t,decorative:f(this,ea),guessedText:f(this,ol),textWithDisclaimer:f(this,Vh)}}get data(){return{altText:f(this,wr),decorative:f(this,ea)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:r,cancel:s=!1}){n&&(U(this,ol,n),U(this,Vh,r)),!(f(this,wr)===e&&f(this,ea)===t)&&(s||(U(this,wr,e),U(this,ea,t)),W(this,Io,h_).call(this))}toggle(e=!1){f(this,yo)&&(!e&&f(this,Qi)&&(clearTimeout(f(this,Qi)),U(this,Qi,null)),f(this,yo).disabled=!e)}shown(){f(this,Fi)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:f(this,Io,py)}})}destroy(){var e,t;(e=f(this,yo))==null||e.remove(),U(this,yo,null),U(this,Fp,null),U(this,ta,null),(t=f(this,na))==null||t.remove(),U(this,na,null)}};wr=new WeakMap,ea=new WeakMap,yo=new WeakMap,Fp=new WeakMap,ta=new WeakMap,Qi=new WeakMap,Mp=new WeakMap,na=new WeakMap,Fi=new WeakMap,ol=new WeakMap,Vh=new WeakMap,ra=new WeakMap,Xu=new WeakMap,Io=new WeakSet,py=function(){return f(this,wr)&&"added"||f(this,wr)===null&&this.guessedText&&"review"||"missing"},h_=async function(){var r,s,o;const e=f(this,yo);if(!e)return;if(f(this,ra)){if(e.classList.toggle("done",!!f(this,wr)),e.setAttribute("data-l10n-id",f(di,Xu)[f(this,Io,py)]),(r=f(this,Fp))==null||r.setAttribute("data-l10n-id",f(di,Xu)[`${f(this,Io,py)}-label`]),!f(this,wr)){(s=f(this,ta))==null||s.remove();return}}else{if(!f(this,wr)&&!f(this,ea)){e.classList.remove("done"),(o=f(this,ta))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=f(this,ta);if(!t){U(this,ta,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${f(this,Fi).id}`;const a=100,u=f(this,Fi)._uiManager._signal;u.addEventListener("abort",()=>{clearTimeout(f(this,Qi)),U(this,Qi,null)},{once:!0}),e.addEventListener("mouseenter",()=>{U(this,Qi,setTimeout(()=>{U(this,Qi,null),f(this,ta).classList.add("show"),f(this,Fi)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:u}),e.addEventListener("mouseleave",()=>{var c;f(this,Qi)&&(clearTimeout(f(this,Qi)),U(this,Qi,null)),(c=f(this,ta))==null||c.classList.remove("show")},{signal:u})}f(this,ea)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=f(this,wr)),t.parentNode||e.append(t);const n=f(this,Fi).getElementForAltText();n==null||n.setAttribute("aria-describedby",t.id)},z(di,Xu,null),re(di,"_l10n",null);let d1=di;var ia,Hh,vo,Av,al,Bp,Qu;class Mw{constructor(e){z(this,ia,null);z(this,Hh,!1);z(this,vo,null);z(this,Av,null);z(this,al,null);z(this,Bp,null);z(this,Qu,!1);U(this,vo,e),this.toolbar=null}render(){if(!f(this,vo)._uiManager.hasCommentManager())return null;const e=U(this,ia,document.createElement("button"));e.className="comment",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const t=f(this,vo)._uiManager._signal;if(!(t instanceof AbortSignal)||t.aborted)return e;e.addEventListener("contextmenu",Xs,{signal:t}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:t});const n=r=>{r.preventDefault(),this.edit()};return e.addEventListener("click",n,{capture:!0,signal:t}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(U(this,Hh,!0),n(r))},{signal:t}),e}edit(){const{bottom:e,left:t,right:n}=f(this,vo).getClientDimensions(),r={top:e};f(this,vo)._uiManager.direction==="ltr"?r.right=n:r.left=t,f(this,vo)._uiManager.editComment(f(this,vo),r)}finish(){f(this,ia)&&(f(this,ia).focus({focusVisible:f(this,Hh)}),U(this,Hh,!1))}isDeleted(){return f(this,Qu)||f(this,al)===""}hasBeenEdited(){return this.isDeleted()||f(this,al)!==f(this,Av)}serialize(){return this.data}get data(){return{text:f(this,al),date:f(this,Bp),deleted:f(this,Qu)}}set data(e){if(e===null){U(this,al,""),U(this,Qu,!0);return}U(this,al,e),U(this,Bp,new Date),U(this,Qu,!1)}setInitialText(e){U(this,Av,e),this.data=e}toggle(e=!1){f(this,ia)&&(f(this,ia).disabled=!e)}shown(){}destroy(){var e;(e=f(this,ia))==null||e.remove(),U(this,ia,null),U(this,al,""),U(this,Bp,null),U(this,vo,null),U(this,Hh,!1),U(this,Qu,!1)}}ia=new WeakMap,Hh=new WeakMap,vo=new WeakMap,Av=new WeakMap,al=new WeakMap,Bp=new WeakMap,Qu=new WeakMap;var jp,zh,Ev,Cv,xv,Sv,Tv,ll,$h,ul,Wh,cl,Kc,tj,nj,rj;const vD=class vD{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:r=null,onPinching:s=null,onPinchEnd:o=null,signal:a}){z(this,Kc);z(this,jp);z(this,zh,!1);z(this,Ev,null);z(this,Cv);z(this,xv);z(this,Sv);z(this,Tv);z(this,ll,null);z(this,$h);z(this,ul,null);z(this,Wh);z(this,cl,null);U(this,jp,e),U(this,Ev,n),U(this,Cv,t),U(this,xv,r),U(this,Sv,s),U(this,Tv,o),U(this,Wh,new AbortController),U(this,$h,AbortSignal.any([a,f(this,Wh).signal])),e.addEventListener("touchstart",W(this,Kc,tj).bind(this),{passive:!1,signal:f(this,$h)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Da.pixelRatio}destroy(){var e,t;(e=f(this,Wh))==null||e.abort(),U(this,Wh,null),(t=f(this,ll))==null||t.abort(),U(this,ll,null)}};jp=new WeakMap,zh=new WeakMap,Ev=new WeakMap,Cv=new WeakMap,xv=new WeakMap,Sv=new WeakMap,Tv=new WeakMap,ll=new WeakMap,$h=new WeakMap,ul=new WeakMap,Wh=new WeakMap,cl=new WeakMap,Kc=new WeakSet,tj=function(e){var r,s,o;if((r=f(this,Cv))!=null&&r.call(this))return;if(e.touches.length===1){if(f(this,ll))return;const a=U(this,ll,new AbortController),u=AbortSignal.any([f(this,$h),a.signal]),c=f(this,jp),d={capture:!0,signal:u,passive:!1},m=p=>{var g;p.pointerType==="touch"&&((g=f(this,ll))==null||g.abort(),U(this,ll,null))};c.addEventListener("pointerdown",p=>{p.pointerType==="touch"&&(Jn(p),m(p))},d),c.addEventListener("pointerup",m,d),c.addEventListener("pointercancel",m,d);return}if(!f(this,cl)){U(this,cl,new AbortController);const a=AbortSignal.any([f(this,$h),f(this,cl).signal]),u=f(this,jp),c={signal:a,capture:!1,passive:!1};u.addEventListener("touchmove",W(this,Kc,nj).bind(this),c);const d=W(this,Kc,rj).bind(this);u.addEventListener("touchend",d,c),u.addEventListener("touchcancel",d,c),c.capture=!0,u.addEventListener("pointerdown",Jn,c),u.addEventListener("pointermove",Jn,c),u.addEventListener("pointercancel",Jn,c),u.addEventListener("pointerup",Jn,c),(s=f(this,xv))==null||s.call(this)}if(Jn(e),e.touches.length!==2||(o=f(this,Ev))!=null&&o.call(this)){U(this,ul,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),U(this,ul,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},nj=function(e){var S;if(!f(this,ul)||e.touches.length!==2)return;Jn(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:r,screenY:s}=t,{screenX:o,screenY:a}=n,u=f(this,ul),{touch0X:c,touch0Y:d,touch1X:m,touch1Y:p}=u,g=m-c,w=p-d,b=o-r,A=a-s,_=Math.hypot(b,A)||1,C=Math.hypot(g,w)||1;if(!f(this,zh)&&Math.abs(C-_)<=vD.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(u.touch0X=r,u.touch0Y=s,u.touch1X=o,u.touch1Y=a,!f(this,zh)){U(this,zh,!0);return}const I=[(r+o)/2,(s+a)/2];(S=f(this,Sv))==null||S.call(this,I,C,_)},rj=function(e){var t;e.touches.length>=2||(f(this,cl)&&(f(this,cl).abort(),U(this,cl,null),(t=f(this,Tv))==null||t.call(this)),f(this,ul)&&(Jn(e),U(this,ul,null),U(this,zh,!1)))};let f1=vD;var Gh,wo,An,Or,qp,Zu,Iv,Kh,Lr,Jh,hl,ec,Dv,Yh,Zi,kv,Xh,dl,sa,Up,Vp,qs,Qh,Rv,S1,ut,bS,Pv,AS,d_,ij,sj,ES,f_,CS,oj,aj,lj,xS,uj,SS,cj,hj,dj,TS,my;const xt=class xt{constructor(e){z(this,ut);z(this,Gh,null);z(this,wo,null);z(this,An,null);z(this,Or,null);z(this,qp,!1);z(this,Zu,null);z(this,Iv,"");z(this,Kh,!1);z(this,Lr,null);z(this,Jh,null);z(this,hl,null);z(this,ec,null);z(this,Dv,"");z(this,Yh,!1);z(this,Zi,null);z(this,kv,!1);z(this,Xh,!1);z(this,dl,!1);z(this,sa,null);z(this,Up,0);z(this,Vp,0);z(this,qs,null);z(this,Qh,null);re(this,"isSelected",!1);re(this,"_isCopy",!1);re(this,"_editToolbar",null);re(this,"_initialOptions",Object.create(null));re(this,"_initialData",null);re(this,"_isVisible",!0);re(this,"_uiManager",null);re(this,"_focusEventsAllowed",!0);z(this,Rv,!1);z(this,S1,xt._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:r,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[s,o];const[a,u]=this.parentDimensions;this.x=e.x/a,this.y=e.y/u,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=xt.prototype._resizeWithKeyboard,t=Qd.TRANSLATE_SMALL,n=Qd.TRANSLATE_BIG;return Rt(this,"_resizerKeyboardManager",new s2([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],xt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Rt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new rZ({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(xt._l10n??(xt._l10n=e),xt._l10nResizer||(xt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),xt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);xt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){rn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return f(this,Rv)}set _isDraggable(e){var t;U(this,Rv,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=f(this,S1)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):W(this,ut,my).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(f(this,Yh)?U(this,Yh,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,r){const[s,o]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(e+n)/s,this.y=(t+r)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,r]=this.parentDimensions;this.setAt(e*n,t*r,this.width*n,this.height*r),this._onTranslated()}translate(e,t){W(this,ut,bS).call(this,this.parentDimensions,e,t)}translateInPage(e,t){f(this,Zi)||U(this,Zi,[this.x,this.y,this.width,this.height]),W(this,ut,bS).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){f(this,Zi)||U(this,Zi,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[r,s]}=this;if(this.x+=e/r,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[u,c]=this.getBaseTranslation();o+=u,a+=c;const{style:d}=n;d.left=`${(100*o).toFixed(2)}%`,d.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!f(this,Zi)&&(f(this,Zi)[0]!==this.x||f(this,Zi)[1]!==this.y)}get _hasBeenResized(){return!!f(this,Zi)&&(f(this,Zi)[2]!==this.width||f(this,Zi)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=xt,r=n/e,s=n/t;switch(this.rotation){case 90:return[-r,s];case 180:return[r,s];case 270:return[r,-s];default:return[-r,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,r]}=this;let{x:s,y:o,width:a,height:u}=this;if(a*=n,u*=r,s*=n,o*=r,this._mustFixPosition)switch(e){case 0:s=vi(s,0,n-a),o=vi(o,0,r-u);break;case 90:s=vi(s,0,n-u),o=vi(o,a,r);break;case 180:s=vi(s,a,n),o=vi(o,u,r);break;case 270:s=vi(s,u,n),o=vi(o,0,r-a);break}this.x=s/=n,this.y=o/=r;const[c,d]=this.getBaseTranslation();s+=c,o+=d,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return W(n=xt,Pv,AS).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return W(n=xt,Pv,AS).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,r]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*e/n).toFixed(2)}%`,f(this,Kh)||(s.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,r=n.endsWith("%"),s=!f(this,Kh)&&t.endsWith("%");if(r&&s)return;const[o,a]=this.parentDimensions;r||(e.width=`${(100*parseFloat(n)/o).toFixed(2)}%`),!f(this,Kh)&&!s&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=f(this,An))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||f(this,Xh))return this._editToolbar;this._editToolbar=new hS(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=f(this,An))==null||e.destroy())}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return f(this,An)||(d1.initialize(xt._l10n),U(this,An,new d1(this)),f(this,Gh)&&(f(this,An).data=f(this,Gh),U(this,Gh,null))),f(this,An)}get altTextData(){var e;return(e=f(this,An))==null?void 0:e.data}set altTextData(e){f(this,An)&&(f(this,An).data=e)}get guessedAltText(){var e;return(e=f(this,An))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=f(this,An))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=f(this,An))==null?void 0:t.serialize(e)}hasAltText(){return!!f(this,An)&&!f(this,An).isEmpty()}hasAltTextData(){var e;return((e=f(this,An))==null?void 0:e.hasData())??!1}addCommentButton(){return f(this,Or)?f(this,Or):U(this,Or,new Mw(this))}get commentColor(){return null}get comment(){const e=f(this,Or);return{text:e.data.text,date:e.data.date,deleted:e.isDeleted(),color:this.commentColor}}set comment(e){f(this,Or)||U(this,Or,new Mw(this)),f(this,Or).data=e}setCommentData(e){f(this,Or)||U(this,Or,new Mw(this)),f(this,Or).setInitialText(e)}get hasEditedComment(){var e;return(e=f(this,Or))==null?void 0:e.hasBeenEdited()}async editComment(){f(this,Or)||U(this,Or,new Mw(this)),f(this,Or).edit()}addComment(e){if(this.hasEditedComment){const[,,,r]=e.rect,[s]=this.pageDimensions,[o]=this.pageTranslation,a=o+s+1,u=r-100,c=a+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[a,u,c,r]}}}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=f(this,qp)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),W(this,ut,SS).call(this);const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[r,s]=this.getInitialTranslation();return this.translate(r,s),H5(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(f(this,Qh)||U(this,Qh,new f1({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:W(this,ut,oj).bind(this),onPinching:W(this,ut,aj).bind(this),onPinchEnd:W(this,ut,lj).bind(this),signal:this._uiManager._signal}))),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=$r.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(U(this,Yh,!0),this._isDraggable){W(this,ut,uj).call(this,e);return}W(this,ut,xS).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){f(this,sa)&&clearTimeout(f(this,sa)),U(this,sa,setTimeout(()=>{var e;U(this,sa,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const r=this.parentScale,[s,o]=this.pageDimensions,[a,u]=this.pageTranslation,c=e/r,d=t/r,m=this.x*s,p=this.y*o,g=this.width*s,w=this.height*o;switch(n){case 0:return[m+c+a,o-p-d-w+u,m+c+g+a,o-p-d+u];case 90:return[m+d+a,o-p+c+u,m+d+w+a,o-p+c+g+u];case 180:return[m-c-g+a,o-p+d+u,m-c+a,o-p+d+w+u];case 270:return[m-d-w+a,o-p-c-g+u,m-d+a,o-p-c+u];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,r,s,o]=e,a=s-n,u=o-r;switch(this.rotation){case 0:return[n,t-o,a,u];case 90:return[n,t-r,u,a];case 180:return[s,t-r,a,u];case 270:return[s,t-o,u,a];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),U(this,Xh,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),U(this,Xh,!1),!0):!1}isInEditMode(){return f(this,Xh)}shouldGetKeyboardEvents(){return f(this,dl)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:r}=this.getClientDimensions(),{innerHeight:s,innerWidth:o}=window;return t<o&&r>0&&e<s&&n>0}rebuild(){W(this,ut,SS).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){rn("An editor must be serializable")}static async deserialize(e,t,n){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId});r.rotation=e.rotation,U(r,Gh,e.accessibilityData),r._isCopy=e.isCopy||!1;const[s,o]=r.pageDimensions,[a,u,c,d]=r.getRectInCurrentCoords(e.rect,o);return r.x=a/s,r.y=u/o,r.width=c/s,r.height=d/o,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=f(this,ec))==null||e.abort(),U(this,ec,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),f(this,sa)&&(clearTimeout(f(this,sa)),U(this,sa,null)),W(this,ut,my).call(this),this.removeEditToolbar(),f(this,qs)){for(const n of f(this,qs).values())clearTimeout(n);U(this,qs,null)}this.parent=null,(t=f(this,Qh))==null||t.destroy(),U(this,Qh,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(W(this,ut,ij).call(this),f(this,Lr).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),U(this,hl,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=f(this,Lr).children;if(!f(this,wo)){U(this,wo,Array.from(t));const o=W(this,ut,cj).bind(this),a=W(this,ut,hj).bind(this),u=this._uiManager._signal;for(const c of f(this,wo)){const d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",o,{signal:u}),c.addEventListener("blur",a,{signal:u}),c.addEventListener("focus",W(this,ut,dj).bind(this,d),{signal:u}),c.setAttribute("data-l10n-id",xt._l10nResizer[d])}}const n=f(this,wo)[0];let r=0;for(const o of t){if(o===n)break;r++}const s=(360-this.rotation+this.parentRotation)%360/90*(f(this,wo).length/4);if(s!==r){if(s<r)for(let a=0;a<r-s;a++)f(this,Lr).append(f(this,Lr).firstChild);else if(s>r)for(let a=0;a<s-r;a++)f(this,Lr).firstChild.before(f(this,Lr).lastChild);let o=0;for(const a of t){const c=f(this,wo)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",xt._l10nResizer[c])}}W(this,ut,TS).call(this,0),U(this,dl,!0),f(this,Lr).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){f(this,dl)&&W(this,ut,CS).call(this,f(this,Dv),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){W(this,ut,my).call(this),this.div.focus()}select(){var e,t,n;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var r,s;(r=this.div)!=null&&r.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(t=this._editToolbar)==null||t.show(),(n=f(this,An))==null||n.toggleAltTextBadge(!1)}}unselect(){var e,t,n,r,s;this.isSelected&&(this.isSelected=!1,(e=f(this,Lr))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(r=this._editToolbar)==null||r.hide(),(s=f(this,An))==null||s.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return f(this,kv)}set isEditing(e){U(this,kv,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){U(this,Kh,!0);const n=e/t,{style:r}=this.div;r.aspectRatio=n,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){f(this,qs)||U(this,qs,new Map);const{action:n}=e;let r=f(this,qs).get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),f(this,qs).delete(n),f(this,qs).size===0&&U(this,qs,null)},xt._telemetryTimeout),f(this,qs).set(n,r);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),U(this,qp,!1)}disable(){this.div&&(this.div.tabIndex=-1),U(this,qp,!0)}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Gh=new WeakMap,wo=new WeakMap,An=new WeakMap,Or=new WeakMap,qp=new WeakMap,Zu=new WeakMap,Iv=new WeakMap,Kh=new WeakMap,Lr=new WeakMap,Jh=new WeakMap,hl=new WeakMap,ec=new WeakMap,Dv=new WeakMap,Yh=new WeakMap,Zi=new WeakMap,kv=new WeakMap,Xh=new WeakMap,dl=new WeakMap,sa=new WeakMap,Up=new WeakMap,Vp=new WeakMap,qs=new WeakMap,Qh=new WeakMap,Rv=new WeakMap,S1=new WeakMap,ut=new WeakSet,bS=function([e,t],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Pv=new WeakSet,AS=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},d_=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},ij=function(){if(f(this,Lr))return;U(this,Lr,document.createElement("div")),f(this,Lr).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const r=document.createElement("div");f(this,Lr).append(r),r.classList.add("resizer",n),r.setAttribute("data-resizer-name",n),r.addEventListener("pointerdown",W(this,ut,sj).bind(this,n),{signal:t}),r.addEventListener("contextmenu",Xs,{signal:t}),r.tabIndex=-1}this.div.prepend(f(this,Lr))},sj=function(e,t){var d;t.preventDefault();const{isMac:n}=$r.platform;if(t.button!==0||t.ctrlKey&&n)return;(d=f(this,An))==null||d.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,U(this,Jh,[t.screenX,t.screenY]);const s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",W(this,ut,CS).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Jn,{passive:!1,signal:o}),window.addEventListener("contextmenu",Xs,{signal:o}),U(this,hl,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var m;s.abort(),this.parent.togglePointerEvents(!0),(m=f(this,An))==null||m.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=a,this.div.style.cursor=u,W(this,ut,f_).call(this)};window.addEventListener("pointerup",c,{signal:o}),window.addEventListener("blur",c,{signal:o})},ES=function(e,t,n,r){this.width=n,this.height=r,this.x=e,this.y=t;const[s,o]=this.parentDimensions;this.setDims(s*n,o*r),this.fixAndSetPosition(),this._onResized()},f_=function(){if(!f(this,hl))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:r}=f(this,hl);U(this,hl,null);const s=this.x,o=this.y,a=this.width,u=this.height;s===e&&o===t&&a===n&&u===r||this.addCommands({cmd:W(this,ut,ES).bind(this,s,o,a,u),undo:W(this,ut,ES).bind(this,e,t,n,r),mustExec:!0})},CS=function(e,t){const[n,r]=this.parentDimensions,s=this.x,o=this.y,a=this.width,u=this.height,c=xt.MIN_SIZE/n,d=xt.MIN_SIZE/r,m=W(this,ut,d_).call(this,this.rotation),p=(ie,ee)=>[m[0]*ie+m[2]*ee,m[1]*ie+m[3]*ee],g=W(this,ut,d_).call(this,360-this.rotation),w=(ie,ee)=>[g[0]*ie+g[2]*ee,g[1]*ie+g[3]*ee];let b,A,_=!1,C=!1;switch(e){case"topLeft":_=!0,b=(ie,ee)=>[0,0],A=(ie,ee)=>[ie,ee];break;case"topMiddle":b=(ie,ee)=>[ie/2,0],A=(ie,ee)=>[ie/2,ee];break;case"topRight":_=!0,b=(ie,ee)=>[ie,0],A=(ie,ee)=>[0,ee];break;case"middleRight":C=!0,b=(ie,ee)=>[ie,ee/2],A=(ie,ee)=>[0,ee/2];break;case"bottomRight":_=!0,b=(ie,ee)=>[ie,ee],A=(ie,ee)=>[0,0];break;case"bottomMiddle":b=(ie,ee)=>[ie/2,ee],A=(ie,ee)=>[ie/2,0];break;case"bottomLeft":_=!0,b=(ie,ee)=>[0,ee],A=(ie,ee)=>[ie,0];break;case"middleLeft":C=!0,b=(ie,ee)=>[0,ee/2],A=(ie,ee)=>[ie,ee/2];break}const I=b(a,u),S=A(a,u);let R=p(...S);const L=xt._round(s+R[0]),k=xt._round(o+R[1]);let T=1,D=1,P,N;if(t.fromKeyboard)({deltaX:P,deltaY:N}=t);else{const{screenX:ie,screenY:ee}=t,[ue,Y]=f(this,Jh);[P,N]=this.screenToPageTranslation(ie-ue,ee-Y),f(this,Jh)[0]=ie,f(this,Jh)[1]=ee}if([P,N]=w(P/n,N/r),_){const ie=Math.hypot(a,u);T=D=Math.max(Math.min(Math.hypot(S[0]-I[0]-P,S[1]-I[1]-N)/ie,1/a,1/u),c/a,d/u)}else C?T=vi(Math.abs(S[0]-I[0]-P),c,1)/a:D=vi(Math.abs(S[1]-I[1]-N),d,1)/u;const F=xt._round(a*T),M=xt._round(u*D);R=p(...A(F,M));const $=L-R[0],Q=k-R[1];f(this,Zi)||U(this,Zi,[this.x,this.y,this.width,this.height]),this.width=F,this.height=M,this.x=$,this.y=Q,this.setDims(n*F,r*M),this.fixAndSetPosition(),this._onResizing()},oj=function(){var e;U(this,hl,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=f(this,An))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},aj=function(e,t,n){let s=.7*(n/t)+1-.7;if(s===1)return;const o=W(this,ut,d_).call(this,this.rotation),a=(L,k)=>[o[0]*L+o[2]*k,o[1]*L+o[3]*k],[u,c]=this.parentDimensions,d=this.x,m=this.y,p=this.width,g=this.height,w=xt.MIN_SIZE/u,b=xt.MIN_SIZE/c;s=Math.max(Math.min(s,1/p,1/g),w/p,b/g);const A=xt._round(p*s),_=xt._round(g*s);if(A===p&&_===g)return;f(this,Zi)||U(this,Zi,[d,m,p,g]);const C=a(p/2,g/2),I=xt._round(d+C[0]),S=xt._round(m+C[1]),R=a(A/2,_/2);this.x=I-R[0],this.y=S-R[1],this.width=A,this.height=_,this.setDims(u*A,c*_),this.fixAndSetPosition(),this._onResizing()},lj=function(){var e;(e=f(this,An))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),W(this,ut,f_).call(this)},xS=function(e){const{isMac:t}=$r.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},uj=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const r=new AbortController,s=this._uiManager.combinedSignal(r),o={capture:!0,passive:!1,signal:s},a=c=>{r.abort(),U(this,Zu,null),U(this,Yh,!1),this._uiManager.endDragSession()||W(this,ut,xS).call(this,c),n&&this._onStopDragging()};t&&(U(this,Up,e.clientX),U(this,Vp,e.clientY),U(this,Zu,e.pointerId),U(this,Iv,e.pointerType),window.addEventListener("pointermove",c=>{n||(n=!0,this._onStartDragging());const{clientX:d,clientY:m,pointerId:p}=c;if(p!==f(this,Zu)){Jn(c);return}const[g,w]=this.screenToPageTranslation(d-f(this,Up),m-f(this,Vp));U(this,Up,d),U(this,Vp,m),this._uiManager.dragSelectedEditors(g,w)},o),window.addEventListener("touchmove",Jn,o),window.addEventListener("pointerdown",c=>{c.pointerType===f(this,Iv)&&(f(this,Qh)||c.isPrimary)&&a(c),Jn(c)},o));const u=c=>{if(!f(this,Zu)||f(this,Zu)===c.pointerId){a(c);return}Jn(c)};window.addEventListener("pointerup",u,{signal:s}),window.addEventListener("blur",u,{signal:s})},SS=function(){if(f(this,ec)||!this.div)return;U(this,ec,new AbortController);const e=this._uiManager.combinedSignal(f(this,ec));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},cj=function(e){xt._resizerKeyboardManager.exec(this,e)},hj=function(e){var t;f(this,dl)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==f(this,Lr)&&W(this,ut,my).call(this)},dj=function(e){U(this,Dv,f(this,dl)?e:"")},TS=function(e){if(f(this,wo))for(const t of f(this,wo))t.tabIndex=e},my=function(){U(this,dl,!1),W(this,ut,TS).call(this,-1),W(this,ut,f_).call(this)},z(xt,Pv),re(xt,"_l10n",null),re(xt,"_l10nResizer",null),re(xt,"_borderLineWidth",-1),re(xt,"_colorManager",new pS),re(xt,"_zIndex",1),re(xt,"_telemetryTimeout",1e3);let cn=xt;class rZ extends cn{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const GL=3285377520,Os=4294901760,Go=65535;class fj{constructor(e){this.h1=e?e&4294967295:GL,this.h2=e?e&4294967295:GL}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let b=0,A=e.length;b<A;b++){const _=e.charCodeAt(b);_<=255?t[n++]=_:(t[n++]=_>>>8,t[n++]=_&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=n>>2,s=n-r*4,o=new Uint32Array(t.buffer,0,r);let a=0,u=0,c=this.h1,d=this.h2;const m=3432918353,p=461845907,g=m&Go,w=p&Go;for(let b=0;b<r;b++)b&1?(a=o[b],a=a*m&Os|a*g&Go,a=a<<15|a>>>17,a=a*p&Os|a*w&Go,c^=a,c=c<<13|c>>>19,c=c*5+3864292196):(u=o[b],u=u*m&Os|u*g&Go,u=u<<15|u>>>17,u=u*p&Os|u*w&Go,d^=u,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,s){case 3:a^=t[r*4+2]<<16;case 2:a^=t[r*4+1]<<8;case 1:a^=t[r*4],a=a*m&Os|a*g&Go,a=a<<15|a>>>17,a=a*p&Os|a*w&Go,r&1?c^=a:d^=a}this.h1=c,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Os|e*36045&Go,t=t*4283543511&Os|((t<<16|e>>>16)*2950163797&Os)>>>16,e^=t>>>1,e=e*444984403&Os|e*60499&Go,t=t*3301882366&Os|((t<<16|e>>>16)*3120437893&Os)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const IS=Object.freeze({map:null,hash:"",transfer:void 0});var Zh,ed,Fr,T1,pj;class uD{constructor(){z(this,T1);z(this,Zh,!1);z(this,ed,null);z(this,Fr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=f(this,Fr).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return f(this,Fr).get(e)}remove(e){if(f(this,Fr).delete(e),f(this,Fr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of f(this,Fr).values())if(t instanceof cn)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=f(this,Fr).get(e);let r=!1;if(n!==void 0)for(const[s,o]of Object.entries(t))n[s]!==o&&(r=!0,n[s]=o);else r=!0,f(this,Fr).set(e,t);r&&W(this,T1,pj).call(this),t instanceof cn&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return f(this,Fr).has(e)}get size(){return f(this,Fr).size}resetModified(){f(this,Zh)&&(U(this,Zh,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new mj(this)}get serializable(){if(f(this,Fr).size===0)return IS;const e=new Map,t=new fj,n=[],r=Object.create(null);let s=!1;for(const[o,a]of f(this,Fr)){const u=a instanceof cn?a.serialize(!1,r):a;u&&(e.set(o,u),t.update(`${o}:${JSON.stringify(u)}`),s||(s=!!u.bitmap))}if(s)for(const o of e.values())o.bitmap&&n.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:IS}get editorStats(){let e=null;const t=new Map;for(const n of f(this,Fr).values()){if(!(n instanceof cn))continue;const r=n.telemetryFinalData;if(!r)continue;const{type:s}=r;t.has(s)||t.set(s,Object.getPrototypeOf(n).constructor),e||(e=Object.create(null));const o=e[s]||(e[s]=new Map);for(const[a,u]of Object.entries(r)){if(a==="type")continue;let c=o.get(a);c||(c=new Map,o.set(a,c));const d=c.get(u)??0;c.set(u,d+1)}}for(const[n,r]of t)e[n]=r.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){U(this,ed,null)}get modifiedIds(){if(f(this,ed))return f(this,ed);const e=[];for(const t of f(this,Fr).values())!(t instanceof cn)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return U(this,ed,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return f(this,Fr).entries()}}Zh=new WeakMap,ed=new WeakMap,Fr=new WeakMap,T1=new WeakSet,pj=function(){f(this,Zh)||(U(this,Zh,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Nv;class mj extends uD{constructor(t){super();z(this,Nv);const{map:n,hash:r,transfer:s}=t.serializable,o=structuredClone(n,s?{transfer:s}:null);U(this,Nv,{map:o,hash:r,transfer:s})}get print(){rn("Should not call PrintAnnotationStorage.print")}get serializable(){return f(this,Nv)}get modifiedIds(){return Rt(this,"modifiedIds",{ids:new Set,hash:""})}}Nv=new WeakMap;var Hp;class iZ{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){z(this,Hp,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),f(this,Hp).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||f(this,Hp).has(e.loadedName))){if(Xn(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:s,style:o}=e,a=new FontFace(r,s,o);this.addNativeFontFace(a);try{await a.load(),f(this,Hp).add(r),n==null||n(e)}catch{Et(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}rn("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(r){throw Et(`Failed to load font '${n.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const r=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Rt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Rt(this,"isSyncFontLoadingSupported",yi||$r.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Xn(!r.done,"completeRequest() cannot be called twice."),r.done=!0;n.length>0&&n[0].done;){const s=n.shift();setTimeout(s.callback,0)}}const{loadingRequests:n}=this,r={done:!1,complete:t,callback:e};return n.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Rt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(S,R){return S.charCodeAt(R)<<24|S.charCodeAt(R+1)<<16|S.charCodeAt(R+2)<<8|S.charCodeAt(R+3)&255}function r(S,R,L,k){const T=S.substring(0,R),D=S.substring(R+L);return T+k+D}let s,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const u=a.getContext("2d");let c=0;function d(S,R){if(++c>30){Et("Load test font never loaded."),R();return}if(u.font="30px "+S,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(d.bind(null,S,R))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=r(p,976,m.length,m);const w=16,b=1482184792;let A=n(p,w);for(s=0,o=m.length-3;s<o;s+=4)A=A-b+n(m,s)|0;s<m.length&&(A=A-b+n(m+"XXX",s)|0),p=r(p,w,4,VQ(A));const _=`url(data:font/opentype;base64,${btoa(p)});`,C=`@font-face {font-family:"${m}";src:${_}}`;this.insertRule(C);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const S of[e.loadedName,m]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=S,I.append(R)}this._document.body.append(I),d(m,()=>{I.remove(),t.complete()})}}Hp=new WeakMap;class sZ{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const n in e)this[n]=e[n];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${M5(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let r;try{r=e.get(n)}catch(o){Et(`getPathGenerator - ignoring character: "${o}".`)}const s=new Path2D(r||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=s}}function oZ(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(yi)return i;const e=URL.parse(i,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function aZ(i){if(yi&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return n2(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i==null?void 0:i.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Bw(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const DS=i=>typeof i=="object"&&Number.isInteger(i==null?void 0:i.num)&&i.num>=0&&Number.isInteger(i==null?void 0:i.gen)&&i.gen>=0,lZ=i=>typeof i=="object"&&typeof(i==null?void 0:i.name)=="string",uZ=GQ.bind(null,DS,lZ);var fl,I1;class cZ{constructor(){z(this,fl,new Map);z(this,I1,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};f(this,I1).then(()=>{for(const[r]of f(this,fl))r.call(this,n)})}addEventListener(e,t,n=null){let r=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:s}=n;if(s.aborted){Et("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);r=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}f(this,fl).set(t,r)}removeEventListener(e,t){const n=f(this,fl).get(t);n==null||n(),f(this,fl).delete(t)}terminate(){for(const[,e]of f(this,fl))e==null||e();f(this,fl).clear()}}fl=new WeakMap,I1=new WeakMap;const jw={DATA:1,ERROR:2},Wn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function KL(){}function Oi(i){if(i instanceof Wc||i instanceof lS||i instanceof zL||i instanceof c1||i instanceof wx)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||rn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new Wc(i.message);case"InvalidPDFException":return new lS(i.message);case"PasswordException":return new zL(i.message,i.code);case"ResponseException":return new c1(i.message,i.status,i.missing);case"UnknownErrorException":return new wx(i.message,i.details)}return new wx(i.message,i.toString())}var zp,Ys,gj,yj,vj,p_;class gy{constructor(e,t,n){z(this,Ys);z(this,zp,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",W(this,Ys,gj).bind(this),{signal:f(this,zp).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const r=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[r]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},n)}catch(o){s.reject(o)}return s.promise}sendWithStream(e,t,n,r){const s=this.streamId++,o=this.sourceName,a=this.targetName,u=this.comObj;return new ReadableStream({start:c=>{const d=Promise.withResolvers();return this.streamControllers[s]={controller:c,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:o,targetName:a,action:e,streamId:s,data:t,desiredSize:c.desiredSize},r),d.promise},pull:c=>{const d=Promise.withResolvers();return this.streamControllers[s].pullCall=d,u.postMessage({sourceName:o,targetName:a,stream:Wn.PULL,streamId:s,desiredSize:c.desiredSize}),d.promise},cancel:c=>{Xn(c instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[s].cancelCall=d,this.streamControllers[s].isClosed=!0,u.postMessage({sourceName:o,targetName:a,stream:Wn.CANCEL,streamId:s,reason:Oi(c)}),d.promise}},n)}destroy(){var e;(e=f(this,zp))==null||e.abort(),U(this,zp,null)}}zp=new WeakMap,Ys=new WeakSet,gj=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){W(this,Ys,vj).call(this,e);return}if(e.callback){const n=e.callbackId,r=this.callbackCapabilities[n];if(!r)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===jw.DATA)r.resolve(e.data);else if(e.callback===jw.ERROR)r.reject(Oi(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,r=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(o){s.postMessage({sourceName:n,targetName:r,callback:jw.DATA,callbackId:e.callbackId,data:o})},function(o){s.postMessage({sourceName:n,targetName:r,callback:jw.ERROR,callbackId:e.callbackId,reason:Oi(o)})});return}if(e.streamId){W(this,Ys,yj).call(this,e);return}t(e.data)},yj=function(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,s=this.comObj,o=this,a=this.actionHandler[e.action],u={enqueue(c,d=1,m){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=d,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:r,stream:Wn.ENQUEUE,streamId:t,chunk:c},m)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:r,stream:Wn.CLOSE,streamId:t}),delete o.streamSinks[t])},error(c){Xn(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:r,stream:Wn.ERROR,streamId:t,reason:Oi(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[t]=u,Promise.try(a,e.data,u).then(function(){s.postMessage({sourceName:n,targetName:r,stream:Wn.START_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:n,targetName:r,stream:Wn.START_COMPLETE,streamId:t,reason:Oi(c)})})},vj=function(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,s=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Wn.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Oi(e.reason));break;case Wn.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Oi(e.reason));break;case Wn.PULL:if(!a){s.postMessage({sourceName:n,targetName:r,stream:Wn.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||KL).then(function(){s.postMessage({sourceName:n,targetName:r,stream:Wn.PULL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:n,targetName:r,stream:Wn.PULL_COMPLETE,streamId:t,reason:Oi(c)})});break;case Wn.ENQUEUE:if(Xn(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Wn.CLOSE:if(Xn(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),W(this,Ys,p_).call(this,o,t);break;case Wn.ERROR:Xn(o,"error should have stream controller"),o.controller.error(Oi(e.reason)),W(this,Ys,p_).call(this,o,t);break;case Wn.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Oi(e.reason)),W(this,Ys,p_).call(this,o,t);break;case Wn.CANCEL:if(!a)break;const u=Oi(e.reason);Promise.try(a.onCancel||KL,u).then(function(){s.postMessage({sourceName:n,targetName:r,stream:Wn.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:n,targetName:r,stream:Wn.CANCEL_COMPLETE,streamId:t,reason:Oi(c)})}),a.sinkCapability.reject(u),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},p_=async function(e,t){var n,r,s;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(r=e.pullCall)==null?void 0:r.promise,(s=e.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[t]};var Ov;class wj{constructor({enableHWA:e=!1}){z(this,Ov,!1);U(this,Ov,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!f(this,Ov)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){rn("Abstract method `_createCanvas` called.")}}Ov=new WeakMap;class hZ extends wj{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class _j{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){rn("Abstract method `_fetch` called.")}}class JL extends _j{async _fetch(e){const t=await r2(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):n2(t)}}class bj{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,r,s){return"none"}destroy(e=!1){}}var td,$p,pl,ml,ei,nd,rd,Ve,Qr,yy,ip,m_,sp,Aj,kS,op,vy,wy,RS,_y;class dZ extends bj{constructor({docId:t,ownerDocument:n=globalThis.document}){super();z(this,Ve);z(this,td);z(this,$p);z(this,pl);z(this,ml);z(this,ei);z(this,nd);z(this,rd,0);U(this,ml,t),U(this,ei,n)}addFilter(t){if(!t)return"none";let n=f(this,Ve,Qr).get(t);if(n)return n;const[r,s,o]=W(this,Ve,m_).call(this,t),a=t.length===1?r:`${r}${s}${o}`;if(n=f(this,Ve,Qr).get(a),n)return f(this,Ve,Qr).set(t,n),n;const u=`g_${f(this,ml)}_transfer_map_${ir(this,rd)._++}`,c=W(this,Ve,sp).call(this,u);f(this,Ve,Qr).set(t,c),f(this,Ve,Qr).set(a,c);const d=W(this,Ve,op).call(this,u);return W(this,Ve,wy).call(this,r,s,o,d),c}addHCMFilter(t,n){var w;const r=`${t}-${n}`,s="base";let o=f(this,Ve,yy).get(s);if((o==null?void 0:o.key)===r||(o?((w=o.filter)==null||w.remove(),o.key=r,o.url="none",o.filter=null):(o={key:r,url:"none",filter:null},f(this,Ve,yy).set(s,o)),!t||!n))return o.url;const a=W(this,Ve,_y).call(this,t);t=Je.makeHexColor(...a);const u=W(this,Ve,_y).call(this,n);if(n=Je.makeHexColor(...u),f(this,Ve,ip).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return o.url;const c=new Array(256);for(let b=0;b<=255;b++){const A=b/255;c[b]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const d=c.join(","),m=`g_${f(this,ml)}_hcm_filter`,p=o.filter=W(this,Ve,op).call(this,m);W(this,Ve,wy).call(this,d,d,d,p),W(this,Ve,kS).call(this,p);const g=(b,A)=>{const _=a[b]/255,C=u[b]/255,I=new Array(A+1);for(let S=0;S<=A;S++)I[S]=_+S/A*(C-_);return I.join(",")};return W(this,Ve,wy).call(this,g(0,5),g(1,5),g(2,5),p),o.url=W(this,Ve,sp).call(this,m),o.url}addAlphaFilter(t){let n=f(this,Ve,Qr).get(t);if(n)return n;const[r]=W(this,Ve,m_).call(this,[t]),s=`alpha_${r}`;if(n=f(this,Ve,Qr).get(s),n)return f(this,Ve,Qr).set(t,n),n;const o=`g_${f(this,ml)}_alpha_map_${ir(this,rd)._++}`,a=W(this,Ve,sp).call(this,o);f(this,Ve,Qr).set(t,a),f(this,Ve,Qr).set(s,a);const u=W(this,Ve,op).call(this,o);return W(this,Ve,RS).call(this,r,u),a}addLuminosityFilter(t){let n=f(this,Ve,Qr).get(t||"luminosity");if(n)return n;let r,s;if(t?([r]=W(this,Ve,m_).call(this,[t]),s=`luminosity_${r}`):s="luminosity",n=f(this,Ve,Qr).get(s),n)return f(this,Ve,Qr).set(t,n),n;const o=`g_${f(this,ml)}_luminosity_map_${ir(this,rd)._++}`,a=W(this,Ve,sp).call(this,o);f(this,Ve,Qr).set(t,a),f(this,Ve,Qr).set(s,a);const u=W(this,Ve,op).call(this,o);return W(this,Ve,Aj).call(this,u),t&&W(this,Ve,RS).call(this,r,u),a}addHighlightHCMFilter(t,n,r,s,o){var C;const a=`${n}-${r}-${s}-${o}`;let u=f(this,Ve,yy).get(t);if((u==null?void 0:u.key)===a||(u?((C=u.filter)==null||C.remove(),u.key=a,u.url="none",u.filter=null):(u={key:a,url:"none",filter:null},f(this,Ve,yy).set(t,u)),!n||!r))return u.url;const[c,d]=[n,r].map(W(this,Ve,_y).bind(this));let m=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[g,w]=[s,o].map(W(this,Ve,_y).bind(this));p<m&&([m,p,g,w]=[p,m,w,g]),f(this,Ve,ip).style.color="";const b=(I,S,R)=>{const L=new Array(256),k=(p-m)/R,T=I/255,D=(S-I)/(255*R);let P=0;for(let N=0;N<=R;N++){const F=Math.round(m+N*k),M=T+N*D;for(let $=P;$<=F;$++)L[$]=M;P=F+1}for(let N=P;N<256;N++)L[N]=L[P-1];return L.join(",")},A=`g_${f(this,ml)}_hcm_${t}_filter`,_=u.filter=W(this,Ve,op).call(this,A);return W(this,Ve,kS).call(this,_),W(this,Ve,wy).call(this,b(g[0],w[0],5),b(g[1],w[1],5),b(g[2],w[2],5),_),u.url=W(this,Ve,sp).call(this,A),u.url}destroy(t=!1){var n,r,s,o;t&&((n=f(this,nd))!=null&&n.size)||((r=f(this,pl))==null||r.parentNode.parentNode.remove(),U(this,pl,null),(s=f(this,$p))==null||s.clear(),U(this,$p,null),(o=f(this,nd))==null||o.clear(),U(this,nd,null),U(this,rd,0))}}td=new WeakMap,$p=new WeakMap,pl=new WeakMap,ml=new WeakMap,ei=new WeakMap,nd=new WeakMap,rd=new WeakMap,Ve=new WeakSet,Qr=function(){return f(this,$p)||U(this,$p,new Map)},yy=function(){return f(this,nd)||U(this,nd,new Map)},ip=function(){if(!f(this,pl)){const t=f(this,ei).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const r=f(this,ei).createElementNS(Ja,"svg");r.setAttribute("width",0),r.setAttribute("height",0),U(this,pl,f(this,ei).createElementNS(Ja,"defs")),t.append(r),r.append(f(this,pl)),f(this,ei).body.append(t)}return f(this,pl)},m_=function(t){if(t.length===1){const c=t[0],d=new Array(256);for(let p=0;p<256;p++)d[p]=c[p]/255;const m=d.join(",");return[m,m,m]}const[n,r,s]=t,o=new Array(256),a=new Array(256),u=new Array(256);for(let c=0;c<256;c++)o[c]=n[c]/255,a[c]=r[c]/255,u[c]=s[c]/255;return[o.join(","),a.join(","),u.join(",")]},sp=function(t){if(f(this,td)===void 0){U(this,td,"");const n=f(this,ei).URL;n!==f(this,ei).baseURI&&(Lb(n)?Et('#createUrl: ignore "data:"-URL for performance reasons.'):U(this,td,O5(n,"")))}return`url(${f(this,td)}#${t})`},Aj=function(t){const n=f(this,ei).createElementNS(Ja,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},kS=function(t){const n=f(this,ei).createElementNS(Ja,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},op=function(t){const n=f(this,ei).createElementNS(Ja,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),f(this,Ve,ip).append(n),n},vy=function(t,n,r){const s=f(this,ei).createElementNS(Ja,n);s.setAttribute("type","discrete"),s.setAttribute("tableValues",r),t.append(s)},wy=function(t,n,r,s){const o=f(this,ei).createElementNS(Ja,"feComponentTransfer");s.append(o),W(this,Ve,vy).call(this,o,"feFuncR",t),W(this,Ve,vy).call(this,o,"feFuncG",n),W(this,Ve,vy).call(this,o,"feFuncB",r)},RS=function(t,n){const r=f(this,ei).createElementNS(Ja,"feComponentTransfer");n.append(r),W(this,Ve,vy).call(this,r,"feFuncA",t)},_y=function(t){return f(this,Ve,ip).style.color=t,Fb(getComputedStyle(f(this,Ve,ip)).getPropertyValue("color"))};class Ej{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){rn("Abstract method `_fetch` called.")}}class YL extends Ej{async _fetch(e){const t=await r2(e,"arraybuffer");return new Uint8Array(t)}}class Cj{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){rn("Abstract method `_fetch` called.")}}class XL extends Cj{async _fetch(e){const t=await r2(e,"arraybuffer");return new Uint8Array(t)}}yi&&Et("Please use the `legacy` build in Node.js environments.");async function cD(i){const t=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(t)}class fZ extends bj{}class pZ extends wj{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class mZ extends _j{async _fetch(e){return cD(e)}}class gZ extends Ej{async _fetch(e){return cD(e)}}class yZ extends Cj{async _fetch(e){return cD(e)}}const Qf="__forcedDependency";var es,fi,Wp,oa,Gp,gl,Qt,en,yl,ts,tc,Kp,nc,rc;class vZ{constructor(e){z(this,es,{__proto__:null});z(this,fi,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Qf]:[]});z(this,Wp,new Map);z(this,oa,[]);z(this,Gp,[]);z(this,gl,[[1,0,0,1,0,0]]);z(this,Qt,[-1/0,-1/0,1/0,1/0]);z(this,en,new Float64Array([1/0,1/0,-1/0,-1/0]));z(this,yl,-1);z(this,ts,new Set);z(this,tc,new Map);z(this,Kp,new Map);z(this,nc);z(this,rc);U(this,nc,e.width),U(this,rc,e.height)}save(e){return U(this,es,{__proto__:f(this,es)}),U(this,fi,{__proto__:f(this,fi),transform:{__proto__:f(this,fi).transform},moveText:{__proto__:f(this,fi).moveText},sameLineText:{__proto__:f(this,fi).sameLineText},[Qf]:{__proto__:f(this,fi)[Qf]}}),U(this,Qt,{__proto__:f(this,Qt)}),f(this,oa).push([e,null]),this}restore(e){const t=Object.getPrototypeOf(f(this,es));if(t===null)return this;U(this,es,t),U(this,fi,Object.getPrototypeOf(f(this,fi))),U(this,Qt,Object.getPrototypeOf(f(this,Qt)));const n=f(this,oa).pop();return n!==void 0&&(n[1]=e),this}recordOpenMarker(e){return f(this,oa).push([e,null]),this}getOpenMarker(){return f(this,oa).length===0?null:f(this,oa).at(-1)[0]}recordCloseMarker(e){const t=f(this,oa).pop();return t!==void 0&&(t[1]=e),this}beginMarkedContent(e){return f(this,Gp).push([e,null]),this}endMarkedContent(e){const t=f(this,Gp).pop();return t!==void 0&&(t[1]=e),this}pushBaseTransform(e){return f(this,gl).push(Je.multiplyByDOMMatrix(f(this,gl).at(-1),e.getTransform())),this}popBaseTransform(){return f(this,gl).length>1&&f(this,gl).pop(),this}recordSimpleData(e,t){return f(this,es)[e]=t,this}recordIncrementalData(e,t){return f(this,fi)[e].push(t),this}resetIncrementalData(e,t){return f(this,fi)[e].length=0,this}recordNamedData(e,t){return f(this,Wp).set(e,t),this}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Qf,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in f(this,es)&&this.recordFutureForcedDependency(t,f(this,es)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of f(this,ts))this.recordFutureForcedDependency(Qf,e);return this}resetBBox(e){return U(this,yl,e),f(this,en)[0]=1/0,f(this,en)[1]=1/0,f(this,en)[2]=-1/0,f(this,en)[3]=-1/0,this}get hasPendingBBox(){return f(this,yl)!==-1}recordClipBox(e,t,n,r,s,o){const a=Je.multiplyByDOMMatrix(f(this,gl).at(-1),t.getTransform()),u=[1/0,1/0,-1/0,-1/0];Je.axialAlignedBoundingBox([n,s,r,o],a,u);const c=Je.intersect(f(this,Qt),u);return c?(f(this,Qt)[0]=c[0],f(this,Qt)[1]=c[1],f(this,Qt)[2]=c[2],f(this,Qt)[3]=c[3]):(f(this,Qt)[0]=f(this,Qt)[1]=1/0,f(this,Qt)[2]=f(this,Qt)[3]=-1/0),this}recordBBox(e,t,n,r,s,o){const a=f(this,Qt);if(a[0]===1/0)return this;const u=Je.multiplyByDOMMatrix(f(this,gl).at(-1),t.getTransform());if(a[0]===-1/0)return Je.axialAlignedBoundingBox([n,s,r,o],u,f(this,en)),this;const c=[1/0,1/0,-1/0,-1/0];return Je.axialAlignedBoundingBox([n,s,r,o],u,c),f(this,en)[0]=Math.min(f(this,en)[0],Math.max(c[0],a[0])),f(this,en)[1]=Math.min(f(this,en)[1],Math.max(c[1],a[1])),f(this,en)[2]=Math.max(f(this,en)[2],Math.min(c[2],a[2])),f(this,en)[3]=Math.max(f(this,en)[3],Math.min(c[3],a[3])),this}recordCharacterBBox(e,t,n,r=1,s=0,o=0,a){const u=n.bbox;let c,d;if(u&&(c=u[2]!==u[0]&&u[3]!==u[1]&&f(this,Kp).get(n),c!==!1&&(d=[0,0,0,0],Je.axialAlignedBoundingBox(u,n.fontMatrix,d),(r!==1||s!==0||o!==0)&&Je.scaleMinMax([r,0,0,-r,s,o],d),c)))return this.recordBBox(e,t,d[0],d[2],d[1],d[3]);if(!a)return this.recordFullPageBBox(e);const m=a();return u&&d&&c===void 0&&(c=d[0]<=s-m.actualBoundingBoxLeft&&d[2]>=s+m.actualBoundingBoxRight&&d[1]<=o-m.actualBoundingBoxAscent&&d[3]>=o+m.actualBoundingBoxDescent,f(this,Kp).set(n,c),c)?this.recordBBox(e,t,d[0],d[2],d[1],d[3]):this.recordBBox(e,t,s-m.actualBoundingBoxLeft,s+m.actualBoundingBoxRight,o-m.actualBoundingBoxAscent,o+m.actualBoundingBoxDescent)}recordFullPageBBox(e){return f(this,en)[0]=Math.max(0,f(this,Qt)[0]),f(this,en)[1]=Math.max(0,f(this,Qt)[1]),f(this,en)[2]=Math.min(f(this,nc),f(this,Qt)[2]),f(this,en)[3]=Math.min(f(this,rc),f(this,Qt)[3]),this}getSimpleIndex(e){return f(this,es)[e]}recordDependencies(e,t){const n=f(this,ts),r=f(this,es),s=f(this,fi);for(const o of t)o in f(this,es)?n.add(r[o]):o in s&&s[o].forEach(n.add,n);return this}copyDependenciesFromIncrementalOperation(e,t){const n=f(this,tc),r=f(this,ts);for(const s of f(this,fi)[t])n.get(s).dependencies.forEach(r.add,r.add(s));return this}recordNamedDependency(e,t){return f(this,Wp).has(t)&&f(this,ts).add(f(this,Wp).get(t)),this}recordOperation(e,t=!1){this.recordDependencies(e,[Qf]);const n=new Set(f(this,ts)),r=f(this,oa).concat(f(this,Gp)),s=f(this,yl)===e?{minX:f(this,en)[0],minY:f(this,en)[1],maxX:f(this,en)[2],maxY:f(this,en)[3]}:null;return f(this,tc).set(e,{bbox:s,pairs:r,dependencies:n}),t||U(this,yl,-1),f(this,ts).clear(),this}bboxToClipBoxDropOperation(e){return f(this,yl)!==-1&&(U(this,yl,-1),f(this,Qt)[0]=Math.max(f(this,Qt)[0],f(this,en)[0]),f(this,Qt)[1]=Math.max(f(this,Qt)[1],f(this,en)[1]),f(this,Qt)[2]=Math.min(f(this,Qt)[2],f(this,en)[2]),f(this,Qt)[3]=Math.min(f(this,Qt)[3],f(this,en)[3])),f(this,ts).clear(),this}_takePendingDependencies(){const e=f(this,ts);return U(this,ts,new Set),e}_extractOperation(e){const t=f(this,tc).get(e);return f(this,tc).delete(e),t}_pushPendingDependencies(e){for(const t of e)f(this,ts).add(t)}take(){return f(this,Kp).clear(),Array.from(f(this,tc),([e,{bbox:t,pairs:n,dependencies:r}])=>(n.forEach(s=>s.forEach(r.add,r)),r.delete(e),{minX:((t==null?void 0:t.minX)??0)/f(this,nc),maxX:((t==null?void 0:t.maxX)??f(this,nc))/f(this,nc),minY:((t==null?void 0:t.minY)??0)/f(this,rc),maxY:((t==null?void 0:t.maxY)??f(this,rc))/f(this,rc),dependencies:Array.from(r).sort((s,o)=>s-o),idx:e}))}}es=new WeakMap,fi=new WeakMap,Wp=new WeakMap,oa=new WeakMap,Gp=new WeakMap,gl=new WeakMap,Qt=new WeakMap,en=new WeakMap,yl=new WeakMap,ts=new WeakMap,tc=new WeakMap,Kp=new WeakMap,nc=new WeakMap,rc=new WeakMap;var Kt,Dn,Jp,ic,Yp;const wD=class wD{constructor(e,t){z(this,Kt);z(this,Dn);z(this,Jp,0);z(this,ic);z(this,Yp,0);if(e instanceof wD)return e;U(this,Kt,e),U(this,ic,e._takePendingDependencies()),U(this,Dn,t)}save(e){return ir(this,Yp)._++,f(this,Kt).save(f(this,Dn)),this}restore(e){return f(this,Yp)>0&&(f(this,Kt).restore(f(this,Dn)),ir(this,Yp)._--),this}recordOpenMarker(e){return ir(this,Jp)._++,this}getOpenMarker(){return f(this,Jp)>0?f(this,Dn):f(this,Kt).getOpenMarker()}recordCloseMarker(e){return ir(this,Jp)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return f(this,Kt).pushBaseTransform(e),this}popBaseTransform(){return f(this,Kt).popBaseTransform(),this}recordSimpleData(e,t){return f(this,Kt).recordSimpleData(e,f(this,Dn)),this}recordIncrementalData(e,t){return f(this,Kt).recordIncrementalData(e,f(this,Dn)),this}resetIncrementalData(e,t){return f(this,Kt).resetIncrementalData(e,f(this,Dn)),this}recordNamedData(e,t){return this}recordFutureForcedDependency(e,t){return f(this,Kt).recordFutureForcedDependency(e,f(this,Dn)),this}inheritSimpleDataAsFutureForcedDependencies(e){return f(this,Kt).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return f(this,Kt).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return f(this,Kt).hasPendingBBox||f(this,Kt).resetBBox(f(this,Dn)),this}get hasPendingBBox(){return f(this,Kt).hasPendingBBox}recordClipBox(e,t,n,r,s,o){return f(this,Kt).recordClipBox(f(this,Dn),t,n,r,s,o),this}recordBBox(e,t,n,r,s,o){return f(this,Kt).recordBBox(f(this,Dn),t,n,r,s,o),this}recordCharacterBBox(e,t,n,r,s,o,a){return f(this,Kt).recordCharacterBBox(f(this,Dn),t,n,r,s,o,a),this}recordFullPageBBox(e){return f(this,Kt).recordFullPageBBox(f(this,Dn)),this}getSimpleIndex(e){return f(this,Kt).getSimpleIndex(e)}recordDependencies(e,t){return f(this,Kt).recordDependencies(f(this,Dn),t),this}copyDependenciesFromIncrementalOperation(e,t){return f(this,Kt).copyDependenciesFromIncrementalOperation(f(this,Dn),t),this}recordNamedDependency(e,t){return f(this,Kt).recordNamedDependency(f(this,Dn),t),this}recordOperation(e){f(this,Kt).recordOperation(f(this,Dn),!0);const t=f(this,Kt)._extractOperation(f(this,Dn));for(const n of t.dependencies)f(this,ic).add(n);return f(this,ic).delete(f(this,Dn)),f(this,ic).delete(null),this}bboxToClipBoxDropOperation(e){return f(this,Kt).bboxToClipBoxDropOperation(f(this,Dn)),this}recordNestedDependencies(){f(this,Kt)._pushPendingDependencies(f(this,ic))}take(){throw new Error("Unreachable")}};Kt=new WeakMap,Dn=new WeakMap,Jp=new WeakMap,ic=new WeakMap,Yp=new WeakMap;let p1=wD;const Ls={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation"],transform:["transform"],transformAndFill:["transform","fillColor"]},qr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function PS(i,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,n),i.clip(r)}class hD{isModifyingCurrentTransform(){return!1}getPattern(){rn("Abstract method `getPattern` called.")}}class wZ extends hD{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,r){let s;if(r===qr.STROKE||r===qr.FILL){const o=t.current.getClippedPathBoundingBox(r,kn(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,u=Math.ceil(o[3]-o[1])||1,c=t.cachedCanvases.getCanvas("pattern",a,u),d=c.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-o[0],-o[1]),n=Je.transform(n,[1,0,0,1,o[0],o[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),PS(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),s=e.createPattern(c.canvas,"no-repeat");const m=new DOMMatrix(n);s.setTransform(m)}else PS(e,this._bbox),s=this._createGradient(e);return s}}function Ax(i,e,t,n,r,s,o,a){const u=e.coords,c=e.colors,d=i.data,m=i.width*4;let p;u[t+1]>u[n+1]&&(p=t,t=n,n=p,p=s,s=o,o=p),u[n+1]>u[r+1]&&(p=n,n=r,r=p,p=o,o=a,a=p),u[t+1]>u[n+1]&&(p=t,t=n,n=p,p=s,s=o,o=p);const g=(u[t]+e.offsetX)*e.scaleX,w=(u[t+1]+e.offsetY)*e.scaleY,b=(u[n]+e.offsetX)*e.scaleX,A=(u[n+1]+e.offsetY)*e.scaleY,_=(u[r]+e.offsetX)*e.scaleX,C=(u[r+1]+e.offsetY)*e.scaleY;if(w>=C)return;const I=c[s],S=c[s+1],R=c[s+2],L=c[o],k=c[o+1],T=c[o+2],D=c[a],P=c[a+1],N=c[a+2],F=Math.round(w),M=Math.round(C);let $,Q,ie,ee,ue,Y,J,q;for(let H=F;H<=M;H++){if(H<A){const ne=H<w?0:(w-H)/(w-A);$=g-(g-b)*ne,Q=I-(I-L)*ne,ie=S-(S-k)*ne,ee=R-(R-T)*ne}else{let ne;H>C?ne=1:A===C?ne=0:ne=(A-H)/(A-C),$=b-(b-_)*ne,Q=L-(L-D)*ne,ie=k-(k-P)*ne,ee=T-(T-N)*ne}let G;H<w?G=0:H>C?G=1:G=(w-H)/(w-C),ue=g-(g-_)*G,Y=I-(I-D)*G,J=S-(S-P)*G,q=R-(R-N)*G;const le=Math.round(Math.min($,ue)),se=Math.round(Math.max($,ue));let X=m*H+le*4;for(let ne=le;ne<=se;ne++)G=($-ne)/($-ue),G<0?G=0:G>1&&(G=1),d[X++]=Q-(Q-Y)*G|0,d[X++]=ie-(ie-J)*G|0,d[X++]=ee-(ee-q)*G|0,d[X++]=255}}function _Z(i,e,t){const n=e.coords,r=e.colors;let s,o;switch(e.type){case"lattice":const a=e.verticesPerRow,u=Math.floor(n.length/a)-1,c=a-1;for(s=0;s<u;s++){let d=s*a;for(let m=0;m<c;m++,d++)Ax(i,t,n[d],n[d+1],n[d+a],r[d],r[d+1],r[d+a]),Ax(i,t,n[d+a+1],n[d+1],n[d+a],r[d+a+1],r[d+1],r[d+a])}break;case"triangles":for(s=0,o=n.length;s<o;s+=3)Ax(i,t,n[s],n[s+1],n[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}class bZ extends hD{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const a=Math.floor(this._bounds[0]),u=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-u,m=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),g=c/m,w=d/p,b={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-u,scaleX:1/g,scaleY:1/w},A=m+2*2,_=p+2*2,C=n.getCanvas("mesh",A,_),I=C.context,S=I.createImageData(m,p);if(t){const L=S.data;for(let k=0,T=L.length;k<T;k+=4)L[k]=t[0],L[k+1]=t[1],L[k+2]=t[2],L[k+3]=255}for(const L of this._figures)_Z(S,L,b);return I.putImageData(S,2,2),{canvas:C.canvas,offsetX:a-2*g,offsetY:u-2*w,scaleX:g,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,r){PS(e,this._bbox);const s=new Float32Array(2);if(r===qr.SHADING)Je.singularValueDecompose2dScale(kn(e),s);else if(this.matrix){Je.singularValueDecompose2dScale(this.matrix,s);const[a,u]=s;Je.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=a,s[1]*=u}else Je.singularValueDecompose2dScale(t.baseTransform,s);const o=this._createMeshCanvas(s,r===qr.SHADING?null:this._background,t.cachedCanvases);return r!==qr.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class AZ extends hD{getPattern(){return"hotpink"}}function EZ(i){switch(i[0]){case"RadialAxial":return new wZ(i);case"Mesh":return new bZ(i);case"Dummy":return new AZ}throw new Error(`Unknown IR type: ${i[0]}`)}const QL={COLORED:1,UNCOLORED:2},D1=class D1{constructor(e,t,n,r){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=r}createPatternCanvas(e){var ue,Y,J,q;const{bbox:t,operatorList:n,paintType:r,tilingType:s,color:o,canvasGraphicsFactory:a}=this;let{xstep:u,ystep:c}=this;u=Math.abs(u),c=Math.abs(c),Ob("TilingType: "+s);const d=t[0],m=t[1],p=t[2],g=t[3],w=p-d,b=g-m,A=new Float32Array(2);Je.singularValueDecompose2dScale(this.matrix,A);const[_,C]=A;Je.singularValueDecompose2dScale(this.baseTransform,A);const I=_*A[0],S=C*A[1];let R=w,L=b,k=!1,T=!1;const D=Math.ceil(u*I),P=Math.ceil(c*S),N=Math.ceil(w*I),F=Math.ceil(b*S);D>=N?R=u:k=!0,P>=F?L=c:T=!0;const M=this.getSizeAndScale(R,this.ctx.canvas.width,I),$=this.getSizeAndScale(L,this.ctx.canvas.height,S),Q=e.cachedCanvases.getCanvas("pattern",M.size,$.size),ie=Q.context,ee=a.createCanvasGraphics(ie);if(ee.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ee,r,o),ie.translate(-M.scale*d,-$.scale*m),ee.transform(0,M.scale,0,0,$.scale,0,0),ie.save(),(ue=ee.dependencyTracker)==null||ue.save(),this.clipBbox(ee,d,m,p,g),ee.baseTransform=kn(ee.ctx),ee.executeOperatorList(n),ee.endDrawing(),(q=(Y=ee.dependencyTracker)==null?void 0:(J=Y.restore()).recordNestedDependencies)==null||q.call(J),ie.restore(),k||T){const H=Q.canvas;k&&(R=u),T&&(L=c);const G=this.getSizeAndScale(R,this.ctx.canvas.width,I),le=this.getSizeAndScale(L,this.ctx.canvas.height,S),se=G.size,X=le.size,ne=e.cachedCanvases.getCanvas("pattern-workaround",se,X),te=ne.context,ae=k?Math.floor(w/u):0,de=T?Math.floor(b/c):0;for(let ye=0;ye<=ae;ye++)for(let xe=0;xe<=de;xe++)te.drawImage(H,se*ye,X*xe,se,X,0,0,se,X);return{canvas:ne.canvas,scaleX:G.scale,scaleY:le.scale,offsetX:d,offsetY:m}}return{canvas:Q.canvas,scaleX:M.scale,scaleY:$.scale,offsetX:d,offsetY:m}}getSizeAndScale(e,t,n){const r=Math.max(D1.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*n);return s>=r?s=r:n=s/e,{scale:n,size:s}}clipBbox(e,t,n,r,s){const o=r-t,a=s-n;e.ctx.rect(t,n,o,a),Je.axialAlignedBoundingBox([t,n,r,s],kn(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const r=e.ctx,s=e.current;switch(t){case QL.COLORED:const{fillStyle:o,strokeStyle:a}=this.ctx;r.fillStyle=s.fillColor=o,r.strokeStyle=s.strokeColor=a;break;case QL.UNCOLORED:r.fillStyle=r.strokeStyle=n,s.fillColor=s.strokeColor=n;break;default:throw new UQ(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,r){let s=n;r!==qr.SHADING&&(s=Je.transform(s,t.baseTransform),this.matrix&&(s=Je.transform(s,this.matrix)));const o=this.createPatternCanvas(t);let a=new DOMMatrix(s);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const u=e.createPattern(o.canvas,"repeat");return u.setTransform(a),u}};re(D1,"MAX_PATTERN_SIZE",3e3);let NS=D1;function CZ({src:i,srcPos:e=0,dest:t,width:n,height:r,nonBlackColor:s=4294967295,inverseDecode:o=!1}){const a=$r.isLittleEndian?4278190080:255,[u,c]=o?[s,a]:[a,s],d=n>>3,m=n&7,p=i.length;t=new Uint32Array(t.buffer);let g=0;for(let w=0;w<r;w++){for(const A=e+d;e<A;e++){const _=e<p?i[e]:255;t[g++]=_&128?c:u,t[g++]=_&64?c:u,t[g++]=_&32?c:u,t[g++]=_&16?c:u,t[g++]=_&8?c:u,t[g++]=_&4?c:u,t[g++]=_&2?c:u,t[g++]=_&1?c:u}if(m===0)continue;const b=e<p?i[e++]:255;for(let A=0;A<m;A++)t[g++]=b&1<<7-A?c:u}return{srcPos:e,destPos:g}}const ZL=16,eF=100,xZ=15,tF=10,ji=16,Ex=new DOMMatrix,ms=new Float32Array(2),dp=new Float32Array([1/0,1/0,-1/0,-1/0]);function SZ(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},i.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},i.transform=function(t,n,r,s,o,a){e.transform(t,n,r,s,o,a),this.__originalTransform(t,n,r,s,o,a)},i.setTransform=function(t,n,r,s,o,a){e.setTransform(t,n,r,s,o,a),this.__originalSetTransform(t,n,r,s,o,a)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(t){e.rotate(t),this.__originalRotate(t)},i.clip=function(t){e.clip(t),this.__originalClip(t)},i.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},i.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},i.bezierCurveTo=function(t,n,r,s,o,a){e.bezierCurveTo(t,n,r,s,o,a),this.__originalBezierCurveTo(t,n,r,s,o,a)},i.rect=function(t,n,r,s){e.rect(t,n,r,s),this.__originalRect(t,n,r,s)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class TZ{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,n)):(r=this.canvasFactory.create(t,n),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function qw(i,e,t,n,r,s,o,a,u,c){const[d,m,p,g,w,b]=kn(i);if(m===0&&p===0){const C=o*d+w,I=Math.round(C),S=a*g+b,R=Math.round(S),L=(o+u)*d+w,k=Math.abs(Math.round(L)-I)||1,T=(a+c)*g+b,D=Math.abs(Math.round(T)-R)||1;return i.setTransform(Math.sign(d),0,0,Math.sign(g),I,R),i.drawImage(e,t,n,r,s,0,0,k,D),i.setTransform(d,m,p,g,w,b),[k,D]}if(d===0&&g===0){const C=a*p+w,I=Math.round(C),S=o*m+b,R=Math.round(S),L=(a+c)*p+w,k=Math.abs(Math.round(L)-I)||1,T=(o+u)*m+b,D=Math.abs(Math.round(T)-R)||1;return i.setTransform(0,Math.sign(m),Math.sign(p),0,I,R),i.drawImage(e,t,n,r,s,0,0,D,k),i.setTransform(d,m,p,g,w,b),[D,k]}i.drawImage(e,t,n,r,s,o,a,u,c);const A=Math.hypot(d,m),_=Math.hypot(p,g);return[A*u,_*c]}class nF{constructor(e,t,n){re(this,"alphaIsShape",!1);re(this,"fontSize",0);re(this,"fontSizeScale",1);re(this,"textMatrix",null);re(this,"textMatrixScale",1);re(this,"fontMatrix",aS);re(this,"leading",0);re(this,"x",0);re(this,"y",0);re(this,"lineX",0);re(this,"lineY",0);re(this,"charSpacing",0);re(this,"wordSpacing",0);re(this,"textHScale",1);re(this,"textRenderingMode",Pr.FILL);re(this,"textRise",0);re(this,"fillColor","#000000");re(this,"strokeColor","#000000");re(this,"patternFill",!1);re(this,"patternStroke",!1);re(this,"fillAlpha",1);re(this,"strokeAlpha",1);re(this,"lineWidth",1);re(this,"activeSMask",null);re(this,"transferMaps","none");n==null||n(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=dp.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=qr.FILL,t=null){const n=this.minMax.slice();if(e===qr.STROKE){t||rn("Stroke bounding box must include transform."),Je.singularValueDecompose2dScale(t,ms);const r=ms[0]*this.lineWidth/2,s=ms[1]*this.lineWidth/2;n[0]-=r,n[1]-=s,n[2]+=r,n[3]+=s}return n}updateClipFromPath(){const e=Je.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(dp,0)}getClippedPathBoundingBox(e=qr.FILL,t=null){return Je.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function rF(i,e){if(e instanceof ImageData){i.putImageData(e,0,0);return}const t=e.height,n=e.width,r=t%ji,s=(t-r)/ji,o=r===0?s:s+1,a=i.createImageData(n,ji);let u=0,c;const d=e.data,m=a.data;let p,g,w,b;if(e.kind===a_.GRAYSCALE_1BPP){const A=d.byteLength,_=new Uint32Array(m.buffer,0,m.byteLength>>2),C=_.length,I=n+7>>3,S=4294967295,R=$r.isLittleEndian?4278190080:255;for(p=0;p<o;p++){for(w=p<s?ji:r,c=0,g=0;g<w;g++){const L=A-u;let k=0;const T=L>I?n:L*8-7,D=T&-8;let P=0,N=0;for(;k<D;k+=8)N=d[u++],_[c++]=N&128?S:R,_[c++]=N&64?S:R,_[c++]=N&32?S:R,_[c++]=N&16?S:R,_[c++]=N&8?S:R,_[c++]=N&4?S:R,_[c++]=N&2?S:R,_[c++]=N&1?S:R;for(;k<T;k++)P===0&&(N=d[u++],P=128),_[c++]=N&P?S:R,P>>=1}for(;c<C;)_[c++]=0;i.putImageData(a,0,p*ji)}}else if(e.kind===a_.RGBA_32BPP){for(g=0,b=n*ji*4,p=0;p<s;p++)m.set(d.subarray(u,u+b)),u+=b,i.putImageData(a,0,g),g+=ji;p<o&&(b=n*r*4,m.set(d.subarray(u,u+b)),i.putImageData(a,0,g))}else if(e.kind===a_.RGB_24BPP)for(w=ji,b=n*w,p=0;p<o;p++){for(p>=s&&(w=r,b=n*w),c=0,g=b;g--;)m[c++]=d[u++],m[c++]=d[u++],m[c++]=d[u++],m[c++]=255;i.putImageData(a,0,p*ji)}else throw new Error(`bad image kind: ${e.kind}`)}function iF(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,r=t%ji,s=(t-r)/ji,o=r===0?s:s+1,a=i.createImageData(n,ji);let u=0;const c=e.data,d=a.data;for(let m=0;m<o;m++){const p=m<s?ji:r;({srcPos:u}=CZ({src:c,srcPos:u,dest:d,width:n,height:p,nonBlackColor:0})),i.putImageData(a,0,m*ji)}}function Xg(i,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)i[n]!==void 0&&(e[n]=i[n]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function Uw(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}function sF(i,e){if(e)return!0;Je.singularValueDecompose2dScale(i,ms);const t=Math.fround(Da.pixelRatio*Gc.PDF_TO_CSS_UNITS);return ms[0]<=t&&ms[1]<=t}const IZ=["butt","round","square"],DZ=["miter","round","bevel"],kZ={},oF={};var Oo,OS,LS,FS;const _D=class _D{constructor(e,t,n,r,s,{optionalContentConfig:o,markedContentStack:a=null},u,c,d){z(this,Oo);this.ctx=e,this.current=new nF(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new TZ(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=d??null}getObject(e,t,n=null){var r;return typeof t=="string"?((r=this.dependencyTracker)==null||r.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:r=null}){const s=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=a,n){const u=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=u.canvas,this.ctx=u.context,this.ctx.save(),this.ctx.transform(...kn(this.compositeCtx))}this.ctx.save(),Uw(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=kn(this.ctx)}executeOperatorList(e,t,n,r,s){var _;const o=e.argsArray,a=e.fnArray;let u=t||0;const c=o.length;if(c===u)return u;const d=c-u>tF&&typeof n=="function",m=d?Date.now()+xZ:0;let p=0;const g=this.commonObjs,w=this.objs;let b,A;for(;;){if(r!==void 0&&u===r.nextBreakPoint)return r.breakIt(u,n),u;if(!s||s.has(u))if(b=a[u],A=o[u]??null,b!==rv.dependency)A===null?this[b](u):this[b](u,...A);else for(const C of A){(_=this.dependencyTracker)==null||_.recordNamedData(C,u);const I=C.startsWith("g_")?g:w;if(!I.has(C))return I.get(C,n),u}if(u++,u===c)return u;if(d&&++p>tF){if(Date.now()>m)return n(),u;p=0}}}endDrawing(){W(this,Oo,OS).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),W(this,Oo,LS).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,r=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=n,u=r,c="prescale1",d,m;for(;s>2&&a>1||o>2&&u>1;){let p=a,g=u;s>2&&a>1&&(p=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),s/=a/p),o>2&&u>1&&(g=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u)/2,o/=u/g),d=this.cachedCanvases.getCanvas(c,p,g),m=d.context,m.clearRect(0,0,p,g),m.drawImage(e,0,0,a,u,0,0,p,g),e=d.canvas,a=p,u=g,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:u}}_createMaskCanvas(e,t){var P,N;const n=this.ctx,{width:r,height:s}=t,o=this.current.fillColor,a=this.current.patternFill,u=kn(n);let c,d,m,p;if((t.bitmap||t.data)&&t.count>1){const F=t.bitmap||t.data.buffer;d=JSON.stringify(a?u:[u.slice(0,4),o]),c=this._cachedBitmapsMap.get(F),c||(c=new Map,this._cachedBitmapsMap.set(F,c));const M=c.get(d);if(M&&!a){const $=Math.round(Math.min(u[0],u[2])+u[4]),Q=Math.round(Math.min(u[1],u[3])+u[5]);return(P=this.dependencyTracker)==null||P.recordDependencies(e,Ls.transformAndFill),{canvas:M,offsetX:$,offsetY:Q}}m=M}m||(p=this.cachedCanvases.getCanvas("maskCanvas",r,s),iF(p.context,t));let g=Je.transform(u,[1/r,0,0,-1/s,0,0]);g=Je.transform(g,[1,0,0,1,0,-s]);const w=dp.slice();Je.axialAlignedBoundingBox([0,0,r,s],g,w);const[b,A,_,C]=w,I=Math.round(_-b)||1,S=Math.round(C-A)||1,R=this.cachedCanvases.getCanvas("fillCanvas",I,S),L=R.context,k=b,T=A;L.translate(-k,-T),L.transform(...g),m||(m=this._scaleImage(p.canvas,Wo(L)),m=m.img,c&&a&&c.set(d,m)),L.imageSmoothingEnabled=sF(kn(L),t.interpolate),qw(L,m,0,0,m.width,m.height,0,0,r,s),L.globalCompositeOperation="source-in";const D=Je.transform(Wo(L),[1,0,0,1,-k,-T]);return L.fillStyle=a?o.getPattern(n,this,D,qr.FILL):o,L.fillRect(0,0,r,s),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(d,R.canvas)),(N=this.dependencyTracker)==null||N.recordDependencies(e,Ls.transformAndFill),{canvas:R.canvas,offsetX:Math.round(k),offsetY:Math.round(T)}}setLineWidth(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineCap",e),this.ctx.lineCap=IZ[t]}setLineJoin(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineJoin",e),this.ctx.lineJoin=DZ[t]}setMiterLimit(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("dash",e);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var n,r,s,o,a;for(const[u,c]of t)switch(u){case"LW":this.setLineWidth(e,c);break;case"LC":this.setLineCap(e,c);break;case"LJ":this.setLineJoin(e,c);break;case"ML":this.setMiterLimit(e,c);break;case"D":this.setDash(e,c[0],c[1]);break;case"RI":this.setRenderingIntent(e,c);break;case"FL":this.setFlatness(e,c);break;case"Font":this.setFont(e,c[0],c[1]);break;case"CA":(n=this.dependencyTracker)==null||n.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=c;break;case"ca":(r=this.dependencyTracker)==null||r.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=c;break;case"BM":(s=this.dependencyTracker)==null||s.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=c;break;case"SMask":(o=this.dependencyTracker)==null||o.recordSimpleData("SMask",e),this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(a=this.dependencyTracker)==null||a.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(r,t,n);this.suspendedCtx=this.ctx;const o=this.ctx=s.context;o.setTransform(this.suspendedCtx.getTransform()),Xg(this.suspendedCtx,o),SZ(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Xg(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,r){const s=r[0],o=r[1],a=r[2]-s,u=r[3]-o;a===0||u===0||(this.genericComposeSMask(t.context,n,a,u,t.subtype,t.backdrop,t.transferMap,s,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,r,s,o,a,u,c,d,m){let p=e.canvas,g=u-d,w=c-m;if(o)if(g<0||w<0||g+n>p.width||w+r>p.height){const A=this.cachedCanvases.getCanvas("maskExtension",n,r),_=A.context;_.drawImage(p,-g,-w),_.globalCompositeOperation="destination-atop",_.fillStyle=o,_.fillRect(0,0,n,r),_.globalCompositeOperation="source-over",p=A.canvas,g=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(g,w,n,r),e.clip(A),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(g,w,n,r),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const b=new Path2D;b.rect(u,c,n,r),t.clip(b),t.globalCompositeOperation="destination-in",t.drawImage(p,g,w,n,r,u,c,n,r),t.restore()}save(e){var n;this.inSMaskMode&&Xg(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(n=this.dependencyTracker)==null||n.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Xg(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,r,s,o,a){var u;(u=this.dependencyTracker)==null||u.recordIncrementalData("transform",e),this.ctx.transform(t,n,r,s,o,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,r){let[s]=n;if(!r){s||(s=n[0]=new Path2D),this[t](e,s);return}if(this.dependencyTracker!==null){const o=t===rv.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,r[0]-o,r[2]+o,r[1]-o,r[3]+o).recordDependencies(e,["transform"])}if(!(s instanceof Path2D)){const o=n[0]=new Path2D;for(let a=0,u=s.length;a<u;)switch(s[a++]){case Fw.moveTo:o.moveTo(s[a++],s[a++]);break;case Fw.lineTo:o.lineTo(s[a++],s[a++]);break;case Fw.curveTo:o.bezierCurveTo(s[a++],s[a++],s[a++],s[a++],s[a++],s[a++]);break;case Fw.closePath:o.closePath();break;default:Et(`Unrecognized drawing path operator: ${s[a-1]}`);break}s=o}Je.axialAlignedBoundingBox(r,kn(this.ctx),this.current.minMax),this[t](e,s),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){var o;const r=this.ctx,s=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const a=s.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=s.getPattern(r,this,Wo(r),qr.STROKE),a){const u=new Path2D;u.addPath(t,r.getTransform().invertSelf().multiplySelf(a)),t=u}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);(o=this.dependencyTracker)==null||o.recordDependencies(e,Ls.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(qr.STROKE,kn(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){var c,d,m;const r=this.ctx,s=this.current.fillColor,o=this.current.patternFill;let a=!1;if(o){const p=s.isModifyingCurrentTransform()?r.getTransform():null;if((c=this.dependencyTracker)==null||c.save(e),r.save(),r.fillStyle=s.getPattern(r,this,Wo(r),qr.FILL),p){const g=new Path2D;g.addPath(t,r.getTransform().invertSelf().multiplySelf(p)),t=g}a=!0}const u=this.current.getClippedPathBoundingBox();this.contentVisible&&u!==null&&(this.pendingEOFill?(r.fill(t,"evenodd"),this.pendingEOFill=!1):r.fill(t)),(d=this.dependencyTracker)==null||d.recordDependencies(e,Ls.fill),a&&(r.restore(),(m=this.dependencyTracker)==null||m.restore(e)),n&&this.consumePath(e,t,u)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var n;this.ctx.fill(t),(n=this.dependencyTracker)==null||n.recordDependencies(e,Ls.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=kZ}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=oF}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;t!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",e),r.recordCloseMarker(e)}if(t!==void 0){const r=new Path2D,s=n.getTransform().invertSelf();for(const{transform:o,x:a,y:u,fontSize:c,path:d}of t)d&&r.addPath(d,new DOMMatrix(o).preMultiplySelf(s).translate(a,u).scale(c,-c));n.clip(r)}delete this.pendingTextPaths}setCharSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){var m,p;(m=this.dependencyTracker)==null||m.recordSimpleData("font",e).recordNamedDependency(e,t);const r=this.commonObjs.get(t),s=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=r.fontMatrix||aS,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Et("Invalid font matrix for font "+t),n<0?(n=-n,s.fontDirection=-1):s.fontDirection=1,this.current.font=r,this.current.fontSize=n,r.isType3Font)return;const o=r.loadedName||"sans-serif",a=((p=r.systemFontInfo)==null?void 0:p.css)||`"${o}", ${r.fallbackName}`;let u="normal";r.black?u="900":r.bold&&(u="bold");const c=r.italic?"italic":"normal";let d=n;n<ZL?d=ZL:n>eF&&(d=eF),this.current.fontSizeScale=n/d,this.ctx.font=`${c} ${u} ${d}px ${a}`}setTextRenderingMode(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){var r;(r=this.dependencyTracker)==null||r.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,n,r,s,o){var _,C,I,S;const a=this.ctx,u=this.current,c=u.font,d=u.textRenderingMode,m=u.fontSize/u.fontSizeScale,p=d&Pr.FILL_STROKE_MASK,g=!!(d&Pr.ADD_TO_PATH_FLAG),w=u.patternFill&&!c.missingFile,b=u.patternStroke&&!c.missingFile;let A;if((c.disableFontFace||g||w||b)&&!c.missingFile&&(A=c.getPathGenerator(this.commonObjs,t)),A&&(c.disableFontFace||w||b)){a.save(),a.translate(n,r),a.scale(m,-m),(_=this.dependencyTracker)==null||_.recordCharacterBBox(e,a,c);let R;if(p===Pr.FILL||p===Pr.FILL_STROKE)if(s){R=a.getTransform(),a.setTransform(...s);const L=W(this,Oo,FS).call(this,A,R,s);a.fill(L)}else a.fill(A);if(p===Pr.STROKE||p===Pr.FILL_STROKE)if(o){R||(R=a.getTransform()),a.setTransform(...o);const{a:L,b:k,c:T,d:D}=R,P=Je.inverseTransform(o),N=Je.transform([L,k,T,D,0,0],P);Je.singularValueDecompose2dScale(N,ms),a.lineWidth*=Math.max(ms[0],ms[1])/m,a.stroke(W(this,Oo,FS).call(this,A,R,o))}else a.lineWidth/=m,a.stroke(A);a.restore()}else(p===Pr.FILL||p===Pr.FILL_STROKE)&&(a.fillText(t,n,r),(C=this.dependencyTracker)==null||C.recordCharacterBBox(e,a,c,m,n,r,()=>a.measureText(t))),(p===Pr.STROKE||p===Pr.FILL_STROKE)&&(this.dependencyTracker&&((I=this.dependencyTracker)==null||I.recordCharacterBBox(e,a,c,m,n,r,()=>a.measureText(t)).recordDependencies(e,Ls.stroke)),a.strokeText(t,n,r));g&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:kn(a),x:n,y:r,fontSize:m,path:A}),(S=this.dependencyTracker)==null||S.recordCharacterBBox(e,a,c,m,n,r))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){n=!0;break}return Rt(this,"isFontSubpixelAAEnabled",n)}showText(e,t){var T,D,P,N;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Ls.showText).copyDependenciesFromIncrementalOperation(e,"sameLineText").resetBBox(e),this.current.textRenderingMode&Pr.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,r=n.font;if(r.isType3Font){this.showType3Text(e,t),(T=this.dependencyTracker)==null||T.recordOperation(e).recordIncrementalData("sameLineText",e);return}const s=n.fontSize;if(s===0){(D=this.dependencyTracker)==null||D.recordOperation(e);return}const o=this.ctx,a=n.fontSizeScale,u=n.charSpacing,c=n.wordSpacing,d=n.fontDirection,m=n.textHScale*d,p=t.length,g=r.vertical,w=g?1:-1,b=r.defaultVMetrics,A=s*n.fontMatrix[0],_=n.textRenderingMode===Pr.FILL&&!r.disableFontFace&&!n.patternFill;o.save(),n.textMatrix&&o.transform(...n.textMatrix),o.translate(n.x,n.y+n.textRise),d>0?o.scale(m,-1):o.scale(m,1);let C,I;if(n.patternFill){o.save();const F=n.fillColor.getPattern(o,this,Wo(o),qr.FILL);C=kn(o),o.restore(),o.fillStyle=F}if(n.patternStroke){o.save();const F=n.strokeColor.getPattern(o,this,Wo(o),qr.STROKE);I=kn(o),o.restore(),o.strokeStyle=F}let S=n.lineWidth;const R=n.textMatrixScale;if(R===0||S===0){const F=n.textRenderingMode&Pr.FILL_STROKE_MASK;(F===Pr.STROKE||F===Pr.FILL_STROKE)&&(S=this.getSinglePixelWidth())}else S/=R;if(a!==1&&(o.scale(a,a),S/=a),o.lineWidth=S,r.isInvalidPDFjsFont){const F=[];let M=0;for(const Q of t)F.push(Q.unicode),M+=Q.width;const $=F.join("");if(o.fillText($,0,0),this.dependencyTracker!==null){const Q=o.measureText($);this.dependencyTracker.recordBBox(e,this.ctx,-Q.actualBoundingBoxLeft,Q.actualBoundingBoxRight,-Q.actualBoundingBoxAscent,Q.actualBoundingBoxDescent).recordOperation(e).recordIncrementalData("sameLineText",e)}n.x+=M*A*m,o.restore(),this.compose();return}let L=0,k;for(k=0;k<p;++k){const F=t[k];if(typeof F=="number"){L+=w*F*s/1e3;continue}let M=!1;const $=(F.isSpace?c:0)+u,Q=F.fontChar,ie=F.accent;let ee,ue,Y=F.width;if(g){const H=F.vmetric||b,G=-(F.vmetric?H[1]:Y*.5)*A,le=H[2]*A;Y=H?-H[0]:Y,ee=G/a,ue=(L+le)/a}else ee=L/a,ue=0;let J;if(r.remeasure&&Y>0){J=o.measureText(Q);const H=J.width*1e3/s*a;if(Y<H&&this.isFontSubpixelAAEnabled){const G=Y/H;M=!0,o.save(),o.scale(G,1),ee/=G}else Y!==H&&(ee+=(Y-H)/2e3*s/a)}if(this.contentVisible&&(F.isInFont||r.missingFile)){if(_&&!ie)o.fillText(Q,ee,ue),(P=this.dependencyTracker)==null||P.recordCharacterBBox(e,o,J?{bbox:null}:r,s/a,ee,ue,()=>J??o.measureText(Q));else if(this.paintChar(e,Q,ee,ue,C,I),ie){const H=ee+s*ie.offset.x/a,G=ue-s*ie.offset.y/a;this.paintChar(e,ie.fontChar,H,G,C,I)}}const q=g?Y*A-$*d:Y*A+$*d;L+=q,M&&o.restore()}g?n.y-=L:n.x+=L*m,o.restore(),this.compose(),(N=this.dependencyTracker)==null||N.recordOperation(e).recordIncrementalData("sameLineText",e)}showType3Text(e,t){const n=this.ctx,r=this.current,s=r.font,o=r.fontSize,a=r.fontDirection,u=s.vertical?1:-1,c=r.charSpacing,d=r.wordSpacing,m=r.textHScale*a,p=r.fontMatrix||aS,g=t.length,w=r.textRenderingMode===Pr.INVISIBLE;let b,A,_,C;if(w||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),r.textMatrix&&n.transform(...r.textMatrix),n.translate(r.x,r.y+r.textRise),n.scale(m,a);const I=this.dependencyTracker;for(this.dependencyTracker=I?new p1(I,e):null,b=0;b<g;++b){if(A=t[b],typeof A=="number"){C=u*A*o/1e3,this.ctx.translate(C,0),r.x+=C*m;continue}const S=(A.isSpace?d:0)+c,R=s.charProcOperatorList[A.operatorListId];R?this.contentVisible&&(this.save(),n.scale(o,o),n.transform(...p),this.executeOperatorList(R),this.restore()):Et(`Type3 character "${A.operatorListId}" is not available.`);const L=[A.width,0];Je.applyTransform(L,p),_=L[0]*o+S,n.translate(_,0),r.x+=_*m}n.restore(),I&&(this.dependencyTracker.recordNestedDependencies(),this.dependencyTracker=I)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,r,s,o,a){var c;const u=new Path2D;u.rect(r,s,o-r,a-s),this.ctx.clip(u),(c=this.dependencyTracker)==null||c.recordBBox(e,this.ctx,r,o,s,a).recordClipBox(e,this.ctx,r,o,s,a),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const r=this.baseTransform||kn(this.ctx),s={createCanvasGraphics:o=>new _D(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new p1(this.dependencyTracker,e):null)};n=new NS(t,this.ctx,s,r)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=EZ(this.getObject(e,t)),this.cachedPatterns.set(t,r)),n&&(r.matrix=n),r}shadingFill(e,t){var o;if(!this.contentVisible)return;const n=this.ctx;this.save(e);const r=this._getPattern(e,t);n.fillStyle=r.getPattern(n,this,Wo(n),qr.SHADING);const s=Wo(n);if(s){const{width:a,height:u}=n.canvas,c=dp.slice();Je.axialAlignedBoundingBox([0,0,a,u],s,c);const[d,m,p,g]=c;this.ctx.fillRect(d,m,p-d,g-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(o=this.dependencyTracker)==null||o.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Ls.transform).recordDependencies(e,Ls.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){rn("Should not call beginInlineImage")}beginImageData(){rn("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){var r;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=kn(this.ctx),n)){Je.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[s,o,a,u]=n,c=new Path2D;c.rect(s,o,a-s,u-o),this.ctx.clip(c),(r=this.dependencyTracker)==null||r.recordClipBox(e,this.ctx,s,a,o,u),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var I;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||Ob("TODO: Support non-isolated groups."),t.knockout&&Et("Knockout groups not supported.");const r=kn(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=dp.slice();Je.axialAlignedBoundingBox(t.bbox,kn(n),s);const o=[0,0,n.canvas.width,n.canvas.height];s=Je.intersect(s,o)||[0,0,0,0];const a=Math.floor(s[0]),u=Math.floor(s[1]),c=Math.max(Math.ceil(s[2])-a,1),d=Math.max(Math.ceil(s[3])-u,1);this.current.startNewPathAndClipBox([0,0,c,d]);let m="groupAt"+this.groupLevel;t.smask&&(m+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(m,c,d),g=p.context;g.translate(-a,-u),g.transform(...r);let w=new Path2D;const[b,A,_,C]=t.bbox;if(w.rect(b,A,_-b,C-A),t.matrix){const S=new Path2D;S.addPath(w,new DOMMatrix(t.matrix)),w=S}g.clip(w),t.smask&&this.smaskStack.push({canvas:p.canvas,context:g,offsetX:a,offsetY:u,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(a,u),n.save()),Xg(n,g),this.ctx=g,(I=this.dependencyTracker)==null||I.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){var s;if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,(s=this.dependencyTracker)==null||s.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=kn(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const a=dp.slice();Je.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],o,a),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,n,r,s,o){if(W(this,Oo,OS).call(this),Uw(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const a=n[2]-n[0],u=n[3]-n[1];if(o&&this.annotationCanvasMap){r=r.slice(),r[4]-=n[0],r[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=a,n[3]=u,Je.singularValueDecompose2dScale(kn(this.ctx),ms);const{viewportScale:c}=this,d=Math.ceil(a*this.outputScaleX*c),m=Math.ceil(u*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(d,m);const{canvas:p,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(ms[0],0,0,-ms[1],0,u*ms[1]),Uw(this.ctx)}else{Uw(this.ctx),this.endPath(e);const c=new Path2D;c.rect(n[0],n[1],a,u),this.ctx.clip(c)}}this.current=new nF(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...r),this.transform(e,...s)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),W(this,Oo,LS).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var a;if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const r=this.ctx,s=this._createMaskCanvas(e,t),o=s.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,s.offsetX,s.offsetY),(a=this.dependencyTracker)==null||a.resetBBox(e).recordBBox(e,this.ctx,s.offsetX,s.offsetX+o.width,s.offsetY,s.offsetY+o.height).recordOperation(e),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,r=0,s=0,o,a){var m,p,g;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const u=this.ctx;u.save();const c=kn(u);u.transform(n,r,s,o,0,0);const d=this._createMaskCanvas(e,t);u.setTransform(1,0,0,1,d.offsetX-c[4],d.offsetY-c[5]),(m=this.dependencyTracker)==null||m.resetBBox(e);for(let w=0,b=a.length;w<b;w+=2){const A=Je.transform(c,[n,r,s,o,a[w],a[w+1]]);u.drawImage(d.canvas,A[4],A[5]),(p=this.dependencyTracker)==null||p.recordBBox(e,this.ctx,A[4],A[4]+d.canvas.width,A[5],A[5]+d.canvas.height)}u.restore(),this.compose(),(g=this.dependencyTracker)==null||g.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var o,a,u;if(!this.contentVisible)return;const n=this.ctx,r=this.current.fillColor,s=this.current.patternFill;(o=this.dependencyTracker)==null||o.resetBBox(e).recordDependencies(e,Ls.transformAndFill);for(const c of t){const{data:d,width:m,height:p,transform:g}=c,w=this.cachedCanvases.getCanvas("maskCanvas",m,p),b=w.context;b.save();const A=this.getObject(e,d,c);iF(b,A),b.globalCompositeOperation="source-in",b.fillStyle=s?r.getPattern(b,this,Wo(n),qr.FILL):r,b.fillRect(0,0,m,p),b.restore(),n.save(),n.transform(...g),n.scale(1,-1),qw(n,w.canvas,0,0,m,p,0,-1,1,1),(a=this.dependencyTracker)==null||a.recordBBox(e,n,0,m,0,p),n.restore()}this.compose(),(u=this.dependencyTracker)==null||u.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){Et("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,r,s){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){Et("Dependent image isn't ready yet");return}const a=o.width,u=o.height,c=[];for(let d=0,m=s.length;d<m;d+=2)c.push({transform:[n,0,0,r,s[d],s[d+1]],x:0,y:0,w:a,h:u});this.paintInlineImageXObjectGroup(e,o,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:r}=e,s=this.cachedCanvases.getCanvas("inlineImage",n,r),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",s.canvas}paintInlineImageXObject(e,t){var c;if(!this.contentVisible)return;const n=t.width,r=t.height,s=this.ctx;this.save(e);const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none"),s.scale(1/n,-1/r);let a;if(t.bitmap)a=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)a=t;else{const m=this.cachedCanvases.getCanvas("inlineImage",n,r).context;rF(m,t),a=this.applyTransferMapsToCanvas(m)}const u=this._scaleImage(a,Wo(s));s.imageSmoothingEnabled=sF(kn(s),t.interpolate),(c=this.dependencyTracker)==null||c.resetBBox(e).recordBBox(e,s,0,n,-r,0).recordDependencies(e,Ls.imageXObject).recordOperation(e),qw(s,u.img,0,0,u.paintWidth,u.paintHeight,0,-r,n,r),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){var o,a,u;if(!this.contentVisible)return;const r=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const c=t.width,d=t.height,p=this.cachedCanvases.getCanvas("inlineImage",c,d).context;rF(p,t),s=this.applyTransferMapsToCanvas(p)}(o=this.dependencyTracker)==null||o.resetBBox(e);for(const c of n)r.save(),r.transform(...c.transform),r.scale(1,-1),qw(r,s,c.x,c.y,c.w,c.h,0,-1,1,1),(a=this.dependencyTracker)==null||a.recordBBox(e,r,0,1,-1,0),r.restore();(u=this.dependencyTracker)==null||u.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Ls.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){var n;(n=this.dependencyTracker)==null||n.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){var o,a;const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const s=this.ctx;this.pendingClip?(r||(this.pendingClip===oF?s.clip(t,"evenodd"):s.clip(t)),this.pendingClip=null,(o=this.dependencyTracker)==null||o.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(a=this.dependencyTracker)==null||a.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=kn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:r,d:s}=this.ctx.getTransform();let o,a;if(n===0&&r===0){const u=Math.abs(t),c=Math.abs(s);if(u===c)if(e===0)o=a=1/u;else{const d=u*e;o=a=d<1?1/d:1}else if(e===0)o=1/u,a=1/c;else{const d=u*e,m=c*e;o=d<1?1/d:1,a=m<1?1/m:1}}else{const u=Math.abs(t*s-n*r),c=Math.hypot(t,n),d=Math.hypot(r,s);if(e===0)o=d/u,a=c/u;else{const m=e*u;o=d>m?d/m:1,a=c>m?c/m:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:r}}=this,[s,o]=this.getScaleForStroking();if(s===o){n.lineWidth=(r||1)*s,n.stroke(e);return}const a=n.getLineDash();t&&n.save(),n.scale(s,o),Ex.a=1/s,Ex.d=1/o;const u=new Path2D;if(u.addPath(e,Ex),a.length>0){const c=Math.max(s,o);n.setLineDash(a.map(d=>d/c)),n.lineDashOffset/=c}n.lineWidth=r||1,n.stroke(u),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Oo=new WeakSet,OS=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},LS=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},FS=function(e,t,n){const r=new Path2D;return r.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),r};let bp=_D;for(const i in rv)bp.prototype[i]!==void 0&&(bp.prototype[rv[i]]=bp.prototype[i]);var Lv,Fv;class va{static get workerPort(){return f(this,Lv)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");U(this,Lv,e)}static get workerSrc(){return f(this,Fv)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");U(this,Fv,e)}}Lv=new WeakMap,Fv=new WeakMap,z(va,Lv,null),z(va,Fv,"");var Xp,Mv;class RZ{constructor({parsedData:e,rawData:t}){z(this,Xp);z(this,Mv);U(this,Xp,e),U(this,Mv,t)}getRaw(){return f(this,Mv)}get(e){return f(this,Xp).get(e)??null}[Symbol.iterator](){return f(this,Xp).entries()}}Xp=new WeakMap,Mv=new WeakMap;const ap=Symbol("INTERNAL");var Bv,jv,qv,Qp;class PZ{constructor(e,{name:t,intent:n,usage:r,rbGroups:s}){z(this,Bv,!1);z(this,jv,!1);z(this,qv,!1);z(this,Qp,!0);U(this,Bv,!!(e&ps.DISPLAY)),U(this,jv,!!(e&ps.PRINT)),this.name=t,this.intent=n,this.usage=r,this.rbGroups=s}get visible(){if(f(this,qv))return f(this,Qp);if(!f(this,Qp))return!1;const{print:e,view:t}=this.usage;return f(this,Bv)?(t==null?void 0:t.viewState)!=="OFF":f(this,jv)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==ap&&rn("Internal method `_setVisible` called."),U(this,qv,n),U(this,Qp,t)}}Bv=new WeakMap,jv=new WeakMap,qv=new WeakMap,Qp=new WeakMap;var sc,tn,Zp,em,Uv,MS;class NZ{constructor(e,t=ps.DISPLAY){z(this,Uv);z(this,sc,null);z(this,tn,new Map);z(this,Zp,null);z(this,em,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,U(this,em,e.order);for(const n of e.groups)f(this,tn).set(n.id,new PZ(t,n));if(e.baseState==="OFF")for(const n of f(this,tn).values())n._setVisible(ap,!1);for(const n of e.on)f(this,tn).get(n)._setVisible(ap,!0);for(const n of e.off)f(this,tn).get(n)._setVisible(ap,!1);U(this,Zp,this.getHash())}}isVisible(e){if(f(this,tn).size===0)return!0;if(!e)return Ob("Optional content group not defined."),!0;if(e.type==="OCG")return f(this,tn).has(e.id)?f(this,tn).get(e.id).visible:(Et(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return W(this,Uv,MS).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!f(this,tn).has(t))return Et(`Optional content group not found: ${t}`),!0;if(f(this,tn).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!f(this,tn).has(t))return Et(`Optional content group not found: ${t}`),!0;if(!f(this,tn).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!f(this,tn).has(t))return Et(`Optional content group not found: ${t}`),!0;if(!f(this,tn).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!f(this,tn).has(t))return Et(`Optional content group not found: ${t}`),!0;if(f(this,tn).get(t).visible)return!1}return!0}return Et(`Unknown optional content policy ${e.policy}.`),!0}return Et(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var s;const r=f(this,tn).get(e);if(!r){Et(`Optional content group not found: ${e}`);return}if(n&&t&&r.rbGroups.length)for(const o of r.rbGroups)for(const a of o)a!==e&&((s=f(this,tn).get(a))==null||s._setVisible(ap,!1,!0));r._setVisible(ap,!!t,!0),U(this,sc,null)}setOCGState({state:e,preserveRB:t}){let n;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":n=r;continue}const s=f(this,tn).get(r);if(s)switch(n){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!s.visible,t);break}}U(this,sc,null)}get hasInitialVisibility(){return f(this,Zp)===null||this.getHash()===f(this,Zp)}getOrder(){return f(this,tn).size?f(this,em)?f(this,em).slice():[...f(this,tn).keys()]:null}getGroup(e){return f(this,tn).get(e)||null}getHash(){if(f(this,sc)!==null)return f(this,sc);const e=new fj;for(const[t,n]of f(this,tn))e.update(`${t}:${n.visible}`);return U(this,sc,e.hexdigest())}[Symbol.iterator](){return f(this,tn).entries()}}sc=new WeakMap,tn=new WeakMap,Zp=new WeakMap,em=new WeakMap,Uv=new WeakSet,MS=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let r=1;r<t;r++){const s=e[r];let o;if(Array.isArray(s))o=W(this,Uv,MS).call(this,s);else if(f(this,tn).has(s))o=f(this,tn).get(s).visible;else return Et(`Optional content group not found: ${s}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"};class OZ{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Xn(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:s,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(s==null?void 0:s.length)>0){const u=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((u,c)=>{this._onReceiveData({begin:u,chunk:c})}),e.addProgressListener((u,c)=>{this._onProgress({loaded:u,total:c})}),e.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const r=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(n),!0)});Xn(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,r,s;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(s=(r=this._fullRequestReader)==null?void 0:r.onProgress)==null||s.call(r,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Xn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new LZ(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new FZ(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class LZ{constructor(e,t,n=!1,r=null){this._stream=e,this._done=n||!1,this._filename=lD(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class FZ{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function MZ(i){let e=!0,t=n("filename\\*","i").exec(i);if(t){t=t[1];let d=a(t);return d=unescape(d),d=u(d),d=c(d),s(d)}if(t=o(i),t){const d=c(t);return s(d)}if(t=n("filename","i").exec(i),t){t=t[1];let d=a(t);return d=c(d),s(d)}function n(d,m){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function r(d,m){if(d){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const p=new TextDecoder(d,{fatal:!0}),g=n2(m);m=p.decode(g),e=!1}catch{}}return m}function s(d){return e&&/[\x80-\xff]/.test(d)&&(d=r("utf-8",d),e&&(d=r("iso-8859-1",d))),d}function o(d){const m=[];let p;const g=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=g.exec(d))!==null;){let[,b,A,_]=p;if(b=parseInt(b,10),b in m){if(b===0)break;continue}m[b]=[A,_]}const w=[];for(let b=0;b<m.length&&b in m;++b){let[A,_]=m[b];_=a(_),A&&(_=unescape(_),b===0&&(_=u(_))),w.push(_)}return w.join("")}function a(d){if(d.startsWith('"')){const m=d.slice(1).split('\\"');for(let p=0;p<m.length;++p){const g=m[p].indexOf('"');g!==-1&&(m[p]=m[p].slice(0,g),m.length=p+1),m[p]=m[p].replaceAll(/\\(.)/g,"$1")}d=m.join('"')}return d}function u(d){const m=d.indexOf("'");if(m===-1)return d;const p=d.slice(0,m),w=d.slice(m+1).replace(/^[^']*'/,"");return r(p,w)}function c(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,p,g,w){if(g==="q"||g==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,A){return String.fromCharCode(parseInt(A,16))}),r(p,w);try{w=atob(w)}catch{}return r(p,w)})}return""}function xj(i,e){const t=new Headers;if(!i||!e||typeof e!="object")return t;for(const n in e){const r=e[n];r!==void 0&&t.append(n,r)}return t}function Mb(i){var e;return((e=URL.parse(i))==null?void 0:e.origin)??null}function Sj({responseHeaders:i,isHttp:e,rangeChunkSize:t,disableRange:n}){const r={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(i.get("Content-Length"),10);return!Number.isInteger(s)||(r.suggestedLength=s,s<=2*t)||n||!e||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function Tj(i){const e=i.get("Content-Disposition");if(e){let t=MZ(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(lD(t))return t}return null}function o2(i,e){return new c1(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i,i===404||i===0&&e.startsWith("file:"))}function Ij(i){return i===200||i===206}function Dj(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function kj(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Et(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class BZ{constructor(e){re(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=xj(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Xn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new jZ(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new qZ(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class jZ{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),r=t.url;fetch(r,Dj(n,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=Mb(s.url),!Ij(s.status))throw o2(s.status,r);this._reader=s.body.getReader(),this._headersCapability.resolve();const o=s.headers,{allowRangeRequests:a,suggestedLength:u}=Sj({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=u||this._contentLength,this._filename=Tj(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Wc("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:kj(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class qZ{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${n-1}`);const o=r.url;fetch(o,Dj(s,this._withCredentials,this._abortController)).then(a=>{const u=Mb(a.url);if(u!==e._responseOrigin)throw new Error(`Expected range response-origin "${u}" to match "${e._responseOrigin}".`);if(!Ij(a.status))throw o2(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:kj(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Cx=200,xx=206;function UZ(i){const e=i.response;return typeof e!="string"?e:n2(e).buffer}class VZ{constructor({url:e,httpHeaders:t,withCredentials:n}){re(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=xj(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,o]of this.headers)t.setRequestHeader(s,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=xx):r.expectedStatus=Cx,t.responseType="arraybuffer",Xn(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var r;const n=this.pendingRequests[e];n&&((r=n.onProgress)==null||r.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){n.onError(r.status);return}const s=r.status||Cx;if(!(s===Cx&&n.expectedStatus===xx)&&s!==n.expectedStatus){n.onError(r.status);return}const a=UZ(r);if(s===xx){const u=r.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(u);c?n.onDone({begin:parseInt(c[1],10),chunk:a}):(Et('Missing or invalid "Content-Range" header.'),n.onError(0))}else a?n.onDone({begin:0,chunk:a}):n.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class HZ{constructor(e){this._source=e,this._manager=new VZ(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Xn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new zZ(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new $Z(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class zZ{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Mb(t.responseURL);const n=t.getAllResponseHeaders(),r=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[u,...c]=a.split(": ");return[u,c.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:o}=Sj({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=Tj(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=o2(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class $Z{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Mb((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=o2(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const WZ=/^[a-z][a-z0-9\-+.]+:/i;function GZ(i){if(WZ.test(i))return new URL(i);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(i))}class KZ{constructor(e){this.source=e,this.url=GZ(e.url),Xn(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Xn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new JZ(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new YZ(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class JZ{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=o2(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Wc("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class YZ{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Qg=Symbol("INITIAL_DATA");var ns,Vv,BS;class Rj{constructor(){z(this,Vv);z(this,ns,Object.create(null))}get(e,t=null){if(t){const r=W(this,Vv,BS).call(this,e);return r.promise.then(()=>t(r.data)),null}const n=f(this,ns)[e];if(!n||n.data===Qg)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=f(this,ns)[e];return!!t&&t.data!==Qg}delete(e){const t=f(this,ns)[e];return!t||t.data===Qg?!1:(delete f(this,ns)[e],!0)}resolve(e,t=null){const n=W(this,Vv,BS).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in f(this,ns)){const{data:n}=f(this,ns)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}U(this,ns,Object.create(null))}*[Symbol.iterator](){for(const e in f(this,ns)){const{data:t}=f(this,ns)[e];t!==Qg&&(yield[e,t])}}}ns=new WeakMap,Vv=new WeakSet,BS=function(e){var t;return(t=f(this,ns))[e]||(t[e]={...Promise.withResolvers(),data:Qg})};const XZ=1e5,aF=30;var vF,oc,Mi,Hv,zv,id,vl,$v,Wv,sd,tm,nm,ac,rm,Gv,im,od,Kv,Jv,sm,ad,Yv,lc,om,Zl,Pj,Nj,jS,As,g_,qS,Oj,Lj;const sr=class sr{constructor({textContentSource:e,container:t,viewport:n}){z(this,Zl);z(this,oc,Promise.withResolvers());z(this,Mi,null);z(this,Hv,!1);z(this,zv,!!((vF=globalThis.FontInspector)!=null&&vF.enabled));z(this,id,null);z(this,vl,null);z(this,$v,0);z(this,Wv,0);z(this,sd,null);z(this,tm,null);z(this,nm,0);z(this,ac,0);z(this,rm,Object.create(null));z(this,Gv,[]);z(this,im,null);z(this,od,[]);z(this,Kv,new WeakMap);z(this,Jv,null);var u;if(e instanceof ReadableStream)U(this,im,e);else if(typeof e=="object")U(this,im,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');U(this,Mi,U(this,tm,t)),U(this,ac,n.scale*Da.pixelRatio),U(this,nm,n.rotation),U(this,vl,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:s,pageX:o,pageY:a}=n.rawDims;U(this,Jv,[1,0,0,-1,-o,a+s]),U(this,Wv,r),U(this,$v,s),W(u=sr,As,Oj).call(u),Xd(t,n),f(this,oc).promise.finally(()=>{f(sr,om).delete(this),U(this,vl,null),U(this,rm,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=$r.platform;return Rt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{f(this,sd).read().then(({value:t,done:n})=>{if(n){f(this,oc).resolve();return}f(this,id)??U(this,id,t.lang),Object.assign(f(this,rm),t.styles),W(this,Zl,Pj).call(this,t.items),e()},f(this,oc).reject)};return U(this,sd,f(this,im).getReader()),f(sr,om).add(this),e(),f(this,oc).promise}update({viewport:e,onBefore:t=null}){var s;const n=e.scale*Da.pixelRatio,r=e.rotation;if(r!==f(this,nm)&&(t==null||t(),U(this,nm,r),Xd(f(this,tm),{rotation:r})),n!==f(this,ac)){t==null||t(),U(this,ac,n);const o={div:null,properties:null,ctx:W(s=sr,As,g_).call(s,f(this,id))};for(const a of f(this,od))o.properties=f(this,Kv).get(a),o.div=a,W(this,Zl,jS).call(this,o)}}cancel(){var t;const e=new Wc("TextLayer task cancelled.");(t=f(this,sd))==null||t.cancel(e).catch(()=>{}),U(this,sd,null),f(this,oc).reject(e)}get textDivs(){return f(this,od)}get textContentItemsStr(){return f(this,Gv)}static cleanup(){if(!(f(this,om).size>0)){f(this,sm).clear();for(const{canvas:e}of f(this,ad).values())e.remove();f(this,ad).clear()}}};oc=new WeakMap,Mi=new WeakMap,Hv=new WeakMap,zv=new WeakMap,id=new WeakMap,vl=new WeakMap,$v=new WeakMap,Wv=new WeakMap,sd=new WeakMap,tm=new WeakMap,nm=new WeakMap,ac=new WeakMap,rm=new WeakMap,Gv=new WeakMap,im=new WeakMap,od=new WeakMap,Kv=new WeakMap,Jv=new WeakMap,sm=new WeakMap,ad=new WeakMap,Yv=new WeakMap,lc=new WeakMap,om=new WeakMap,Zl=new WeakSet,Pj=function(e){var r,s;if(f(this,Hv))return;(s=f(this,vl)).ctx??(s.ctx=W(r=sr,As,g_).call(r,f(this,id)));const t=f(this,od),n=f(this,Gv);for(const o of e){if(t.length>XZ){Et("Ignoring additional textDivs for performance reasons."),U(this,Hv,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=f(this,Mi);U(this,Mi,document.createElement("span")),f(this,Mi).classList.add("markedContent"),o.id&&f(this,Mi).setAttribute("id",`${o.id}`),a.append(f(this,Mi))}else o.type==="endMarkedContent"&&U(this,Mi,f(this,Mi).parentNode);continue}n.push(o.str),W(this,Zl,Nj).call(this,o)}},Nj=function(e){var b;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};f(this,od).push(t);const r=Je.transform(f(this,Jv),e.transform);let s=Math.atan2(r[1],r[0]);const o=f(this,rm)[e.fontName];o.vertical&&(s+=Math.PI/2);let a=f(this,zv)&&o.fontSubstitution||o.fontFamily;a=sr.fontFamilyMap.get(a)||a;const u=Math.hypot(r[2],r[3]),c=u*W(b=sr,As,Lj).call(b,a,o,f(this,id));let d,m;s===0?(d=r[4],m=r[5]-c):(d=r[4]+c*Math.sin(s),m=r[5]-c*Math.cos(s));const p="calc(var(--total-scale-factor) *",g=t.style;f(this,Mi)===f(this,tm)?(g.left=`${(100*d/f(this,Wv)).toFixed(2)}%`,g.top=`${(100*m/f(this,$v)).toFixed(2)}%`):(g.left=`${p}${d.toFixed(2)}px)`,g.top=`${p}${m.toFixed(2)}px)`),g.fontSize=`${p}${(f(sr,lc)*u).toFixed(2)}px)`,g.fontFamily=a,n.fontSize=u,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,f(this,zv)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),s!==0&&(n.angle=s*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const A=Math.abs(e.transform[0]),_=Math.abs(e.transform[3]);A!==_&&Math.max(A,_)/Math.min(A,_)>1.5&&(w=!0)}if(w&&(n.canvasWidth=o.vertical?e.height:e.width),f(this,Kv).set(t,n),f(this,vl).div=t,f(this,vl).properties=n,W(this,Zl,jS).call(this,f(this,vl)),n.hasText&&f(this,Mi).append(t),n.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),f(this,Mi).append(A)}},jS=function(e){var a;const{div:t,properties:n,ctx:r}=e,{style:s}=t;let o="";if(f(sr,lc)>1&&(o=`scale(${1/f(sr,lc)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:u}=s,{canvasWidth:c,fontSize:d}=n;W(a=sr,As,qS).call(a,r,d*f(this,ac),u);const{width:m}=r.measureText(t.textContent);m>0&&(o=`scaleX(${c*f(this,ac)/m}) ${o}`)}n.angle!==0&&(o=`rotate(${n.angle}deg) ${o}`),o.length>0&&(s.transform=o)},As=new WeakSet,g_=function(e=null){let t=f(this,ad).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),f(this,ad).set(e,t),f(this,Yv).set(t,{size:0,family:""})}return t},qS=function(e,t,n){const r=f(this,Yv).get(e);t===r.size&&n===r.family||(e.font=`${t}px ${n}`,r.size=t,r.family=n)},Oj=function(){if(f(this,lc)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),U(this,lc,e.getBoundingClientRect().height),e.remove()},Lj=function(e,t,n){const r=f(this,sm).get(e);if(r)return r;const s=W(this,As,g_).call(this,n);s.canvas.width=s.canvas.height=aF,W(this,As,qS).call(this,s,aF,e);const o=s.measureText(""),a=o.fontBoundingBoxAscent,u=Math.abs(o.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let c=.8;return a?c=a/(a+u):($r.platform.isFirefox&&Et("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),f(this,sm).set(e,c),c},z(sr,As),z(sr,sm,new Map),z(sr,ad,new Map),z(sr,Yv,new WeakMap),z(sr,lc,null),z(sr,om,new Set);let iv=sr;class sv{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function r(s){var u;if(!s)return;let o=null;const a=s.name;if(a==="#text")o=s.value;else if(sv.shouldBuildText(a))(u=s==null?void 0:s.attributes)!=null&&u.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&t.push({str:o}),!!s.children)for(const c of s.children)r(c)}return r(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const QZ=100;function Fj(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const e=new US,{docId:t}=e,n=i.url?oZ(i.url):null,r=i.data?aZ(i.data):null,s=i.httpHeaders||null,o=i.withCredentials===!0,a=i.password??null,u=i.range instanceof Mj?i.range:null,c=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let d=i.worker instanceof ov?i.worker:null;const m=i.verbosity,p=typeof i.docBaseUrl=="string"&&!Lb(i.docBaseUrl)?i.docBaseUrl:null,g=Bw(i.cMapUrl),w=i.cMapPacked!==!1,b=i.CMapReaderFactory||(yi?mZ:JL),A=Bw(i.iccUrl),_=Bw(i.standardFontDataUrl),C=i.StandardFontDataFactory||(yi?gZ:YL),I=Bw(i.wasmUrl),S=i.WasmFactory||(yi?yZ:XL),R=i.stopAtErrors!==!0,L=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,k=i.isEvalSupported!==!1,T=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!yi,D=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!yi&&($r.platform.isFirefox||!globalThis.chrome),P=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,N=typeof i.disableFontFace=="boolean"?i.disableFontFace:yi,F=i.fontExtraProperties===!0,M=i.enableXfa===!0,$=i.ownerDocument||globalThis.document,Q=i.disableRange===!0,ie=i.disableStream===!0,ee=i.disableAutoFetch===!0,ue=i.pdfBug===!0,Y=i.CanvasFactory||(yi?pZ:hZ),J=i.FilterFactory||(yi?fZ:dZ),q=i.enableHWA===!0,H=i.useWasm!==!1,G=u?u.length:i.length??NaN,le=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!yi&&!N,se=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(b===JL&&C===YL&&S===XL&&g&&_&&I&&cy(g,document.baseURI)&&cy(_,document.baseURI)&&cy(I,document.baseURI)),X=null;BQ(m);const ne={canvasFactory:new Y({ownerDocument:$,enableHWA:q}),filterFactory:new J({docId:t,ownerDocument:$}),cMapReaderFactory:se?null:new b({baseUrl:g,isCompressed:w}),standardFontDataFactory:se?null:new C({baseUrl:_}),wasmFactory:se?null:new S({baseUrl:I})};d||(d=ov.create({verbosity:m,port:va.workerPort}),e._worker=d);const te={docId:t,apiVersion:"5.4.149",data:r,password:a,disableAutoFetch:ee,rangeChunkSize:c,length:G,docBaseUrl:p,enableXfa:M,evaluatorOptions:{maxImageSize:L,disableFontFace:N,ignoreErrors:R,isEvalSupported:k,isOffscreenCanvasSupported:T,isImageDecoderSupported:D,canvasMaxAreaInBytes:P,fontExtraProperties:F,useSystemFonts:le,useWasm:H,useWorkerFetch:se,cMapUrl:g,iccUrl:A,standardFontDataUrl:_,wasmUrl:I}},ae={ownerDocument:$,pdfBug:ue,styleElement:X,loadingParams:{disableAutoFetch:ee,enableXfa:M}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const de=d.messageHandler.sendWithPromise("GetDocRequest",te,r?[r.buffer]:null);let ye;if(u)ye=new OZ(u,{disableRange:Q,disableStream:ie});else if(!r){if(!n)throw new Error("getDocument - no `url` parameter provided.");const xe=cy(n)?BZ:yi?KZ:HZ;ye=new xe({url:n,length:G,httpHeaders:s,withCredentials:o,rangeChunkSize:c,disableRange:Q,disableStream:ie})}return de.then(xe=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Oe=new gy(t,xe,d.port),Fe=new tee(Oe,e,ye,ae,ne,q);e._transport=Fe,Oe.send("Ready",null)})}).catch(e._capability.reject),e}var k1;const R1=class R1{constructor(){re(this,"_capability",Promise.withResolvers());re(this,"_transport",null);re(this,"_worker",null);re(this,"docId",`d${ir(R1,k1)._++}`);re(this,"destroyed",!1);re(this,"onPassword",null);re(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,n,r;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(s){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,s}this._transport=null,(r=this._worker)==null||r.destroy(),this._worker=null}async getData(){return this._transport.getData()}};k1=new WeakMap,z(R1,k1,0);let US=R1;var ld,Xv,Qv,Zv,e0;class Mj{constructor(e,t,n=!1,r=null){z(this,ld,Promise.withResolvers());z(this,Xv,[]);z(this,Qv,[]);z(this,Zv,[]);z(this,e0,[]);this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=r}addRangeListener(e){f(this,e0).push(e)}addProgressListener(e){f(this,Zv).push(e)}addProgressiveReadListener(e){f(this,Qv).push(e)}addProgressiveDoneListener(e){f(this,Xv).push(e)}onDataRange(e,t){for(const n of f(this,e0))n(e,t)}onDataProgress(e,t){f(this,ld).promise.then(()=>{for(const n of f(this,Zv))n(e,t)})}onDataProgressiveRead(e){f(this,ld).promise.then(()=>{for(const t of f(this,Qv))t(e)})}onDataProgressiveDone(){f(this,ld).promise.then(()=>{for(const e of f(this,Xv))e()})}transportReady(){f(this,ld).resolve()}requestDataRange(e,t){rn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}ld=new WeakMap,Xv=new WeakMap,Qv=new WeakMap,Zv=new WeakMap,e0=new WeakMap;class ZZ{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Rt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var wl,ud,by;class eee{constructor(e,t,n,r=!1){z(this,ud);z(this,wl,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=r?new WL:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new Rj,this._intentStates=new Map,this.destroyed=!1,this.recordedGroups=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:s=!1}={}){return new i2({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Rt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:r="display",annotationMode:s=Mu.ENABLE,transform:o=null,background:a=null,optionalContentConfigPromise:u=null,annotationCanvasMap:c=null,pageColors:d=null,printAnnotationStorage:m=null,isEditing:p=!1,recordOperations:g=!1,filteredOperationIndexes:w=null}){var T,D,P;(T=this._stats)==null||T.time("Overall");const b=this._transport.getRenderingIntent(r,s,m,p),{renderingIntent:A,cacheKey:_}=b;U(this,wl,!1),u||(u=this._transport.getOptionalContentConfig(A));let C=this._intentStates.get(_);C||(C=Object.create(null),this._intentStates.set(_,C)),C.streamReaderCancelTimeout&&(clearTimeout(C.streamReaderCancelTimeout),C.streamReaderCancelTimeout=null);const I=!!(A&ps.PRINT);C.displayReadyCapability||(C.displayReadyCapability=Promise.withResolvers(),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(D=this._stats)==null||D.time("Page Request"),this._pumpOperatorList(b));const S=!this.recordedGroups&&(g||this._pdfBug&&((P=globalThis.StepperManager)==null?void 0:P.enabled)),R=N=>{var F,M,$;if(C.renderTasks.delete(L),S){const Q=(F=L.gfx)==null?void 0:F.dependencyTracker.take();Q?((M=L.stepper)==null||M.setOperatorGroups(Q),g&&(this.recordedGroups=Q)):g&&(this.recordedGroups=[])}I&&U(this,wl,!0),W(this,ud,by).call(this),N?(L.capability.reject(N),this._abortOperatorList({intentState:C,reason:N instanceof Error?N:new Error(N)})):L.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),($=globalThis.Stats)!=null&&$.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},L=new VS({callback:R,params:{canvas:t,canvasContext:e,dependencyTracker:S?new vZ(t):null,viewport:n,transform:o,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:C.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!I,pdfBug:this._pdfBug,pageColors:d,enableHWA:this._transport.enableHWA,filteredOperationIndexes:w});(C.renderTasks||(C.renderTasks=new Set)).add(L);const k=L.task;return Promise.all([C.displayReadyCapability.promise,u]).then(([N,F])=>{var M;if(this.destroyed){R();return}if((M=this._stats)==null||M.time("Rendering"),!(F.renderingIntent&A))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");L.initializeGraphics({transparency:N,optionalContentConfig:F}),L.operatorListChanged()}).catch(R),k}getOperatorList({intent:e="display",annotationMode:t=Mu.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){var c;function s(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(u))}const o=this._transport.getRenderingIntent(e,t,n,r,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let u;return a.opListReadCapability||(u=Object.create(null),u.operatorListChanged=s,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(u),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>sv.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,r){function s(){o.read().then(function({value:u,done:c}){if(c){n(a);return}a.lang??(a.lang=u.lang),Object.assign(a.styles,u.styles),a.items.push(...u.items),s()},r)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),U(this,wl,!1),Promise.all(e)}cleanup(e=!1){U(this,wl,!0);const t=W(this,ud,by).call(this);return e&&t&&this._stats&&(this._stats=new WL),t}_startRenderPage(e,t){var r,s;const n=this._intentStates.get(t);n&&((r=this._stats)==null||r.timeEnd("Page Request"),(s=n.displayReadyCapability)==null||s.resolve(e))}_renderPageChunk(e,t){for(let n=0,r=e.length;n<r;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&W(this,ud,by).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:r}){const{map:s,transfer:o}=n,u=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:r},o).getReader(),c=this._intentStates.get(t);c.streamReader=u;const d=()=>{u.read().then(({value:m,done:p})=>{if(p){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,c),d())},m=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const p of c.renderTasks)p.operatorListChanged();W(this,ud,by).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(m);else if(c.opListReadCapability)c.opListReadCapability.reject(m);else throw m}})};d()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof aD){let r=QZ;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new Wc(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,s]of this._intentStates)if(s===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}wl=new WeakMap,ud=new WeakSet,by=function(){if(!f(this,wl)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),U(this,wl,!1),!0};var uc,_o,_l,cd,P1,hd,dd,wi,y_,Bj,jj,Ay,am,v_;const bn=class bn{constructor({name:e=null,port:t=null,verbosity:n=jQ()}={}){z(this,wi);z(this,uc,Promise.withResolvers());z(this,_o,null);z(this,_l,null);z(this,cd,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(f(bn,dd).has(t))throw new Error("Cannot use more than one PDFWorker per port.");f(bn,dd).set(t,this),W(this,wi,Bj).call(this,t)}else W(this,wi,jj).call(this)}get promise(){return f(this,uc).promise}get port(){return f(this,_l)}get messageHandler(){return f(this,_o)}destroy(){var e,t;this.destroyed=!0,(e=f(this,cd))==null||e.terminate(),U(this,cd,null),f(bn,dd).delete(f(this,_l)),U(this,_l,null),(t=f(this,_o))==null||t.destroy(),U(this,_o,null)}static create(e){const t=f(this,dd).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new bn(e)}static get workerSrc(){if(va.workerSrc)return va.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Rt(this,"_setupFakeWorkerGlobal",(async()=>f(this,am,v_)?f(this,am,v_):(await import(this.workerSrc)).WorkerMessageHandler)())}};uc=new WeakMap,_o=new WeakMap,_l=new WeakMap,cd=new WeakMap,P1=new WeakMap,hd=new WeakMap,dd=new WeakMap,wi=new WeakSet,y_=function(){f(this,uc).resolve(),f(this,_o).send("configure",{verbosity:this.verbosity})},Bj=function(e){U(this,_l,e),U(this,_o,new gy("main","worker",e)),f(this,_o).on("ready",()=>{}),W(this,wi,y_).call(this)},jj=function(){if(f(bn,hd)||f(bn,am,v_)){W(this,wi,Ay).call(this);return}let{workerSrc:e}=bn;try{bn._isSameOrigin(window.location,e)||(e=bn._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new gy("main","worker",t),r=()=>{s.abort(),n.destroy(),t.terminate(),this.destroyed?f(this,uc).reject(new Error("Worker was destroyed")):W(this,wi,Ay).call(this)},s=new AbortController;t.addEventListener("error",()=>{f(this,cd)||r()},{signal:s.signal}),n.on("test",a=>{if(s.abort(),this.destroyed||!a){r();return}U(this,_o,n),U(this,_l,t),U(this,cd,t),W(this,wi,y_).call(this)}),n.on("ready",a=>{if(s.abort(),this.destroyed){r();return}try{o()}catch{W(this,wi,Ay).call(this)}});const o=()=>{const a=new Uint8Array;n.send("test",a,[a.buffer])};o();return}catch{Ob("The worker has been disabled.")}W(this,wi,Ay).call(this)},Ay=function(){f(bn,hd)||(Et("Setting up fake worker."),U(bn,hd,!0)),bn._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){f(this,uc).reject(new Error("Worker was destroyed"));return}const t=new cZ;U(this,_l,t);const n=`fake${ir(bn,P1)._++}`,r=new gy(n+"_worker",n,t);e.setup(r,t),U(this,_o,new gy(n,n+"_worker",t)),W(this,wi,y_).call(this)}).catch(e=>{f(this,uc).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},am=new WeakSet,v_=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},z(bn,am),z(bn,P1,0),z(bn,hd,!1),z(bn,dd,new WeakMap),yi&&(U(bn,hd,!0),va.workerSrc||(va.workerSrc="./pdf.worker.mjs")),bn._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const r=new URL(t,n);return n.origin===r.origin},bn._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},bn.fromPort=e=>{if(XQ("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return bn.create(e)};let ov=bn;var bl,aa,lm,um,Al,fd,Ey;class tee{constructor(e,t,n,r,s,o){z(this,fd);z(this,bl,new Map);z(this,aa,new Map);z(this,lm,new Map);z(this,um,new Map);z(this,Al,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Rj,this.fontLoader=new iZ({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}get annotationStorage(){return Rt(this,"annotationStorage",new uD)}getRenderingIntent(e,t=Mu.ENABLE,n=null,r=!1,s=!1){let o=ps.DISPLAY,a=IS;switch(e){case"any":o=ps.ANY;break;case"display":break;case"print":o=ps.PRINT;break;default:Et(`getRenderingIntent - invalid intent: ${e}`)}const u=o&ps.PRINT&&n instanceof mj?n:this.annotationStorage;switch(t){case Mu.DISABLE:o+=ps.ANNOTATIONS_DISABLE;break;case Mu.ENABLE:break;case Mu.ENABLE_FORMS:o+=ps.ANNOTATIONS_FORMS;break;case Mu.ENABLE_STORAGE:o+=ps.ANNOTATIONS_STORAGE,a=u.serializable;break;default:Et(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(o+=ps.IS_EDITING),s&&(o+=ps.OPLIST);const{ids:c,hash:d}=u.modifiedIds,m=[o,a.hash,d];return{renderingIntent:o,cacheKey:m.join("_"),annotationStorageSerializable:a,modifiedIds:c}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=f(this,Al))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of f(this,aa).values())e.push(r._destroy());f(this,aa).clear(),f(this,lm).clear(),f(this,um).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var r,s;this.commonObjs.clear(),this.fontLoader.clear(),f(this,bl).clear(),this.filterFactory.destroy(),iv.cleanup(),(r=this._networkStream)==null||r.cancelAllRequests(new Wc("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,r)=>{Xn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},r.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){r.close();return}Xn(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{r.error(s)})},r.onCancel=s=>{this._fullReader.cancel(s),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async n=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:s,contentLength:o}=this._fullReader;return(!r||!s)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=u=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:s,contentLength:o}}),e.on("GetRangeReader",(n,r)=>{Xn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(n.begin,n.end);if(!s){r.close();return}r.onPull=()=>{s.read().then(function({value:o,done:a}){if(a){r.close();return}Xn(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{s.cancel(o),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new ZZ(n,this))}),e.on("DocException",n=>{t._capability.reject(Oi(n))}),e.on("PasswordRequest",n=>{U(this,Al,Promise.withResolvers());try{if(!t.onPassword)throw Oi(n);const r=s=>{s instanceof Error?f(this,Al).reject(s):f(this,Al).resolve({password:s})};t.onPassword(r,n.code)}catch(r){f(this,Al).reject(r)}return f(this,Al).promise}),e.on("DataLoaded",n=>{var r;(r=t.onProgress)==null||r.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;f(this,aa).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,r,s])=>{var o;if(this.destroyed||this.commonObjs.has(n))return null;switch(r){case"Font":if("error"in s){const d=s.error;Et(`Error during font loading: ${d}`),this.commonObjs.resolve(n,d);break}const a=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(d,m)=>globalThis.FontInspector.fontAdded(d,m):null,u=new sZ(s,a);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!u.fontExtraProperties&&u.data&&(u.data=null),this.commonObjs.resolve(n,u)});break;case"CopyLocalImage":const{imageRef:c}=s;Xn(c,"The imageRef must be defined.");for(const d of f(this,aa).values())for(const[,m]of d.objs)if((m==null?void 0:m.ref)===c)return m.dataLen?(this.commonObjs.resolve(n,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,s);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([n,r,s,o])=>{var u;if(this.destroyed)return;const a=f(this,aa).get(r);if(!a.objs.has(n)){if(a._intentStates.size===0){(u=o==null?void 0:o.bitmap)==null||u.close();return}switch(s){case"Image":case"Pattern":a.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",n=>{var r;this.destroyed||(r=t.onProgress)==null||r.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[n.type];if(!r)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Et("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=f(this,lm).get(t);if(n)return n;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&f(this,um).set(s.refStr,e);const o=new eee(t,s,this,this._params.pdfBug);return f(this,aa).set(t,o),o});return f(this,lm).set(t,r),r}getPageIndex(e){return DS(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return W(this,fd,Ey).call(this,"GetFieldObjects")}hasJSActions(){return W(this,fd,Ey).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return W(this,fd,Ey).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return W(this,fd,Ey).call(this,"GetOptionalContentConfig").then(t=>new NZ(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=f(this,bl).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(r=>{var s,o;return{info:r[0],metadata:r[1]?new RZ(r[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return f(this,bl).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of f(this,aa).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),f(this,bl).clear(),this.filterFactory.destroy(!0),iv.cleanup()}}cachedPageNumber(e){if(!DS(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return f(this,um).get(t)??null}}bl=new WeakMap,aa=new WeakMap,lm=new WeakMap,um=new WeakMap,Al=new WeakMap,fd=new WeakSet,Ey=function(e,t=null){const n=f(this,bl).get(e);if(n)return n;const r=this.messageHandler.sendWithPromise(e,t);return f(this,bl).set(e,r),r};var cc;class nee{constructor(e){z(this,cc,null);re(this,"onContinue",null);re(this,"onError",null);U(this,cc,e)}get promise(){return f(this,cc).capability.promise}cancel(e=0){f(this,cc).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=f(this,cc).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=f(this,cc);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}cc=new WeakMap;var hc,pd;const Oh=class Oh{constructor({callback:e,params:t,objs:n,commonObjs:r,annotationCanvasMap:s,operatorList:o,pageIndex:a,canvasFactory:u,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:m=!1,pageColors:p=null,enableHWA:g=!1,filteredOperationIndexes:w=null}){z(this,hc,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=u,this.filterFactory=c,this._pdfBug=m,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new nee(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=g,this._dependencyTracker=t.dependencyTracker,this._filteredOperationIndexes=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var u,c;if(this.cancelled)return;if(this._canvas){if(f(Oh,pd).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");f(Oh,pd).add(this._canvas)}this._pdfBug&&((u=globalThis.StepperManager)!=null&&u.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:r,background:s,dependencyTracker:o}=this.params,a=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new bp(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:r,viewport:n,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var n,r,s;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),f(this,hc)&&(window.cancelAnimationFrame(f(this,hc)),U(this,hc,null)),f(Oh,pd).delete(this._canvas),e||(e=new aD(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(s=(r=this.task).onError)==null||s.call(r,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?U(this,hc,window.requestAnimationFrame(()=>{U(this,hc,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._filteredOperationIndexes),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),f(Oh,pd).delete(this._canvas),this.callback())))}};hc=new WeakMap,pd=new WeakMap,z(Oh,pd,new WeakSet);let VS=Oh;const ree="5.4.149",iee="9e2e9e209";var rs,md,cm,ur,t0,hm,El,n0,dc,bo,r0,nn,HS,zS,$S,kh,qj,ku;const Li=class Li{constructor({editor:e=null,uiManager:t=null}){z(this,nn);z(this,rs,null);z(this,md,null);z(this,cm);z(this,ur,null);z(this,t0,!1);z(this,hm,!1);z(this,El,null);z(this,n0);z(this,dc,null);z(this,bo,null);var n,r;e?(U(this,hm,!1),U(this,El,e)):U(this,hm,!0),U(this,bo,(e==null?void 0:e._uiManager)||t),U(this,n0,f(this,bo)._eventBus),U(this,cm,((n=e==null?void 0:e.color)==null?void 0:n.toUpperCase())||((r=f(this,bo))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),f(Li,r0)||U(Li,r0,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Rt(this,"_keyboardManager",new s2([[["Escape","mac+Escape"],Li.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Li.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Li.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Li.prototype._moveToPrevious],[["Home","mac+Home"],Li.prototype._moveToBeginning],[["End","mac+End"],Li.prototype._moveToEnd]]))}renderButton(){const e=U(this,rs,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",f(this,El)&&(e.ariaControls=`${f(this,El).id}_colorpicker_dropdown`);const t=f(this,bo)._signal;e.addEventListener("click",W(this,nn,kh).bind(this),{signal:t}),e.addEventListener("keydown",W(this,nn,$S).bind(this),{signal:t});const n=U(this,md,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=f(this,cm),e.append(n),e}renderMainDropdown(){const e=U(this,ur,W(this,nn,HS).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===f(this,rs)){W(this,nn,kh).call(this,e);return}const t=e.target.getAttribute("data-color");t&&W(this,nn,zS).call(this,t,e)}_moveToNext(e){var t,n;if(!f(this,nn,ku)){W(this,nn,kh).call(this,e);return}if(e.target===f(this,rs)){(t=f(this,ur).firstChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=f(this,ur))==null?void 0:t.firstChild)||e.target===f(this,rs)){f(this,nn,ku)&&this._hideDropdownFromKeyboard();return}f(this,nn,ku)||W(this,nn,kh).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!f(this,nn,ku)){W(this,nn,kh).call(this,e);return}(t=f(this,ur).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!f(this,nn,ku)){W(this,nn,kh).call(this,e);return}(t=f(this,ur).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=f(this,ur))==null||e.classList.add("hidden"),f(this,rs).ariaExpanded="false",(t=f(this,dc))==null||t.abort(),U(this,dc,null)}_hideDropdownFromKeyboard(){var e;if(!f(this,hm)){if(!f(this,nn,ku)){(e=f(this,El))==null||e.unselect();return}this.hideDropdown(),f(this,rs).focus({preventScroll:!0,focusVisible:f(this,t0)})}}updateColor(e){if(f(this,md)&&(f(this,md).style.backgroundColor=e),!f(this,ur))return;const t=f(this,bo).highlightColors.values();for(const n of f(this,ur).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=f(this,rs))==null||e.remove(),U(this,rs,null),U(this,md,null),(t=f(this,ur))==null||t.remove(),U(this,ur,null)}};rs=new WeakMap,md=new WeakMap,cm=new WeakMap,ur=new WeakMap,t0=new WeakMap,hm=new WeakMap,El=new WeakMap,n0=new WeakMap,dc=new WeakMap,bo=new WeakMap,r0=new WeakMap,nn=new WeakSet,HS=function(){const e=document.createElement("div"),t=f(this,bo)._signal;e.addEventListener("contextmenu",Xs,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),f(this,El)&&(e.id=`${f(this,El).id}_colorpicker_dropdown`);for(const[n,r]of f(this,bo).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",r),s.title=n,s.setAttribute("data-l10n-id",f(Li,r0)[n]);const o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=r,s.ariaSelected=r===f(this,cm),s.addEventListener("click",W(this,nn,zS).bind(this,r),{signal:t}),e.append(s)}return e.addEventListener("keydown",W(this,nn,$S).bind(this),{signal:t}),e},zS=function(e,t){t.stopPropagation(),f(this,n0).dispatch("switchannotationeditorparams",{source:this,type:Ft.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},$S=function(e){Li._keyboardManager.exec(this,e)},kh=function(e){if(f(this,nn,ku)){this.hideDropdown();return}if(U(this,t0,e.detail===0),f(this,dc)||(U(this,dc,new AbortController),window.addEventListener("pointerdown",W(this,nn,qj).bind(this),{signal:f(this,bo).combinedSignal(f(this,dc))})),f(this,rs).ariaExpanded="true",f(this,ur)){f(this,ur).classList.remove("hidden");return}const t=U(this,ur,W(this,nn,HS).call(this));f(this,rs).append(t)},qj=function(e){var t;(t=f(this,ur))!=null&&t.contains(e.target)||this.hideDropdown()},ku=function(){return f(this,ur)&&!f(this,ur).classList.contains("hidden")},z(Li,r0,null);let m1=Li;var la,i0,dm,s0;const Lh=class Lh{constructor(e){z(this,la,null);z(this,i0,null);z(this,dm,null);U(this,i0,e),U(this,dm,e._uiManager),f(Lh,s0)||U(Lh,s0,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(f(this,la))return f(this,la);const{editorType:e,colorType:t,colorValue:n}=f(this,i0),r=U(this,la,document.createElement("input"));return r.type="color",r.value=n||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",f(Lh,s0)[e]),r.addEventListener("input",()=>{f(this,dm).updateParams(t,r.value)},{signal:f(this,dm)._signal}),r}update(e){f(this,la)&&(f(this,la).value=e)}destroy(){var e;(e=f(this,la))==null||e.remove(),U(this,la,null)}hideDropdown(){}};la=new WeakMap,i0=new WeakMap,dm=new WeakMap,s0=new WeakMap,z(Lh,s0,null);let g1=Lh;function lF(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function Zg(i){return Math.max(0,Math.min(255,255*i))}class uF{static CMYK_G([e,t,n,r]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Zg(e),[e,e,e]}static G_HTML([e]){const t=lF(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(Zg)}static RGB_HTML(e){return`#${e.map(lF).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,n+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,n,r]){return[Zg(1-Math.min(1,e+r)),Zg(1-Math.min(1,n+r)),Zg(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const r=1-e,s=1-t,o=1-n,a=Math.min(r,s,o);return["CMYK",r,s,o,a]}}class see{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){rn("Abstract method `_createSVG` called.")}}class y1 extends see{_createSVG(e){return document.createElementNS(Ja,e)}}class Uj{static setupStorage(e,t,n,r,s){const o=r.getValue(t,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),s==="print")break;e.addEventListener("input",a=>{r.setValue(t,{value:a.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?e.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",a=>{r.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),s==="print")break;e.addEventListener("input",a=>{r.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of n.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const u=a.target.options,c=u.selectedIndex===-1?"":u[u.selectedIndex].value;r.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:r,linkService:s}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${r}`);for(const[u,c]of Object.entries(o))if(c!=null)switch(u){case"class":c.length&&e.setAttribute(u,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!a||u!=="href"&&u!=="newWindow")&&e.setAttribute(u,c)}a&&s.addLinkAttributes(e,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(e,o.dataId,t,n)}static render(e){var m,p;const t=e.annotationStorage,n=e.linkService,r=e.xfaHtml,s=e.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:s,linkService:n});const a=s!=="richText",u=e.div;if(u.append(o),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;u.style.transform=g}a&&u.setAttribute("class","xfaLayer xfaFont");const c=[];if(r.children.length===0){if(r.value){const g=document.createTextNode(r.value);o.append(g),a&&sv.shouldBuildText(r.name)&&c.push(g)}return{textDivs:c}}const d=[[r,-1,o]];for(;d.length>0;){const[g,w,b]=d.at(-1);if(w+1===g.children.length){d.pop();continue}const A=g.children[++d.at(-1)[1]];if(A===null)continue;const{name:_}=A;if(_==="#text"){const I=document.createTextNode(A.value);c.push(I),b.append(I);continue}const C=(m=A==null?void 0:A.attributes)!=null&&m.xmlns?document.createElementNS(A.attributes.xmlns,_):document.createElement(_);if(b.append(C),A.attributes&&this.setAttributes({html:C,element:A,storage:t,intent:s,linkService:n}),((p=A.children)==null?void 0:p.length)>0)d.push([A,-1,C]);else if(A.value){const I=document.createTextNode(A.value);a&&sv.shouldBuildText(_)&&c.push(I),C.append(I)}}for(const g of u.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const oee=9,Zd=new WeakSet,aee=new Date().getTimezoneOffset()*60*1e3;class cF{static create(e){switch(e.data.annotationType){case Gn.LINK:return new dD(e);case Gn.TEXT:return new lee(e);case Gn.WIDGET:switch(e.data.fieldType){case"Tx":return new uee(e);case"Btn":return e.data.radioButton?new $j(e):e.data.checkBox?new hee(e):new dee(e);case"Ch":return new fee(e);case"Sig":return new cee(e)}return new cf(e);case Gn.POPUP:return new GS(e);case Gn.FREETEXT:return new Qj(e);case Gn.LINE:return new mee(e);case Gn.SQUARE:return new gee(e);case Gn.CIRCLE:return new yee(e);case Gn.POLYLINE:return new Zj(e);case Gn.CARET:return new wee(e);case Gn.INK:return new fD(e);case Gn.POLYGON:return new vee(e);case Gn.HIGHLIGHT:return new e4(e);case Gn.UNDERLINE:return new _ee(e);case Gn.SQUIGGLY:return new bee(e);case Gn.STRIKEOUT:return new Aee(e);case Gn.STAMP:return new t4(e);case Gn.FILEATTACHMENT:return new Eee(e);default:return new Vn(e)}}}var gd,fm,Cl,ef,Vj,WS;const bD=class bD{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){z(this,ef);z(this,gd,null);z(this,fm,!1);z(this,Cl,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return bD._hasPopupData(this.data)}get hasCommentButton(){return this.enableComment&&this._isEditable&&this.hasPopupElement}get commentButtonPosition(){const{quadPoints:e,rect:t}=this.data;let n=-1/0,r=-1/0;if((e==null?void 0:e.length)>=8){for(let s=0;s<e.length;s+=8)e[s+1]>r?(r=e[s+1],n=e[s+2]):e[s+1]===r&&(n=Math.max(n,e[s+2]));return[n,r]}return t?[t[2],t[3]]:null}get commentButtonColor(){if(!this.data.color)return null;const[e,t,n]=this.data.color,s=255*(1-(this.data.opacity??1));return W(this,ef,Vj).call(this,Math.min(e+s,255),Math.min(t+s,255),Math.min(n+s,255))}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:r,pageX:s,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-s)/n,e[1]=100*(e[1]-o)/r,e}updateEdited(e){var s;if(!this.container)return;e.rect&&(f(this,gd)||U(this,gd,{rect:this.data.rect.slice(0)}));const{rect:t,popup:n}=e;t&&W(this,ef,WS).call(this,t);let r=((s=f(this,Cl))==null?void 0:s.popup)||this.popup;!r&&(n!=null&&n.text)&&(this._createPopup(n),r=f(this,Cl).popup),r&&(r.updateEdited(e),n!=null&&n.deleted&&(r.remove(),U(this,Cl,null),this.popup=null))}resetEdited(){var e;f(this,gd)&&(W(this,ef,WS).call(this,f(this,gd).rect),(e=f(this,Cl))==null||e.popup.resetEdited(),U(this,gd,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:r}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),!(this instanceof cf)&&!(this instanceof dD)&&(s.tabIndex=0);const{style:o}=s;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof GS){const{rotation:b}=t;return!t.hasOwnCanvas&&b!==0&&this.setRotation(b,s),s}const{width:a,height:u}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const b=t.borderStyle.horizontalCornerRadius,A=t.borderStyle.verticalCornerRadius;if(b>0||A>0){const C=`calc(${b}px * var(--total-scale-factor)) / calc(${A}px * var(--total-scale-factor))`;o.borderRadius=C}else if(this instanceof $j){const C=`calc(${a}px * var(--total-scale-factor)) / calc(${u}px * var(--total-scale-factor))`;o.borderRadius=C}switch(t.borderStyle.style){case np.SOLID:o.borderStyle="solid";break;case np.DASHED:o.borderStyle="dashed";break;case np.BEVELED:Et("Unimplemented border style: beveled");break;case np.INSET:Et("Unimplemented border style: inset");break;case np.UNDERLINE:o.borderBottomStyle="solid";break}const _=t.borderColor||null;_?(U(this,fm,!0),o.borderColor=Je.makeHexColor(_[0]|0,_[1]|0,_[2]|0)):o.borderWidth=0}const c=Je.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:d,pageHeight:m,pageX:p,pageY:g}=r.rawDims;o.left=`${100*(c[0]-p)/d}%`,o.top=`${100*(c[1]-g)/m}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(o.width=`${100*a/d}%`,o.height=`${100*u/m}%`):this.setRotation(w,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims;let{width:s,height:o}=this;e%180!==0&&([s,o]=[o,s]),t.style.width=`${100*s/n}%`,t.style.height=`${100*o/r}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,r)=>{const s=r.detail[t],o=s[0],a=s.slice(1);r.target.style[n]=uF[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[n]:uF[`${o}_rgb`](a)})};return Rt(this,"_commonActions",{display:t=>{const{display:n}=t.detail,r=n%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const r of Object.keys(t.detail)){const s=e[r]||n[r];s==null||s(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[r,s]of Object.entries(t)){const o=n[r];if(o){const a={detail:{[r]:s},target:e};o(a),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,r,s]=this.data.rect.map(b=>Math.fround(b));if(e.length===8){const[b,A,_,C]=e.subarray(2,6);if(r===b&&s===A&&t===_&&n===C)return}const{style:o}=this.container;let a;if(f(this,fm)){const{borderColor:b,borderWidth:A}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const u=r-t,c=s-n,{svgFactory:d}=this,m=d.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const p=d.createElement("defs");m.append(p);const g=d.createElement("clipPath"),w=`clippath_${this.data.id}`;g.setAttribute("id",w),g.setAttribute("clipPathUnits","objectBoundingBox"),p.append(g);for(let b=2,A=e.length;b<A;b+=8){const _=e[b],C=e[b+1],I=e[b+2],S=e[b+3],R=d.createElement("rect"),L=(I-t)/u,k=(s-C)/c,T=(_-I)/u,D=(C-S)/c;R.setAttribute("x",L),R.setAttribute("y",k),R.setAttribute("width",T),R.setAttribute("height",D),g.append(R),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${L}" y="${k}" width="${T}" height="${D}"/>`)}f(this,fm)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(m),this.container.style.clipPath=`url(#${w})`}_createPopup(e=null){const{data:t}=this;let n,r;e?(n={str:e.text},r=e.date):(n=t.contentsObj,r=t.modificationDate);const s=U(this,Cl,new GS({data:{color:t.color,titleObj:t.titleObj,modificationDate:r,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent.div.append(s.render())}get hasPopupElement(){return!!(f(this,Cl)||this.popup||this.data.popupRef)}render(){rn("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:s,id:o,exportValues:a}of r){if(s===-1||o===t)continue;const u=typeof a=="string"?a:null,c=document.querySelector(`[data-element-id="${o}"]`);if(c&&!Zd.has(c)){Et(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:u,domElement:c})}return n}for(const r of document.getElementsByName(e)){const{exportValue:s}=r,o=r.getAttribute("data-element-id");o!==t&&Zd.has(r)&&n.push({id:o,exportValue:s,domElement:r})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};gd=new WeakMap,fm=new WeakMap,Cl=new WeakMap,ef=new WeakSet,Vj=function(e,t,n){e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n),o=(r+s)/2,a=((1+Math.sqrt(o))/2*100).toFixed(2);if(r===s)return`hsl(0, 0%, ${a}%)`;const u=r-s;let c;r===e?c=(t-n)/u+(t<n?6:0):r===t?c=(n-e)/u+2:c=(e-t)/u+4,c=(c*60).toFixed(2);const d=(u/(1-Math.abs(2*o-1))*100).toFixed(2);return`hsl(${c}, ${d}%, ${a}%)`},WS=function(e){const{container:{style:t},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:u}}}}=this;n==null||n.splice(0,4,...e),t.left=`${100*(e[0]-a)/s}%`,t.top=`${100*(o-e[3]+u)/o}%`,r===0?(t.width=`${100*(e[2]-e[0])/s}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(r)};let Vn=bD;var gs,Rh,Hj,zj;class dD extends Vn{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});z(this,gs);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let s=!1;return t.url?(n.addLinkAttributes(r,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(r,t.action,t.overlaidText),s=!0):t.attachment?(W(this,gs,Hj).call(this,r,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(W(this,gs,zj).call(this,r,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(r,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),s=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(r,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(r),this.container}_bindLink(t,n,r=""){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&W(this,gs,Rh).call(this),r&&(t.title=r)}_bindNamedAction(t,n,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),r&&(t.title=r),W(this,gs,Rh).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(n.actions)){const o=r.get(s);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:s}}),!1})}n.overlaidText&&(t.title=n.overlaidText),t.onclick||(t.onclick=()=>!1),W(this,gs,Rh).call(this)}_bindResetFormAction(t,n){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),W(this,gs,Rh).call(this),!this._fieldObjects){Et('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{var m;r==null||r();const{fields:s,refs:o,include:a}=n,u=[];if(s.length!==0||o.length!==0){const p=new Set(o);for(const g of s){const w=this._fieldObjects[g]||[];for(const{id:b}of w)p.add(b)}for(const g of Object.values(this._fieldObjects))for(const w of g)p.has(w.id)===a&&u.push(w)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const c=this.annotationStorage,d=[];for(const p of u){const{id:g}=p;switch(d.push(g),p.type){case"text":{const b=p.defaultValue||"";c.setValue(g,{value:b});break}case"checkbox":case"radiobutton":{const b=p.defaultValue===p.exportValues;c.setValue(g,{value:b});break}case"combobox":case"listbox":{const b=p.defaultValue||"";c.setValue(g,{value:b});break}default:continue}const w=document.querySelector(`[data-element-id="${g}"]`);if(w){if(!Zd.has(w)){Et(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;w.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}gs=new WeakSet,Rh=function(){this.container.setAttribute("data-internal-link","")},Hj=function(t,n,r="",s=null){t.href=this.linkService.getAnchorUrl(""),n.description?t.title=n.description:r&&(t.title=r),t.onclick=()=>{var o;return(o=this.downloadManager)==null||o.openOrDownloadData(n.content,n.filename,s),!1},W(this,gs,Rh).call(this)},zj=function(t,n,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),r&&(t.title=r),W(this,gs,Rh).call(this)};class lee extends Vn{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class cf extends Vn{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return $r.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,r,s){n.includes("mouse")?e.addEventListener(n,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(n,o=>{var a;if(n==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}s&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(o)}}))})}_setEventListeners(e,t,n,r){var s,o,a;for(const[u,c]of n)(c==="Action"||(s=this.data.actions)!=null&&s[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,u,c,r),c==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Je.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||oee,s=e.style;let o;const a=2,u=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(c/(vx*r))||1,m=c/d;o=Math.min(r,u(m/vx))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(r,u(c/vx))}s.fontSize=`calc(${o}px * var(--total-scale-factor))`,s.color=Je.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class uee extends cf{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,r){const s=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=n),s.setValue(o.id,{[r]:n})}render(){var r,s;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const u=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;u&&a.length>u&&(a=a.slice(0,u));let c=o.formattedValue||((r=this.data.textContent)==null?void 0:r.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Zd.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:m,datetimeType:p,timeStep:g}=this.data,w=!!p&&this.enableScripting;m&&(n.title=m),this._setRequired(n,this.data.required),u&&(n.maxLength=u),n.addEventListener("input",A=>{e.setValue(t,{value:A.target.value}),this.setPropertyOnSiblings(n,"value",A.target.value,"value"),d.formattedValue=null}),n.addEventListener("resetform",A=>{const _=this.data.defaultFieldValue??"";n.value=d.userValue=_,d.formattedValue=null});let b=A=>{const{formattedValue:_}=d;_!=null&&(A.target.value=_),A.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",_=>{var I;if(d.focused)return;const{target:C}=_;if(w&&(C.type=p,g&&(C.step=g)),d.userValue){const S=d.userValue;if(w)if(p==="time"){const R=new Date(S),L=[R.getHours(),R.getMinutes(),R.getSeconds()];C.value=L.map(k=>k.toString().padStart(2,"0")).join(":")}else C.value=new Date(S-aee).toISOString().split(p==="date"?"T":".",1)[0];else C.value=S}d.lastCommittedValue=C.value,d.commitKey=1,(I=this.data.actions)!=null&&I.Focus||(d.focused=!0)}),n.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const C={value(I){d.userValue=I.detail.value??"",w||e.setValue(t,{value:d.userValue.toString()}),I.target.value=d.userValue},formattedValue(I){const{formattedValue:S}=I.detail;d.formattedValue=S,S!=null&&I.target!==document.activeElement&&(I.target.value=S);const R={formattedValue:S};w&&(R.value=S),e.setValue(t,R)},selRange(I){I.target.setSelectionRange(...I.detail.selRange)},charLimit:I=>{var k;const{charLimit:S}=I.detail,{target:R}=I;if(S===0){R.removeAttribute("maxLength");return}R.setAttribute("maxLength",S);let L=d.userValue;!L||L.length<=S||(L=L.slice(0,S),R.value=d.userValue=L,e.setValue(t,{value:L}),(k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:L,willCommit:!0,commitKey:1,selStart:R.selectionStart,selEnd:R.selectionEnd}}))}};this._dispatchEventFromSandbox(C,_)}),n.addEventListener("keydown",_=>{var S;d.commitKey=1;let C=-1;if(_.key==="Escape"?C=0:_.key==="Enter"&&!this.data.multiLine?C=2:_.key==="Tab"&&(d.commitKey=3),C===-1)return;const{value:I}=_.target;d.lastCommittedValue!==I&&(d.lastCommittedValue=I,d.userValue=I,(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:I,willCommit:!0,commitKey:C,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const A=b;b=null,n.addEventListener("blur",_=>{var S,R;if(!d.focused||!_.relatedTarget)return;(S=this.data.actions)!=null&&S.Blur||(d.focused=!1);const{target:C}=_;let{value:I}=C;if(w){if(I&&p==="time"){const L=I.split(":").map(k=>parseInt(k,10));I=new Date(2e3,0,1,L[0],L[1],L[2]||0).valueOf(),C.step=""}else I=new Date(I).valueOf();C.type="text"}d.userValue=I,d.lastCommittedValue!==I&&((R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:I,willCommit:!0,commitKey:d.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}})),A(_)}),(s=this.data.actions)!=null&&s.Keystroke&&n.addEventListener("beforeinput",_=>{var D;d.lastCommittedValue=null;const{data:C,target:I}=_,{value:S,selectionStart:R,selectionEnd:L}=I;let k=R,T=L;switch(_.inputType){case"deleteWordBackward":{const P=S.substring(0,R).match(/\w*[^\w]*$/);P&&(k-=P[0].length);break}case"deleteWordForward":{const P=S.substring(R).match(/^[^\w]*\w*/);P&&(T+=P[0].length);break}case"deleteContentBackward":R===L&&(k-=1);break;case"deleteContentForward":R===L&&(T+=1);break}_.preventDefault(),(D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,change:C||"",willCommit:!1,selStart:k,selEnd:T}})}),this._setEventListeners(n,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(b&&n.addEventListener("blur",b),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/u;n.classList.add("comb"),n.style.letterSpacing=`calc(${_}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class cee extends cf{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class hee extends cf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Zd.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=0,s.addEventListener("change",o=>{const{name:a,checked:u}=o.target;for(const c of this._getElementsByName(a,n)){const d=u&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=d),e.setValue(c.id,{value:d})}e.setValue(n,{value:u})}),s.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{const a={value(u){u.target.checked=u.detail.value!=="Off",e.setValue(n,{value:u.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class $j extends cf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(n,{value:r})),r)for(const o of this._getElementsByName(t.fieldName,n))e.setValue(o.id,{value:!1});const s=document.createElement("input");if(Zd.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",o=>{const{name:a,checked:u}=o.target;for(const c of this._getElementsByName(a,n))e.setValue(c.id,{value:!1});e.setValue(n,{value:u})}),s.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;s.addEventListener("updatefromsandbox",a=>{const u={value:c=>{const d=o===c.detail.value;for(const m of this._getElementsByName(c.target.name)){const p=d&&m.id===n;m.domElement&&(m.domElement.checked=p),e.setValue(m.id,{value:p})}}};this._dispatchEventFromSandbox(u,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class dee extends dD{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class fee extends cf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");Zd.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",d=>{const m=this.data.defaultFieldValue;for(const p of r.options)p.selected=p.value===m});for(const d of this.data.options){const m=document.createElement("option");m.textContent=d.displayValue,m.value=d.exportValue,n.value.includes(d.exportValue)&&(m.setAttribute("selected",!0),s=!1),r.append(m)}let o=null;if(s){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),r.prepend(d),o=()=>{d.remove(),r.removeEventListener("input",o),o=null},r.addEventListener("input",o)}const a=d=>{const m=d?"value":"textContent",{options:p,multiple:g}=r;return g?Array.prototype.filter.call(p,w=>w.selected).map(w=>w[m]):p.selectedIndex===-1?null:p[p.selectedIndex][m]};let u=a(!1);const c=d=>{const m=d.target.options;return Array.prototype.map.call(m,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",d=>{const m={value(p){o==null||o();const g=p.detail.value,w=new Set(Array.isArray(g)?g:[g]);for(const b of r.options)b.selected=w.has(b.value);e.setValue(t,{value:a(!0)}),u=a(!1)},multipleSelection(p){r.multiple=!0},remove(p){const g=r.options,w=p.detail.remove;g[w].selected=!1,r.remove(w),g.length>0&&Array.prototype.findIndex.call(g,A=>A.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:a(!0),items:c(p)}),u=a(!1)},clear(p){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),u=a(!1)},insert(p){const{index:g,displayValue:w,exportValue:b}=p.detail.insert,A=r.children[g],_=document.createElement("option");_.textContent=w,_.value=b,A?A.before(_):r.append(_),e.setValue(t,{value:a(!0),items:c(p)}),u=a(!1)},items(p){const{items:g}=p.detail;for(;r.length!==0;)r.remove(0);for(const w of g){const{displayValue:b,exportValue:A}=w,_=document.createElement("option");_.textContent=b,_.value=A,r.append(_)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:a(!0),items:c(p)}),u=a(!1)},indices(p){const g=new Set(p.detail.indices);for(const w of p.target.options)w.selected=g.has(w.index);e.setValue(t,{value:a(!0)}),u=a(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(m,d)}),r.addEventListener("input",d=>{var g;const m=a(!0),p=a(!1);e.setValue(t,{value:m}),d.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:u,change:p,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):r.addEventListener("input",function(d){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class GS extends Vn{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:Vn._hasPopupData(t)}),this.elements=n,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new pee({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,eventBus:this.linkService.eventBus}),n=[];for(const r of this.elements)r.popup=t,r.container.ariaHasPopup="dialog",n.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(r=>`${oD}${r}`).join(",")),this.container}}var yd,N1,O1,vd,pm,On,xl,fc,Sl,o0,a0,mm,ua,is,Tl,Il,l0,pc,gm,u0,Dl,ym,wd,mc,Ot,w_,Wj,Gj,__,KS,Kj,Jj,Yj,Xj,b_,A_,JS;class pee{constructor({container:e,color:t,elements:n,titleObj:r,modificationDate:s,contentsObj:o,richText:a,parent:u,rect:c,parentRect:d,open:m,eventBus:p=null}){z(this,Ot);z(this,yd,W(this,Ot,Yj).bind(this));z(this,N1,W(this,Ot,JS).bind(this));z(this,O1,W(this,Ot,A_).bind(this));z(this,vd,W(this,Ot,b_).bind(this));z(this,pm,null);z(this,On,null);z(this,xl,null);z(this,fc,null);z(this,Sl,null);z(this,o0,null);z(this,a0,null);z(this,mm,null);z(this,ua,!1);z(this,is,null);z(this,Tl,null);z(this,Il,null);z(this,l0,null);z(this,pc,null);z(this,gm,null);z(this,u0,null);z(this,Dl,null);z(this,ym,null);z(this,wd,null);z(this,mc,!1);U(this,On,e),U(this,ym,r),U(this,xl,o),U(this,Dl,a),U(this,a0,u),U(this,pm,t),U(this,u0,c),U(this,mm,d),U(this,Sl,n),U(this,o0,p),U(this,fc,h1.toDateObject(s)),this.trigger=n.flatMap(g=>g.getElementsToTriggerPopup()),W(this,Ot,w_).call(this),f(this,On).hidden=!0,m&&W(this,Ot,b_).call(this)}render(){var r;if(f(this,is))return;const e=U(this,is,document.createElement("div"));if(e.className="popup",f(this,pm)){const s=e.style.outlineColor=Je.makeHexColor(...f(this,pm));e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");if(t.className="header",(r=f(this,ym))!=null&&r.str){const s=document.createElement("span");s.className="title",t.append(s),{dir:s.dir,str:s.textContent}=f(this,ym)}if(e.append(t),f(this,fc)){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:f(this,fc).valueOf()})),s.dateTime=f(this,fc).toISOString(),t.append(s)}const n=f(this,Ot,__);if(n)Uj.render({xfaHtml:n,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(f(this,xl));e.append(s)}f(this,On).append(e)}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const r=e.split(/(?:\r\n?|\n)/);for(let s=0,o=r.length;s<o;++s){const a=r[s];n.append(document.createTextNode(a)),s<o-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:e,popup:t,deleted:n}){var r;if(n||t!=null&&t.deleted){this.remove();return}W(this,Ot,w_).call(this),f(this,wd)||U(this,wd,{contentsObj:f(this,xl),richText:f(this,Dl)}),e&&U(this,Il,null),t&&(U(this,Dl,W(this,Ot,Jj).call(this,t.text)),U(this,fc,h1.toDateObject(t.date)),U(this,xl,null)),(r=f(this,is))==null||r.remove(),U(this,is,null)}resetEdited(){var e;f(this,wd)&&({contentsObj:ir(this,xl)._,richText:ir(this,Dl)._}=f(this,wd),U(this,wd,null),(e=f(this,is))==null||e.remove(),U(this,is,null),U(this,Il,null))}remove(){var e,t;(e=f(this,Tl))==null||e.abort(),U(this,Tl,null),(t=f(this,is))==null||t.remove(),U(this,is,null),U(this,mc,!1),U(this,ua,!1);for(const n of this.trigger)n.classList.remove("popupTriggerArea")}forceHide(){U(this,mc,this.isVisible),f(this,mc)&&(f(this,On).hidden=!0)}maybeShow(){W(this,Ot,w_).call(this),f(this,mc)&&(f(this,is)||W(this,Ot,A_).call(this),U(this,mc,!1),f(this,On).hidden=!1)}get isVisible(){return f(this,On).hidden===!1}}yd=new WeakMap,N1=new WeakMap,O1=new WeakMap,vd=new WeakMap,pm=new WeakMap,On=new WeakMap,xl=new WeakMap,fc=new WeakMap,Sl=new WeakMap,o0=new WeakMap,a0=new WeakMap,mm=new WeakMap,ua=new WeakMap,is=new WeakMap,Tl=new WeakMap,Il=new WeakMap,l0=new WeakMap,pc=new WeakMap,gm=new WeakMap,u0=new WeakMap,Dl=new WeakMap,ym=new WeakMap,wd=new WeakMap,mc=new WeakMap,Ot=new WeakSet,w_=function(){var t;if(f(this,Tl))return;U(this,Tl,new AbortController);const{signal:e}=f(this,Tl);for(const n of this.trigger)n.addEventListener("click",f(this,vd),{signal:e}),n.addEventListener("mouseenter",f(this,O1),{signal:e}),n.addEventListener("mouseleave",f(this,N1),{signal:e}),n.classList.add("popupTriggerArea");for(const n of f(this,Sl))(t=n.container)==null||t.addEventListener("keydown",f(this,yd),{signal:e});W(this,Ot,Gj).call(this)},Wj=function(){const e=f(this,Sl).find(t=>t.hasCommentButton);e&&(U(this,pc,e._normalizePoint(e.commentButtonPosition)),U(this,gm,e.commentButtonColor))},Gj=function(){if(f(this,l0)||(f(this,pc)||W(this,Ot,Wj).call(this),!f(this,pc)))return;const e=U(this,l0,document.createElement("button"));e.className="annotationCommentButton";const t=f(this,Sl)[0].container;e.style.zIndex=t.style.zIndex+1,e.tabIndex=0;const{signal:n}=f(this,Tl);e.addEventListener("hover",f(this,vd),{signal:n}),e.addEventListener("keydown",f(this,yd),{signal:n}),e.addEventListener("click",()=>{var a;const[{data:{id:s},annotationEditorType:o}]=f(this,Sl);(a=f(this,o0))==null||a.dispatch("switchannotationeditormode",{source:this,editId:s,mode:o,editComment:!0})},{signal:n});const{style:r}=e;r.left=`calc(${f(this,pc)[0]}%)`,r.top=`calc(${f(this,pc)[1]}% - var(--comment-button-dim))`,f(this,gm)&&(r.backgroundColor=f(this,gm)),t.after(e)},__=function(){const e=f(this,Dl),t=f(this,xl);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&f(this,Dl).html||null},KS=function(){var e,t,n;return((n=(t=(e=f(this,Ot,__))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},Kj=function(){var e,t,n;return((n=(t=(e=f(this,Ot,__))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},Jj=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:f(this,Ot,Kj),fontSize:f(this,Ot,KS)?`calc(${f(this,Ot,KS)}px * var(--total-scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:r});return n},Yj=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&f(this,ua))&&W(this,Ot,b_).call(this)},Xj=function(){if(f(this,Il)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:r,pageY:s}}}=f(this,a0);let o=!!f(this,mm),a=o?f(this,mm):f(this,u0);for(const w of f(this,Sl))if(!a||Je.intersect(w.data.rect,a)!==null){a=w.data.rect,o=!0;break}const u=Je.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),d=o?a[2]-a[0]+5:0,m=u[0]+d,p=u[1];U(this,Il,[100*(m-r)/t,100*(p-s)/n]);const{style:g}=f(this,On);g.left=`${f(this,Il)[0]}%`,g.top=`${f(this,Il)[1]}%`},b_=function(){U(this,ua,!f(this,ua)),f(this,ua)?(W(this,Ot,A_).call(this),f(this,On).addEventListener("click",f(this,vd)),f(this,On).addEventListener("keydown",f(this,yd))):(W(this,Ot,JS).call(this),f(this,On).removeEventListener("click",f(this,vd)),f(this,On).removeEventListener("keydown",f(this,yd)))},A_=function(){f(this,is)||this.render(),this.isVisible?f(this,ua)&&f(this,On).classList.add("focused"):(W(this,Ot,Xj).call(this),f(this,On).hidden=!1,f(this,On).style.zIndex=parseInt(f(this,On).style.zIndex)+1e3)},JS=function(){f(this,On).classList.remove("focused"),!(f(this,ua)||!this.isVisible)&&(f(this,On).hidden=!0,f(this,On).style.zIndex=parseInt(f(this,On).style.zIndex)-1e3)};class Qj extends Vn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=yt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var c0;class mee extends Vn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});z(this,c0,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:n,height:r}=this,s=this.svgFactory.create(n,r,!0),o=U(this,c0,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,c0)}addHighlightArea(){this.container.classList.add("highlightArea")}}c0=new WeakMap;var h0;class gee extends Vn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});z(this,h0,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:n,height:r}=this,s=this.svgFactory.create(n,r,!0),o=t.borderStyle.width,a=U(this,h0,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",n-o),a.setAttribute("height",r-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,h0)}addHighlightArea(){this.container.classList.add("highlightArea")}}h0=new WeakMap;var d0;class yee extends Vn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});z(this,d0,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:n,height:r}=this,s=this.svgFactory.create(n,r,!0),o=t.borderStyle.width,a=U(this,d0,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",n/2),a.setAttribute("cy",r/2),a.setAttribute("rx",n/2-o/2),a.setAttribute("ry",r/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,d0)}addHighlightArea(){this.container.classList.add("highlightArea")}}d0=new WeakMap;var f0;class Zj extends Vn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});z(this,f0,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:r,popupRef:s},width:o,height:a}=this;if(!n)return this.container;const u=this.svgFactory.create(o,a,!0);let c=[];for(let m=0,p=n.length;m<p;m+=2){const g=n[m]-t[0],w=t[3]-n[m+1];c.push(`${g},${w}`)}c=c.join(" ");const d=U(this,f0,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",c),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),u.append(d),this.container.append(u),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,f0)}addHighlightArea(){this.container.classList.add("highlightArea")}}f0=new WeakMap;class vee extends Zj{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class wee extends Vn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var p0,_d,m0,YS;class fD extends Vn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});z(this,m0);z(this,p0,null);z(this,_d,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?yt.HIGHLIGHT:yt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:r,borderStyle:s,popupRef:o}}=this,{transform:a,width:u,height:c}=W(this,m0,YS).call(this,n,t),d=this.svgFactory.create(u,c,!0),m=U(this,p0,this.svgFactory.createElement("svg:g"));d.append(m),m.setAttribute("stroke-width",s.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",a);for(let p=0,g=r.length;p<g;p++){const w=this.svgFactory.createElement(this.svgElementName);f(this,_d).push(w),w.setAttribute("points",r[p].join(",")),m.append(w)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:r,rect:s}=t,o=f(this,p0);if(n>=0&&o.setAttribute("stroke-width",n||1),r)for(let a=0,u=f(this,_d).length;a<u;a++)f(this,_d)[a].setAttribute("points",r[a].join(","));if(s){const{transform:a,width:u,height:c}=W(this,m0,YS).call(this,this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${u} ${c}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return f(this,_d)}addHighlightArea(){this.container.classList.add("highlightArea")}get commentButtonPosition(){const{inkLists:t,rect:n}=this.data;if((t==null?void 0:t.length)>=1){let r=-1/0,s=-1/0;for(const o of t)for(let a=0,u=o.length;a<u;a+=2)o[a+1]>s?(s=o[a+1],r=o[a]):o[a+1]===s&&(r=Math.max(r,o[a]));if(r!==1/0)return[r,s]}return n?[n[2],n[3]]:null}}p0=new WeakMap,_d=new WeakMap,m0=new WeakSet,YS=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class e4 extends Vn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=yt.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class _ee extends Vn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class bee extends Vn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class Aee extends Vn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class t4 extends Vn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=yt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var g0,y0,XS;class Eee extends Vn{constructor(t){var r;super(t,{isRenderable:!0});z(this,y0);z(this,g0,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(r=this.linkService.eventBus)==null||r.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let r;n.hasAppearance||n.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),r.addEventListener("dblclick",W(this,y0,XS).bind(this)),U(this,g0,r);const{isMac:s}=$r.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&W(this,y0,XS).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return f(this,g0)}addHighlightArea(){this.container.classList.add("highlightArea")}}g0=new WeakMap,y0=new WeakSet,XS=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var v0,bd,gc,w0,Jc,ZS,eT;const AD=class AD{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:r,page:s,viewport:o,structTreeLayer:a}){z(this,Jc);z(this,v0,null);z(this,bd,null);z(this,gc,new Map);z(this,w0,null);this.div=e,U(this,v0,t),U(this,bd,n),U(this,w0,a||null),this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return f(this,gc).size>0}async render(e){var o;const{annotations:t}=e,n=this.div;Xd(n,this.viewport);const r=new Map,s={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new y1,annotationStorage:e.annotationStorage||new uD,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const u=a.annotationType===Gn.POPUP;if(u){const m=r.get(a.id);if(!m)continue;s.elements=m}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;s.data=a;const c=cF.create(s);if(!c.isRenderable)continue;if(!u&&a.popupRef){const m=r.get(a.popupRef);m?m.push(c):r.set(a.popupRef,[c])}const d=c.render();a.hidden&&(d.style.visibility="hidden"),await W(this,Jc,ZS).call(this,d,a.id,s.elements),c._isEditable&&(f(this,gc).set(c.data.id,c),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(c))}W(this,Jc,eT).call(this)}async addLinkAnnotations(e,t){const n={data:null,layer:this.div,linkService:t,svgFactory:new y1,parent:this};for(const r of e){r.borderStyle||(r.borderStyle=AD._defaultBorderStyle),n.data=r;const s=cF.create(n);if(!s.isRenderable)continue;const o=s.render();await W(this,Jc,ZS).call(this,o,r.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,Xd(t,{rotation:e.rotation}),W(this,Jc,eT).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(f(this,gc).values())}getEditableAnnotation(e){return f(this,gc).get(e)}static get _defaultBorderStyle(){return Rt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:np.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};v0=new WeakMap,bd=new WeakMap,gc=new WeakMap,w0=new WeakMap,Jc=new WeakSet,ZS=async function(e,t,n){var a,u;const r=e.firstChild||e,s=r.id=`${oD}${t}`,o=await((a=f(this,w0))==null?void 0:a.getAriaAttributes(s));if(o)for(const[c,d]of o)r.setAttribute(c,d);n?n.at(-1).container.after(e):(this.div.append(e),(u=f(this,v0))==null||u.moveElementInDOM(this.div,e,r,!1))},eT=function(){var t;if(!f(this,bd))return;const e=this.div;for(const[n,r]of f(this,bd)){const s=e.querySelector(`[data-annotation-id="${n}"]`);if(!s)continue;r.className="annotationContent";const{firstChild:o}=s;o?o.nodeName==="CANVAS"?o.replaceWith(r):o.classList.contains("annotationContent")?o.after(r):o.before(r):s.append(r);const a=f(this,gc).get(n);a&&(a._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(n,s.id,r),a._hasNoCanvas=!1):a.canvas=r)}f(this,bd).clear()};let QS=AD;const Vw=/\r\n?|\n/g;var Us,ss,_0,Ad,os,Zn,n4,r4,i4,E_,Wl,C_,x_,s4,nT,o4;const pn=class pn extends cn{constructor(t){super({...t,name:"freeTextEditor"});z(this,Zn);z(this,Us);z(this,ss,"");z(this,_0,`${this.id}-editor`);z(this,Ad,null);z(this,os);re(this,"_colorPicker",null);U(this,Us,t.color||pn._defaultColor||cn._defaultLineColor),U(this,os,t.fontSize||pn._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=pn.prototype,n=o=>o.isEmpty(),r=Qd.TRANSLATE_SMALL,s=Qd.TRANSLATE_BIG;return Rt(this,"_keyboardManager",new s2([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:n}]]))}static initialize(t,n){cn.initialize(t,n);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case Ft.FREETEXT_SIZE:pn._defaultFontSize=n;break;case Ft.FREETEXT_COLOR:pn._defaultColor=n;break}}updateParams(t,n){switch(t){case Ft.FREETEXT_SIZE:W(this,Zn,n4).call(this,n);break;case Ft.FREETEXT_COLOR:W(this,Zn,r4).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Ft.FREETEXT_SIZE,pn._defaultFontSize],[Ft.FREETEXT_COLOR,pn._defaultColor||cn._defaultLineColor]]}get propertiesToUpdate(){return[[Ft.FREETEXT_SIZE,f(this,os)],[Ft.FREETEXT_COLOR,f(this,Us)]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new g1(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Ft.FREETEXT_COLOR}get colorValue(){return f(this,Us)}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-pn._internalPadding*t,-(pn._internalPadding+f(this,os))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),U(this,Ad,new AbortController);const t=this._uiManager.combinedSignal(f(this,Ad));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",f(this,_0)),this._isDraggable=!0,(t=f(this,Ad))==null||t.abort(),U(this,Ad,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=f(this,ss),n=U(this,ss,W(this,Zn,i4).call(this).trimEnd());if(t===n)return;const r=s=>{if(U(this,ss,s),!s){this.remove();return}W(this,Zn,x_).call(this),this._uiManager.rebuild(this),W(this,Zn,E_).call(this)};this.addCommands({cmd:()=>{r(n)},undo:()=>{r(t)},mustExec:!1}),W(this,Zn,E_).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){pn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,n;(this._isCopy||this.annotationElementId)&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",f(this,_0)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${f(this,os)}px * var(--total-scale-factor))`,r.color=f(this,Us),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[u,c]=this.getInitialTranslation();[u,c]=this.pageTranslationToScreen(u,c);const[d,m]=this.pageDimensions,[p,g]=this.pageTranslation;let w,b;switch(this.rotation){case 0:w=t+(a[0]-p)/d,b=n+this.height-(a[1]-g)/m;break;case 90:w=t+(a[0]-p)/d,b=n-(a[1]-g)/m,[u,c]=[c,-u];break;case 180:w=t-this.width+(a[0]-p)/d,b=n-(a[1]-g)/m,[u,c]=[-u,-c];break;case 270:w=t+(a[0]-p-this.height*m)/d,b=n+(a[1]-g-this.width*d)/m,[u,c]=[-c,u];break}this.setAt(w*s,b*o,u,c)}else this._moveAfterPaste(t,n);W(this,Zn,x_).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var w,b,A;const n=t.clipboardData||window.clipboardData,{types:r}=n;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const s=W(w=pn,Wl,nT).call(w,n.getData("text")||"").replaceAll(Vw,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!s.includes(`
`)){a.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:u,startOffset:c}=a,d=[],m=[];if(u.nodeType===Node.TEXT_NODE){const _=u.parentElement;if(m.push(u.nodeValue.slice(c).replaceAll(Vw,"")),_!==this.editorDiv){let C=d;for(const I of this.editorDiv.childNodes){if(I===_){C=m;continue}C.push(W(b=pn,Wl,C_).call(b,I))}}d.push(u.nodeValue.slice(0,c).replaceAll(Vw,""))}else if(u===this.editorDiv){let _=d,C=0;for(const I of this.editorDiv.childNodes)C++===c&&(_=m),_.push(W(A=pn,Wl,C_).call(A,I))}U(this,ss,`${d.join(`
`)}${s}${m.join(`
`)}`),W(this,Zn,x_).call(this);const p=new Range;let g=Math.sumPrecise(d.map(_=>_.length));for(const{firstChild:_}of this.editorDiv.childNodes)if(_.nodeType===Node.TEXT_NODE){const C=_.nodeValue.length;if(g<=C){p.setStart(_,g),p.setEnd(_,g);break}g-=C}o.removeAllRanges(),o.addRange(p)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=pn._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,n,r){var a;let s=null;if(t instanceof Qj){const{data:{defaultAppearanceData:{fontSize:u,fontColor:c},rect:d,rotation:m,id:p,popupRef:g,contentsObj:w},textContent:b,textPosition:A,parent:{page:{pageNumber:_}}}=t;if(!b||b.length===0)return null;s=t={annotationType:yt.FREETEXT,color:Array.from(c),fontSize:u,value:b.join(`
`),position:A,pageIndex:_-1,rect:d.slice(0),rotation:m,annotationElementId:p,id:p,deleted:!1,popupRef:g,comment:(w==null?void 0:w.str)||null}}const o=await super.deserialize(t,n,r);return U(o,os,t.fontSize),U(o,Us,Je.makeHexColor(...t.color)),U(o,ss,W(a=pn,Wl,nT).call(a,t.value)),o._initialData=s,t.comment&&o.setCommentData(t.comment),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=this.getPDFRect(),r=cn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:f(this,Us)),s={annotationType:yt.FREETEXT,color:r,fontSize:f(this,os),value:W(this,Zn,s4).call(this),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!W(this,Zn,o4).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(!n)return null;const{style:r}=n;r.fontSize=`calc(${f(this,os)}px * var(--total-scale-factor))`,r.color=f(this,Us),n.replaceChildren();for(const o of f(this,ss).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),n.append(a)}const s={rect:this.getPDFRect()};return s.popup=this.hasEditedComment?this.comment:{text:f(this,ss)},t.updateEdited(s),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Us=new WeakMap,ss=new WeakMap,_0=new WeakMap,Ad=new WeakMap,os=new WeakMap,Zn=new WeakSet,n4=function(t){const n=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-f(this,os))*this.parentScale),U(this,os,s),W(this,Zn,E_).call(this)},r=f(this,os);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ft.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},r4=function(t){const n=s=>{var o;U(this,Us,this.editorDiv.style.color=s),(o=this._colorPicker)==null||o.update(s)},r=f(this,Us);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ft.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},i4=function(){var r;const t=[];this.editorDiv.normalize();let n=null;for(const s of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(W(r=pn,Wl,C_).call(r,s)),n=s);return t.join(`
`)},E_=function(){const[t,n]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,a=o.style.display,u=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),r=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/n):(this.width=r.height/t,this.height=r.width/n),this.fixAndSetPosition()},Wl=new WeakSet,C_=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Vw,"")},x_=function(){if(this.editorDiv.replaceChildren(),!!f(this,ss))for(const t of f(this,ss).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},s4=function(){return f(this,ss).replaceAll(" "," ")},nT=function(t){return t.replaceAll(" "," ")},o4=function(t){const{value:n,fontSize:r,color:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==n||t.fontSize!==r||t.color.some((a,u)=>a!==s[u])||t.pageIndex!==o},z(pn,Wl),re(pn,"_freeTextDefaultContent",""),re(pn,"_internalPadding",0),re(pn,"_defaultColor",null),re(pn,"_defaultFontSize",10),re(pn,"_type","freetext"),re(pn,"_editorType",yt.FREETEXT);let tT=pn;class He{toSVGPath(){rn("Abstract method `toSVGPath` must be implemented.")}get box(){rn("Abstract getter `box` must be implemented.")}serialize(e,t){rn("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,r,s,o){o||(o=new Float32Array(e.length));for(let a=0,u=e.length;a<u;a+=2)o[a]=t+e[a]*r,o[a+1]=n+e[a+1]*s;return o}static _rescaleAndSwap(e,t,n,r,s,o){o||(o=new Float32Array(e.length));for(let a=0,u=e.length;a<u;a+=2)o[a]=t+e[a+1]*r,o[a+1]=n+e[a]*s;return o}static _translate(e,t,n,r){r||(r=new Float32Array(e.length));for(let s=0,o=e.length;s<o;s+=2)r[s]=t+e[s],r[s+1]=n+e[s+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,r,s){switch(s){case 90:return[1-t/n,e/r];case 180:return[1-e/n,1-t/r];case 270:return[t/n,1-e/r];default:return[e/n,t/r]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,r,s,o){return[(e+5*n)/6,(t+5*r)/6,(5*n+s)/6,(5*r+o)/6,(n+s)/2,(r+o)/2]}}re(He,"PRECISION",1e-4);var as,Ao,vm,wm,ca,Dt,Ed,Cd,b0,A0,_m,bm,yc,E0,L1,F1,dr,Cy,a4,l4,u4,c4,h4,d4;const Za=class Za{constructor({x:e,y:t},n,r,s,o,a=0){z(this,dr);z(this,as);z(this,Ao,[]);z(this,vm);z(this,wm);z(this,ca,[]);z(this,Dt,new Float32Array(18));z(this,Ed);z(this,Cd);z(this,b0);z(this,A0);z(this,_m);z(this,bm);z(this,yc,[]);U(this,as,n),U(this,bm,s*r),U(this,wm,o),f(this,Dt).set([NaN,NaN,NaN,NaN,e,t],6),U(this,vm,a),U(this,A0,f(Za,E0)*r),U(this,b0,f(Za,F1)*r),U(this,_m,r),f(this,yc).push(e,t)}isEmpty(){return isNaN(f(this,Dt)[8])}add({x:e,y:t}){var D;U(this,Ed,e),U(this,Cd,t);const[n,r,s,o]=f(this,as);let[a,u,c,d]=f(this,Dt).subarray(8,12);const m=e-c,p=t-d,g=Math.hypot(m,p);if(g<f(this,b0))return!1;const w=g-f(this,A0),b=w/g,A=b*m,_=b*p;let C=a,I=u;a=c,u=d,c+=A,d+=_,(D=f(this,yc))==null||D.push(e,t);const S=-_/w,R=A/w,L=S*f(this,bm),k=R*f(this,bm);return f(this,Dt).set(f(this,Dt).subarray(2,8),0),f(this,Dt).set([c+L,d+k],4),f(this,Dt).set(f(this,Dt).subarray(14,18),12),f(this,Dt).set([c-L,d-k],16),isNaN(f(this,Dt)[6])?(f(this,ca).length===0&&(f(this,Dt).set([a+L,u+k],2),f(this,ca).push(NaN,NaN,NaN,NaN,(a+L-n)/s,(u+k-r)/o),f(this,Dt).set([a-L,u-k],14),f(this,Ao).push(NaN,NaN,NaN,NaN,(a-L-n)/s,(u-k-r)/o)),f(this,Dt).set([C,I,a,u,c,d],6),!this.isEmpty()):(f(this,Dt).set([C,I,a,u,c,d],6),Math.abs(Math.atan2(I-u,C-a)-Math.atan2(_,A))<Math.PI/2?([a,u,c,d]=f(this,Dt).subarray(2,6),f(this,ca).push(NaN,NaN,NaN,NaN,((a+c)/2-n)/s,((u+d)/2-r)/o),[a,u,C,I]=f(this,Dt).subarray(14,18),f(this,Ao).push(NaN,NaN,NaN,NaN,((C+a)/2-n)/s,((I+u)/2-r)/o),!0):([C,I,a,u,c,d]=f(this,Dt).subarray(0,6),f(this,ca).push(((C+5*a)/6-n)/s,((I+5*u)/6-r)/o,((5*a+c)/6-n)/s,((5*u+d)/6-r)/o,((a+c)/2-n)/s,((u+d)/2-r)/o),[c,d,a,u,C,I]=f(this,Dt).subarray(12,18),f(this,Ao).push(((C+5*a)/6-n)/s,((I+5*u)/6-r)/o,((5*a+c)/6-n)/s,((5*u+d)/6-r)/o,((a+c)/2-n)/s,((u+d)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=f(this,ca),t=f(this,Ao);if(isNaN(f(this,Dt)[6])&&!this.isEmpty())return W(this,dr,a4).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?n.push(`L${e[r+4]} ${e[r+5]}`):n.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);W(this,dr,u4).call(this,n);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?n.push(`L${t[r+4]} ${t[r+5]}`):n.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return W(this,dr,l4).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,r,s,o){return new f4(e,t,n,r,s,o)}getOutlines(){var m;const e=f(this,ca),t=f(this,Ao),n=f(this,Dt),[r,s,o,a]=f(this,as),u=new Float32Array((((m=f(this,yc))==null?void 0:m.length)??0)+2);for(let p=0,g=u.length-2;p<g;p+=2)u[p]=(f(this,yc)[p]-r)/o,u[p+1]=(f(this,yc)[p+1]-s)/a;if(u[u.length-2]=(f(this,Ed)-r)/o,u[u.length-1]=(f(this,Cd)-s)/a,isNaN(n[6])&&!this.isEmpty())return W(this,dr,c4).call(this,u);const c=new Float32Array(f(this,ca).length+24+f(this,Ao).length);let d=e.length;for(let p=0;p<d;p+=2){if(isNaN(e[p])){c[p]=c[p+1]=NaN;continue}c[p]=e[p],c[p+1]=e[p+1]}d=W(this,dr,d4).call(this,c,d);for(let p=t.length-6;p>=6;p-=6)for(let g=0;g<6;g+=2){if(isNaN(t[p+g])){c[d]=c[d+1]=NaN,d+=2;continue}c[d]=t[p+g],c[d+1]=t[p+g+1],d+=2}return W(this,dr,h4).call(this,c,d),this.newFreeDrawOutline(c,u,f(this,as),f(this,_m),f(this,vm),f(this,wm))}};as=new WeakMap,Ao=new WeakMap,vm=new WeakMap,wm=new WeakMap,ca=new WeakMap,Dt=new WeakMap,Ed=new WeakMap,Cd=new WeakMap,b0=new WeakMap,A0=new WeakMap,_m=new WeakMap,bm=new WeakMap,yc=new WeakMap,E0=new WeakMap,L1=new WeakMap,F1=new WeakMap,dr=new WeakSet,Cy=function(){const e=f(this,Dt).subarray(4,6),t=f(this,Dt).subarray(16,18),[n,r,s,o]=f(this,as);return[(f(this,Ed)+(e[0]-t[0])/2-n)/s,(f(this,Cd)+(e[1]-t[1])/2-r)/o,(f(this,Ed)+(t[0]-e[0])/2-n)/s,(f(this,Cd)+(t[1]-e[1])/2-r)/o]},a4=function(){const[e,t,n,r]=f(this,as),[s,o,a,u]=W(this,dr,Cy).call(this);return`M${(f(this,Dt)[2]-e)/n} ${(f(this,Dt)[3]-t)/r} L${(f(this,Dt)[4]-e)/n} ${(f(this,Dt)[5]-t)/r} L${s} ${o} L${a} ${u} L${(f(this,Dt)[16]-e)/n} ${(f(this,Dt)[17]-t)/r} L${(f(this,Dt)[14]-e)/n} ${(f(this,Dt)[15]-t)/r} Z`},l4=function(e){const t=f(this,Ao);e.push(`L${t[4]} ${t[5]} Z`)},u4=function(e){const[t,n,r,s]=f(this,as),o=f(this,Dt).subarray(4,6),a=f(this,Dt).subarray(16,18),[u,c,d,m]=W(this,dr,Cy).call(this);e.push(`L${(o[0]-t)/r} ${(o[1]-n)/s} L${u} ${c} L${d} ${m} L${(a[0]-t)/r} ${(a[1]-n)/s}`)},c4=function(e){const t=f(this,Dt),[n,r,s,o]=f(this,as),[a,u,c,d]=W(this,dr,Cy).call(this),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(t[2]-n)/s,(t[3]-r)/o,NaN,NaN,NaN,NaN,(t[4]-n)/s,(t[5]-r)/o,NaN,NaN,NaN,NaN,a,u,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,(t[16]-n)/s,(t[17]-r)/o,NaN,NaN,NaN,NaN,(t[14]-n)/s,(t[15]-r)/o],0),this.newFreeDrawOutline(m,e,f(this,as),f(this,_m),f(this,vm),f(this,wm))},h4=function(e,t){const n=f(this,Ao);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},d4=function(e,t){const n=f(this,Dt).subarray(4,6),r=f(this,Dt).subarray(16,18),[s,o,a,u]=f(this,as),[c,d,m,p]=W(this,dr,Cy).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-s)/a,(n[1]-o)/u,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,m,p,NaN,NaN,NaN,NaN,(r[0]-s)/a,(r[1]-o)/u],t),t+=24},z(Za,E0,8),z(Za,L1,2),z(Za,F1,f(Za,E0)+f(Za,L1));let v1=Za;var Am,xd,kl,C0,ls,x0,qn,M1,p4;class f4 extends He{constructor(t,n,r,s,o,a){super();z(this,M1);z(this,Am);z(this,xd,new Float32Array(4));z(this,kl);z(this,C0);z(this,ls);z(this,x0);z(this,qn);U(this,qn,t),U(this,ls,n),U(this,Am,r),U(this,x0,s),U(this,kl,o),U(this,C0,a),this.lastPoint=[NaN,NaN],W(this,M1,p4).call(this,a);const[u,c,d,m]=f(this,xd);for(let p=0,g=t.length;p<g;p+=2)t[p]=(t[p]-u)/d,t[p+1]=(t[p+1]-c)/m;for(let p=0,g=n.length;p<g;p+=2)n[p]=(n[p]-u)/d,n[p+1]=(n[p+1]-c)/m}toSVGPath(){const t=[`M${f(this,qn)[4]} ${f(this,qn)[5]}`];for(let n=6,r=f(this,qn).length;n<r;n+=6){if(isNaN(f(this,qn)[n])){t.push(`L${f(this,qn)[n+4]} ${f(this,qn)[n+5]}`);continue}t.push(`C${f(this,qn)[n]} ${f(this,qn)[n+1]} ${f(this,qn)[n+2]} ${f(this,qn)[n+3]} ${f(this,qn)[n+4]} ${f(this,qn)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,r,s],o){const a=r-t,u=s-n;let c,d;switch(o){case 0:c=He._rescale(f(this,qn),t,s,a,-u),d=He._rescale(f(this,ls),t,s,a,-u);break;case 90:c=He._rescaleAndSwap(f(this,qn),t,n,a,u),d=He._rescaleAndSwap(f(this,ls),t,n,a,u);break;case 180:c=He._rescale(f(this,qn),r,n,-a,u),d=He._rescale(f(this,ls),r,n,-a,u);break;case 270:c=He._rescaleAndSwap(f(this,qn),r,s,-a,-u),d=He._rescaleAndSwap(f(this,ls),r,s,-a,-u);break}return{outline:Array.from(c),points:[Array.from(d)]}}get box(){return f(this,xd)}newOutliner(t,n,r,s,o,a=0){return new v1(t,n,r,s,o,a)}getNewOutline(t,n){const[r,s,o,a]=f(this,xd),[u,c,d,m]=f(this,Am),p=o*d,g=a*m,w=r*d+u,b=s*m+c,A=this.newOutliner({x:f(this,ls)[0]*p+w,y:f(this,ls)[1]*g+b},f(this,Am),f(this,x0),t,f(this,C0),n??f(this,kl));for(let _=2;_<f(this,ls).length;_+=2)A.add({x:f(this,ls)[_]*p+w,y:f(this,ls)[_+1]*g+b});return A.getOutlines()}}Am=new WeakMap,xd=new WeakMap,kl=new WeakMap,C0=new WeakMap,ls=new WeakMap,x0=new WeakMap,qn=new WeakMap,M1=new WeakSet,p4=function(t){const n=f(this,qn);let r=n[4],s=n[5];const o=[r,s,r,s];let a=r,u=s;const c=t?Math.max:Math.min;for(let m=6,p=n.length;m<p;m+=6){const g=n[m+4],w=n[m+5];if(isNaN(n[m]))Je.pointBoundingBox(g,w,o),u<w?(a=g,u=w):u===w&&(a=c(a,g));else{const b=[1/0,1/0,-1/0,-1/0];Je.bezierBoundingBox(r,s,...n.slice(m,m+6),b),Je.rectBoundingBox(...b,o),u<b[3]?(a=b[2],u=b[3]):u===b[3]&&(a=c(a,b[2]))}r=g,s=w}const d=f(this,xd);d[0]=o[0]-f(this,kl),d[1]=o[1]-f(this,kl),d[2]=o[2]-o[0]+2*f(this,kl),d[3]=o[3]-o[1]+2*f(this,kl),this.lastPoint=[a,u]};var S0,T0,vc,Eo,bi,m4,S_,g4,y4,iT;class rT{constructor(e,t=0,n=0,r=!0){z(this,bi);z(this,S0);z(this,T0);z(this,vc,[]);z(this,Eo,[]);const s=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:g,y:w,width:b,height:A}of e){const _=Math.floor((g-t)/o)*o,C=Math.ceil((g+b+t)/o)*o,I=Math.floor((w-t)/o)*o,S=Math.ceil((w+A+t)/o)*o,R=[_,I,S,!0],L=[C,I,S,!1];f(this,vc).push(R,L),Je.rectBoundingBox(_,I,C,S,s)}const a=s[2]-s[0]+2*n,u=s[3]-s[1]+2*n,c=s[0]-n,d=s[1]-n,m=f(this,vc).at(r?-1:-2),p=[m[0],m[2]];for(const g of f(this,vc)){const[w,b,A]=g;g[0]=(w-c)/a,g[1]=(b-d)/u,g[2]=(A-d)/u}U(this,S0,new Float32Array([c,d,a,u])),U(this,T0,p)}getOutlines(){f(this,vc).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of f(this,vc))t[3]?(e.push(...W(this,bi,iT).call(this,t)),W(this,bi,g4).call(this,t)):(W(this,bi,y4).call(this,t),e.push(...W(this,bi,iT).call(this,t)));return W(this,bi,m4).call(this,e)}}S0=new WeakMap,T0=new WeakMap,vc=new WeakMap,Eo=new WeakMap,bi=new WeakSet,m4=function(e){const t=[],n=new Set;for(const o of e){const[a,u,c]=o;t.push([a,u,o],[a,c,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const u=t[o][2],c=t[o+1][2];u.push(c),c.push(u),n.add(u),n.add(c)}const r=[];let s;for(;n.size>0;){const o=n.values().next().value;let[a,u,c,d,m]=o;n.delete(o);let p=a,g=u;for(s=[a,c],r.push(s);;){let w;if(n.has(d))w=d;else if(n.has(m))w=m;else break;n.delete(w),[a,u,c,d,m]=w,p!==a&&(s.push(p,g,a,g===u?u:c),p=a),g=g===u?c:u}s.push(p,g)}return new Cee(r,f(this,S0),f(this,T0))},S_=function(e){const t=f(this,Eo);let n=0,r=t.length-1;for(;n<=r;){const s=n+r>>1,o=t[s][0];if(o===e)return s;o<e?n=s+1:r=s-1}return r+1},g4=function([,e,t]){const n=W(this,bi,S_).call(this,e);f(this,Eo).splice(n,0,[e,t])},y4=function([,e,t]){const n=W(this,bi,S_).call(this,e);for(let r=n;r<f(this,Eo).length;r++){const[s,o]=f(this,Eo)[r];if(s!==e)break;if(s===e&&o===t){f(this,Eo).splice(r,1);return}}for(let r=n-1;r>=0;r--){const[s,o]=f(this,Eo)[r];if(s!==e)break;if(s===e&&o===t){f(this,Eo).splice(r,1);return}}},iT=function(e){const[t,n,r]=e,s=[[t,n,r]],o=W(this,bi,S_).call(this,r);for(let a=0;a<o;a++){const[u,c]=f(this,Eo)[a];for(let d=0,m=s.length;d<m;d++){const[,p,g]=s[d];if(!(c<=p||g<=u)){if(p>=u){if(g>c)s[d][1]=c;else{if(m===1)return[];s.splice(d,1),d--,m--}continue}s[d][2]=u,g>c&&s.push([t,c,g])}}}return s};var I0,Em;class Cee extends He{constructor(t,n,r){super();z(this,I0);z(this,Em);U(this,Em,t),U(this,I0,n),this.lastPoint=r}toSVGPath(){const t=[];for(const n of f(this,Em)){let[r,s]=n;t.push(`M${r} ${s}`);for(let o=2;o<n.length;o+=2){const a=n[o],u=n[o+1];a===r?(t.push(`V${u}`),s=u):u===s&&(t.push(`H${a}`),r=a)}t.push("Z")}return t.join(" ")}serialize([t,n,r,s],o){const a=[],u=r-t,c=s-n;for(const d of f(this,Em)){const m=new Array(d.length);for(let p=0;p<d.length;p+=2)m[p]=t+d[p]*u,m[p+1]=s-d[p+1]*c;a.push(m)}return a}get box(){return f(this,I0)}get classNamesForOutlining(){return["highlightOutline"]}}I0=new WeakMap,Em=new WeakMap;class sT extends v1{newFreeDrawOutline(e,t,n,r,s,o){return new xee(e,t,n,r,s,o)}}class xee extends f4{newOutliner(e,t,n,r,s,o=0){return new sT(e,t,n,r,s,o)}}var Cm,D0,Rl,Sd,k0,Bi,R0,P0,Td,Vs,us,Mr,xm,Pl,ti,Sm,Hs,N0,Ct,oT,T_,v4,w4,_4,aT,Ph,$s,lp,b4,I_,xy,A4,E4,C4,x4,S4;const $t=class $t extends cn{constructor(t){super({...t,name:"highlightEditor"});z(this,Ct);z(this,Cm,null);z(this,D0,0);z(this,Rl);z(this,Sd,null);z(this,k0,null);z(this,Bi,null);z(this,R0,null);z(this,P0,0);z(this,Td,null);z(this,Vs,null);z(this,us,null);z(this,Mr,!1);z(this,xm,null);z(this,Pl);z(this,ti,null);z(this,Sm,"");z(this,Hs);z(this,N0,"");this.color=t.color||$t._defaultColor,U(this,Hs,t.thickness||$t._defaultThickness),U(this,Pl,t.opacity||$t._defaultOpacity),U(this,Rl,t.boxes||null),U(this,N0,t.methodOfCreation||""),U(this,Sm,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(U(this,Mr,!0),W(this,Ct,T_).call(this,t),W(this,Ct,Ph).call(this)):f(this,Rl)&&(U(this,Cm,t.anchorNode),U(this,D0,t.anchorOffset),U(this,R0,t.focusNode),U(this,P0,t.focusOffset),W(this,Ct,oT).call(this),W(this,Ct,Ph).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=$t.prototype;return Rt(this,"_keyboardManager",new s2([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:f(this,Mr)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:f(this,Hs),methodOfCreation:f(this,N0)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var r;cn.initialize(t,n),$t._defaultColor||($t._defaultColor=((r=n.highlightColors)==null?void 0:r.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case Ft.HIGHLIGHT_COLOR:$t._defaultColor=n;break;case Ft.HIGHLIGHT_THICKNESS:$t._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return f(this,xm)}updateParams(t,n){switch(t){case Ft.HIGHLIGHT_COLOR:W(this,Ct,v4).call(this,n);break;case Ft.HIGHLIGHT_THICKNESS:W(this,Ct,w4).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Ft.HIGHLIGHT_COLOR,$t._defaultColor],[Ft.HIGHLIGHT_THICKNESS,$t._defaultThickness]]}get propertiesToUpdate(){return[[Ft.HIGHLIGHT_COLOR,this.color||$t._defaultColor],[Ft.HIGHLIGHT_THICKNESS,f(this,Hs)||$t._defaultThickness],[Ft.HIGHLIGHT_FREE,f(this,Mr)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",U(this,k0,new m1({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(W(this,Ct,xy).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,W(this,Ct,xy).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){W(this,Ct,aT).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(W(this,Ct,Ph).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let n=!1;this.parent&&!t?W(this,Ct,aT).call(this):t&&(W(this,Ct,Ph).call(this,t),n=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var s,o,a;const{drawLayer:n}=this.parent;let r;f(this,Mr)?(t=(t-this.rotation+360)%360,r=W(s=$t,$s,lp).call(s,f(this,Vs).box,t)):r=W(o=$t,$s,lp).call(o,[this.x,this.y,this.width,this.height],t),n.updateProperties(f(this,us),{bbox:r,root:{"data-main-rotation":t}}),n.updateProperties(f(this,ti),{bbox:W(a=$t,$s,lp).call(a,f(this,Bi).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();f(this,Sm)&&(t.setAttribute("aria-label",f(this,Sm)),t.setAttribute("role","mark")),f(this,Mr)?t.classList.add("free"):this.div.addEventListener("keydown",W(this,Ct,b4).bind(this),{signal:this._uiManager._signal});const n=U(this,Td,document.createElement("div"));t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=f(this,Sd);const[r,s]=this.parentDimensions;return this.setDims(this.width*r,this.height*s),H5(this,f(this,Td),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(f(this,ti),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(f(this,ti),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:W(this,Ct,I_).call(this,!0);break;case 1:case 3:W(this,Ct,I_).call(this,!1);break}}select(){var t;super.select(),f(this,ti)&&((t=this.parent)==null||t.drawLayer.updateProperties(f(this,ti),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),f(this,ti)&&((t=this.parent)==null||t.drawLayer.updateProperties(f(this,ti),{rootClass:{selected:!1}}),f(this,Mr)||W(this,Ct,I_).call(this,!1))}get _mustFixPosition(){return!f(this,Mr)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(f(this,us),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(f(this,ti),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:r,x:s,y:o}){const{x:a,y:u,width:c,height:d}=r.getBoundingClientRect(),m=new AbortController,p=t.combinedSignal(m),g=w=>{m.abort(),W(this,$s,x4).call(this,t,w)};window.addEventListener("blur",g,{signal:p}),window.addEventListener("pointerup",g,{signal:p}),window.addEventListener("pointerdown",Jn,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Xs,{signal:p}),r.addEventListener("pointermove",W(this,$s,C4).bind(this,t),{signal:p}),this._freeHighlight=new sT({x:s,y:o},[a,u,c,d],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,r){var b,A,_,C;let s=null;if(t instanceof e4){const{data:{quadPoints:I,rect:S,rotation:R,id:L,color:k,opacity:T,popupRef:D,contentsObj:P},parent:{page:{pageNumber:N}}}=t;s=t={annotationType:yt.HIGHLIGHT,color:Array.from(k),opacity:T,quadPoints:I,boxes:null,pageIndex:N-1,rect:S.slice(0),rotation:R,annotationElementId:L,id:L,deleted:!1,popupRef:D,comment:(P==null?void 0:P.str)||null}}else if(t instanceof fD){const{data:{inkLists:I,rect:S,rotation:R,id:L,color:k,borderStyle:{rawWidth:T},popupRef:D,contentsObj:P},parent:{page:{pageNumber:N}}}=t;s=t={annotationType:yt.HIGHLIGHT,color:Array.from(k),thickness:T,inkLists:I,boxes:null,pageIndex:N-1,rect:S.slice(0),rotation:R,annotationElementId:L,id:L,deleted:!1,popupRef:D,comment:(P==null?void 0:P.str)||null}}const{color:o,quadPoints:a,inkLists:u,opacity:c}=t,d=await super.deserialize(t,n,r);d.color=Je.makeHexColor(...o),U(d,Pl,c||1),u&&U(d,Hs,t.thickness),d._initialData=s,t.comment&&d.setCommentData(t.comment);const[m,p]=d.pageDimensions,[g,w]=d.pageTranslation;if(a){const I=U(d,Rl,[]);for(let S=0;S<a.length;S+=8)I.push({x:(a[S]-g)/m,y:1-(a[S+1]-w)/p,width:(a[S+2]-a[S])/m,height:(a[S+1]-a[S+5])/p});W(b=d,Ct,oT).call(b),W(A=d,Ct,Ph).call(A),d.rotate(d.rotation)}else if(u){U(d,Mr,!0);const I=u[0],S={x:I[0]-g,y:p-(I[1]-w)},R=new sT(S,[0,0,m,p],1,f(d,Hs)/2,!0,.001);for(let T=0,D=I.length;T<D;T+=2)S.x=I[T]-g,S.y=p-(I[T+1]-w),R.add(S);const{id:L,clipPathId:k}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:R.toSVGPath()}},!0,!0);W(_=d,Ct,T_).call(_,{highlightOutlines:R.getOutlines(),highlightId:L,clipPathId:k}),W(C=d,Ct,Ph).call(C),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=this.getPDFRect(),r=cn._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s={annotationType:yt.HIGHLIGHT,color:r,opacity:f(this,Pl),thickness:f(this,Hs),quadPoints:W(this,Ct,A4).call(this),outlines:W(this,Ct,E4).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:W(this,Ct,xy).call(this),structTreeParentId:this._structTreeParentId};return this.addComment(s),this.annotationElementId&&!W(this,Ct,S4).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const n={rect:this.getPDFRect()};return this.hasEditedComment&&(n.popup=this.comment),t.updateEdited(n),null}static canCreateNewEmptyEditor(){return!1}};Cm=new WeakMap,D0=new WeakMap,Rl=new WeakMap,Sd=new WeakMap,k0=new WeakMap,Bi=new WeakMap,R0=new WeakMap,P0=new WeakMap,Td=new WeakMap,Vs=new WeakMap,us=new WeakMap,Mr=new WeakMap,xm=new WeakMap,Pl=new WeakMap,ti=new WeakMap,Sm=new WeakMap,Hs=new WeakMap,N0=new WeakMap,Ct=new WeakSet,oT=function(){const t=new rT(f(this,Rl),.001);U(this,Vs,t.getOutlines()),[this.x,this.y,this.width,this.height]=f(this,Vs).box;const n=new rT(f(this,Rl),.0025,.001,this._uiManager.direction==="ltr");U(this,Bi,n.getOutlines());const{lastPoint:r}=f(this,Bi);U(this,xm,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},T_=function({highlightOutlines:t,highlightId:n,clipPathId:r}){var m,p;if(U(this,Vs,t),U(this,Bi,t.getNewOutline(f(this,Hs)/2+1.5,.0025)),n>=0)U(this,us,n),U(this,Sd,r),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),U(this,ti,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:f(this,Bi).box,path:{d:f(this,Bi).toSVGPath()}},!0));else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(f(this,us),{bbox:W(m=$t,$s,lp).call(m,f(this,Vs).box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(f(this,ti),{bbox:W(p=$t,$s,lp).call(p,f(this,Bi).box,g),path:{d:f(this,Bi).toSVGPath()}})}const[o,a,u,c]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=u,this.height=c;break;case 90:{const[g,w]=this.parentDimensions;this.x=a,this.y=1-o,this.width=u*w/g,this.height=c*g/w;break}case 180:this.x=1-o,this.y=1-a,this.width=u,this.height=c;break;case 270:{const[g,w]=this.parentDimensions;this.x=1-a,this.y=o,this.width=u*w/g,this.height=c*g/w;break}}const{lastPoint:d}=f(this,Bi);U(this,xm,[(d[0]-o)/u,(d[1]-a)/c])},v4=function(t){const n=(o,a)=>{var u,c;this.color=o,U(this,Pl,a),(u=this.parent)==null||u.drawLayer.updateProperties(f(this,us),{root:{fill:o,"fill-opacity":a}}),(c=f(this,k0))==null||c.updateColor(o)},r=this.color,s=f(this,Pl);this.addCommands({cmd:n.bind(this,t,$t._defaultOpacity),undo:n.bind(this,r,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ft.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},w4=function(t){const n=f(this,Hs),r=s=>{U(this,Hs,s),W(this,Ct,_4).call(this,s)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ft.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},_4=function(t){if(!f(this,Mr))return;W(this,Ct,T_).call(this,{highlightOutlines:f(this,Vs).getNewOutline(t/2)}),this.fixAndSetPosition();const[n,r]=this.parentDimensions;this.setDims(this.width*n,this.height*r)},aT=function(){f(this,us)===null||!this.parent||(this.parent.drawLayer.remove(f(this,us)),U(this,us,null),this.parent.drawLayer.remove(f(this,ti)),U(this,ti,null))},Ph=function(t=this.parent){f(this,us)===null&&({id:ir(this,us)._,clipPathId:ir(this,Sd)._}=t.drawLayer.draw({bbox:f(this,Vs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":f(this,Pl)},rootClass:{highlight:!0,free:f(this,Mr)},path:{d:f(this,Vs).toSVGPath()}},!1,!0),U(this,ti,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:f(this,Mr)},bbox:f(this,Bi).box,path:{d:f(this,Bi).toSVGPath()}},f(this,Mr))),f(this,Td)&&(f(this,Td).style.clipPath=f(this,Sd)))},$s=new WeakSet,lp=function([t,n,r,s],o){switch(o){case 90:return[1-n-s,t,s,r];case 180:return[1-t-r,1-n-s,r,s];case 270:return[n,1-t-r,s,r]}return[t,n,r,s]},b4=function(t){$t._keyboardManager.exec(this,t)},I_=function(t){if(!f(this,Cm))return;const n=window.getSelection();t?n.setPosition(f(this,Cm),f(this,D0)):n.setPosition(f(this,R0),f(this,P0))},xy=function(){return f(this,Mr)?this.rotation:0},A4=function(){if(f(this,Mr))return null;const[t,n]=this.pageDimensions,[r,s]=this.pageTranslation,o=f(this,Rl),a=new Float32Array(o.length*8);let u=0;for(const{x:c,y:d,width:m,height:p}of o){const g=c*t+r,w=(1-d)*n+s;a[u]=a[u+4]=g,a[u+1]=a[u+3]=w,a[u+2]=a[u+6]=g+m*t,a[u+5]=a[u+7]=w-p*n,u+=8}return a},E4=function(t){return f(this,Vs).serialize(t,W(this,Ct,xy).call(this))},C4=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},x4=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},S4=function(t){const{color:n}=this._initialData;return this.hasEditedComment||t.color.some((r,s)=>r!==n[s])},z($t,$s),re($t,"_defaultColor",null),re($t,"_defaultOpacity",1),re($t,"_defaultThickness",12),re($t,"_type","highlight"),re($t,"_editorType",yt.HIGHLIGHT),re($t,"_freeHighlightId",-1),re($t,"_freeHighlight",null),re($t,"_freeHighlightClipId","");let w1=$t;var Id;class T4{constructor(){z(this,Id,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){f(this,Id)[e]=t}toSVGProperties(){const e=f(this,Id);return U(this,Id,Object.create(null)),{root:e}}reset(){U(this,Id,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){rn("Not implemented")}}Id=new WeakMap;var cs,Tm,_r,Dd,kd,wc,_c,bc,Rd,Vt,lT,uT,cT,Sy,I4,D_,Ty,up;const Ke=class Ke extends cn{constructor(t){super(t);z(this,Vt);z(this,cs,null);z(this,Tm);re(this,"_colorPicker",null);re(this,"_drawId",null);U(this,Tm,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(W(this,Vt,lT).call(this,t),W(this,Vt,Sy).call(this))}static _mergeSVGProperties(t,n){const r=new Set(Object.keys(t));for(const[s,o]of Object.entries(n))r.has(s)?Object.assign(t[s],o):t[s]=o;return t}static getDefaultDrawingOptions(t){rn("Not implemented")}static get typesMap(){rn("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,n),this._currentParent&&(f(Ke,_r).updateProperty(r,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[r,s]of this.typesMap)t.push([r,n[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[r,s]of this.constructor.typesMap)t.push([r,n[s]]);return t}_updateProperty(t,n,r){const s=this._drawingOptions,o=s[n],a=u=>{var d,m;s.updateProperty(n,u);const c=f(this,cs).updateProperty(n,u);c&&W(this,Vt,Ty).call(this,c),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&((m=this._colorPicker)==null||m.update(u))};this.addCommands({cmd:a.bind(this,r),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ke._mergeSVGProperties(f(this,cs).getPathResizingSVGProperties(W(this,Vt,D_).call(this)),{bbox:W(this,Vt,up).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ke._mergeSVGProperties(f(this,cs).getPathResizedSVGProperties(W(this,Vt,D_).call(this)),{bbox:W(this,Vt,up).call(this)}))}_onTranslating(t,n){var r;(r=this.parent)==null||r.drawLayer.updateProperties(this._drawId,{bbox:W(this,Vt,up).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ke._mergeSVGProperties(f(this,cs).getPathTranslatedSVGProperties(W(this,Vt,D_).call(this),this.parentDimensions),{bbox:W(this,Vt,up).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,f(this,Tm)&&(U(this,Tm,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){W(this,Vt,cT).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(W(this,Vt,Sy).call(this),W(this,Vt,Ty).call(this,f(this,cs).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),W(this,Vt,cT).call(this)):t&&(this._uiManager.addShouldRescale(this),W(this,Vt,Sy).call(this,t),n=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ke._mergeSVGProperties({bbox:W(this,Vt,up).call(this)},f(this,cs).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&W(this,Vt,Ty).call(this,f(this,cs).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,n;this._isCopy&&(t=this.x,n=this.y);const r=super.render();r.classList.add("draw");const s=document.createElement("div");r.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[o,a]=this.parentDimensions;return this.setDims(this.width*o,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,n),r}static createDrawerInstance(t,n,r,s,o){rn("Not implemented")}static startDrawing(t,n,r,s){var A;const{target:o,offsetX:a,offsetY:u,pointerId:c,pointerType:d}=s;if(f(Ke,_c)&&f(Ke,_c)!==d)return;const{viewport:{rotation:m}}=t,{width:p,height:g}=o.getBoundingClientRect(),w=U(Ke,Dd,new AbortController),b=t.combinedSignal(w);if(f(Ke,wc)||U(Ke,wc,c),f(Ke,_c)??U(Ke,_c,d),window.addEventListener("pointerup",_=>{var C;f(Ke,wc)===_.pointerId?this._endDraw(_):(C=f(Ke,bc))==null||C.delete(_.pointerId)},{signal:b}),window.addEventListener("pointercancel",_=>{var C;f(Ke,wc)===_.pointerId?this._currentParent.endDrawingSession():(C=f(Ke,bc))==null||C.delete(_.pointerId)},{signal:b}),window.addEventListener("pointerdown",_=>{f(Ke,_c)===_.pointerType&&((f(Ke,bc)||U(Ke,bc,new Set)).add(_.pointerId),f(Ke,_r).isCancellable()&&(f(Ke,_r).removeLastElement(),f(Ke,_r).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Xs,{signal:b}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),o.addEventListener("touchmove",_=>{_.timeStamp===f(Ke,Rd)&&Jn(_)},{signal:b}),t.toggleDrawing(),(A=n._editorUndoBar)==null||A.hide(),f(Ke,_r)){t.drawLayer.updateProperties(this._currentDrawId,f(Ke,_r).startNew(a,u,p,g,m));return}n.updateUIForDefaultProperties(this),U(Ke,_r,this.createDrawerInstance(a,u,p,g,m)),U(Ke,kd,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(f(Ke,kd).toSVGProperties(),f(Ke,_r).defaultSVGProperties),!0,!1)}static _drawMove(t){var o;if(U(Ke,Rd,-1),!f(Ke,_r))return;const{offsetX:n,offsetY:r,pointerId:s}=t;if(f(Ke,wc)===s){if(((o=f(Ke,bc))==null?void 0:o.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,f(Ke,_r).add(n,r)),U(Ke,Rd,t.timeStamp),Jn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,U(Ke,_r,null),U(Ke,kd,null),U(Ke,_c,null),U(Ke,Rd,NaN)),f(Ke,Dd)&&(f(Ke,Dd).abort(),U(Ke,Dd,null),U(Ke,wc,NaN),U(Ke,bc,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,f(Ke,_r).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=f(Ke,_r),s=this._currentDrawId,o=r.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(s,r.setLastElement(o))},undo:()=>{n.drawLayer.updateProperties(s,r.removeLastElement())},mustExec:!1,type:Ft.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(Ft.DRAW_STEP),!f(Ke,_r).isEmpty()){const{pageDimensions:[r,s],scale:o}=n,a=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:f(Ke,_r).getOutlines(r*o,s*o,o,this._INNER_MARGIN),drawingOptions:f(Ke,kd),mustBeCommitted:!t});return this._cleanup(!0),a}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,r,s,o,a){rn("Not implemented")}static async deserialize(t,n,r){var m,p;const{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:u}}=n.viewport,c=this.deserializeDraw(a,u,s,o,this._INNER_MARGIN,t),d=await super.deserialize(t,n,r);return d.createDrawingOptions(t),W(m=d,Vt,lT).call(m,{drawOutlines:c}),W(p=d,Vt,Sy).call(p),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[n,r]=this.pageTranslation,[s,o]=this.pageDimensions;return f(this,cs).serialize([n,r,s,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};cs=new WeakMap,Tm=new WeakMap,_r=new WeakMap,Dd=new WeakMap,kd=new WeakMap,wc=new WeakMap,_c=new WeakMap,bc=new WeakMap,Rd=new WeakMap,Vt=new WeakSet,lT=function({drawOutlines:t,drawId:n,drawingOptions:r}){U(this,cs,t),this._drawingOptions||(this._drawingOptions=r),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=W(this,Vt,uT).call(this,t,this.parent),W(this,Vt,Ty).call(this,t.box)},uT=function(t,n){const{id:r}=n.drawLayer.draw(Ke._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r},cT=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Sy=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=W(this,Vt,uT).call(this,f(this,cs),t)}},I4=function([t,n,r,s]){const{parentDimensions:[o,a],rotation:u}=this;switch(u){case 90:return[n,1-t,r*(a/o),s*(o/a)];case 180:return[1-t,1-n,r,s];case 270:return[1-n,t,r*(a/o),s*(o/a)];default:return[t,n,r,s]}},D_=function(){const{x:t,y:n,width:r,height:s,parentDimensions:[o,a],rotation:u}=this;switch(u){case 90:return[1-n,t,r*(o/a),s*(a/o)];case 180:return[1-t,1-n,r,s];case 270:return[n,1-t,r*(o/a),s*(a/o)];default:return[t,n,r,s]}},Ty=function(t){if([this.x,this.y,this.width,this.height]=W(this,Vt,I4).call(this,t),this.div){this.fixAndSetPosition();const[n,r]=this.parentDimensions;this.setDims(this.width*n,this.height*r)}this._onResized()},up=function(){const{x:t,y:n,width:r,height:s,rotation:o,parentRotation:a,parentDimensions:[u,c]}=this;switch((o*4+a)/90){case 1:return[1-n-s,t,s,r];case 2:return[1-t-r,1-n-s,r,s];case 3:return[n,1-t-r,s,r];case 4:return[t,n-r*(u/c),s*(c/u),r*(u/c)];case 5:return[1-n,t,r*(u/c),s*(c/u)];case 6:return[1-t-s*(c/u),1-n,s*(c/u),r*(u/c)];case 7:return[n-r*(u/c),1-t-s*(c/u),r*(u/c),s*(c/u)];case 8:return[t-r,n-s,r,s];case 9:return[1-n,t-r,s,r];case 10:return[1-t,1-n,r,s];case 11:return[n-s,1-t,s,r];case 12:return[t-s*(c/u),n,s*(c/u),r*(u/c)];case 13:return[1-n-r*(u/c),t-s*(c/u),r*(u/c),s*(c/u)];case 14:return[1-t,1-n-r*(u/c),s*(c/u),r*(u/c)];case 15:return[n,1-t,r*(u/c),s*(c/u)];default:return[t,n,r,s]}},re(Ke,"_currentDrawId",-1),re(Ke,"_currentParent",null),z(Ke,_r,null),z(Ke,Dd,null),z(Ke,kd,null),z(Ke,wc,NaN),z(Ke,_c,null),z(Ke,bc,null),z(Ke,Rd,NaN),re(Ke,"_INNER_MARGIN",3);let _1=Ke;var ha,br,Ar,Pd,Im,pi,Br,zs,Nd,Od,Ld,Dm,k_;class See{constructor(e,t,n,r,s,o){z(this,Dm);z(this,ha,new Float64Array(6));z(this,br);z(this,Ar);z(this,Pd);z(this,Im);z(this,pi);z(this,Br,"");z(this,zs,0);z(this,Nd,new a2);z(this,Od);z(this,Ld);U(this,Od,n),U(this,Ld,r),U(this,Pd,s),U(this,Im,o),[e,t]=W(this,Dm,k_).call(this,e,t);const a=U(this,br,[NaN,NaN,NaN,NaN,e,t]);U(this,pi,[e,t]),U(this,Ar,[{line:a,points:f(this,pi)}]),f(this,ha).set(a,0)}updateProperty(e,t){e==="stroke-width"&&U(this,Im,t)}isEmpty(){return!f(this,Ar)||f(this,Ar).length===0}isCancellable(){return f(this,pi).length<=10}add(e,t){[e,t]=W(this,Dm,k_).call(this,e,t);const[n,r,s,o]=f(this,ha).subarray(2,6),a=e-s,u=t-o;return Math.hypot(f(this,Od)*a,f(this,Ld)*u)<=2?null:(f(this,pi).push(e,t),isNaN(n)?(f(this,ha).set([s,o,e,t],2),f(this,br).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(f(this,ha)[0])&&f(this,br).splice(6,6),f(this,ha).set([n,r,s,o,e,t],0),f(this,br).push(...He.createBezierPoints(n,r,s,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(f(this,pi).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,r,s){U(this,Od,n),U(this,Ld,r),U(this,Pd,s),[e,t]=W(this,Dm,k_).call(this,e,t);const o=U(this,br,[NaN,NaN,NaN,NaN,e,t]);U(this,pi,[e,t]);const a=f(this,Ar).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),f(this,Ar).push({line:o,points:f(this,pi)}),f(this,ha).set(o,0),U(this,zs,0),this.toSVGPath(),null}getLastElement(){return f(this,Ar).at(-1)}setLastElement(e){return f(this,Ar)?(f(this,Ar).push(e),U(this,br,e.line),U(this,pi,e.points),U(this,zs,0),{path:{d:this.toSVGPath()}}):f(this,Nd).setLastElement(e)}removeLastElement(){if(!f(this,Ar))return f(this,Nd).removeLastElement();f(this,Ar).pop(),U(this,Br,"");for(let e=0,t=f(this,Ar).length;e<t;e++){const{line:n,points:r}=f(this,Ar)[e];U(this,br,n),U(this,pi,r),U(this,zs,0),this.toSVGPath()}return{path:{d:f(this,Br)}}}toSVGPath(){const e=He.svgRound(f(this,br)[4]),t=He.svgRound(f(this,br)[5]);if(f(this,pi).length===2)return U(this,Br,`${f(this,Br)} M ${e} ${t} Z`),f(this,Br);if(f(this,pi).length<=6){const r=f(this,Br).lastIndexOf("M");U(this,Br,`${f(this,Br).slice(0,r)} M ${e} ${t}`),U(this,zs,6)}if(f(this,pi).length===4){const r=He.svgRound(f(this,br)[10]),s=He.svgRound(f(this,br)[11]);return U(this,Br,`${f(this,Br)} L ${r} ${s}`),U(this,zs,12),f(this,Br)}const n=[];f(this,zs)===0&&(n.push(`M ${e} ${t}`),U(this,zs,6));for(let r=f(this,zs),s=f(this,br).length;r<s;r+=6){const[o,a,u,c,d,m]=f(this,br).slice(r,r+6).map(He.svgRound);n.push(`C${o} ${a} ${u} ${c} ${d} ${m}`)}return U(this,Br,f(this,Br)+n.join(" ")),U(this,zs,f(this,br).length),f(this,Br)}getOutlines(e,t,n,r){const s=f(this,Ar).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),f(this,Nd).build(f(this,Ar),e,t,n,f(this,Pd),f(this,Im),r),U(this,ha,null),U(this,br,null),U(this,Ar,null),U(this,Br,null),f(this,Nd)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}ha=new WeakMap,br=new WeakMap,Ar=new WeakMap,Pd=new WeakMap,Im=new WeakMap,pi=new WeakMap,Br=new WeakMap,zs=new WeakMap,Nd=new WeakMap,Od=new WeakMap,Ld=new WeakMap,Dm=new WeakSet,k_=function(e,t){return He._normalizePoint(e,t,f(this,Od),f(this,Ld),f(this,Pd))};var mi,O0,L0,hs,da,fa,km,Rm,Fd,Ur,Xa,D4,k4,R4;class a2 extends He{constructor(){super(...arguments);z(this,Ur);z(this,mi);z(this,O0,0);z(this,L0);z(this,hs);z(this,da);z(this,fa);z(this,km);z(this,Rm);z(this,Fd)}build(t,n,r,s,o,a,u){U(this,da,n),U(this,fa,r),U(this,km,s),U(this,Rm,o),U(this,Fd,a),U(this,L0,u??0),U(this,hs,t),W(this,Ur,k4).call(this)}get thickness(){return f(this,Fd)}setLastElement(t){return f(this,hs).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return f(this,hs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of f(this,hs)){if(t.push(`M${He.svgRound(n[4])} ${He.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12&&isNaN(n[6])){t.push(`L${He.svgRound(n[10])} ${He.svgRound(n[11])}`);continue}for(let r=6,s=n.length;r<s;r+=6){const[o,a,u,c,d,m]=n.subarray(r,r+6).map(He.svgRound);t.push(`C${o} ${a} ${u} ${c} ${d} ${m}`)}}return t.join("")}serialize([t,n,r,s],o){const a=[],u=[],[c,d,m,p]=W(this,Ur,D4).call(this);let g,w,b,A,_,C,I,S,R;switch(f(this,Rm)){case 0:R=He._rescale,g=t,w=n+s,b=r,A=-s,_=t+c*r,C=n+(1-d-p)*s,I=t+(c+m)*r,S=n+(1-d)*s;break;case 90:R=He._rescaleAndSwap,g=t,w=n,b=r,A=s,_=t+d*r,C=n+c*s,I=t+(d+p)*r,S=n+(c+m)*s;break;case 180:R=He._rescale,g=t+r,w=n,b=-r,A=s,_=t+(1-c-m)*r,C=n+d*s,I=t+(1-c)*r,S=n+(d+p)*s;break;case 270:R=He._rescaleAndSwap,g=t+r,w=n+s,b=-r,A=-s,_=t+(1-d-p)*r,C=n+(1-c-m)*s,I=t+(1-d)*r,S=n+(1-c)*s;break}for(const{line:L,points:k}of f(this,hs))a.push(R(L,g,w,b,A,o?new Array(L.length):null)),u.push(R(k,g,w,b,A,o?new Array(k.length):null));return{lines:a,points:u,rect:[_,C,I,S]}}static deserialize(t,n,r,s,o,{paths:{lines:a,points:u},rotation:c,thickness:d}){const m=[];let p,g,w,b,A;switch(c){case 0:A=He._rescale,p=-t/r,g=n/s+1,w=1/r,b=-1/s;break;case 90:A=He._rescaleAndSwap,p=-n/s,g=-t/r,w=1/s,b=1/r;break;case 180:A=He._rescale,p=t/r+1,g=-n/s,w=-1/r,b=1/s;break;case 270:A=He._rescaleAndSwap,p=n/s+1,g=t/r+1,w=-1/s,b=-1/r;break}if(!a){a=[];for(const C of u){const I=C.length;if(I===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1]]));continue}if(I===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1],NaN,NaN,NaN,NaN,C[2],C[3]]));continue}const S=new Float32Array(3*(I-2));a.push(S);let[R,L,k,T]=C.subarray(0,4);S.set([NaN,NaN,NaN,NaN,R,L],0);for(let D=4;D<I;D+=2){const P=C[D],N=C[D+1];S.set(He.createBezierPoints(R,L,k,T,P,N),(D-2)*3),[R,L,k,T]=[k,T,P,N]}}}for(let C=0,I=a.length;C<I;C++)m.push({line:A(a[C].map(S=>S??NaN),p,g,w,b),points:A(u[C].map(S=>S??NaN),p,g,w,b)});const _=new this.prototype.constructor;return _.build(m,r,s,1,c,d,o),_}get box(){return f(this,mi)}updateProperty(t,n){return t==="stroke-width"?W(this,Ur,R4).call(this,n):null}updateParentDimensions([t,n],r){const[s,o]=W(this,Ur,Xa).call(this);U(this,da,t),U(this,fa,n),U(this,km,r);const[a,u]=W(this,Ur,Xa).call(this),c=a-s,d=u-o,m=f(this,mi);return m[0]-=c,m[1]-=d,m[2]+=2*c,m[3]+=2*d,m}updateRotation(t){return U(this,O0,t),{path:{transform:this.rotationTransform}}}get viewBox(){return f(this,mi).map(He.svgRound).join(" ")}get defaultProperties(){const[t,n]=f(this,mi);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${He.svgRound(t)} ${He.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=f(this,mi);let r=0,s=0,o=0,a=0,u=0,c=0;switch(f(this,O0)){case 90:s=n/t,o=-t/n,u=t;break;case 180:r=-1,a=-1,u=t,c=n;break;case 270:s=-n/t,o=t/n,c=n;break;default:return""}return`matrix(${r} ${s} ${o} ${a} ${He.svgRound(u)} ${He.svgRound(c)})`}getPathResizingSVGProperties([t,n,r,s]){const[o,a]=W(this,Ur,Xa).call(this),[u,c,d,m]=f(this,mi);if(Math.abs(d-o)<=He.PRECISION||Math.abs(m-a)<=He.PRECISION){const A=t+r/2-(u+d/2),_=n+s/2-(c+m/2);return{path:{"transform-origin":`${He.svgRound(t)} ${He.svgRound(n)}`,transform:`${this.rotationTransform} translate(${A} ${_})`}}}const p=(r-2*o)/(d-2*o),g=(s-2*a)/(m-2*a),w=d/r,b=m/s;return{path:{"transform-origin":`${He.svgRound(u)} ${He.svgRound(c)}`,transform:`${this.rotationTransform} scale(${w} ${b}) translate(${He.svgRound(o)} ${He.svgRound(a)}) scale(${p} ${g}) translate(${He.svgRound(-o)} ${He.svgRound(-a)})`}}}getPathResizedSVGProperties([t,n,r,s]){const[o,a]=W(this,Ur,Xa).call(this),u=f(this,mi),[c,d,m,p]=u;if(u[0]=t,u[1]=n,u[2]=r,u[3]=s,Math.abs(m-o)<=He.PRECISION||Math.abs(p-a)<=He.PRECISION){const _=t+r/2-(c+m/2),C=n+s/2-(d+p/2);for(const{line:I,points:S}of f(this,hs))He._translate(I,_,C,I),He._translate(S,_,C,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${He.svgRound(t)} ${He.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(r-2*o)/(m-2*o),w=(s-2*a)/(p-2*a),b=-g*(c+o)+t+o,A=-w*(d+a)+n+a;if(g!==1||w!==1||b!==0||A!==0)for(const{line:_,points:C}of f(this,hs))He._rescale(_,b,A,g,w,_),He._rescale(C,b,A,g,w,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${He.svgRound(t)} ${He.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],r){const[s,o]=r,a=f(this,mi),u=t-a[0],c=n-a[1];if(f(this,da)===s&&f(this,fa)===o)for(const{line:d,points:m}of f(this,hs))He._translate(d,u,c,d),He._translate(m,u,c,m);else{const d=f(this,da)/s,m=f(this,fa)/o;U(this,da,s),U(this,fa,o);for(const{line:p,points:g}of f(this,hs))He._rescale(p,u,c,d,m,p),He._rescale(g,u,c,d,m,g);a[2]*=d,a[3]*=m}return a[0]=t,a[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${He.svgRound(t)} ${He.svgRound(n)}`}}}get defaultSVGProperties(){const t=f(this,mi);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${He.svgRound(t[0])} ${He.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}mi=new WeakMap,O0=new WeakMap,L0=new WeakMap,hs=new WeakMap,da=new WeakMap,fa=new WeakMap,km=new WeakMap,Rm=new WeakMap,Fd=new WeakMap,Ur=new WeakSet,Xa=function(t=f(this,Fd)){const n=f(this,L0)+t/2*f(this,km);return f(this,Rm)%180===0?[n/f(this,da),n/f(this,fa)]:[n/f(this,fa),n/f(this,da)]},D4=function(){const[t,n,r,s]=f(this,mi),[o,a]=W(this,Ur,Xa).call(this,0);return[t+o,n+a,r-2*o,s-2*a]},k4=function(){const t=U(this,mi,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of f(this,hs)){if(s.length<=12){for(let u=4,c=s.length;u<c;u+=6)Je.pointBoundingBox(s[u],s[u+1],t);continue}let o=s[4],a=s[5];for(let u=6,c=s.length;u<c;u+=6){const[d,m,p,g,w,b]=s.subarray(u,u+6);Je.bezierBoundingBox(o,a,d,m,p,g,w,b,t),o=w,a=b}}const[n,r]=W(this,Ur,Xa).call(this);t[0]=vi(t[0]-n,0,1),t[1]=vi(t[1]-r,0,1),t[2]=vi(t[2]+n,0,1),t[3]=vi(t[3]+r,0,1),t[2]-=t[0],t[3]-=t[1]},R4=function(t){const[n,r]=W(this,Ur,Xa).call(this);U(this,Fd,t);const[s,o]=W(this,Ur,Xa).call(this),[a,u]=[s-n,o-r],c=f(this,mi);return c[0]-=a,c[1]-=u,c[2]+=2*a,c[3]+=2*u,c};class Bb extends T4{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:cn._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Bb(this._viewParameters);return e.updateAll(this),e}}var B1,P4;const pp=class pp extends _1{constructor(t){super({...t,name:"inkEditor"});z(this,B1);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,n){cn.initialize(t,n),this._defaultDrawingOptions=new Bb(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Rt(this,"typesMap",new Map([[Ft.INK_THICKNESS,"stroke-width"],[Ft.INK_COLOR,"stroke"],[Ft.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,r,s,o){return new See(t,n,r,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,r,s,o,a){return a2.deserialize(t,n,r,s,o,a)}static async deserialize(t,n,r){let s=null;if(t instanceof fD){const{data:{inkLists:a,rect:u,rotation:c,id:d,color:m,opacity:p,borderStyle:{rawWidth:g},popupRef:w,contentsObj:b},parent:{page:{pageNumber:A}}}=t;s=t={annotationType:yt.INK,color:Array.from(m),thickness:g,opacity:p,paths:{points:a},boxes:null,pageIndex:A-1,rect:u.slice(0),rotation:c,annotationElementId:d,id:d,deleted:!1,popupRef:w,comment:(b==null?void 0:b.str)||null}}const o=await super.deserialize(t,n,r);return o._initialData=s,t.comment&&o.setCommentData(t.comment),o}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new g1(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Ft.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:r}=this;n.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:r}){this._drawingOptions=pp.getDefaultDrawingOptions({stroke:Je.makeHexColor(...t),"stroke-width":n,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:r,rect:s}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":a,"stroke-width":u}}=this,c={annotationType:yt.INK,color:cn._colorManager.convert(o),opacity:a,thickness:u,paths:{lines:n,points:r},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!W(this,B1,P4).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:n,rect:r}=this.serializeDraw(!1),s={rect:r,thickness:this._drawingOptions["stroke-width"],points:n};return this.hasEditedComment&&(s.popup=this.comment),t.updateEdited(s),null}};B1=new WeakSet,P4=function(t){const{color:n,thickness:r,opacity:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((a,u)=>a!==n[u])||t.thickness!==r||t.opacity!==s||t.pageIndex!==o},re(pp,"_type","ink"),re(pp,"_editorType",yt.INK),re(pp,"_defaultDrawingOptions",null);let hT=pp;class dT extends a2{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Hw=8,ey=3;var Md,Jt,fT,Co,N4,O4,pT,R_,L4,F4,M4,mT,gT,B4;class Bl{static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:r},s,o,a,u){let c=new OffscreenCanvas(1,1),d=c.getContext("2d",{alpha:!1});const m=200,p=d.font=`${n} ${r} ${m}px ${t}`,{actualBoundingBoxLeft:g,actualBoundingBoxRight:w,actualBoundingBoxAscent:b,actualBoundingBoxDescent:A,fontBoundingBoxAscent:_,fontBoundingBoxDescent:C,width:I}=d.measureText(e),S=1.5,R=Math.ceil(Math.max(Math.abs(g)+Math.abs(w)||0,I)*S),L=Math.ceil(Math.max(Math.abs(b)+Math.abs(A)||m,Math.abs(_)+Math.abs(C)||m)*S);c=new OffscreenCanvas(R,L),d=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=p,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,R,L),d.fillStyle="black",d.fillText(e,R*(S-1)/2,L*(3-S)/2);const k=W(this,Jt,mT).call(this,d.getImageData(0,0,R,L).data),T=W(this,Jt,M4).call(this,k),D=W(this,Jt,gT).call(this,T),P=W(this,Jt,pT).call(this,k,R,L,D);return this.processDrawnLines({lines:{curves:P,width:R,height:L},pageWidth:s,pageHeight:o,rotation:a,innerMargin:u,mustSmooth:!0,areContours:!0})}static process(e,t,n,r,s){const[o,a,u]=W(this,Jt,B4).call(this,e),[c,d]=W(this,Jt,F4).call(this,o,a,u,Math.hypot(a,u)*f(this,Md).sigmaSFactor,f(this,Md).sigmaR,f(this,Md).kernelSize),m=W(this,Jt,gT).call(this,d),p=W(this,Jt,pT).call(this,c,a,u,m);return this.processDrawnLines({lines:{curves:p,width:a,height:u},pageWidth:t,pageHeight:n,rotation:r,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:r,innerMargin:s,mustSmooth:o,areContours:a}){r%180!==0&&([t,n]=[n,t]);const{curves:u,width:c,height:d}=e,m=e.thickness??0,p=[],g=Math.min(t/c,n/d),w=g/t,b=g/n,A=[];for(const{points:C}of u){const I=o?W(this,Jt,L4).call(this,C):C;if(!I)continue;A.push(I);const S=I.length,R=new Float32Array(S),L=new Float32Array(3*(S===2?2:S-2));if(p.push({line:L,points:R}),S===2){R[0]=I[0]*w,R[1]=I[1]*b,L.set([NaN,NaN,NaN,NaN,R[0],R[1]],0);continue}let[k,T,D,P]=I;k*=w,T*=b,D*=w,P*=b,R.set([k,T,D,P],0),L.set([NaN,NaN,NaN,NaN,k,T],0);for(let N=4;N<S;N+=2){const F=R[N]=I[N]*w,M=R[N+1]=I[N+1]*b;L.set(He.createBezierPoints(k,T,D,P,F,M),(N-2)*3),[k,T,D,P]=[D,P,F,M]}}if(p.length===0)return null;const _=a?new dT:new a2;return _.build(p,t,n,1,r,a?0:m,s),{outline:_,newCurves:A,areContours:a,thickness:m,width:c,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:r,height:s}){let o=1/0,a=-1/0,u=0;for(const I of e){u+=I.length;for(let S=2,R=I.length;S<R;S++){const L=I[S]-I[S-2];o=Math.min(o,L),a=Math.max(a,L)}}let c;o>=-128&&a<=127?c=Int8Array:o>=-32768&&a<=32767?c=Int16Array:c=Int32Array;const d=e.length,m=Hw+ey*d,p=new Uint32Array(m);let g=0;p[g++]=m*Uint32Array.BYTES_PER_ELEMENT+(u-2*d)*c.BYTES_PER_ELEMENT,p[g++]=0,p[g++]=r,p[g++]=s,p[g++]=t?0:1,p[g++]=Math.max(0,Math.floor(n??0)),p[g++]=d,p[g++]=c.BYTES_PER_ELEMENT;for(const I of e)p[g++]=I.length-2,p[g++]=I[0],p[g++]=I[1];const w=new CompressionStream("deflate-raw"),b=w.writable.getWriter();await b.ready,b.write(p);const A=c.prototype.constructor;for(const I of e){const S=new A(I.length-2);for(let R=2,L=I.length;R<L;R++)S[R-2]=I[R]-I[R-2];b.write(S)}b.close();const _=await new Response(w.readable).arrayBuffer(),C=new Uint8Array(_);return M5(C)}static async decompressSignature(e){try{const t=KQ(e),{readable:n,writable:r}=new DecompressionStream("deflate-raw"),s=r.getWriter();await s.ready,s.write(t).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let o=null,a=0;for await(const I of n)o||(o=new Uint8Array(new Uint32Array(I.buffer,0,4)[0])),o.set(I,a),a+=I.length;const u=new Uint32Array(o.buffer,0,o.length>>2),c=u[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const d=u[2],m=u[3],p=u[4]===0,g=u[5],w=u[6],b=u[7],A=[],_=(Hw+ey*w)*Uint32Array.BYTES_PER_ELEMENT;let C;switch(b){case Int8Array.BYTES_PER_ELEMENT:C=new Int8Array(o.buffer,_);break;case Int16Array.BYTES_PER_ELEMENT:C=new Int16Array(o.buffer,_);break;case Int32Array.BYTES_PER_ELEMENT:C=new Int32Array(o.buffer,_);break}a=0;for(let I=0;I<w;I++){const S=u[ey*I+Hw],R=new Float32Array(S+2);A.push(R);for(let L=0;L<ey-1;L++)R[L]=u[ey*I+Hw+L+1];for(let L=0;L<S;L++)R[L+2]=R[L]+C[a++]}return{areContours:p,thickness:g,outlines:A,width:d,height:m}}catch(t){return Et(`decompressSignature: ${t}`),null}}}Md=new WeakMap,Jt=new WeakSet,fT=function(e,t,n,r){return n-=e,r-=t,n===0?r>0?0:4:n===1?r+6:2-r},Co=new WeakMap,N4=function(e,t,n,r,s,o,a){const u=W(this,Jt,fT).call(this,n,r,s,o);for(let c=0;c<8;c++){const d=(-c+u-a+16)%8,m=f(this,Co)[2*d],p=f(this,Co)[2*d+1];if(e[(n+m)*t+(r+p)]!==0)return d}return-1},O4=function(e,t,n,r,s,o,a){const u=W(this,Jt,fT).call(this,n,r,s,o);for(let c=0;c<8;c++){const d=(c+u+a+16)%8,m=f(this,Co)[2*d],p=f(this,Co)[2*d+1];if(e[(n+m)*t+(r+p)]!==0)return d}return-1},pT=function(e,t,n,r){const s=e.length,o=new Int32Array(s);for(let d=0;d<s;d++)o[d]=e[d]<=r?1:0;for(let d=1;d<n-1;d++)o[d*t]=o[d*t+t-1]=0;for(let d=0;d<t;d++)o[d]=o[t*n-1-d]=0;let a=1,u;const c=[];for(let d=1;d<n-1;d++){u=1;for(let m=1;m<t-1;m++){const p=d*t+m,g=o[p];if(g===0)continue;let w=d,b=m;if(g===1&&o[p-1]===0)a+=1,b-=1;else if(g>=1&&o[p+1]===0)a+=1,b+=1,g>1&&(u=g);else{g!==1&&(u=Math.abs(g));continue}const A=[m,d],_=b===m+1,C={isHole:_,points:A,id:a,parent:0};c.push(C);let I;for(const N of c)if(N.id===u){I=N;break}I?I.isHole?C.parent=_?I.parent:u:C.parent=_?u:I.parent:C.parent=_?u:0;const S=W(this,Jt,N4).call(this,o,t,d,m,w,b,0);if(S===-1){o[p]=-a,o[p]!==1&&(u=Math.abs(o[p]));continue}let R=f(this,Co)[2*S],L=f(this,Co)[2*S+1];const k=d+R,T=m+L;w=k,b=T;let D=d,P=m;for(;;){const N=W(this,Jt,O4).call(this,o,t,D,P,w,b,1);R=f(this,Co)[2*N],L=f(this,Co)[2*N+1];const F=D+R,M=P+L;A.push(M,F);const $=D*t+P;if(o[$+1]===0?o[$]=-a:o[$]===1&&(o[$]=a),F===d&&M===m&&D===k&&P===T){o[p]!==1&&(u=Math.abs(o[p]));break}else w=D,b=P,D=F,P=M}}}return c},R_=function(e,t,n,r){if(n-t<=4){for(let k=t;k<n-2;k+=2)r.push(e[k],e[k+1]);return}const s=e[t],o=e[t+1],a=e[n-4]-s,u=e[n-3]-o,c=Math.hypot(a,u),d=a/c,m=u/c,p=d*o-m*s,g=u/a,w=1/c,b=Math.atan(g),A=Math.cos(b),_=Math.sin(b),C=w*(Math.abs(A)+Math.abs(_)),I=w*(1-C+C**2),S=Math.max(Math.atan(Math.abs(_+A)*I),Math.atan(Math.abs(_-A)*I));let R=0,L=t;for(let k=t+2;k<n-2;k+=2){const T=Math.abs(p-d*e[k+1]+m*e[k]);T>R&&(L=k,R=T)}R>(c*S)**2?(W(this,Jt,R_).call(this,e,t,L+2,r),W(this,Jt,R_).call(this,e,L,n,r)):r.push(s,o)},L4=function(e){const t=[],n=e.length;return W(this,Jt,R_).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t},F4=function(e,t,n,r,s,o){const a=new Float32Array(o**2),u=-2*r**2,c=o>>1;for(let b=0;b<o;b++){const A=(b-c)**2;for(let _=0;_<o;_++)a[b*o+_]=Math.exp((A+(_-c)**2)/u)}const d=new Float32Array(256),m=-2*s**2;for(let b=0;b<256;b++)d[b]=Math.exp(b**2/m);const p=e.length,g=new Uint8Array(p),w=new Uint32Array(256);for(let b=0;b<n;b++)for(let A=0;A<t;A++){const _=b*t+A,C=e[_];let I=0,S=0;for(let L=0;L<o;L++){const k=b+L-c;if(!(k<0||k>=n))for(let T=0;T<o;T++){const D=A+T-c;if(D<0||D>=t)continue;const P=e[k*t+D],N=a[L*o+T]*d[Math.abs(P-C)];I+=P*N,S+=N}}const R=g[_]=Math.round(I/S);w[R]++}return[g,w]},M4=function(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t},mT=function(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let r=-1/0,s=1/0;for(let a=0,u=n.length;a<u;a++){const c=n[a]=e[a<<2];r=Math.max(r,c),s=Math.min(s,c)}const o=255/(r-s);for(let a=0,u=n.length;a<u;a++)n[a]=(n[a]-s)*o;return n},gT=function(e){let t,n=-1/0,r=-1/0;const s=e.findIndex(u=>u!==0);let o=s,a=s;for(t=s;t<256;t++){const u=e[t];u>n&&(t-o>r&&(r=t-o,a=t-1),n=u,o=t)}for(t=a-1;t>=0&&!(e[t]>e[t+1]);t--);return t},B4=function(e){const t=e,{width:n,height:r}=e,{maxDim:s}=f(this,Md);let o=n,a=r;if(n>s||r>s){let p=n,g=r,w=Math.log2(Math.max(n,r)/s);const b=Math.floor(w);w=w===b?b-1:b;for(let _=0;_<w;_++){o=Math.ceil(p/2),a=Math.ceil(g/2);const C=new OffscreenCanvas(o,a);C.getContext("2d").drawImage(e,0,0,p,g,0,0,o,a),p=o,g=a,e!==t&&e.close(),e=C.transferToImageBitmap()}const A=Math.min(s/o,s/a);o=Math.round(o*A),a=Math.round(a*A)}const c=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});c.fillStyle="white",c.fillRect(0,0,o,a),c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,o,a);const d=c.getImageData(0,0,o,a).data;return[W(this,Jt,mT).call(this,d),o,a]},z(Bl,Jt),z(Bl,Md,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),z(Bl,Co,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class pD extends T4{constructor(){super(),super.updateProperties({fill:cn._defaultLineColor,"stroke-width":0})}clone(){const e=new pD;return e.updateAll(this),e}}class mD extends Bb{constructor(e){super(e),super.updateProperties({stroke:cn._defaultLineColor,"stroke-width":1})}clone(){const e=new mD(this._viewParameters);return e.updateAll(this),e}}var Ac,pa,Ec,Bd;const Yi=class Yi extends _1{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});z(this,Ac,!1);z(this,pa,null);z(this,Ec,null);z(this,Bd,null);this._willKeepAspectRatio=!0,U(this,Ec,t.signatureData||null),U(this,pa,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,n){cn.initialize(t,n),this._defaultDrawingOptions=new pD,this._defaultDrawnSignatureOptions=new mD(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return Rt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!f(this,pa)}}static computeTelemetryFinalData(t){const n=t.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,n;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,t=this.x,n=this.y),super.render(),this._drawId===null)if(f(this,Ec)){const{lines:s,mustSmooth:o,areContours:a,description:u,uuid:c,heightInPage:d}=f(this,Ec),{rawDims:{pageWidth:m,pageHeight:p},rotation:g}=this.parent.viewport,w=Bl.processDrawnLines({lines:s,pageWidth:m,pageHeight:p,rotation:g,innerMargin:Yi._INNER_MARGIN,mustSmooth:o,areContours:a});this.addSignature(w,d,u,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:f(this,pa)||""}));return r&&(this._isCopy=!0,this._moveAfterPaste(t,n)),this.div}setUuid(t){U(this,Bd,t),this.addEditToolbar()}getUuid(){return f(this,Bd)}get description(){return f(this,pa)}set description(t){U(this,pa,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:n,thickness:r,width:s,height:o}=f(this,Ec),a=Math.max(s,o),u=Bl.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:r,width:s,height:o},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,n,r,s){const{x:o,y:a}=this,{outline:u}=U(this,Ec,t);U(this,Ac,u instanceof dT),this.description=r;let c;f(this,Ac)?c=Yi.getDefaultDrawingOptions():(c=Yi._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:c});const[d,m]=this.parentDimensions,[,p]=this.pageDimensions;let g=n/p;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(d*this.width,m*this.height),this.x=o,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:n,pageHeight:r},rotation:s}=this.parent.viewport;return Bl.process(t,n,r,s,Yi._INNER_MARGIN)}getFromText(t,n){const{rawDims:{pageWidth:r,pageHeight:s},rotation:o}=this.parent.viewport;return Bl.extractContoursFromText(t,n,r,s,o,Yi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:n,pageHeight:r},rotation:s}=this.parent.viewport;return Bl.processDrawnLines({lines:t,pageWidth:n,pageHeight:r,rotation:s,innerMargin:Yi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:n}){t?this._drawingOptions=Yi.getDefaultDrawingOptions():(this._drawingOptions=Yi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:n,points:r,rect:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":o}}=this,a={annotationType:yt.SIGNATURE,isSignature:!0,areContours:f(this,Ac),color:[0,0,0],thickness:f(this,Ac)?0:o,pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(a),t?(a.paths={lines:n,points:r},a.uuid=f(this,Bd),a.isCopy=!0):a.lines=n,f(this,pa)&&(a.accessibilityData={type:"Figure",alt:f(this,pa)}),a}static deserializeDraw(t,n,r,s,o,a){return a.areContours?dT.deserialize(t,n,r,s,o,a):a2.deserialize(t,n,r,s,o,a)}static async deserialize(t,n,r){var o;const s=await super.deserialize(t,n,r);return U(s,Ac,t.areContours),s.description=((o=t.accessibilityData)==null?void 0:o.alt)||"",U(s,Bd,t.uuid),s}};Ac=new WeakMap,pa=new WeakMap,Ec=new WeakMap,Bd=new WeakMap,re(Yi,"_type","signature"),re(Yi,"_editorType",yt.SIGNATURE),re(Yi,"_defaultDrawingOptions",null);let yT=Yi;var En,Er,Cc,Nl,xc,Pm,Ol,jd,ma,ds,Nm,Ht,Iy,Dy,P_,N_,O_,wT,L_,j4;class vT extends cn{constructor(t){super({...t,name:"stampEditor"});z(this,Ht);z(this,En,null);z(this,Er,null);z(this,Cc,null);z(this,Nl,null);z(this,xc,null);z(this,Pm,"");z(this,Ol,null);z(this,jd,!1);z(this,ma,null);z(this,ds,!1);z(this,Nm,!1);U(this,Nl,t.bitmapUrl),U(this,xc,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,n){cn.initialize(t,n)}static isHandlingMimeForPasting(t){return cS.includes(t)}static paste(t,n){n.pasteEditor({mode:yt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,u=await r.guess({name:"altText",request:{data:s,width:o,height:a,channels:s.length/(o*a)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const c=u.output;return await this.setGuessedAltText(c),n&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;f(this,Er)&&(U(this,En,null),this._uiManager.imageManager.deleteId(f(this,Er)),(t=f(this,Ol))==null||t.remove(),U(this,Ol,null),f(this,ma)&&(clearTimeout(f(this,ma)),U(this,ma,null))),super.remove()}rebuild(){if(!this.parent){f(this,Er)&&W(this,Ht,P_).call(this);return}super.rebuild(),this.div!==null&&(f(this,Er)&&f(this,Ol)===null&&W(this,Ht,P_).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(f(this,Cc)||f(this,En)||f(this,Nl)||f(this,xc)||f(this,Er)||f(this,jd))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;return this._isCopy&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),f(this,jd)||(f(this,En)?W(this,Ht,N_).call(this):W(this,Ht,P_).call(this)),this._isCopy&&this._moveAfterPaste(t,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,n){const{id:r,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,n);n.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(U(this,Er,r),s&&U(this,En,s),U(this,jd,!1),W(this,Ht,N_).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;f(this,ma)!==null&&clearTimeout(f(this,ma)),U(this,ma,setTimeout(()=>{U(this,ma,null),W(this,Ht,wT).call(this)},200))}copyCanvas(t,n,r=!1){var g;t||(t=224);const{width:s,height:o}=f(this,En),a=new Da;let u=f(this,En),c=s,d=o,m=null;if(n){if(s>n||o>n){const T=Math.min(n/s,n/o);c=Math.floor(s*T),d=Math.floor(o*T)}m=document.createElement("canvas");const w=m.width=Math.ceil(c*a.sx),b=m.height=Math.ceil(d*a.sy);f(this,ds)||(u=W(this,Ht,O_).call(this,w,b));const A=m.getContext("2d");A.filter=this._uiManager.hcmFilter;let _="white",C="#cfcfd8";this._uiManager.hcmFilter!=="none"?C="black":(g=window.matchMedia)!=null&&g.call(window,"(prefers-color-scheme: dark)").matches&&(_="#8f8f9d",C="#42414d");const I=15,S=I*a.sx,R=I*a.sy,L=new OffscreenCanvas(S*2,R*2),k=L.getContext("2d");k.fillStyle=_,k.fillRect(0,0,S*2,R*2),k.fillStyle=C,k.fillRect(0,0,S,R),k.fillRect(S,R,S,R),A.fillStyle=A.createPattern(L,"repeat"),A.fillRect(0,0,w,b),A.drawImage(u,0,0,u.width,u.height,0,0,w,b)}let p=null;if(r){let w,b;if(a.symmetric&&u.width<t&&u.height<t)w=u.width,b=u.height;else if(u=f(this,En),s>t||o>t){const C=Math.min(t/s,t/o);w=Math.floor(s*C),b=Math.floor(o*C),f(this,ds)||(u=W(this,Ht,O_).call(this,w,b))}const _=new OffscreenCanvas(w,b).getContext("2d",{willReadFrequently:!0});_.drawImage(u,0,0,u.width,u.height,0,0,w,b),p={width:w,height:b,data:_.getImageData(0,0,w,b).data}}return{canvas:m,width:c,height:d,imageData:p}}static async deserialize(t,n,r){var A;let s=null,o=!1;if(t instanceof t4){const{data:{rect:_,rotation:C,id:I,structParent:S,popupRef:R,contentsObj:L},container:k,parent:{page:{pageNumber:T}},canvas:D}=t;let P,N;D?(delete t.canvas,{id:P,bitmap:N}=r.imageManager.getFromCanvas(k.id,D),D.remove()):(o=!0,t._hasNoCanvas=!0);const F=((A=await n._structTree.getAriaAttributes(`${oD}${I}`))==null?void 0:A.get("aria-label"))||"";s=t={annotationType:yt.STAMP,bitmapId:P,bitmap:N,pageIndex:T-1,rect:_.slice(0),rotation:C,annotationElementId:I,id:I,deleted:!1,accessibilityData:{decorative:!1,altText:F},isSvg:!1,structParent:S,popupRef:R,comment:(L==null?void 0:L.str)||null}}const a=await super.deserialize(t,n,r),{rect:u,bitmap:c,bitmapUrl:d,bitmapId:m,isSvg:p,accessibilityData:g}=t;o?(r.addMissingCanvas(t.id,a),U(a,jd,!0)):m&&r.imageManager.isValidId(m)?(U(a,Er,m),c&&U(a,En,c)):U(a,Nl,d),U(a,ds,p);const[w,b]=a.pageDimensions;return a.width=(u[2]-u[0])/w,a.height=(u[3]-u[1])/b,g&&(a.altTextData=g),a._initialData=s,t.comment&&a.setCommentData(t.comment),U(a,Nm,!!s),a}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r={annotationType:yt.STAMP,bitmapId:f(this,Er),pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,isSvg:f(this,ds),structTreeParentId:this._structTreeParentId};if(this.addComment(r),t)return r.bitmapUrl=W(this,Ht,L_).call(this,!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(r.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const u=W(this,Ht,j4).call(this,r);if(u.isSame)return null;u.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1}if(r.id=this.annotationElementId,n===null)return r;n.stamps||(n.stamps=new Map);const a=f(this,ds)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!n.stamps.has(f(this,Er)))n.stamps.set(f(this,Er),{area:a,serialized:r}),r.bitmap=W(this,Ht,L_).call(this,!1);else if(f(this,ds)){const u=n.stamps.get(f(this,Er));a>u.area&&(u.area=a,u.serialized.bitmap.close(),u.serialized.bitmap=W(this,Ht,L_).call(this,!1))}return r}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const n={rect:this.getPDFRect()};return this.hasEditedComment&&(n.popup=this.comment),t.updateEdited(n),null}}En=new WeakMap,Er=new WeakMap,Cc=new WeakMap,Nl=new WeakMap,xc=new WeakMap,Pm=new WeakMap,Ol=new WeakMap,jd=new WeakMap,ma=new WeakMap,ds=new WeakMap,Nm=new WeakMap,Ht=new WeakSet,Iy=function(t,n=!1){if(!t){this.remove();return}U(this,En,t.bitmap),n||(U(this,Er,t.id),U(this,ds,t.isSvg)),t.file&&U(this,Pm,t.file.name),W(this,Ht,N_).call(this)},Dy=function(){if(U(this,Cc,null),this._uiManager.enableWaiting(!1),!!f(this,Ol)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&f(this,En)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&f(this,En)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},P_=function(){if(f(this,Er)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(f(this,Er)).then(r=>W(this,Ht,Iy).call(this,r,!0)).finally(()=>W(this,Ht,Dy).call(this));return}if(f(this,Nl)){const r=f(this,Nl);U(this,Nl,null),this._uiManager.enableWaiting(!0),U(this,Cc,this._uiManager.imageManager.getFromUrl(r).then(s=>W(this,Ht,Iy).call(this,s)).finally(()=>W(this,Ht,Dy).call(this)));return}if(f(this,xc)){const r=f(this,xc);U(this,xc,null),this._uiManager.enableWaiting(!0),U(this,Cc,this._uiManager.imageManager.getFromFile(r).then(s=>W(this,Ht,Iy).call(this,s)).finally(()=>W(this,Ht,Dy).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=cS.join(",");const n=this._uiManager._signal;U(this,Cc,new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),W(this,Ht,Iy).call(this,s)}r()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:n})}).finally(()=>W(this,Ht,Dy).call(this))),t.click()},N_=function(){var m;const{div:t}=this;let{width:n,height:r}=f(this,En);const[s,o]=this.pageDimensions,a=.75;if(this.width)n=this.width*s,r=this.height*o;else if(n>a*s||r>a*o){const p=Math.min(a*s/n,a*o/r);n*=p,r*=p}const[u,c]=this.parentDimensions;this.setDims(n*u/s,r*c/o),this._uiManager.enableWaiting(!1);const d=U(this,Ol,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),this.width=n/s,this.height=r/o,(m=this._initialOptions)!=null&&m.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),W(this,Ht,wT).call(this),f(this,Nm)||(this.parent.addUndoableEditor(this),U(this,Nm,!0)),this._reportTelemetry({action:"inserted_image"}),f(this,Pm)&&this.div.setAttribute("aria-description",f(this,Pm)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},O_=function(t,n){const{width:r,height:s}=f(this,En);let o=r,a=s,u=f(this,En);for(;o>2*t||a>2*n;){const c=o,d=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*n&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const m=new OffscreenCanvas(o,a);m.getContext("2d").drawImage(u,0,0,c,d,0,0,o,a),u=m.transferToImageBitmap()}return u},wT=function(){const[t,n]=this.parentDimensions,{width:r,height:s}=this,o=new Da,a=Math.ceil(r*t*o.sx),u=Math.ceil(s*n*o.sy),c=f(this,Ol);if(!c||c.width===a&&c.height===u)return;c.width=a,c.height=u;const d=f(this,ds)?f(this,En):W(this,Ht,O_).call(this,a,u),m=c.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(d,0,0,d.width,d.height,0,0,a,u)},L_=function(t){if(t){if(f(this,ds)){const s=this._uiManager.imageManager.getSvgUrl(f(this,Er));if(s)return s}const n=document.createElement("canvas");return{width:n.width,height:n.height}=f(this,En),n.getContext("2d").drawImage(f(this,En),0,0),n.toDataURL()}if(f(this,ds)){const[n,r]=this.pageDimensions,s=Math.round(this.width*n*Gc.PDF_TO_CSS_UNITS),o=Math.round(this.height*r*Gc.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(s,o);return a.getContext("2d").drawImage(f(this,En),0,0,f(this,En).width,f(this,En).height,0,0,s,o),a.transferToImageBitmap()}return structuredClone(f(this,En))},j4=function(t){var a;const{pageIndex:n,accessibilityData:{altText:r}}=this._initialData,s=t.pageIndex===n,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===r;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}},re(vT,"_type","stamp"),re(vT,"_editorType",yt.STAMP);var qd,Om,ga,Sc,Ll,fs,Tc,Lm,Ud,xo,Fl,Cr,Ml,Ic,Fm,nt,Dc,xn,q4,Ko,bT,AT,F_;const go=class go{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:r,accessibilityManager:s,annotationLayer:o,drawLayer:a,textLayer:u,viewport:c,l10n:d}){z(this,xn);z(this,qd);z(this,Om,!1);z(this,ga,null);z(this,Sc,null);z(this,Ll,null);z(this,fs,new Map);z(this,Tc,!1);z(this,Lm,!1);z(this,Ud,!1);z(this,xo,null);z(this,Fl,null);z(this,Cr,null);z(this,Ml,null);z(this,Ic,null);z(this,Fm,-1);z(this,nt);const m=[...f(go,Dc).values()];if(!go._initialized){go._initialized=!0;for(const p of m)p.initialize(d,e)}e.registerEditorTypes(m),U(this,nt,e),this.pageIndex=t,this.div=n,U(this,qd,s),U(this,ga,o),this.viewport=c,U(this,Cr,u),this.drawLayer=a,this._structTree=r,f(this,nt).addLayer(this)}get isEmpty(){return f(this,fs).size===0}get isInvisible(){return this.isEmpty&&f(this,nt).getMode()===yt.NONE}updateToolbar(e){f(this,nt).updateToolbar(e)}updateMode(e=f(this,nt).getMode()){switch(W(this,xn,F_).call(this),e){case yt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case yt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case yt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of f(go,Dc).values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=f(this,Cr))==null?void 0:t.div)}setEditingState(e){f(this,nt).setEditingState(e)}addCommands(e){f(this,nt).addCommands(e)}cleanUndoStack(e){f(this,nt).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=f(this,ga))==null||t.div.classList.toggle("disabled",!e)}async enable(){var n;U(this,Ud,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(n=f(this,Ic))==null||n.abort(),U(this,Ic,null);const e=new Set;for(const r of f(this,fs).values())r.enableEditing(),r.show(!0),r.annotationElementId&&(f(this,nt).removeChangedExistingAnnotation(r),e.add(r.annotationElementId));if(!f(this,ga)){U(this,Ud,!1);return}const t=f(this,ga).getEditableAnnotations();for(const r of t){if(r.hide(),f(this,nt).isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const s=await this.deserialize(r);s&&(this.addOrRebuild(s),s.enableEditing())}U(this,Ud,!1)}disable(){var r;if(U(this,Lm,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),f(this,Cr)&&!f(this,Ic)){U(this,Ic,new AbortController);const s=f(this,nt).combinedSignal(f(this,Ic));f(this,Cr).div.addEventListener("pointerdown",o=>{const{clientX:u,clientY:c,timeStamp:d}=o,m=f(this,Fm);if(d-m>500){U(this,Fm,d);return}U(this,Fm,-1);const{classList:p}=this.div;p.toggle("getElements",!0);const g=document.elementsFromPoint(u,c);if(p.toggle("getElements",!1),!this.div.contains(g[0]))return;let w;const b=new RegExp(`^${P5}[0-9]+$`);for(const _ of g)if(b.test(_.id)){w=_.id;break}if(!w)return;const A=f(this,fs).get(w);(A==null?void 0:A.annotationElementId)===null&&(o.stopPropagation(),o.preventDefault(),A.dblclick())},{signal:s,capture:!0})}const e=new Map,t=new Map;for(const s of f(this,fs).values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){e.set(s.annotationElementId,s);continue}else t.set(s.annotationElementId,s);(r=this.getEditableAnnotation(s.annotationElementId))==null||r.show(),s.remove()}if(f(this,ga)){const s=f(this,ga).getEditableAnnotations();for(const o of s){const{id:a}=o.data;if(f(this,nt).isDeletedAnnotationElement(a)){o.updateEdited({deleted:!0});continue}let u=t.get(a);if(u){u.resetAnnotationElement(o),u.show(!1),o.show();continue}u=e.get(a),u&&(f(this,nt).addChangedExistingAnnotation(u),u.renderAnnotationElement(o)&&u.show(!1)),o.show()}}W(this,xn,F_).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of f(go,Dc).values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),U(this,Lm,!1)}getEditableAnnotation(e){var t;return((t=f(this,ga))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){f(this,nt).getActive()!==e&&f(this,nt).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=f(this,Cr))!=null&&e.div&&!f(this,Ml)){U(this,Ml,new AbortController);const t=f(this,nt).combinedSignal(f(this,Ml));f(this,Cr).div.addEventListener("pointerdown",W(this,xn,q4).bind(this),{signal:t}),f(this,Cr).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=f(this,Cr))!=null&&e.div&&f(this,Ml)&&(f(this,Ml).abort(),U(this,Ml,null),f(this,Cr).div.classList.remove("highlighting"))}enableClick(){if(f(this,Sc))return;U(this,Sc,new AbortController);const e=f(this,nt).combinedSignal(f(this,Sc));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=f(this,Sc))==null||e.abort(),U(this,Sc,null)}attach(e){f(this,fs).set(e.id,e);const{annotationElementId:t}=e;t&&f(this,nt).isDeletedAnnotationElement(t)&&f(this,nt).removeDeletedAnnotationElement(e)}detach(e){var t;f(this,fs).delete(e.id),(t=f(this,qd))==null||t.removePointerInTextLayer(e.contentDiv),!f(this,Lm)&&e.annotationElementId&&f(this,nt).addDeletedAnnotationElement(e)}remove(e){this.detach(e),f(this,nt).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(f(this,nt).addDeletedAnnotationElement(e.annotationElementId),cn.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),f(this,nt).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!f(this,Ud)),f(this,nt).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!f(this,Ll)&&(e._focusEventsAllowed=!1,U(this,Ll,setTimeout(()=>{U(this,Ll,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:f(this,nt)._signal}),t.focus())},0))),e._structTreeParentId=(n=f(this,qd))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return f(this,nt).getId()}combinedSignal(e){return f(this,nt).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=f(this,xn,Ko))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await f(this,nt).updateMode(e.mode);const{offsetX:n,offsetY:r}=W(this,xn,AT).call(this),s=this.getNextId(),o=W(this,xn,bT).call(this,{parent:this,id:s,x:n,y:r,uiManager:f(this,nt),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=f(go,Dc).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,f(this,nt)))||null}createAndAddNewEditor(e,t,n={}){const r=this.getNextId(),s=W(this,xn,bT).call(this,{parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:f(this,nt),isCentered:t,...n});return s&&this.add(s),s}addNewEditor(e={}){this.createAndAddNewEditor(W(this,xn,AT).call(this),!0,e)}setSelected(e){f(this,nt).setSelected(e)}toggleSelected(e){f(this,nt).toggleSelected(e)}unselect(e){f(this,nt).unselect(e)}pointerup(e){var r;const{isMac:t}=$r.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!f(this,Tc)||(U(this,Tc,!1),(r=f(this,xn,Ko))!=null&&r.isDrawer&&f(this,xn,Ko).supportMultipleDrawings))return;if(!f(this,Om)){U(this,Om,!0);return}const n=f(this,nt).getMode();if(n===yt.STAMP||n===yt.SIGNATURE){f(this,nt).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var r;if(f(this,nt).getMode()===yt.HIGHLIGHT&&this.enableTextSelection(),f(this,Tc)){U(this,Tc,!1);return}const{isMac:t}=$r.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(U(this,Tc,!0),(r=f(this,xn,Ko))!=null&&r.isDrawer){this.startDrawingSession(e);return}const n=f(this,nt).getActive();U(this,Om,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),f(this,xo)){f(this,xn,Ko).startDrawing(this,f(this,nt),!1,e);return}f(this,nt).setCurrentDrawingSession(this),U(this,xo,new AbortController);const t=f(this,nt).combinedSignal(f(this,xo));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(U(this,Fl,null),this.commitOrRemove())},{signal:t}),f(this,xn,Ko).startDrawing(this,f(this,nt),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&U(this,Fl,t);return}f(this,Fl)&&setTimeout(()=>{var t;(t=f(this,Fl))==null||t.focus(),U(this,Fl,null)},0)}endDrawingSession(e=!1){return f(this,xo)?(f(this,nt).setCurrentDrawingSession(null),f(this,xo).abort(),U(this,xo,null),U(this,Fl,null),f(this,xn,Ko).endDrawing(e)):null}findNewParent(e,t,n){const r=f(this,nt).findParent(t,n);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return f(this,xo)?(this.endDrawingSession(),!0):!1}onScaleChanging(){f(this,xo)&&f(this,xn,Ko).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=f(this,nt).getActive())==null?void 0:e.parent)===this&&(f(this,nt).commitOrRemove(),f(this,nt).setActiveEditor(null)),f(this,Ll)&&(clearTimeout(f(this,Ll)),U(this,Ll,null));for(const n of f(this,fs).values())(t=f(this,qd))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,f(this,fs).clear(),f(this,nt).removeLayer(this)}render({viewport:e}){this.viewport=e,Xd(this.div,e);for(const t of f(this,nt).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){f(this,nt).commitOrRemove(),W(this,xn,F_).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,Xd(this.div,{rotation:n}),t!==n)for(const r of f(this,fs).values())r.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return f(this,nt).viewParameters.realScale}};qd=new WeakMap,Om=new WeakMap,ga=new WeakMap,Sc=new WeakMap,Ll=new WeakMap,fs=new WeakMap,Tc=new WeakMap,Lm=new WeakMap,Ud=new WeakMap,xo=new WeakMap,Fl=new WeakMap,Cr=new WeakMap,Ml=new WeakMap,Ic=new WeakMap,Fm=new WeakMap,nt=new WeakMap,Dc=new WeakMap,xn=new WeakSet,q4=function(e){f(this,nt).unselectAll();const{target:t}=e;if(t===f(this,Cr).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&f(this,Cr).div.contains(t)){const{isMac:n}=$r.platform;if(e.button!==0||e.ctrlKey&&n)return;f(this,nt).showAllEditors("highlight",!0,!0),f(this,Cr).div.classList.add("free"),this.toggleDrawing(),w1.startHighlighting(this,f(this,nt).direction==="ltr",{target:f(this,Cr).div,x:e.x,y:e.y}),f(this,Cr).div.addEventListener("pointerup",()=>{f(this,Cr).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:f(this,nt)._signal}),e.preventDefault()}},Ko=function(){return f(go,Dc).get(f(this,nt).getMode())},bT=function(e){const t=f(this,xn,Ko);return t?new t.prototype.constructor(e):null},AT=function(){const{x:e,y:t,width:n,height:r}=this.div.getBoundingClientRect(),s=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+n),u=Math.min(window.innerHeight,t+r),c=(s+a)/2-e,d=(o+u)/2-t,[m,p]=this.viewport.rotation%180===0?[c,d]:[d,c];return{offsetX:m,offsetY:p}},F_=function(){for(const e of f(this,fs).values())e.isEmpty()&&e.remove()},re(go,"_initialized",!1),z(go,Dc,new Map([tT,hT,vT,w1,yT].map(e=>[e._editorType,e])));let _T=go;var So,gi,Vd,F0,j1,U4,ka,CT,V4,xT;const or=class or{constructor({pageIndex:e}){z(this,ka);z(this,So,null);z(this,gi,new Map);z(this,Vd,new Map);this.pageIndex=e}setParent(e){if(!f(this,So)){U(this,So,e);return}if(f(this,So)!==e){if(f(this,gi).size>0)for(const t of f(this,gi).values())t.remove(),e.append(t);U(this,So,e)}}static get _svgFactory(){return Rt(this,"_svgFactory",new y1)}draw(e,t=!1,n=!1){const r=ir(or,F0)._++,s=W(this,ka,CT).call(this),o=or._svgFactory.createElement("defs");s.append(o);const a=or._svgFactory.createElement("path");o.append(a);const u=`path_p${this.pageIndex}_${r}`;a.setAttribute("id",u),a.setAttribute("vector-effect","non-scaling-stroke"),t&&f(this,Vd).set(r,a);const c=n?W(this,ka,V4).call(this,o,u):null,d=or._svgFactory.createElement("use");return s.append(d),d.setAttribute("href",`#${u}`),this.updateProperties(s,e),f(this,gi).set(r,s),{id:r,clipPathId:`url(#${c})`}}drawOutline(e,t){const n=ir(or,F0)._++,r=W(this,ka,CT).call(this),s=or._svgFactory.createElement("defs");r.append(s);const o=or._svgFactory.createElement("path");s.append(o);const a=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let u;if(t){const m=or._svgFactory.createElement("mask");s.append(m),u=`mask_p${this.pageIndex}_${n}`,m.setAttribute("id",u),m.setAttribute("maskUnits","objectBoundingBox");const p=or._svgFactory.createElement("rect");m.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const g=or._svgFactory.createElement("use");m.append(g),g.setAttribute("href",`#${a}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const c=or._svgFactory.createElement("use");r.append(c),c.setAttribute("href",`#${a}`),u&&c.setAttribute("mask",`url(#${u})`);const d=c.cloneNode();return r.append(d),c.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(r,e),f(this,gi).set(n,r),n}finalizeDraw(e,t){f(this,Vd).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var u;if(!t)return;const{root:n,bbox:r,rootClass:s,path:o}=t,a=typeof e=="number"?f(this,gi).get(e):e;if(a){if(n&&W(this,ka,xT).call(this,a,n),r&&W(u=or,j1,U4).call(u,a,r),s){const{classList:c}=a;for(const[d,m]of Object.entries(s))c.toggle(d,m)}if(o){const d=a.firstChild.firstChild;W(this,ka,xT).call(this,d,o)}}}updateParent(e,t){if(t===this)return;const n=f(this,gi).get(e);n&&(f(t,So).append(n),f(this,gi).delete(e),f(t,gi).set(e,n))}remove(e){f(this,Vd).delete(e),f(this,So)!==null&&(f(this,gi).get(e).remove(),f(this,gi).delete(e))}destroy(){U(this,So,null);for(const e of f(this,gi).values())e.remove();f(this,gi).clear(),f(this,Vd).clear()}};So=new WeakMap,gi=new WeakMap,Vd=new WeakMap,F0=new WeakMap,j1=new WeakSet,U4=function(e,[t,n,r,s]){const{style:o}=e;o.top=`${100*n}%`,o.left=`${100*t}%`,o.width=`${100*r}%`,o.height=`${100*s}%`},ka=new WeakSet,CT=function(){const e=or._svgFactory.create(1,1,!0);return f(this,So).append(e),e.setAttribute("aria-hidden",!0),e},V4=function(e,t){const n=or._svgFactory.createElement("clipPath");e.append(n);const r=`clip_${t}`;n.setAttribute("id",r),n.setAttribute("clipPathUnits","objectBoundingBox");const s=or._svgFactory.createElement("use");return n.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),r},xT=function(e,t){for(const[n,r]of Object.entries(t))r===null?e.removeAttribute(n):e.setAttribute(n,r)},z(or,j1),z(or,F0,0);let ET=or;globalThis._pdfjsTestingUtils={HighlightOutliner:rT};globalThis.pdfjsLib={AbortException:Wc,AnnotationEditorLayer:_T,AnnotationEditorParamsType:Ft,AnnotationEditorType:yt,AnnotationEditorUIManager:Qd,AnnotationLayer:QS,AnnotationMode:Mu,AnnotationType:Gn,build:iee,ColorPicker:m1,createValidAbsoluteUrl:N5,DOMSVGFactory:y1,DrawLayer:ET,FeatureTest:$r,fetchData:r2,getDocument:Fj,getFilenameFromUrl:JQ,getPdfFilenameFromUrl:YQ,getRGB:Fb,getUuid:F5,getXfaPageViewport:QQ,GlobalWorkerOptions:va,ImageKind:a_,InvalidPDFException:lS,isDataScheme:Lb,isPdfFile:lD,isValidExplicitDest:uZ,MathClamp:vi,noContextMenu:Xs,normalizeUnicode:WQ,OPS:rv,OutputScale:Da,PasswordResponses:MQ,PDFDataRangeTransport:Mj,PDFDateString:h1,PDFWorker:ov,PermissionFlag:FQ,PixelsPerInch:Gc,RenderingCancelledException:aD,ResponseException:c1,setLayerDimensions:Xd,shadow:Rt,SignatureExtractor:Bl,stopEvent:Jn,SupportedImageMimeTypes:cS,TextLayer:iv,TouchManager:f1,updateUrlHash:O5,Util:Je,VerbosityLevel:Pb,version:ree,XfaLayer:Uj};const Tee="/assets/pdf.worker.min-r-TJsTTt.mjs";va.workerSrc=Tee;class gD extends ct{constructor(t){super(t);re(this,"handleFileUpload",async t=>{var r,s,o,a,u;const n=(r=t.target.files)==null?void 0:r[0];if(n){this.setState({loading:!0,error:null});try{const c=(n.name.split(".").pop()||"").toLowerCase();if(c==="pdf"){const d=await this._parsePdf(n);(o=(s=this.props)==null?void 0:s.callBack)==null||o.call(s,{data:d})}else if(["txt","md","log"].includes(c)){const d=await this._parseText(n);(u=(a=this.props)==null?void 0:a.callBack)==null||u.call(a,{data:d})}else throw new Error("Unsupported file type. Please upload a .pdf or .txt/.md/.log file.")}catch(c){console.error("Upload/parse error:",c),this.setState({error:(c==null?void 0:c.message)||"Failed to parse file."})}finally{this.setState({loading:!1}),t.target.value=""}}});re(this,"_parseText",async t=>{const n=await t.text();return{type:"text",fileName:t.name,size:t.size,text:n,lines:n.split(/\r?\n/)}});re(this,"_parsePdf",async t=>{const n=await t.arrayBuffer(),r=await Fj({data:n}).promise,s=[];for(let o=1;o<=r.numPages;o++){const c=(await(await r.getPage(o)).getTextContent()).items.map(d=>"str"in d?d.str:(d==null?void 0:d.text)||"").join(" ").replace(/\s+([.,;:!?])/g,"$1").replace(/\s+/g," ").trim();s.push(c)}return{type:"pdf",fileName:t.name,size:t.size,numPages:r.numPages,pages:s,fullText:s.join(`

`)}});this.state={loading:!1,error:null}}render(){const{loading:t,error:n}=this.state;return v.jsxs("div",{className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:[v.jsx("label",{style:{cursor:"pointer"},children:t?"Processing…":"Upload PDF/Text"}),v.jsx("input",{type:"file",accept:".pdf,.txt,.md,.log",onChange:this.handleFileUpload,style:{display:"block"}}),n&&v.jsx("div",{style:{color:"#ff6b6b",fontSize:12,marginTop:6},children:n})]})}}class Iee extends ct{constructor(t){super(t);re(this,"types",{dataTraining:"profile",dataPreference:"training",chatbot:"content",valueProp:"valueProposition",genTraining:"content",companyVetting:"training",rules:"rules",other:"training"});this.state={...this.state}}render(){const{obj:t}=this.props;let n=t.getJson(),r=this.types[n.trainingType];return n.trainingType==="rules"&&(r=this.types.rules),r||(r=this.types.other),v.jsxs("div",{className:"sequence",children:[v.jsxs("div",{children:["owner: ",n.owner]}),v.jsxs("div",{children:["type: ",n.trainingType]}),v.jsxs("div",{children:["id/name: ",n._id]}),v.jsxs("div",{children:["Messaging Type ",n.emailType]}),v.jsxs("div",{children:["Training: ",n[r]]}),v.jsx(gD,{callBack:async({data:s})=>{var c;debugger;const a={pdf:"fullText",text:"text"}[s.type];let u=this.types[n.trainingType];n.trainingType==="rules"&&(u=this.types.rules),u||(u=this.types.other),await t.setCompState({[u]:s[a]}),this.dispatch({uploadText:s}),(c=t.update)==null||c.call(t)}})]})}}class Dee extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit"}}getInnerContent(){return v.jsxs(v.Fragment,{children:[v.jsx("h4",{style:{marginBottom:"10px",font:"normal normal 900 16px/22px Satoshi"},children:"Admin"}),v.jsx(er,{name:"client",cells:[{type:"custom",custom:LQ}]}),"ALL TRAINING DOCS",v.jsx(Rb,{wrapperclassName:"none",content:v.jsx("div",{className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:"Add Training"}),popupSwitch:"addTraining"}),v.jsx(er,{name:"training",cells:[{type:"custom",custom:Iee}]})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class kee extends ct{constructor(t){super(t);re(this,"handleCsvUpload",async t=>{debugger;const r=(await this.operationsFactory.prepare({prepare:{type:"csv",researchId:this.researchId}}))[0],s=Js.getIdFromURL();let o=this.componentList.getComponent("user",s,"_id");const a=t.map(d=>({...d,owner:s,type:"potentialProspect",researchId:this.researchId,companyOwnerId:o.getJson().companyId,csvId:r.getJson()._id}));let u=await this.operationsFactory.prepare({prepare:a});this.operationsFactory.run();let c=this.componentList.getComponent("research",this.researchId,"_id");if(c!=null&&c.getJson().autoSequence){debugger;let d=this.componentList.getComponent("user",Js.getIdFromURL(!1),"_id");d||(await this.componentList.getComponentFromBackend({type:"user"}),d=this.componentList.getComponent("user",Js.getIdFromURL(!1),"_id"));for(let p of u)p.copy({type:"contact",ogPPId:p.getJson()._id,outreach:!0});const m={contacts:a,user:d.getJson(),research:c.getJson()};try{const p=await fetch("https://autosequence-7c5i3vsqma-uc.a.run.app",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}),g=await p.json();if(!p.ok)throw g;console.log("✅ Contacts created & enrolled:",g)}catch(p){console.error("❌ Error adding to sequence:",p)}}});this.state={...this.state},this.handleFileUpload=this.handleFileUpload.bind(this)}componentDidUpdate(t){const n=this.props.obj.getJson()._id;n!==this.researchId&&(this.researchId=n)}handleFileUpload(t){debugger;const n=t.target.files[0];n&&k5.parse(n,{header:!0,skipEmptyLines:!0,complete:r=>{console.log("Parsed CSV data:",r.data),this.handleCsvUpload(r.data)},error:r=>{console.error("Error while parsing:",r)}})}async componentDidMount(){var s;const t=(s=this.props.obj)==null?void 0:s.getJson().content,n=No(t);this.setState({plainText:n});let{obj:r}=this.props;await this.componentList.getComponentsFromBackend({type:"csv",ids:r.getJson()._id,filterKeys:"researchId"}),this.setState({})}render(){const{obj:t}=this.props;let n=t.getJson();return v.jsxs("div",{children:[v.jsx("div",{className:"sequence",children:v.jsxs("div",{className:"title",style:{justifyContent:"space-between",padding:"2px"},children:[v.jsx("div",{style:{color:"#262626",maxWidth:"50%",minWidth:"50%"},className:"title-left",children:v.jsx("span",{style:{width:"100%",display:"inline-block",overflow:"hidden",lineBreak:"anywhere",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.name})}),v.jsxs("div",{className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:[v.jsx("label",{htmlFor:`file-upload${this.props.obj.getJson()._id}`,className:"",children:"Upload"}),v.jsx("input",{id:`file-upload${this.props.obj.getJson()._id}`,type:"file",accept:".csv",onChange:this.handleFileUpload})]})]})}),v.jsxs("div",{children:[n.AIPrompt," "]}),v.jsx(er,{name:"csv",filter:{search:n._id,attribute:"researchId"},cells:[{type:"attribute",name:"_id"}]})]})}}class Ree extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit"}}async componentDidMount(){await this.componentList.getComponentFromBackend({type:"user"})}getInnerContent(){let e=Js.getIdFromURL();return v.jsxs(v.Fragment,{children:[v.jsx("h4",{style:{marginBottom:"10px",font:"normal normal 900 16px/22px Satoshi"},children:"Admin"}),v.jsx(er,{name:"research",filter:{search:e,attribute:"owner"},cells:[{type:"custom",custom:kee}]})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class Pee extends ct{constructor(e){super(e),this.state={...this.state,plainText:""}}componentDidMount(){var n;const e=(n=this.props.obj)==null?void 0:n.getJson().content,t=No(e);this.setState({plainText:t})}componentDidUpdate(e){var r,s;const t=(r=this.props.obj)==null?void 0:r.getJson().content,n=(s=this.props.obj)==null?void 0:s.getJson().content;if(t!==n){const o=No(t);this.setState({plainText:o})}}render(){const{obj:e}=this.props;let t=e.getJson();return v.jsx("div",{className:"sequence",children:v.jsxs("div",{className:"title",style:{justifyContent:"space-between",padding:"2px"},children:[v.jsx(yn,{style:{color:"#262626",maxWidth:"50%",minWidth:"50%"},to:"/user/"+t._id,onClick:()=>{this.dispatch({popupSwitch:"",currentPopupComponent:void 0})},className:"title-left",children:v.jsx("span",{style:{width:"100%",display:"inline-block",overflow:"hidden",lineBreak:"anywhere",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t._id})}),v.jsx(yn,{style:{marginRight:"0px"},to:"/template/"+t._id,onClick:()=>{this.dispatch({popupSwitch:"",currentPopupComponent:void 0})},className:"title-right",children:"View Details"})]})})}}class Nee extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit"}}getInnerContent(){return v.jsxs(v.Fragment,{children:[v.jsx("h4",{style:{marginBottom:"10px",font:"normal normal 900 16px/22px Satoshi"},children:"Admin"}),v.jsx(er,{name:"user",filter:{search:this.propsState.currentClient.getJson()._id,attribute:"clientId"},cells:[{type:"custom",custom:Pee}]})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class hF extends sg{async componentDidMount(){let e=Js.getIdFromURL();await this.getComponentsFromBackend(),await this.componentList.getComponentsFromBackend({type:"user",ids:e,filterKeys:"clientId"});let n=(await this.componentList.getComponentsFromBackend({type:"todo",ids:this.propsState.currentUser.getJson()._id,filterKeys:"owner"})).find(r=>r.getJson().clientId===e);n||(n=(await this.operationsFactory.prepare({prepare:{type:"todo",clientId:e},clean:!0}))[0]),this.dispatch({currentTodo:n})}getInnerContent(){return v.jsxs("div",{className:"fit",children:[[1,2,3,4,5,6].map(e=>{var s;const t=`attribute${e}`,n=`complete${e}`,r=(s=this.propsState.currentTodo)==null?void 0:s.getJson();return v.jsxs("div",{children:[r==null?void 0:r[t],v.jsx("div",{onClick:()=>{var a;const o=!r[n];(a=this.propsState.currentTodo)==null||a.setCompState({[n]:o},{run:!0})},children:r!=null&&r[n]?"Done":"Mark Done"})]},e)}),v.jsx(Es,{obj:this.propsState.currentTodo,content:"save"}),v.jsx("div",{onClick:async()=>{let e=await this.operationsFactory.prepare({prepare:{type:"user"}});e=e[0],this.dispatch({popupSwitch:"addUser",currentPopupComponent:e})},children:"add user"}),v.jsx("div",{children:v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(Nee,{})})}),v.jsx("div",{})]})}render(){return v.jsx("div",{className:this.props.pageClass||"fit",children:this.state.gotComponents&&this.getInnerContent()})}}class Oee extends sg{async componentDidMount(){await this.getComponentsFromBackend();let e=await this.componentList.getComponentsFromBackend({type:"client",ids:"alan@salescapture.com",filterKeys:"owner"});await this.componentList.getComponentsFromBackend("training",!1),console.log(e)}getInnerContent(){return v.jsx("div",{className:"fit",children:v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(Dee,{})})})}render(){return v.jsx("div",{className:this.props.pageClass||"fit",children:this.state.gotComponents&&this.getInnerContent()})}}class dF extends sg{async componentDidMount(){await this.getComponentsFromBackend();let e=Js.getIdFromURL(),t=await this.componentList.getComponentsFromBackend({type:"research",ids:e,filterKeys:"owner"});this.dispatch({}),console.log(t)}getInnerContent(){return v.jsx("div",{className:"fit",children:v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(Ree,{})})})}render(){return v.jsx("div",{className:this.props.pageClass||"fit",children:this.state.gotComponents&&this.getInnerContent()})}}class fF extends lf{constructor(e){super(e),this.state={...this.state,defaultClass:"fit",owner:this.app.state.currentUser.getJson()._id,visible:!0}}async componentDidMount(){await this.getComponentsFromBackend()}render(){return v.jsxs("div",{className:this.props.pageClass||this.state.defaultClass,style:{display:"flex"},children:[v.jsx("div",{style:{width:window.innerWidth>600?"50%":"100%"},children:v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(wQ,{})})}),v.jsx("div",{style:{width:window.innerWidth>600?"50%":"0%",position:"relative"},children:this.propsState.currentContact&&window.innerWidth>600&&this.state.visible&&v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(u1,{})})})]})}}class Lee extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit",currentConversation:null}}async componentDidMount(){await this.prepareMessages()}async prepareMessages(){let e=this.propsState.currentConversation;e||(e=this.componentList.getComponent("conversation"),await this.dispatch({currentConversation:e})),e?(await this.prepNewMessage(),this.setState({start:!0})):this.setState({message:"no current conversations"})}async prepNewMessage(){let e=this.propsState.currentConversation;const t=e.getJson().messageType||"email";let n=this.componentList.getList("email",this.propsState.currentConversation.getJson()._id,"conversationId");n=n[n.length-1];let r=n.getJson().originalMessageId,s=n.getJson().subject;const o=await this.operationsFactory.prepare({prepare:{type:t,conversationId:e.getJson()._id,originalMessageId:r||"",subject:s,ownerMessage:!0},clean:!0});this.dispatch({currentComponent:o[0]}),this.setState({currentConversation:e})}componentDidUpdate(e,t){this.propsState.currentConversation!==this.state.currentConversation&&this.prepNewMessage()}getInnerContent(){var n,r;const{currentConversation:e}=this.propsState;let t=this.componentList.getComponent("contact",e==null?void 0:e.getJson().contact,"email");return v.jsxs("div",{children:[window.innerWidth>1&&v.jsxs("div",{style:{position:"sticky",top:0,zIndex:200,display:"flex",flexDirection:"row",alignItems:"center",justifyItems:"space-between",background:"white",padding:"20px",paddingBottom:"8px",transform:"translateZ(0)"},children:[window.innerWidth<600&&v.jsx("div",{onClick:()=>{this.dispatch({showConversation:void 0})},children:v.jsx("img",{src:mQ,style:{color:"black"}})}),v.jsx("div",{className:"contact-avatar",style:{maxWidth:"45px",maxHeight:"45px"},children:v.jsx("i",{className:"fa-solid fa-user"})}),v.jsxs("div",{className:"message-header-title",children:[v.jsx("span",{className:"sender-title",children:(n=this.propsState.currentConversation)==null?void 0:n.getJson().contactName}),v.jsx("span",{className:"sender-details-button",children:"See Details"})]}),v.jsx("div",{style:{fontSize:".8rem",cursor:"pointer",minWidth:"55px"},className:"hover-basic",children:(r=t==null?void 0:t.getJson())!=null&&r.autoAI?v.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},onClick:()=>{t.setCompState({autoAI:!1},{run:!0},!0)},children:v.jsx("i",{class:"fa-solid fa-comment-nodes",style:{fontSize:"35px",color:"#36b593"}})}):v.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},onClick:()=>{t.setCompState({autoAI:!0},{run:!0},!0)},children:v.jsx("i",{class:"fa-solid fa-comment-nodes",style:{fontSize:"35px",color:"#363636"}})})})]}),v.jsx("div",{className:"layoutColumn conversation-container",style:{padding:"20px",marginBottom:"12px"},children:this.state.message?v.jsx(v.Fragment,{children:this.state.message}):v.jsx(v.Fragment,{children:this.state.start&&v.jsxs("div",{style:{width:"100%",marginTop:"-20px"},children:[v.jsx(er,{mapContainerClass:"message-list",name:(e==null?void 0:e.getJson().messageType)||"email",cells:[{type:"custom",custom:pQ}],filter:{search:this.propsState.currentConversation.getJson()._id,attribute:"conversationId"},filterFunc:s=>!(s.getJson().body===void 0||s.getJson().body==="")}),v.jsxs("div",{style:{display:"flex",flexDirection:"row",position:"sticky",bottom:0,zIndex:1,width:"100%",minHeight:"70px",paddingBottom:"85px",paddingLeft:"12px",background:"linear-gradient(to bottom, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 1%)"},children:[v.jsx("div",{style:{position:"relative",width:"40px",zIndex:2},children:v.jsx(Es,{content:v.jsx("button",{className:"footer-btn",style:{marginBottom:"-15px",position:"absolute",left:0},children:v.jsx("i",{className:"fa-solid fa-circle-plus"})}),callbackFunc:()=>{let s=this.propsState.currentComponent;if(s.getJson().body==="")return;this.prepNewMessage();let o={originalMessageId:s.getJson().originalMessageId,from:this.propsState.currentUser.getJson()._id,to:this.propsState.currentConversation.getJson().contact,subject:s.getJson().subject,text:s.getJson().body},a=this.propsState.currentUser.getJson().gmailAuthenticated?"https://gmailapiemailhandler-7c5i3vsqma-uc.a.run.app":"https://sendgridemailhandler-7c5i3vsqma-uc.a.run.app";fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then(u=>{if(!u.ok)throw new Error(`HTTP error! Status: ${u.status}`);return u.json()}).then(u=>{console.log("Reply sent successfully in thread.",u)}).catch(u=>{console.error("Error sending reply:",u)})}})}),v.jsx("div",{style:{zIndex:3,width:"100%"},children:v.jsx(Qe,{wrapperClass:"footer-input",formClass:"search-input",name:"body",obj:this.propsState.currentComponent})})]})]})})})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}const H4="/assets/LogoGreen-BKvA74vO.svg";class pF extends lf{constructor(e){super(e),this.state={...this.state,defaultClass:"fit",owner:this.app.state.currentUser.getJson()._id}}async componentDidMount(){await this.dispatch({currentTopic:void 0,currentSubTopic:void 0,currentComponent:void 0}),await this.getComponentsFromBackend()}componentWillUnmount(){this.operationsFactory.clear(),this.dispatch({currentComponent:void 0})}render(){let e=window.innerWidth>600;return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:v.jsxs("div",{style:{paddingTop:"22px",display:"flex",flexDirection:"column",paddingLeft:e?"0%":"8%"},children:[v.jsx("img",{src:H4,style:{width:"50%",marginBottom:"40px"}}),v.jsx("span",{style:{fontWeight:"900",fontSize:"1.12em",color:"#323232"},children:"Messaging Management Platform Coming Soon"}),v.jsx("div",{style:{marginTop:"20px",width:"80%"},children:"We're polishing the Messaging experience. In the meantime, you can manage contacts and research from the left navigation."}),v.jsx(yn,{to:"/contacts",className:"inLine-Link",style:{alignSelf:"flex-start",marginTop:"22px"},children:"Go to Contacts"})," "]})})}}class Fee extends ct{constructor(e){super(e)}render(){const{obj:e}=this.props;let t=e.getJson();return v.jsx("div",{className:"sequence sequence-custom",children:v.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},onClick:()=>{let n=this.props.obj,r=this.propsState.selectedContacts;if(this.propsState.sequenceDataType==="research"){let o=[];for(let a of r)o.push(this.componentList.getComponent("contact",a.getJson()._id,"ogPPId"))}let s=this.componentList.getList("step",[n.getJson()._id],["sequenceId"]);if(s=s.filter(o=>o.getJson().content!==""&&o.getJson().content)[0],(r==null?void 0:r.length)>0){let o=parseFloat(s.getJson().nextSend),a=new Date(Date.now()+o*60*60*1e3);a=Qn.fromDate(a);for(let u of r){const c=n.getJson()._id,d=u.getJson().sequenceId,m=d?this.componentList.getComponent("sequence",d):null,p=String(u.getJson().finishedSequenceTags||"").split(",").map(w=>w.trim()).filter(Boolean),g=u.getJson().finished===!0;if(m&&g){const w=String(m.getJson().name||"");w&&!p.includes(w)&&p.push(w)}u.setCompState({sequenceId:c,finishedSequenceTags:p.join(","),finished:!1,emailNumber:0,nextSend:a},{run:!0})}this.dispatch({popupSwitch:"",selectedContacts:[]})}},children:[v.jsx("div",{className:"title-left",children:t.name}),v.jsx("div",{children:v.jsx("div",{id:"arrow-icon-appear",className:"send-seq-icon",children:v.jsx("i",{class:"fa-solid fa-right-long"})})})]})})}}class Mee extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit scroller"}}async componentDidMount(){var e;if(this.propsState.currentUser.getJson().outreachio&&((e=this.componentList.getList("outreachUser"))==null?void 0:e.length)===0){let t=this.propsState.currentUser.getJson().outreachAccessToken;await fetch("https://getusersandmailboxes-7c5i3vsqma-uc.a.run.app",{headers:{Authorization:`Bearer ${t}`}}).then(n=>n.json()).then(async n=>{debugger;console.log(n);let r=n.users,s=n.mailboxes,o=r.map(u=>{let c=s.find(m=>m.attributes.email===u.attributes.email);return{_id:u.id.toString(),type:"outreachUser",mailboxId:c.id,type:"outreachUser",mailboxEmail:c.attributes.email}}),a=await this.componentList.addComponents(o,!0);this.dispatch({outreachUsers:a})}),await fetch("https://getsequences-7c5i3vsqma-uc.a.run.app",{headers:{Authorization:`Bearer ${t}`}}).then(n=>n.json()).then(async n=>{console.log(n);let r=n.data.map(o=>({type:"sequence",_id:o.id.toString(),outreach:!0,name:o.attributes.name,outreachSequenceId:o.attributes.id})),s=await this.componentList.addComponents(r,!0);this.dispatch({outreachSequences:s})})}}render(){var e;return v.jsxs("div",{style:{padding:"20px",paddingBottom:"100px",position:"relative",paddingTop:"0px"},className:this.props.pageClass||this.state.defaultClass,children:[v.jsxs("div",{style:{paddingTop:"20px",display:"flex",flexDirection:"column",position:"sticky",top:0,zIndex:20,background:"white"},children:[v.jsx("h2",{children:"Add to Sequence"})," ",v.jsxs("div",{className:"count-desc",style:{position:"relative",margin:"10px"},children:["Contacts: ",((e=this.propsState.selectedContacts)==null?void 0:e.length)||"0"," "]})]}),this.propsState.currentUser.getJson().outreachio?v.jsxs(v.Fragment,{children:["Select Sequence",v.jsx(Qe,{handleChange:t=>{let n=t.target.value;debugger;let r=this.componentList.getComponent("sequence",n);this.dispatch({selectedSequence:r})},type:"select",textOptions:this.componentList.getList("sequence").map(t=>t.getJson().name),selectOptions:this.componentList.getList("sequence")}),"Select User",v.jsx(Qe,{handleChange:t=>{debugger;let n=t.target.value,r=this.componentList.getComponent("outreachUser",n);this.dispatch({selectedUser:r})},type:"select",textOptions:this.componentList.getList("outreachUser").map(t=>t.getJson().mailboxEmail),selectOptions:this.componentList.getList("outreachUser")}),v.jsx("div",{onClick:async()=>{debugger;const{selectedContacts:t=[],selectedUser:n,selectedSequence:r,currentUser:s}=this.propsState,o=n.getJson(),a=r.getJson();if(!Array.isArray(t)||t.length===0){console.error("No contacts selected to add.");return}if(!o||!a){console.error("User or sequence not selected.");return}const c={contacts:t.map(d=>({firstName:d.getJson().firstName,lastName:d.getJson().lastName,emails:[d.getJson().email],userId:o._id,company:d.getJson().company,mailboxId:o.mailboxId})),sequenceId:a._id};try{let d=this.propsState.currentUser.getJson().outreachAccessToken;const m=await fetch("https://createcontactsandenroll-7c5i3vsqma-uc.a.run.app",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(c)}),p=await m.json();if(!m.ok)throw p;console.log("✅ Contacts created & enrolled:",p),this.dispatch({popupSwitch:""})}catch(d){console.error("❌ Error adding to sequence:",d)}},className:"floating-select-btn-text",style:{color:"black"},children:"Add to Sequence"})]}):v.jsx(er,{name:"sequence",cells:[{type:"custom",custom:Fee}]})]})}}class Bee extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit scroller"}}extractSubjectAndBody(e){const t=e.match(/^{{\s*([^}]+?)\s*}}/);let n="",r="";t?(n=t[1].trim(),r=e.slice(t[0].length).trim()):r=e.trim();const s=r.split(`

`).map(o=>`<p>${o.replace(/\n/g,"<br>")}</p>`).join(`
`);return{subject:n,body:s}}render(){this.props.obj;let e=v.jsx(Es,{formClass:"dark-button-1",content:"Save",isPopup:!0,callbackFunc:this.props.callbackFunc});return this.propsState.popupSwitch.includes("update")&&(e=v.jsx(Q0,{formClass:"dark-button-1",obj:this.propsState.currentPopupComponent,content:"Save",isPopup:!0,callbackFunc:this.props.callbackFunc})),v.jsxs("div",{style:{padding:"10px",paddingBottom:"100px"},className:this.props.pageClass||this.state.defaultClass,children:[v.jsxs("div",{style:{display:"flex",gap:"8px"},children:[v.jsx("div",{onClick:async()=>{try{const t=this.propsState.currentUser,n=this.propsState.currentSequence.getJson()._id,r=this.componentList.getList("step",n,"sequenceId");let s="template";const o={};if(r.length>0){const d=r[r.length-1];s="sequence",o.conversationHistory={lastSentEmail:d.getJson().content}}const a=await $c.generateMessage(t,s,o),{subject:u,body:c}=$c.extractSubjectAndBody(a);console.log("Generated Subject:",u),console.log("Generated Body:",c),this.propsState.currentPopupComponent.setCompState({content:c,subject:u}),this.dispatch({})}catch(t){console.error("Failed to draft with AI:",t),console.log("An error occurred while generating the draft. Please check the console.")}},className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:"Draft With AI"}),v.jsx("div",{className:"dark-button-1",style:{position:"relative",width:"fit-content"},onClick:()=>{this.setState({selectTemplate:!0})},children:"Select Template"})]}),this.state.selectTemplate&&v.jsx(er,{name:"template",filterFunc:t=>{var s;if(t.getJson().content===void 0||t.getJson().content==="")return!1;let n=!1;this.propsState.searchText||(n=!0);let r=this.propsState.searchText;return(s=t.getJson().content)!=null&&s.toLowerCase().includes(r==null?void 0:r.toLowerCase())&&(n=!0),n},cells:[{type:"custom",custom:xQ}]}),v.jsx("br",{}),v.jsxs("div",{className:"content-home-add",children:[v.jsx("div",{className:"contact-contact-data",children:v.jsxs("div",{className:"row row-container",children:[v.jsx("div",{className:"row-name",style:{maxWidth:"fit-content"},children:"Subject:"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{obj:this.propsState.currentPopupComponent,name:"subject",formClass:"underline-form"})})]})}),v.jsx("div",{className:"row",children:v.jsx(Qe,{type:"quill",obj:this.propsState.currentPopupComponent,name:"content",wrapperClass:"contentWrapper"})}),v.jsxs("div",{className:"row",children:[v.jsx("div",{children:"Trigger this step in:"}),v.jsx(Qe,{obj:this.propsState.currentPopupComponent,name:"nextSend",formClass:"underline-form",wrapperStyle:{width:"10%",marginRight:"8px",borderBottom:"1px solid rgb(212, 212, 212)"}})," days"]}),v.jsxs("div",{className:"row",children:[this.propsState.popupSwitch.includes("update")&&v.jsx(ng,{obj:this.propsState.currentPopupComponent,formClass:"del-button-1",callbackFunc:()=>{this.dispatch({popupSwitch:"",currentPopupComponent:void 0})}}),v.jsx("div",{className:"col hover-basic",style:{cursor:"pointer",width:"37px",height:"37px"},children:v.jsx(mJ,{obj:this.propsState.currentPopupComponent,content:v.jsx("div",{style:{display:"flex",alignItems:"center",borderRadius:"50%",justifyContent:"center",fontSize:"19px",width:"37px",height:"37px",background:"#378c75",color:"#ade0d3"},children:v.jsx("div",{className:"icon-last",children:v.jsx("i",{className:"fa-solid fa-plus"})})})})}),v.jsx("div",{className:"col",children:e})]}),v.jsx("div",{})]})]})}}const mF="/assets/scailogofake-B3YGBRpn.png";class jee extends E5{getHtml(){return v.jsxs("div",{className:"bottom-nav",children:[v.jsxs(yn,{to:"/conversation",className:"bottom-nav-item",children:[v.jsx("i",{className:"fa-solid fa-message"}),v.jsx("span",{children:"Messages Beta"})]}),v.jsxs(yn,{to:"/contacts",className:"bottom-nav-item",children:[v.jsx("i",{className:"fa-solid fa-address-book"}),v.jsx("span",{children:"Contacts"})]}),v.jsx("a",{href:"#",className:"bottom-nav-item",children:v.jsx("div",{id:"float-btn-plus",className:"float-btn",children:v.jsx("i",{className:"fas fa-plus"})})}),v.jsxs(yn,{to:"/research",className:"bottom-nav-item",children:[v.jsx("i",{className:"fa-solid fa-graduation-cap"}),v.jsx("span",{children:"Research"})]}),v.jsxs(yn,{to:"/content",className:"bottom-nav-item",children:[v.jsx("i",{className:"fa-solid fa-briefcase"}),v.jsx("span",{children:"Content"})]})]})}}const z4="/assets/robot1-CSSNI2BR.png",qee="/assets/robot2-BdnbMmdt.png",Uee="/assets/robot3-ezM16bsn.png",Vee="/assets/robot4-D4sKJWTc.png",Hee="/assets/robot5-OJ06PYe2.png",zee="/assets/ai-agent.png";class jy extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit scroller",showAdvanced:!1,showPasteByType:{},trainingType:"other",trainingDocTypes:["dataTraining","dataPreference","genTraining","valueProp","companyVetting","rules"],agentName:"",agentImageSrc:this.props.agentImageSrc||zee},this.types={dataTraining:"profile",dataPreference:"training",chatbot:"content",valueProp:"valueProposition",genTraining:"content",companyVetting:"training",rules:"rules",other:"training"},this.trainingLabels={dataTraining:{label:"Query Training",hint:"Background & examples to guide the agent’s research queries."},dataPreference:{label:"Scoring / Vetting",hint:"Scoring criteria, disqualifiers, & ideal prospect preferences."},genTraining:{label:"Generation Style",hint:"Tone/voice guidance used when writing outputs."},valueProp:{label:"Value Proposition",hint:"Company/product value props and benefits."},companyVetting:{label:"Company Vetting",hint:"Company-level filters (size, revenue, tech stack, etc.)."},rules:{label:"Rules",hint:"Hard rules the agent must follow."},other:{label:"Other Training",hint:"Any additional guidance."}}}async componentDidMount(){var t;if(this.propsState.currentUser.getJson().outreachio&&((t=this.componentList.getList("outreachUser"))==null?void 0:t.length)===0){let n=this.propsState.currentUser.getJson().outreachAccessToken;await fetch("https://getusersandmailboxes-7c5i3vsqma-uc.a.run.app",{headers:{Authorization:`Bearer ${n}`}}).then(r=>r.json()).then(async r=>{let s=r.users,o=r.mailboxes,a=s.map(m=>{var g;let p=o.find(w=>w.attributes.email===m.attributes.email);return{_id:m.id.toString(),type:"outreachUser",mailboxId:p==null?void 0:p.id,mailboxEmail:(g=p==null?void 0:p.attributes)==null?void 0:g.email}}),u=this.propsState.componentListInterface.getFactory(),d=[...this.componentList.getList("outreachUser")];for(let m of a){let p=await u.getComponent(m);d=[...d,p]}this.componentList.setSelectedList("outreachUser",d),this.dispatch({outreachUsers:d})}),await fetch("https://getsequences-7c5i3vsqma-uc.a.run.app",{headers:{Authorization:`Bearer ${n}`}}).then(r=>r.json()).then(async r=>{let s=r.data.map(c=>({type:"sequence",_id:c.id.toString(),outreach:!0,name:c.attributes.name,outreachSequenceId:c.attributes.id})),o=this.propsState.componentListInterface.getFactory(),u=[...this.componentList.getList("sequence").filter(c=>c.getJson().outreach===void 0)];for(let c of s){let d=await o.getComponent(c);u=[...u,d]}this.componentList.setSelectedList("sequence",u),this.dispatch({outreachSequences:u})})}this.propsState.currentPopupComponent.setCompState({companyOwnerId:this.propsState.currentUser.getJson().companyId})}getHeaderSection(e){const t=this.state.agentName||e.getJson().name||"";return v.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:24,marginBottom:18},children:[v.jsxs("div",{style:{flex:1},children:[v.jsxs("div",{style:{color:"#94a3b8",fontSize:12,marginBottom:6},children:["Configure Options › ",t||"Configure AI agent"]}),v.jsxs("h2",{style:{margin:0,fontSize:28,lineHeight:"32px"},children:["Configure the AI agent",t?`: ${t}`:""]}),v.jsxs("div",{style:{marginTop:12},children:[v.jsx("div",{className:"row-name",style:{marginBottom:6},children:"Agent name"}),v.jsx(Qe,{obj:e,placeholder:"E.g., Daily Research",name:"name",inPopup:!0})]})]}),v.jsx("img",{src:z4,alt:"Agent",style:{width:140,height:140,objectFit:"contain"}})]})}getPromptSection(e){return v.jsx("div",{style:{padding:12,background:"rgb(245,244,244)",borderRadius:12,marginBottom:16},children:v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Prompt"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,placeholder:"Describe your target prospect. “E.g., Research VP of Sales at tech companies under $100M revenue.”",name:"AIPrompt",inPopup:!0})})]})})}getActionsSection(e){const t=!!this.propsState.currentUser.getJson().outreachio,n=this.componentList.getList("sequence").map(s=>s.getJson().name),r=this.componentList.getList("outreachUser").map(s=>s.getJson().mailboxEmail);return v.jsxs("div",{style:{padding:12,background:"white",border:"1px solid #e5e7eb",borderRadius:12,marginBottom:18},children:[v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Action when data is found"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"actionOnFindDisplay",type:"select",inPopup:!0,handleChange:s=>{debugger;let o=s.target.value,a=this.propsState.currentUser.getJson().actionItems[o];e.setCompState({actionOnFind:a,actionOnFindDisplay:o}),this.dispatch({})},selectOptions:this.propsState.currentUser.getJson().actionItems?[...Object.keys(this.propsState.currentUser.getJson().actionItems).sort((s,o)=>{const a=s.includes("Sequence"),u=o.includes("Sequence");return a&&!u?-1:!a&&u?1:s.localeCompare(o)})]:["Sequence"]})})]}),t&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:12},children:[v.jsx("div",{className:"row-name",children:"Outreach sequence"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{name:"sequenceDisplay",obj:e,type:"select",selectOptions:n,handleChange:s=>{const o=s.target.value,a=this.componentList.getComponent("sequence",o,"name");e.setCompState({outreachSequenceId:a==null?void 0:a.getJson()._id,sequenceDisplay:o}),this.dispatch({})}})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:12},children:[v.jsx("div",{className:"row-name",children:"Send as user"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{name:"outreachUserDisplay",obj:e,type:"select",selectOptions:r,handleChange:s=>{const o=s.target.value,a=this.componentList.getComponent("outreachUser",o,"mailboxEmail");e.setCompState({outreachUserId:a==null?void 0:a.getJson()._id,outreachUserDisplay:o}),this.dispatch({})}})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:12},children:[v.jsx("div",{className:"row-name",children:"Auto-add to sequence"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,type:"select",name:"autoSequenceDisplay",selectOptions:["Yes","No"],handleChange:s=>{const o=s.target.value==="Yes";e.setCompState({autoSequence:o,autoSequenceDisplay:s.target.value})}})})]})]})]})}getTrainingUploadsSection(e){const t=Array.isArray(this.state.trainingDocTypes)&&this.state.trainingDocTypes.length?this.state.trainingDocTypes:["other"];return v.jsxs("div",{style:{marginTop:8},children:[v.jsx("h3",{style:{marginBottom:8},children:"Training uploads"}),v.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:t.map(n=>this.getSingleTrainingUpload(e,n))})]})}getSingleTrainingUpload(e,t){var o,a,u;const n=((o=this.trainingLabels[t])==null?void 0:o.label)||t,r=((a=this.trainingLabels[t])==null?void 0:a.hint)||"",s=!!((u=this.state.showPasteByType)!=null&&u[t]);return v.jsxs("div",{style:{padding:12,background:"#f9fafb",borderRadius:12,border:"1px solid #e5e7eb"},children:[v.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between",gap:12},children:[v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:600},children:n}),r&&v.jsx("div",{style:{color:"#6b7280",fontSize:12},children:r})]}),v.jsxs("div",{style:{display:"flex",gap:8},children:[v.jsx("button",{className:"dark-button-1",onClick:()=>this.setState(c=>({trainingType:t,showPasteByType:{...c.showPasteByType,[t]:!1}})),children:"Upload file"}),v.jsx("button",{className:"dark-button-1",onClick:()=>this.setState(c=>{var d;return{trainingType:t,showPasteByType:{...c.showPasteByType,[t]:!((d=c.showPasteByType)!=null&&d[t])}}}),children:s?"Hide paste":"Paste text"})]})]}),!s&&v.jsx("div",{style:{marginTop:10},children:v.jsx(gD,{callBack:async({data:c})=>{let d=this.types[t];t==="rules"&&(d=this.types.rules);const p={pdf:"fullText",text:"text"}[c.type];this.operationsFactory.prepare({prepare:{type:"training",[d]:c[p],trainingType:t,_id:e.getJson()._id+t,companyOwnerId:this.propsState.currentUser.getJson().companyId}}),this.obj.setCompState({[this.researchTrainingkey[t]]:e.getJson()._id+t}),d||(d=this.types.other),this.dispatch({uploadText:c[p]}),this.setState({content:c[p]})}})}),s&&v.jsxs("div",{style:{marginTop:10},children:[v.jsx("textarea",{placeholder:"Paste training text here…",style:{width:"100%",minHeight:140,padding:8,borderRadius:8,border:"1px solid #d1d5db"},onBlur:async c=>{let d=this.types[t]||this.types.other;await e.setCompState({[d]:c.target.value}),this.dispatch({uploadText:c.target.value})}}),v.jsx("div",{style:{color:"#6b7280",fontSize:12,marginTop:6},children:"Blur the field to save."})]})]},t)}getCadenceAndLimitSection(e){return v.jsxs("div",{style:{padding:12,background:"white",border:"1px solid #e5e7eb",borderRadius:12,marginTop:8,marginBottom:16},children:[v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Cadence"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"searchFrequency",type:"select",inPopup:!0,selectOptions:["Daily","Weekly"]})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:10},children:[v.jsx("div",{className:"row-name",children:"Result limit"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"dayLimit",inPopup:!0,placeholder:"e.g., 50"})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:10},children:[v.jsx("div",{className:"row-name",children:"Vetting Threshold"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"vettingThreshold",inPopup:!0,placeholder:"a number between 1-100"})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:10},children:[v.jsx("div",{className:"row-name",children:"Other Titles"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"otherTitles",inPopup:!0,placeholder:"Titles not included in your prompt but still ok."})})]})]})}getAdvancedToggle(){return v.jsx("div",{style:{marginTop:14,marginBottom:8},children:v.jsx("div",{className:"dark-button-1",onClick:()=>this.setState(e=>({showAdvanced:!e.showAdvanced})),children:this.state.showAdvanced?"Hide advanced options":"Show advanced options"})})}getAdvancedPanel(e){var t;return this.state.showAdvanced?((this.componentList.getList("owner")||this.componentList.getList("user")||[]).map(n=>{var r,s;return((r=n.getJson)==null?void 0:r.call(n).email)||((s=n.getJson)==null?void 0:s.call(n).name)||n.email||n.name}).filter(Boolean),v.jsxs("div",{style:{padding:12,background:"white",border:"1px solid #e5e7eb",borderRadius:12,marginTop:10},children:[v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Mode"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"mode",type:"select",inPopup:!0,selectOptions:["Manual","Auto"]})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Active"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx("div",{onClick:()=>{e.setCompState({active:!e.getJson().active}),this.setState()},children:e!=null&&e.getJson().active?"Pause":"activate"})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:10},children:[v.jsx("div",{className:"row-name",children:"Source"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:e.getJson().newDataSrcs})]}),v.jsxs("div",{style:{marginTop:14,paddingTop:10,borderTop:"1px dashed #e5e7eb"},children:[v.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"CSV uploads"}),v.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[v.jsxs("div",{style:{flex:1,minWidth:280},children:[v.jsx("div",{onClick:()=>this.setState({showUpload:"people"}),style:{fontWeight:600,marginBottom:6},children:"People CSV"}),this.state.showUpload==="people"&&v.jsx(oS,{callBack:async n=>{let r=await this.componentList.getComponentsFromBackend({type:"peopleToResearch",ids:this.propsState.currentPopupComponent.getJson()._id,filterKeys:"researchId"});for(let s of r)await s.del();n=n.data.map(s=>({...s,owner:this.propsState.currentUser.getJson()._id,type:"peopleToResearch",companyOwnerId:this.propsState.currentUser.getJson().companyId,researchId:this.propsState.currentPopupComponent.getJson()._id})),this.dispatch({uploadPeopleResearchData:n}),await this.operationsFactory.prepare({prepare:n}),await this.propsState.currentPopupComponent.setCompState({hasPeopleCsv:!0,hasCompanyCsv:!1}),await this.propsState.currentPopupComponent.update(),this.operationsFactory.addToComponentList()}})]}),v.jsxs("div",{style:{flex:1,minWidth:280},children:[v.jsx("div",{onClick:()=>this.setState({showUpload:"company"}),style:{fontWeight:600,marginBottom:6},children:"Company CSV"}),this.state.showUpload==="company"&&v.jsx(oS,{callBack:async n=>{let r=await this.componentList.getComponentsFromBackend({type:"companiesToResearch",ids:this.propsState.currentPopupComponent.getJson()._id,filterKeys:"researchId"});for(let s of r)await s.del();n=n.data.map(s=>({...s,owner:this.propsState.currentUser.getJson()._id,type:"companiesToResearch",companyOwnerId:this.propsState.currentUser.getJson().companyId,researchId:this.propsState.currentPopupComponent.getJson()._id})),this.dispatch({uploadCompanyResearchData:n}),await this.operationsFactory.prepare({prepare:n}),await this.propsState.currentPopupComponent.setCompState({hasCompanyCsv:!0,hasPeopleCsv:!1}),await this.propsState.currentPopupComponent.update(),this.operationsFactory.addToComponentList()}})]})]})]}),v.jsxs("div",{style:{marginTop:14,paddingTop:10,borderTop:"1px dashed #e5e7eb"},children:[v.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"Search criteria"}),this.getSearchFieldsGroup(e)]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:14},children:[v.jsx("div",{className:"row-name",children:"Visibility"}),v.jsx("div",{className:"row-field",style:{width:"100%"}})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:14},children:[v.jsx("div",{className:"row-name",children:"Owner"}),v.jsx("div",{className:"row-field",style:{width:"100%"}})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:14},children:[v.jsx("div",{className:"row-name",children:"Second-opinion prompt (optional)"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,placeholder:"A refining prompt for a second model pass.",name:"secondOpinionPrompt",inPopup:!0})})]}),this.getTrainingUploadsSection(e),(t=this.getExtraAdvancedContent)==null?void 0:t.call(this,e)]})):null}getSearchFieldsGroup(e){return v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Keywords"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"keywords",inPopup:!0,placeholder:"Keywords in target titles"})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Company Size by Revenue"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"companySizebyRevenue",inPopup:!0})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Company Size by # of Employees"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"companySizebyEmployees",inPopup:!0})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Geographic Location"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"location",inPopup:!0})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Decision Making Level"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"contactLevel",type:"select",inPopup:!0,placeholder:"Any, Non-Manager, Director, VP, C-Level",selectOptions:["Any","Non-Manager","Director","VP","C-Level"]})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Department"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"department",inPopup:!0,placeholder:"e.g., IT, HR, Sales, Marketing"})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Industry"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"industry",inPopup:!0,placeholder:"e.g., Technology, Software, SaaS"})})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column"},children:[v.jsx("div",{className:"row-name",children:"Disqualifiers"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:v.jsx(Qe,{obj:e,name:"disqualifiers",inPopup:!0,placeholder:"Describe titles/companies you do NOT want included."})})]})]})}getExtraContent(){return null}getExtraAdvancedContent(){return null}render(){const e={display:"flex",alignItems:"center",gap:8,position:"absolute",bottom:20,right:20,borderRadius:"12px"},t={display:"flex",alignItems:"center",height:36},n={display:"inline-flex",alignItems:"center",justifyContent:"center",lineHeight:1,height:"100%",padding:"8px 14px"},r=this.propsState.currentPopupComponent,o=!!this.propsState.currentPopupComponent.getJson().date?v.jsxs("div",{style:e,children:[v.jsx("div",{style:t,children:v.jsx(ng,{formClass:"danger-button-1 dark-button-1",style:n,obj:this.propsState.currentPopupComponent,content:"Delete",isPopup:!0,inPopup:!0,callbackFunc:()=>this.dispatch({currentPopupComponent:void 0,popupSwitch:""})})}),v.jsx("div",{style:t,children:v.jsx(Q0,{formClass:"dark-button-1",style:n,obj:this.propsState.currentPopupComponent,content:"Save",isPopup:!0,callbackFunc:this.props.callbackFunc})})]}):v.jsx(Es,{formClass:"dark-button-1",content:"Save",isPopup:!0,callbackFunc:this.props.callbackFunc});return v.jsxs("div",{style:{padding:"10px",paddingBottom:"100px",height:"100%"},className:this.props.pageClass||this.state.defaultClass,children:[this.getHeaderSection(r),this.getPromptSection(r),this.getCadenceAndLimitSection(r),this.getActionsSection(r),this.getExtraContent(r),this.getAdvancedToggle(),this.getAdvancedPanel(r),v.jsx("div",{style:{height:"fit-content",display:"flex",justifyContent:"flex-end",position:"absolute",bottom:20,right:20,borderRadius:"12px",gap:8},children:o})]})}}class $ee extends jy{getAdvancedPanel(e){return this.state.showAdvanced?((this.componentList.getList("owner")||this.componentList.getList("user")||[]).map(t=>{var n,r;return((n=t.getJson)==null?void 0:n.call(t).email)||((r=t.getJson)==null?void 0:r.call(t).name)||t.email||t.name}).filter(Boolean),v.jsxs("div",{style:{padding:12,background:"white",border:"1px solid #e5e7eb",borderRadius:12,marginTop:10},children:[v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:10},children:[v.jsx("div",{className:"row-name",children:"Source"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:e.getJson().newDataSrcs})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:14},children:[v.jsx("div",{className:"row-name",children:"Visibility"}),v.jsx("div",{className:"row-field",style:{width:"100%"}})]}),this.propsState.currentPopupComponent.getJson().date&&v.jsx("div",{style:{marginTop:12},children:v.jsx(ng,{obj:this.propsState.currentPopupComponent,isPopup:!0,inPopup:!0,callbackFunc:()=>{this.dispatch({currentPopupComponent:void 0,popupSwitch:""})},formClass:"dark-button-1",content:"Delete"})}),this.getTrainingUploadsSection(e)]})):null}render(){const e=this.propsState.currentPopupComponent,n=!!this.propsState.currentPopupComponent.getJson().date?v.jsx(Q0,{formClass:"dark-button-1",obj:this.propsState.currentPopupComponent,content:"Save",isPopup:!0,callbackFunc:this.props.callbackFunc}):v.jsx(Es,{formClass:"dark-button-1",content:"Save",isPopup:!0,callbackFunc:this.props.callbackFunc});return v.jsxs("div",{style:{padding:"10px",paddingBottom:"100px",height:"100%"},className:this.props.pageClass||this.state.defaultClass,children:[this.getPromptSection(e),this.getActionsSection(e),this.getAdvancedToggle(),this.getAdvancedPanel(e),v.jsx("div",{style:{height:"fit-content",display:"flex",justifyContent:"flex-end",position:"absolute",bottom:20,right:20,borderRadius:"12px",gap:8},children:n})]})}}class Wee extends jy{getAdvancedPanel(e){return this.state.showAdvanced?((this.componentList.getList("owner")||this.componentList.getList("user")||[]).map(t=>{var n,r;return((n=t.getJson)==null?void 0:n.call(t).email)||((r=t.getJson)==null?void 0:r.call(t).name)||t.email||t.name}).filter(Boolean),v.jsxs("div",{style:{padding:12,background:"white",border:"1px solid #e5e7eb",borderRadius:12,marginTop:10},children:[v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:10},children:[v.jsx("div",{className:"row-name",children:"Source"}),v.jsx("div",{className:"row-field",style:{width:"100%"},children:e.getJson().newDataSrcs})]}),v.jsxs("div",{className:"row-container",style:{flexDirection:"column",marginTop:14},children:[v.jsx("div",{className:"row-name",children:"Visibility"}),v.jsx("div",{className:"row-field",style:{width:"100%"}})]}),this.propsState.currentPopupComponent.getJson().date&&v.jsx("div",{style:{marginTop:12},children:v.jsx(ng,{obj:this.propsState.currentPopupComponent,isPopup:!0,inPopup:!0,callbackFunc:()=>{this.dispatch({currentPopupComponent:void 0,popupSwitch:""})},formClass:"dark-button-1",content:"Delete"})}),this.getTrainingUploadsSection(e)]})):null}render(){const e=this.propsState.currentPopupComponent,n=!!this.propsState.currentPopupComponent.getJson().date?v.jsx(Q0,{formClass:"dark-button-1",obj:this.propsState.currentPopupComponent,content:"Save",isPopup:!0,callbackFunc:this.props.callbackFunc}):v.jsx(Es,{formClass:"dark-button-1",content:"Save",isPopup:!0,callbackFunc:this.props.callbackFunc});return v.jsxs("div",{style:{padding:"10px",paddingBottom:"100px",height:"100%"},className:this.props.pageClass||this.state.defaultClass,children:[this.getHeaderSection(e),this.getAdvancedToggle(),this.getAdvancedPanel(e),v.jsx("div",{style:{height:"fit-content",display:"flex",justifyContent:"flex-end",position:"absolute",bottom:20,right:20,borderRadius:"12px",gap:8},children:n})]})}}class Gee extends ct{constructor(t){var s;super(t);re(this,"handleSelectType",t=>{var s,o,a,u,c,d;const n=this.propsState.currentPopupComponent,r={agentType:t};if(t==="existing")r.getDataFrom=["existing"],r.displayDataSrc="existing",r.newDataSrcs=this.propsState.currentUser.getJson().newDataSrcs,r.existingSrcs=this.propsState.currentUser.getJson().existingSrcs,r.actionOnFind={enpoint:"https://sequencecontacts-7c5i3vsqma-uc.a.run.app",technology:[...(a=(o=(s=this.propsState.currentUser.getJson())==null?void 0:s.actionItems)==null?void 0:o.Sequence)==null?void 0:a.technology]};else if(t==="newData"){r.getDataFrom=["newData"],r.displayDataSrc="newData",r.newDataSrcs=this.propsState.currentUser.getJson().newDataSrcs,r.existingSrcs=this.propsState.currentUser.getJson().existingSrcs;let m=((d=(c=(u=this.propsState.currentUser.getJson())==null?void 0:u.actionItems)==null?void 0:c.Sequence)==null?void 0:d.technology)||[];r.actionOnFind={enpoint:"https://sequencecontacts-7c5i3vsqma-uc.a.run.app",technology:[...m]}}else t==="businessCard"?(r.getDataFrom=["newData"],r.displayDataSrc="newData",r.active=!1,r.existingSrcs=this.propsState.currentUser.getJson().existingSrcs,r.actionOnFind={enpoint:"https://sequencecontacts-7c5i3vsqma-uc.a.run.app",technology:[...this.propsState.currentUser.getJson().actionItems.Sequence.technology]},r.researchType="businessCard",this.setState({showUpload:"image"})):t==="askAlan"?(r.chatMode="alan",r.newDataSrcs=this.propsState.currentUser.getJson().newDataSrcs,r.existingSrcs=this.propsState.currentUser.getJson().existingSrcs):t==="askIsaac"&&(r.chatMode="isaac",r.newDataSrcs=this.propsState.currentUser.getJson().newDataSrcs,r.existingSrcs=this.propsState.currentUser.getJson().existingSrcs,r.getDataFrom=["newData"],r.displayDataSrc="newData",r.active=!1);n.setCompState(r),this.setState({stage:"form",agentType:t})});const n=(s=this.propsState)==null?void 0:s.currentPopupComponent,r=n&&!n.getJson().date&&!n.getJson().agentType?"choose":"form";this.state={...this.state,defaultClass:"fit scroller",stage:r,showUpload:void 0}}async componentDidMount(){var n;const t=this.propsState.currentPopupComponent;t&&((n=this.propsState)!=null&&n.currentUser)&&t.setCompState({companyOwnerId:this.propsState.currentUser.getJson().companyId})}getTypeOptions(){return[{key:"newData",title:"New Data Scout",desc:"Find new prospects from external sources",img:z4},{key:"existing",title:"Existing CRM Miner",desc:"Surface existing contacts from your CRM",img:qee},{key:"businessCard",title:"Business Card Analyzer",desc:"Extract contact info from business cards",img:Uee},{key:"askAlan",title:"Ask Alan (Research Chat)",desc:"Chat to identify sales opportunities",img:Vee},{key:"askIsaac",title:"Ask Isaac (Analytics Chat)",desc:"Reporting & analytics insights via chat",img:Hee}]}renderChooseType(){const t=this.getTypeOptions();return v.jsxs("div",{style:{padding:10},className:this.props.pageClass||this.state.defaultClass,children:[v.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:v.jsx("h2",{style:{margin:0},children:"Choose an AI agent type"})}),v.jsx("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:16},children:t.map(n=>v.jsxs("button",{onClick:()=>this.handleSelectType(n.key),className:"agent-tile",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",padding:16,borderRadius:12,border:"1px solid #e5e7eb",background:"white",boxShadow:"0 1px 2px rgba(0,0,0,0.04)",cursor:"pointer"},children:[v.jsx("img",{src:n.img,alt:"",style:{width:84,height:84,objectFit:"contain",marginBottom:12}}),v.jsx("div",{style:{fontWeight:600},children:n.title}),v.jsx("div",{style:{fontSize:13,color:"#4b5563",marginTop:6},children:n.desc})]},n.key))}),v.jsx("div",{style:{marginTop:20,display:"flex",justifyContent:"flex-end"}})]})}renderWrapper(){var s;const t=this.propsState.currentPopupComponent,n=(s=t==null?void 0:t.getJson())==null?void 0:s.agentType,r={newData:v.jsx(jy,{...this.props,agentType:"newData",showUploadDefault:this.state.showUpload,onBack:()=>this.setState({stage:"choose"})}),existing:v.jsx(jy,{...this.props,agentType:"existing",showUploadDefault:this.state.showUpload,onBack:()=>this.setState({stage:"choose"})}),businessCard:v.jsx($ee,{...this.props,agentType:"businessCard",showUploadDefault:this.state.showUpload,onBack:()=>this.setState({stage:"choose"})}),askAlan:v.jsx(jy,{...this.props,agentType:"askAlan",showUploadDefault:this.state.showUpload,onBack:()=>this.setState({stage:"choose"})}),askIsaac:v.jsx(Wee,{...this.props,agentType:"askIsaac",showUploadDefault:this.state.showUpload,onBack:()=>this.setState({stage:"choose"})})};return v.jsxs("div",{className:this.props.pageClass||this.state.defaultClass,style:{height:"100%"},children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"10px"},children:[v.jsx("div",{onClick:()=>this.setState({stage:"choose"}),className:"light-button-1",style:{padding:"8px 12px",borderRadius:10},"aria-label":"Back to choose type",children:"Back"}),v.jsx("h2",{style:{margin:0},children:"Configure Agent"})]}),r[n]||v.jsx("div",{style:{padding:20},children:v.jsx("p",{children:"No agent type selected."})})]})}render(){return this.state.stage==="choose"?this.renderChooseType():this.renderWrapper()}}class Kee extends Lee{constructor(e){super(e),this.state={...this.state,defaultClass:"fit scroller"}}componentDidMount(){var e,t;(t=this.propsState.currentPopupComponent)==null||t.setCompState({conversationId:(e=this.propsState.currentConversation)==null?void 0:e.getJson()._id,originalMessageId:!1,ownerMessage:!0}),this.setState({email:this.propsState.currentPopupComponent})}componentDidUpdate(){}extractSubjectAndBody(e){const t=e.match(/^{{\s*([^}]+?)\s*}}/);let n="",r="";t?(n=t[1].trim(),r=e.slice(t[0].length).trim()):r=e.trim();const s=r.split(`

`).map(o=>`<p>${o.replace(/\n/g,"<br>")}</p>`).join(`
`);return{subject:n,body:s}}render(){var n;const e=this.props.obj;let t=v.jsx(Es,{formClass:"dark-button-1",content:v.jsx("div",{children:"Send"}),callbackFunc:()=>{let r=this.state.email,s={from:this.propsState.currentUser.getJson()._id,to:this.propsState.currentConversation.getJson().contact,subject:r.getJson().subject,text:r.getJson().body},o=this.propsState.currentUser.getJson().gmailAuthenticated?"https://gmailapiemailhandler-7c5i3vsqma-uc.a.run.app":"https://sendgridemailhandler-7c5i3vsqma-uc.a.run.app";fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(a=>{if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);return a.json()}).then(a=>{console.log("Reply sent successfully in thread.",a)}).catch(a=>{console.error("Error sending reply:",a)}),this.dispatch({currentPopupComponent:void 0,popupSwitch:""})}});return v.jsxs("div",{style:{padding:"10px",paddingBottom:"100px",height:"100%"},className:this.props.pageClass||this.state.defaultClass,children:[v.jsx("div",{onClick:async()=>{try{const r=this.propsState.currentUser,s="template",o={},a=await $c.generateMessage(r,s,o),{subject:u,body:c}=$c.extractSubjectAndBody(a);this.propsState.currentPopupComponent.setCompState({body:c,subject:u}),this.dispatch({})}catch(r){console.error("Failed to draft with AI:",r),alert("An error occurred while generating the draft. Please check the console.")}},className:"dark-button-1",style:{position:"relative",width:"fit-content"},children:"Draft With AI"}),v.jsx("h2",{children:"Email"})," ",v.jsxs("div",{className:"contact-Add-container",children:[v.jsxs("div",{className:"row",children:[v.jsx("div",{children:"To:"}),v.jsxs("div",{style:{width:"70%",marginLeft:"7px"},children:[" ",(n=this.propsState.currentConversation)==null?void 0:n.getJson().contactName]})]}),v.jsxs("div",{className:"row",children:[v.jsx("div",{children:"From:"}),v.jsxs("div",{style:{width:"70%",marginLeft:"7px"},children:[" ","Me"]})]}),v.jsxs("div",{className:"row",children:[v.jsx("div",{children:"Subject:"}),v.jsxs("div",{style:{width:"70%",marginLeft:"7px"},children:[" ",v.jsx(Qe,{formClass:"underline-form",obj:e,name:"subject",inPopup:!0})," "]})]}),v.jsx("div",{children:v.jsxs("div",{style:{width:"100%"},children:[" ",v.jsx(Qe,{obj:e,type:"quill",name:"body",inPopup:!0})," "]})}),v.jsxs("div",{style:{width:"100%",background:"white",display:"flex",justifyContent:"flex-end",alignContent:"flex-end"},children:[" ",v.jsxs("div",{style:{marginRight:"-10px"},children:[" ",t]})]})]})]})}}class Jee extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit scroller"}}render(){return v.jsxs("div",{style:{padding:"18px",paddingBottom:"100px",height:"100%"},className:this.props.pageClass||this.state.defaultClass,children:[v.jsx("h2",{style:{font:"normal normal 900 18px/25px Satoshi"},children:"Add Tags to Selected"}),v.jsx("div",{className:"contact-contact-data",style:{marginTop:"8%",padding:"24px",border:"none",background:"#f0f0f0"},children:v.jsxs("div",{className:"row-container",children:[v.jsx("div",{className:"row-name",style:{maxWidth:"fit-content"},children:"Tags:"}),v.jsx("div",{className:"row-field",children:v.jsx("input",{class:"underline-form",onChange:e=>{let{value:t}=e.target;this.setState({tags:t})}})})]})}),v.jsx("div",{class:"dark-button-1",style:{justifySelf:"flex-end",marginTop:"20px"},onClick:async()=>{for(let e of this.propsState.selectedContacts){let t=e.getJson().tags||"";t=t.length===0?this.state.tags:","+this.state.tags,await e.setCompState({tags:t}),e.update()}this.dispatch({popupSwitch:""})},children:"Save"})]})}}class Yee extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit"}}getInnerContent(){return v.jsxs(v.Fragment,{children:[v.jsx(Qe,{obj:this.propsState.currentPopupComponent,name:"_id",inPopup:!0}),v.jsx(Qe,{obj:this.propsState.currentPopupComponent,name:"email",inPopup:!0}),v.jsx(Qe,{obj:this.propsState.currentPopupComponent,name:"collection",inPopup:!0}),v.jsx(Qe,{obj:this.propsState.currentPopupComponent,name:"owner",inPopup:!0}),v.jsx(Es,{content:"save",callbackFunc:async()=>{let e=this.propsState.currentPopupComponent;await e.setCompState({clientId:this.propsState.currentClient.getJson()._id},{run:!0}),await this.operationsFactory.prepare({prepare:[{type:"aiSettings",owner:e.getJson()._id},{type:"limit",owner:e.getJson()._id}]}),this.operationsFactory.run(),this.dispatch({currentPopupComponent:void 0,popupSwitch:""})}})]})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class Xee extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit scroller"}}render(){var t;const{sequence:e}=this.propsState;return v.jsxs("div",{style:{padding:"18px",paddingBottom:"100px",height:"100%"},className:this.props.pageClass||this.state.defaultClass,children:[v.jsx("h2",{style:{font:"normal normal 900 18px/25px Satoshi"},children:"Delete Sequence"}),v.jsx("div",{style:{marginTop:"8%",padding:"24px",border:"none",background:"#f0f0f0"},children:v.jsxs("p",{children:["Are you sure you want to delete the sequence ",v.jsx("strong",{children:((t=this.propsState.delSequence)==null?void 0:t.getJson().name)||"this"}),"? This action cannot be undone."]})}),v.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"20px"},children:[v.jsx("div",{className:"dark-button-1",onClick:()=>{this.dispatch({popupSwitch:"",delSequence:void 0})},children:"Cancel"}),v.jsx(ng,{obj:this.propsState.delSequence,content:"Delete",inPopup:!0,isPopup:!0,callbackFunc:()=>{this.dispatch({popupSwitch:"",delSequence:void 0})},className:"dark-button-1 del-button-red"})]})]})}}class gF extends ct{constructor(e){super(e),this.state={...this.state,defaultClass:"fit"}}componentWillUnmount(){this.operationsFactory.clear(),this.dispatch({currentComponent:void 0})}getInnerContent(){let e=window.innerWidth>600;return v.jsx("div",{className:"layoutRow",style:{width:"100%",height:"100%",padding:"12px"},children:v.jsxs("div",{className:"layoutColumn-welcome",children:[v.jsx("img",{src:H4,style:{width:"50%",marginBottom:"40px"}}),v.jsxs("div",{children:[v.jsx("span",{style:{fontWeight:"900",fontSize:"2em",color:"#323232"},children:"Welcome to SalesCapture AI"}),v.jsx("div",{style:{marginTop:"20px"},children:"Leverage the power of AI to supercharge your sales process"})]}),v.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:e?"row":"column",gap:"1em",marginTop:"30px",paddingBottom:e?"0px":"64px"},children:[v.jsxs("div",{className:"opener-page-card",children:[v.jsx("div",{style:{maxWidth:"45px",maxHeight:"45px",fontSize:"3em",color:"var(--app-green-3)"},children:v.jsx("i",{class:"fa-solid fa-magnifying-glass"})}),v.jsx("div",{className:"main-title",children:"Research Agent"}),v.jsx("div",{className:"main-message",children:"Identify the next best salees targets"}),v.jsx(yn,{to:"/research",className:"inLine-Link",children:v.jsx("div",{children:"Go to Research"})})]}),v.jsxs("div",{className:"opener-page-card",children:[v.jsx("div",{style:{maxWidth:"45px",maxHeight:"45px",fontSize:"3em",color:"var(--app-green-3)"},children:v.jsx("i",{class:"fa-solid fa-file-contract"})}),v.jsx("div",{className:"main-title",children:"Content Engine"}),v.jsx("div",{className:"main-message",children:"Quickly generate effective sales content"}),v.jsx(yn,{to:"/aigeneration",className:"inLine-Link",children:"Create Content"})," "]}),v.jsxs("div",{className:"opener-page-card",children:[v.jsx("div",{style:{maxWidth:"45px",maxHeight:"45px",fontSize:"3em",color:"var(--app-green-3)"},children:v.jsx("i",{class:"fa-solid fa-envelope-circle-check"})}),v.jsx("div",{className:"main-title",children:"Automated BDR"}),v.jsx("div",{className:"main-message",children:"Engage prospects with outbound campaigns"}),v.jsx(yn,{to:"/contacts",className:"inLine-Link",children:"Start Campaign"})," "]})]})]})})}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,children:this.getInnerContent()})}}class Qee extends sg{async componentDidMount(){await this.getComponentsFromBackend(),await this.componentList.getComponentsFromBackend("training",!1);const e=this.urlId;if(!e||e==="aigeneration"){const t=await this.operationsFactory.prepare({prepare:{type:"template"},clean:!0});this.dispatch({currentComponent:t[0]})}}async bridgeAiService(){let{persona:e,details:t,messageType:n}=this.state;n||(n="template");const r=this.propsState.currentComponent,s=this.propsState.currentUser;if(!n){console.log("Please select a message type.");return}const o={persona:e,details:t,conversationHistory:{}};switch(n){case"reply":o.conversationHistory={fullHistory:t,lastProspectReply:t};break;case"sequence":o.conversationHistory={lastSentEmail:t};break;default:o.details=t;break}try{const a=await $c.generateMessage(s,n,o),{subject:u,body:c}=$c.extractSubjectAndBody(a);r.setCompState({content:c,subject:u}),console.log(c),this.dispatch({})}catch(a){console.error("Failed to generate AI message:",a),console.log("There was an error generating the message. Please check the console.")}}getInnerContent(){function e(a){const u=new Set;return a.filter(c=>{const d=c.getJson().emailType;return u.has(d)?!1:(u.add(d),!0)})}let t=this.componentList.getList("training","genTraining","trainingType");t=e(t);let n=t.map(a=>a.getJson().displayName),r=t.map(a=>a.getJson().emailType),s="Additional Instructions",o="Any extra details or specifications...";return this.state.messageType==="reply"?(s="Paste Email Thread to Reply To:",o="e.g., On Fri, Jul 25, 2025, Jane Smith wrote: I'm interested..."):this.state.messageType==="sequence"&&(s="Paste Last Email Sent in Sequence:",o="e.g., Subject: Checking In..."),v.jsxs("div",{className:"fit",style:{display:"flex",flexDirection:"column"},children:[v.jsx(yn,{to:"/content",className:"inLine-Link white-button-end",children:v.jsx("div",{children:"Go to Sequences"})}),v.jsx("h1",{children:"Content Engine"}),v.jsx("h3",{children:"The SalesCapture AI content engine is configured to optimize content for your products and services."}),v.jsx("div",{onClick:()=>this.setState({showAIDraft:!this.state.showAIDraft}),className:this.state.showAIDraft?"dark-button-1":"green-button-1",style:{position:"relative",width:"fit-content",margin:"1em"},children:this.state.showAIDraft?"Cancel":"Draft With AI"}),v.jsx("div",{className:"input-container",style:{marginTop:"38px"},children:" "}),this.state.showAIDraft&&v.jsxs("div",{style:{padding:"1em",marginLeft:"1em",border:"1px solid gray",borderRadius:"14px"},children:[v.jsx("h2",{children:"Generate Content"}),v.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:["Select Message Type:",v.jsx("div",{style:{marginLeft:"8px"},children:v.jsx(Qe,{formClass:"input-bar row-container underline-form",wrapperClass:"fit",type:"select",selectOptions:n,handleChange:a=>{let u=n.indexOf(a.target.value),c=r[u];this.setState({messageType:c})}})})]}),v.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:["Persona/Tone",v.jsx("input",{className:"input-bar row-container",style:{border:"none",paddingBottom:".3em",margin:".5em"},name:"persona",placeholder:'(e.g., "friendly and casual" or "formal and direct")',onChange:a=>this.setState({persona:a.target.value})})]}),v.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[v.jsx("div",{children:s}),v.jsx("input",{className:"input-bar row-container",style:{border:"none",paddingBottom:".3em",margin:".5em"},name:"details",placeholder:o,value:this.state.details||"",onChange:a=>this.setState({details:a.target.value})})]}),v.jsx("div",{className:"green-button-1",onClick:()=>this.bridgeAiService(),children:"Generate"})]}),v.jsxs("div",{className:"input-container",style:{marginTop:"38px"},children:[" ","Subject",v.jsx("div",{className:"row-field input-bar",children:this.propsState.currentComponent&&v.jsx(Qe,{name:"subject",obj:this.propsState.currentComponent})})]}),v.jsxs("div",{className:"input-container",children:[" ","Content",v.jsx("div",{className:"input-bar",children:this.propsState.currentComponent&&v.jsx(Qe,{type:"quill",name:"content",obj:this.propsState.currentComponent})})]}),v.jsx("div",{children:v.jsx(Es,{content:v.jsx("div",{className:"dark-button-1",children:"Save Template"})})})]})}render(){return v.jsx("div",{className:this.props.pageClass||"fit",children:this.state.gotComponents&&this.getInnerContent()})}}class yF extends lf{constructor(e){super(e),this.state={...this.state,defaultClass:"fit",owner:this.app.state.currentUser.getJson()._id}}async componentDidMount(){await this.getComponentsFromBackend()}render(){return v.jsx("div",{className:this.props.pageClass||this.state.defaultClass,style:{display:"flex",flexDirection:"column"},children:v.jsx(pr,{theme:"NoBorder",type:"fit",content:v.jsx(Qee,{})})})}}class Zee extends ct{constructor(t){super(t);re(this,"types",{dataTraining:"profile",dataPreference:"training",chatbot:"content",valueProp:"valueProposition",genTraining:"content",companyVetting:"training",rules:"rules",other:"training"});this.state={...this.state,defaultClass:"fit scroller"}}render(){let t=this.propsState.currentPopupComponent,n=v.jsx(Es,{formClass:"dark-button-1",content:"Save",isPopup:!0});return v.jsxs(v.Fragment,{children:[v.jsx("h2",{style:{position:"sticky",top:0,padding:"2%",width:"80%"},children:"Add Training Doc"}),v.jsx("div",{className:"contact-Add-container",children:v.jsxs("div",{className:"contact-contact-data",children:[v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().owner?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"Owner"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{obj:t,formClass:"underline-form",name:"owner",placeholder:"owner",inPopup:!0})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().trainingType?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"Training Type"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{obj:t,formClass:"underline-form",name:"trainingType",placeholder:"e.g., valueProp, content, training",inPopup:!0,callbackFunc:r=>{let s=r[0];this.setState({trainingType:s.getJson().trainingType})}})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().prompt?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"Email Type (only if its a type for messaging)"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{obj:t,formClass:"underline-form",name:"emailType",placeholder:"Template training in general for messaging",inPopup:!0})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().prompt?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"Prompt (only if its a type for messaging)"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{obj:t,formClass:"underline-form",name:"prompt",placeholder:"Add an innitial prompt needed for messaging",inPopup:!0})})]}),v.jsxs("div",{className:`row-container ${t!=null&&t.getJson().prompt?"":"unfilled-container"}`,children:[v.jsx("div",{className:"row-name",children:"Display Name (only if its a type for messaging)"}),v.jsx("div",{className:"row-field",children:v.jsx(Qe,{obj:t,formClass:"underline-form",name:"displayName",placeholder:"what is displayed on the dropdown",inPopup:!0})})]}),v.jsx(gD,{callBack:async({data:r})=>{debugger;const o={pdf:"fullText",text:"text"}[r.type];let a=this.types[this.state.trainingType];this.state.trainingType==="rules"&&(a=this.types.rules),a||(a=this.types.other),await t.setCompState({[a]:r[o]}),this.dispatch({uploadText:r[o]}),this.setState({content:r[o]})}}),"Training Content:",this.state.content]})}),v.jsx("div",{style:{paddingBottom:"20px",width:"100%",display:"flex",justifyContent:"flex-end",alignContent:"flex-end",gap:"8px"},children:n})]})}}class ete extends FX{constructor(e){super(e,{db:X$,endpoint:"salescaptureAI",auth:Q$,storage:Y$}),this.popupComponents={contact:u1,step:Bee,research:Gee,email:Kee,user:Yee,training:Zee},this.popupComponentsProps={},l1.getFactory().registerComponent("bottomNavMap",jee),this.state={...this.state,navBarProps:{mapType:window.innerWidth<1e3?"bottomNavMap":void 0,type:window.innerWidth<1e3?"topBar":void 0,style:{backgroundColor:"#35b593",color:"white",fontFamily:"'Satoshi-Variable', sans-serif"},cardStyle:{backgroundColor:"#35b593",position:window.innerWidth<1e3&&"absolute",bottom:window.innerWidth<1e3&&"0px",fontFamily:"'Satoshi-Variable', sans-serif"},logoURL:window.innerWidth>1e3&&mF,linkItemStyle:{color:"white",fontFamily:"'Satoshi-Variable', sans-serif"}},routes:[{comp:gF,name:"Home",path:"/"},{comp:pF,name:"Messages Beta",path:"conversation"},{comp:jL,name:"Contacts",path:"contacts"},{comp:UL,name:"Research",path:"research",idComp:fF},{comp:yF,path:"aigeneration",name:"Content Engine"},{comp:HL,name:"Settings",path:"settings"},{comp:VL,name:"",path:"content"},{comp:Ow,name:"",path:"sequence",idComp:Ow},{comp:Lw,name:"",path:"template",idComp:Lw},{comp:hF,name:"",path:"client",idComp:hF},{comp:Oee,name:"Admin",path:"admin"},{comp:dF,name:"",path:"user",idComp:dF}],refresh:!0,popups:[{content:Mee,popupSwitch:"addToSequence"},{content:Jee,popupSwitch:"addTags"},{content:Xee,popupSwitch:"delSequence"},{content:u1,popupSwitch:"viewPotentialProspect"}]},this.registerListWithFactory([...Object.values(rQ)]);let t=l1.getNavList();t.update(0,{class:"SCAILogo"}),t.update(1,{activeClass:"SCAILink"}),window.innerWidth<1e3&&(t.remove(2),t.remove(0))}componentDidMount(){super.componentDidMount();let e=document.getElementById("signUpFT");e&&(e.style.display="none");const t="data-login-img-inserted",n=()=>{const o=document.querySelectorAll('h1, h2, h3, [role="heading"]');return Array.from(o).find(a=>/login/i.test(a.textContent.trim()))},r=()=>{const o=n();if(!o)return!1;const a=o.parentElement;if(!a||a.hasAttribute(t))return!1;const u=document.createElement("img");return u.src=mF,u.alt="Login icon",u.style.display="block",u.style.borderRadius="15px",u.style.marginBottom="15px",u.style.width="200px",u.style.padding="10px",a.insertBefore(u,o),a.setAttribute(t,"true"),!0};if(r())return;const s=new MutationObserver(()=>{r()&&s.disconnect()});s.observe(document.body,{childList:!0,subtree:!0})}componentDidUpdate(e,t){this.state.gotUser&&this.state.refresh&&this.state.currentUser.getJson()._id!=="alan@salescapture.com"&&this.dispatch({refresh:!1,routes:[{comp:gF,name:"Home",path:"/"},{comp:pF,name:"Messages Beta",path:"conversation"},{comp:jL,name:"Contacts",path:"contacts"},{comp:UL,name:"Research",path:"research",idComp:fF},{comp:yF,path:"aigeneration",name:"Content Engine"},{comp:HL,name:"Settings",path:"settings"},{comp:VL,name:"",path:"content"},{comp:Ow,name:"",path:"sequence",idComp:Ow},{comp:Lw,name:"",path:"template",idComp:Lw}]})}}r6.createRoot(document.getElementById("root")).render(v.jsx(Ae.StrictMode,{children:v.jsx(ete,{})}));
